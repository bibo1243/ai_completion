(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function $b(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Fb={exports:{}},dh={},Bb={exports:{}},je={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fc=Symbol.for("react.element"),j_=Symbol.for("react.portal"),L_=Symbol.for("react.fragment"),$_=Symbol.for("react.strict_mode"),F_=Symbol.for("react.profiler"),B_=Symbol.for("react.provider"),U_=Symbol.for("react.context"),z_=Symbol.for("react.forward_ref"),V_=Symbol.for("react.suspense"),H_=Symbol.for("react.memo"),W_=Symbol.for("react.lazy"),ev=Symbol.iterator;function K_(t){return t===null||typeof t!="object"?null:(t=ev&&t[ev]||t["@@iterator"],typeof t=="function"?t:null)}var Ub={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},zb=Object.assign,Vb={};function ga(t,e,n){this.props=t,this.context=e,this.refs=Vb,this.updater=n||Ub}ga.prototype.isReactComponent={};ga.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ga.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Hb(){}Hb.prototype=ga.prototype;function Rg(t,e,n){this.props=t,this.context=e,this.refs=Vb,this.updater=n||Ub}var Ng=Rg.prototype=new Hb;Ng.constructor=Rg;zb(Ng,ga.prototype);Ng.isPureReactComponent=!0;var tv=Array.isArray,Wb=Object.prototype.hasOwnProperty,Ig={current:null},Kb={key:!0,ref:!0,__self:!0,__source:!0};function qb(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)Wb.call(e,r)&&!Kb.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:fc,type:t,key:i,ref:o,props:s,_owner:Ig.current}}function q_(t,e){return{$$typeof:fc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Pg(t){return typeof t=="object"&&t!==null&&t.$$typeof===fc}function G_(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var nv=/\/+/g;function Qh(t,e){return typeof t=="object"&&t!==null&&t.key!=null?G_(""+t.key):e.toString(36)}function du(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case fc:case j_:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Qh(o,0):r,tv(s)?(n="",t!=null&&(n=t.replace(nv,"$&/")+"/"),du(s,e,n,"",function(c){return c})):s!=null&&(Pg(s)&&(s=q_(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(nv,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",tv(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+Qh(i,a);o+=du(i,e,n,l,s)}else if(l=K_(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+Qh(i,a++),o+=du(i,e,n,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Oc(t,e,n){if(t==null)return t;var r=[],s=0;return du(t,r,"","",function(i){return e.call(n,i,s++)}),r}function J_(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var dn={current:null},hu={transition:null},Y_={ReactCurrentDispatcher:dn,ReactCurrentBatchConfig:hu,ReactCurrentOwner:Ig};function Gb(){throw Error("act(...) is not supported in production builds of React.")}je.Children={map:Oc,forEach:function(t,e,n){Oc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Oc(t,function(){e++}),e},toArray:function(t){return Oc(t,function(e){return e})||[]},only:function(t){if(!Pg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};je.Component=ga;je.Fragment=L_;je.Profiler=F_;je.PureComponent=Rg;je.StrictMode=$_;je.Suspense=V_;je.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Y_;je.act=Gb;je.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=zb({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Ig.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)Wb.call(e,l)&&!Kb.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:fc,type:t.type,key:s,ref:i,props:r,_owner:o}};je.createContext=function(t){return t={$$typeof:U_,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:B_,_context:t},t.Consumer=t};je.createElement=qb;je.createFactory=function(t){var e=qb.bind(null,t);return e.type=t,e};je.createRef=function(){return{current:null}};je.forwardRef=function(t){return{$$typeof:z_,render:t}};je.isValidElement=Pg;je.lazy=function(t){return{$$typeof:W_,_payload:{_status:-1,_result:t},_init:J_}};je.memo=function(t,e){return{$$typeof:H_,type:t,compare:e===void 0?null:e}};je.startTransition=function(t){var e=hu.transition;hu.transition={};try{t()}finally{hu.transition=e}};je.unstable_act=Gb;je.useCallback=function(t,e){return dn.current.useCallback(t,e)};je.useContext=function(t){return dn.current.useContext(t)};je.useDebugValue=function(){};je.useDeferredValue=function(t){return dn.current.useDeferredValue(t)};je.useEffect=function(t,e){return dn.current.useEffect(t,e)};je.useId=function(){return dn.current.useId()};je.useImperativeHandle=function(t,e,n){return dn.current.useImperativeHandle(t,e,n)};je.useInsertionEffect=function(t,e){return dn.current.useInsertionEffect(t,e)};je.useLayoutEffect=function(t,e){return dn.current.useLayoutEffect(t,e)};je.useMemo=function(t,e){return dn.current.useMemo(t,e)};je.useReducer=function(t,e,n){return dn.current.useReducer(t,e,n)};je.useRef=function(t){return dn.current.useRef(t)};je.useState=function(t){return dn.current.useState(t)};je.useSyncExternalStore=function(t,e,n){return dn.current.useSyncExternalStore(t,e,n)};je.useTransition=function(){return dn.current.useTransition()};je.version="18.3.1";Bb.exports=je;var A=Bb.exports;const on=$b(A);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Q_=A,X_=Symbol.for("react.element"),Z_=Symbol.for("react.fragment"),eA=Object.prototype.hasOwnProperty,tA=Q_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,nA={key:!0,ref:!0,__self:!0,__source:!0};function Jb(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)eA.call(e,r)&&!nA.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:X_,type:t,key:i,ref:o,props:s,_owner:tA.current}}dh.Fragment=Z_;dh.jsx=Jb;dh.jsxs=Jb;Fb.exports=dh;var x=Fb.exports,Ep={},Yb={exports:{}},Bn={},Qb={exports:{}},Xb={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(D,j){var F=D.length;D.push(j);e:for(;0<F;){var Y=F-1>>>1,Q=D[Y];if(0<s(Q,j))D[Y]=j,D[F]=Q,F=Y;else break e}}function n(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var j=D[0],F=D.pop();if(F!==j){D[0]=F;e:for(var Y=0,Q=D.length,W=Q>>>1;Y<W;){var G=2*(Y+1)-1,H=D[G],se=G+1,be=D[se];if(0>s(H,F))se<Q&&0>s(be,H)?(D[Y]=be,D[se]=F,Y=se):(D[Y]=H,D[G]=F,Y=G);else if(se<Q&&0>s(be,F))D[Y]=be,D[se]=F,Y=se;else break e}}return j}function s(D,j){var F=D.sortIndex-j.sortIndex;return F!==0?F:D.id-j.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,d=null,h=3,f=!1,p=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(D){for(var j=n(c);j!==null;){if(j.callback===null)r(c);else if(j.startTime<=D)r(c),j.sortIndex=j.expirationTime,e(l,j);else break;j=n(c)}}function S(D){if(g=!1,w(D),!p)if(n(l)!==null)p=!0,R(T);else{var j=n(c);j!==null&&C(S,j.startTime-D)}}function T(D,j){p=!1,g&&(g=!1,m(b),b=-1),f=!0;var F=h;try{for(w(j),d=n(l);d!==null&&(!(d.expirationTime>j)||D&&!M());){var Y=d.callback;if(typeof Y=="function"){d.callback=null,h=d.priorityLevel;var Q=Y(d.expirationTime<=j);j=t.unstable_now(),typeof Q=="function"?d.callback=Q:d===n(l)&&r(l),w(j)}else r(l);d=n(l)}if(d!==null)var W=!0;else{var G=n(c);G!==null&&C(S,G.startTime-j),W=!1}return W}finally{d=null,h=F,f=!1}}var E=!1,O=null,b=-1,k=5,N=-1;function M(){return!(t.unstable_now()-N<k)}function L(){if(O!==null){var D=t.unstable_now();N=D;var j=!0;try{j=O(!0,D)}finally{j?$():(E=!1,O=null)}}else E=!1}var $;if(typeof v=="function")$=function(){v(L)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,U=P.port2;P.port1.onmessage=L,$=function(){U.postMessage(null)}}else $=function(){y(L,0)};function R(D){O=D,E||(E=!0,$())}function C(D,j){b=y(function(){D(t.unstable_now())},j)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(D){D.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,R(T))},t.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<D?Math.floor(1e3/D):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(D){switch(h){case 1:case 2:case 3:var j=3;break;default:j=h}var F=h;h=j;try{return D()}finally{h=F}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(D,j){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var F=h;h=D;try{return j()}finally{h=F}},t.unstable_scheduleCallback=function(D,j,F){var Y=t.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?Y+F:Y):F=Y,D){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=F+Q,D={id:u++,callback:j,priorityLevel:D,startTime:F,expirationTime:Q,sortIndex:-1},F>Y?(D.sortIndex=F,e(c,D),n(l)===null&&D===n(c)&&(g?(m(b),b=-1):g=!0,C(S,F-Y))):(D.sortIndex=Q,e(l,D),p||f||(p=!0,R(T))),D},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(D){var j=h;return function(){var F=h;h=j;try{return D.apply(this,arguments)}finally{h=F}}}})(Xb);Qb.exports=Xb;var rA=Qb.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sA=A,Fn=rA;function ne(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Zb=new Set,kl={};function no(t,e){ta(t,e),ta(t+"Capture",e)}function ta(t,e){for(kl[t]=e,t=0;t<e.length;t++)Zb.add(e[t])}var ls=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Cp=Object.prototype.hasOwnProperty,iA=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,rv={},sv={};function oA(t){return Cp.call(sv,t)?!0:Cp.call(rv,t)?!1:iA.test(t)?sv[t]=!0:(rv[t]=!0,!1)}function aA(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function lA(t,e,n,r){if(e===null||typeof e>"u"||aA(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function hn(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Vt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Vt[t]=new hn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Vt[e]=new hn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Vt[t]=new hn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Vt[t]=new hn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Vt[t]=new hn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Vt[t]=new hn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Vt[t]=new hn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Vt[t]=new hn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Vt[t]=new hn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Mg=/[\-:]([a-z])/g;function Dg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Mg,Dg);Vt[e]=new hn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Mg,Dg);Vt[e]=new hn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Mg,Dg);Vt[e]=new hn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Vt[t]=new hn(t,1,!1,t.toLowerCase(),null,!1,!1)});Vt.xlinkHref=new hn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Vt[t]=new hn(t,1,!1,t.toLowerCase(),null,!0,!0)});function jg(t,e,n,r){var s=Vt.hasOwnProperty(e)?Vt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(lA(e,n,s,r)&&(n=null),r||s===null?oA(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var gs=sA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Rc=Symbol.for("react.element"),So=Symbol.for("react.portal"),Eo=Symbol.for("react.fragment"),Lg=Symbol.for("react.strict_mode"),Tp=Symbol.for("react.profiler"),ek=Symbol.for("react.provider"),tk=Symbol.for("react.context"),$g=Symbol.for("react.forward_ref"),_p=Symbol.for("react.suspense"),Ap=Symbol.for("react.suspense_list"),Fg=Symbol.for("react.memo"),Ss=Symbol.for("react.lazy"),nk=Symbol.for("react.offscreen"),iv=Symbol.iterator;function _a(t){return t===null||typeof t!="object"?null:(t=iv&&t[iv]||t["@@iterator"],typeof t=="function"?t:null)}var st=Object.assign,Xh;function Fa(t){if(Xh===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Xh=e&&e[1]||""}return`
`+Xh+t}var Zh=!1;function ef(t,e){if(!t||Zh)return"";Zh=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Zh=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Fa(t):""}function cA(t){switch(t.tag){case 5:return Fa(t.type);case 16:return Fa("Lazy");case 13:return Fa("Suspense");case 19:return Fa("SuspenseList");case 0:case 2:case 15:return t=ef(t.type,!1),t;case 11:return t=ef(t.type.render,!1),t;case 1:return t=ef(t.type,!0),t;default:return""}}function Op(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Eo:return"Fragment";case So:return"Portal";case Tp:return"Profiler";case Lg:return"StrictMode";case _p:return"Suspense";case Ap:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case tk:return(t.displayName||"Context")+".Consumer";case ek:return(t._context.displayName||"Context")+".Provider";case $g:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Fg:return e=t.displayName||null,e!==null?e:Op(t.type)||"Memo";case Ss:e=t._payload,t=t._init;try{return Op(t(e))}catch{}}return null}function uA(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Op(e);case 8:return e===Lg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ei(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function rk(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function dA(t){var e=rk(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Nc(t){t._valueTracker||(t._valueTracker=dA(t))}function sk(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=rk(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function $u(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Rp(t,e){var n=e.checked;return st({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function ov(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ei(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function ik(t,e){e=e.checked,e!=null&&jg(t,"checked",e,!1)}function Np(t,e){ik(t,e);var n=ei(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ip(t,e.type,n):e.hasOwnProperty("defaultValue")&&Ip(t,e.type,ei(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function av(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Ip(t,e,n){(e!=="number"||$u(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ba=Array.isArray;function Ho(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ei(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Pp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ne(91));return st({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function lv(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ne(92));if(Ba(n)){if(1<n.length)throw Error(ne(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ei(n)}}function ok(t,e){var n=ei(e.value),r=ei(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function cv(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function ak(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Mp(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?ak(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ic,lk=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ic=Ic||document.createElement("div"),Ic.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ic.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Sl(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ya={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},hA=["Webkit","ms","Moz","O"];Object.keys(Ya).forEach(function(t){hA.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ya[e]=Ya[t]})});function ck(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ya.hasOwnProperty(t)&&Ya[t]?(""+e).trim():e+"px"}function uk(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=ck(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var fA=st({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Dp(t,e){if(e){if(fA[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ne(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ne(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ne(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ne(62))}}function jp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lp=null;function Bg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var $p=null,Wo=null,Ko=null;function uv(t){if(t=gc(t)){if(typeof $p!="function")throw Error(ne(280));var e=t.stateNode;e&&(e=gh(e),$p(t.stateNode,t.type,e))}}function dk(t){Wo?Ko?Ko.push(t):Ko=[t]:Wo=t}function hk(){if(Wo){var t=Wo,e=Ko;if(Ko=Wo=null,uv(t),e)for(t=0;t<e.length;t++)uv(e[t])}}function fk(t,e){return t(e)}function pk(){}var tf=!1;function mk(t,e,n){if(tf)return t(e,n);tf=!0;try{return fk(t,e,n)}finally{tf=!1,(Wo!==null||Ko!==null)&&(pk(),hk())}}function El(t,e){var n=t.stateNode;if(n===null)return null;var r=gh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ne(231,e,typeof n));return n}var Fp=!1;if(ls)try{var Aa={};Object.defineProperty(Aa,"passive",{get:function(){Fp=!0}}),window.addEventListener("test",Aa,Aa),window.removeEventListener("test",Aa,Aa)}catch{Fp=!1}function pA(t,e,n,r,s,i,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var Qa=!1,Fu=null,Bu=!1,Bp=null,mA={onError:function(t){Qa=!0,Fu=t}};function gA(t,e,n,r,s,i,o,a,l){Qa=!1,Fu=null,pA.apply(mA,arguments)}function yA(t,e,n,r,s,i,o,a,l){if(gA.apply(this,arguments),Qa){if(Qa){var c=Fu;Qa=!1,Fu=null}else throw Error(ne(198));Bu||(Bu=!0,Bp=c)}}function ro(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function gk(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function dv(t){if(ro(t)!==t)throw Error(ne(188))}function vA(t){var e=t.alternate;if(!e){if(e=ro(t),e===null)throw Error(ne(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return dv(s),t;if(i===r)return dv(s),e;i=i.sibling}throw Error(ne(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(ne(189))}}if(n.alternate!==r)throw Error(ne(190))}if(n.tag!==3)throw Error(ne(188));return n.stateNode.current===n?t:e}function yk(t){return t=vA(t),t!==null?vk(t):null}function vk(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=vk(t);if(e!==null)return e;t=t.sibling}return null}var wk=Fn.unstable_scheduleCallback,hv=Fn.unstable_cancelCallback,wA=Fn.unstable_shouldYield,xA=Fn.unstable_requestPaint,ft=Fn.unstable_now,bA=Fn.unstable_getCurrentPriorityLevel,Ug=Fn.unstable_ImmediatePriority,xk=Fn.unstable_UserBlockingPriority,Uu=Fn.unstable_NormalPriority,kA=Fn.unstable_LowPriority,bk=Fn.unstable_IdlePriority,hh=null,Mr=null;function SA(t){if(Mr&&typeof Mr.onCommitFiberRoot=="function")try{Mr.onCommitFiberRoot(hh,t,void 0,(t.current.flags&128)===128)}catch{}}var kr=Math.clz32?Math.clz32:TA,EA=Math.log,CA=Math.LN2;function TA(t){return t>>>=0,t===0?32:31-(EA(t)/CA|0)|0}var Pc=64,Mc=4194304;function Ua(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function zu(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=Ua(a):(i&=o,i!==0&&(r=Ua(i)))}else o=n&~s,o!==0?r=Ua(o):i!==0&&(r=Ua(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-kr(e),s=1<<n,r|=t[n],e&=~s;return r}function _A(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function AA(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-kr(i),a=1<<o,l=s[o];l===-1?(!(a&n)||a&r)&&(s[o]=_A(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function Up(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function kk(){var t=Pc;return Pc<<=1,!(Pc&4194240)&&(Pc=64),t}function nf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function pc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-kr(e),t[e]=n}function OA(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-kr(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function zg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-kr(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Fe=0;function Sk(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Ek,Vg,Ck,Tk,_k,zp=!1,Dc=[],Bs=null,Us=null,zs=null,Cl=new Map,Tl=new Map,Rs=[],RA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function fv(t,e){switch(t){case"focusin":case"focusout":Bs=null;break;case"dragenter":case"dragleave":Us=null;break;case"mouseover":case"mouseout":zs=null;break;case"pointerover":case"pointerout":Cl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tl.delete(e.pointerId)}}function Oa(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=gc(e),e!==null&&Vg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function NA(t,e,n,r,s){switch(e){case"focusin":return Bs=Oa(Bs,t,e,n,r,s),!0;case"dragenter":return Us=Oa(Us,t,e,n,r,s),!0;case"mouseover":return zs=Oa(zs,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Cl.set(i,Oa(Cl.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Tl.set(i,Oa(Tl.get(i)||null,t,e,n,r,s)),!0}return!1}function Ak(t){var e=Ei(t.target);if(e!==null){var n=ro(e);if(n!==null){if(e=n.tag,e===13){if(e=gk(n),e!==null){t.blockedOn=e,_k(t.priority,function(){Ck(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function fu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Vp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Lp=r,n.target.dispatchEvent(r),Lp=null}else return e=gc(n),e!==null&&Vg(e),t.blockedOn=n,!1;e.shift()}return!0}function pv(t,e,n){fu(t)&&n.delete(e)}function IA(){zp=!1,Bs!==null&&fu(Bs)&&(Bs=null),Us!==null&&fu(Us)&&(Us=null),zs!==null&&fu(zs)&&(zs=null),Cl.forEach(pv),Tl.forEach(pv)}function Ra(t,e){t.blockedOn===e&&(t.blockedOn=null,zp||(zp=!0,Fn.unstable_scheduleCallback(Fn.unstable_NormalPriority,IA)))}function _l(t){function e(s){return Ra(s,t)}if(0<Dc.length){Ra(Dc[0],t);for(var n=1;n<Dc.length;n++){var r=Dc[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Bs!==null&&Ra(Bs,t),Us!==null&&Ra(Us,t),zs!==null&&Ra(zs,t),Cl.forEach(e),Tl.forEach(e),n=0;n<Rs.length;n++)r=Rs[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Rs.length&&(n=Rs[0],n.blockedOn===null);)Ak(n),n.blockedOn===null&&Rs.shift()}var qo=gs.ReactCurrentBatchConfig,Vu=!0;function PA(t,e,n,r){var s=Fe,i=qo.transition;qo.transition=null;try{Fe=1,Hg(t,e,n,r)}finally{Fe=s,qo.transition=i}}function MA(t,e,n,r){var s=Fe,i=qo.transition;qo.transition=null;try{Fe=4,Hg(t,e,n,r)}finally{Fe=s,qo.transition=i}}function Hg(t,e,n,r){if(Vu){var s=Vp(t,e,n,r);if(s===null)ff(t,e,r,Hu,n),fv(t,r);else if(NA(s,t,e,n,r))r.stopPropagation();else if(fv(t,r),e&4&&-1<RA.indexOf(t)){for(;s!==null;){var i=gc(s);if(i!==null&&Ek(i),i=Vp(t,e,n,r),i===null&&ff(t,e,r,Hu,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else ff(t,e,r,null,n)}}var Hu=null;function Vp(t,e,n,r){if(Hu=null,t=Bg(r),t=Ei(t),t!==null)if(e=ro(t),e===null)t=null;else if(n=e.tag,n===13){if(t=gk(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Hu=t,null}function Ok(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(bA()){case Ug:return 1;case xk:return 4;case Uu:case kA:return 16;case bk:return 536870912;default:return 16}default:return 16}}var Ds=null,Wg=null,pu=null;function Rk(){if(pu)return pu;var t,e=Wg,n=e.length,r,s="value"in Ds?Ds.value:Ds.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return pu=s.slice(t,1<r?1-r:void 0)}function mu(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function jc(){return!0}function mv(){return!1}function Un(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?jc:mv,this.isPropagationStopped=mv,this}return st(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=jc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=jc)},persist:function(){},isPersistent:jc}),e}var ya={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Kg=Un(ya),mc=st({},ya,{view:0,detail:0}),DA=Un(mc),rf,sf,Na,fh=st({},mc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Na&&(Na&&t.type==="mousemove"?(rf=t.screenX-Na.screenX,sf=t.screenY-Na.screenY):sf=rf=0,Na=t),rf)},movementY:function(t){return"movementY"in t?t.movementY:sf}}),gv=Un(fh),jA=st({},fh,{dataTransfer:0}),LA=Un(jA),$A=st({},mc,{relatedTarget:0}),of=Un($A),FA=st({},ya,{animationName:0,elapsedTime:0,pseudoElement:0}),BA=Un(FA),UA=st({},ya,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),zA=Un(UA),VA=st({},ya,{data:0}),yv=Un(VA),HA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},WA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},KA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qA(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=KA[t])?!!e[t]:!1}function qg(){return qA}var GA=st({},mc,{key:function(t){if(t.key){var e=HA[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=mu(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?WA[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qg,charCode:function(t){return t.type==="keypress"?mu(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?mu(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),JA=Un(GA),YA=st({},fh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),vv=Un(YA),QA=st({},mc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qg}),XA=Un(QA),ZA=st({},ya,{propertyName:0,elapsedTime:0,pseudoElement:0}),eO=Un(ZA),tO=st({},fh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),nO=Un(tO),rO=[9,13,27,32],Gg=ls&&"CompositionEvent"in window,Xa=null;ls&&"documentMode"in document&&(Xa=document.documentMode);var sO=ls&&"TextEvent"in window&&!Xa,Nk=ls&&(!Gg||Xa&&8<Xa&&11>=Xa),wv=String.fromCharCode(32),xv=!1;function Ik(t,e){switch(t){case"keyup":return rO.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Pk(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Co=!1;function iO(t,e){switch(t){case"compositionend":return Pk(e);case"keypress":return e.which!==32?null:(xv=!0,wv);case"textInput":return t=e.data,t===wv&&xv?null:t;default:return null}}function oO(t,e){if(Co)return t==="compositionend"||!Gg&&Ik(t,e)?(t=Rk(),pu=Wg=Ds=null,Co=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Nk&&e.locale!=="ko"?null:e.data;default:return null}}var aO={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!aO[t.type]:e==="textarea"}function Mk(t,e,n,r){dk(r),e=Wu(e,"onChange"),0<e.length&&(n=new Kg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Za=null,Al=null;function lO(t){Wk(t,0)}function ph(t){var e=Ao(t);if(sk(e))return t}function cO(t,e){if(t==="change")return e}var Dk=!1;if(ls){var af;if(ls){var lf="oninput"in document;if(!lf){var kv=document.createElement("div");kv.setAttribute("oninput","return;"),lf=typeof kv.oninput=="function"}af=lf}else af=!1;Dk=af&&(!document.documentMode||9<document.documentMode)}function Sv(){Za&&(Za.detachEvent("onpropertychange",jk),Al=Za=null)}function jk(t){if(t.propertyName==="value"&&ph(Al)){var e=[];Mk(e,Al,t,Bg(t)),mk(lO,e)}}function uO(t,e,n){t==="focusin"?(Sv(),Za=e,Al=n,Za.attachEvent("onpropertychange",jk)):t==="focusout"&&Sv()}function dO(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ph(Al)}function hO(t,e){if(t==="click")return ph(e)}function fO(t,e){if(t==="input"||t==="change")return ph(e)}function pO(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Er=typeof Object.is=="function"?Object.is:pO;function Ol(t,e){if(Er(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Cp.call(e,s)||!Er(t[s],e[s]))return!1}return!0}function Ev(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Cv(t,e){var n=Ev(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Ev(n)}}function Lk(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Lk(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function $k(){for(var t=window,e=$u();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=$u(t.document)}return e}function Jg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function mO(t){var e=$k(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Lk(n.ownerDocument.documentElement,n)){if(r!==null&&Jg(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Cv(n,i);var o=Cv(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var gO=ls&&"documentMode"in document&&11>=document.documentMode,To=null,Hp=null,el=null,Wp=!1;function Tv(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Wp||To==null||To!==$u(r)||(r=To,"selectionStart"in r&&Jg(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),el&&Ol(el,r)||(el=r,r=Wu(Hp,"onSelect"),0<r.length&&(e=new Kg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=To)))}function Lc(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var _o={animationend:Lc("Animation","AnimationEnd"),animationiteration:Lc("Animation","AnimationIteration"),animationstart:Lc("Animation","AnimationStart"),transitionend:Lc("Transition","TransitionEnd")},cf={},Fk={};ls&&(Fk=document.createElement("div").style,"AnimationEvent"in window||(delete _o.animationend.animation,delete _o.animationiteration.animation,delete _o.animationstart.animation),"TransitionEvent"in window||delete _o.transitionend.transition);function mh(t){if(cf[t])return cf[t];if(!_o[t])return t;var e=_o[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Fk)return cf[t]=e[n];return t}var Bk=mh("animationend"),Uk=mh("animationiteration"),zk=mh("animationstart"),Vk=mh("transitionend"),Hk=new Map,_v="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ii(t,e){Hk.set(t,e),no(e,[t])}for(var uf=0;uf<_v.length;uf++){var df=_v[uf],yO=df.toLowerCase(),vO=df[0].toUpperCase()+df.slice(1);ii(yO,"on"+vO)}ii(Bk,"onAnimationEnd");ii(Uk,"onAnimationIteration");ii(zk,"onAnimationStart");ii("dblclick","onDoubleClick");ii("focusin","onFocus");ii("focusout","onBlur");ii(Vk,"onTransitionEnd");ta("onMouseEnter",["mouseout","mouseover"]);ta("onMouseLeave",["mouseout","mouseover"]);ta("onPointerEnter",["pointerout","pointerover"]);ta("onPointerLeave",["pointerout","pointerover"]);no("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));no("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));no("onBeforeInput",["compositionend","keypress","textInput","paste"]);no("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));no("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));no("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var za="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),wO=new Set("cancel close invalid load scroll toggle".split(" ").concat(za));function Av(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,yA(r,e,void 0,t),t.currentTarget=null}function Wk(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;Av(s,a,c),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;Av(s,a,c),i=l}}}if(Bu)throw t=Bp,Bu=!1,Bp=null,t}function qe(t,e){var n=e[Yp];n===void 0&&(n=e[Yp]=new Set);var r=t+"__bubble";n.has(r)||(Kk(e,t,2,!1),n.add(r))}function hf(t,e,n){var r=0;e&&(r|=4),Kk(n,t,r,e)}var $c="_reactListening"+Math.random().toString(36).slice(2);function Rl(t){if(!t[$c]){t[$c]=!0,Zb.forEach(function(n){n!=="selectionchange"&&(wO.has(n)||hf(n,!1,t),hf(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[$c]||(e[$c]=!0,hf("selectionchange",!1,e))}}function Kk(t,e,n,r){switch(Ok(e)){case 1:var s=PA;break;case 4:s=MA;break;default:s=Hg}n=s.bind(null,e,n,t),s=void 0,!Fp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function ff(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Ei(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}mk(function(){var c=i,u=Bg(n),d=[];e:{var h=Hk.get(t);if(h!==void 0){var f=Kg,p=t;switch(t){case"keypress":if(mu(n)===0)break e;case"keydown":case"keyup":f=JA;break;case"focusin":p="focus",f=of;break;case"focusout":p="blur",f=of;break;case"beforeblur":case"afterblur":f=of;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=gv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=LA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=XA;break;case Bk:case Uk:case zk:f=BA;break;case Vk:f=eO;break;case"scroll":f=DA;break;case"wheel":f=nO;break;case"copy":case"cut":case"paste":f=zA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=vv}var g=(e&4)!==0,y=!g&&t==="scroll",m=g?h!==null?h+"Capture":null:h;g=[];for(var v=c,w;v!==null;){w=v;var S=w.stateNode;if(w.tag===5&&S!==null&&(w=S,m!==null&&(S=El(v,m),S!=null&&g.push(Nl(v,S,w)))),y)break;v=v.return}0<g.length&&(h=new f(h,p,null,n,u),d.push({event:h,listeners:g}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",h&&n!==Lp&&(p=n.relatedTarget||n.fromElement)&&(Ei(p)||p[cs]))break e;if((f||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,f?(p=n.relatedTarget||n.toElement,f=c,p=p?Ei(p):null,p!==null&&(y=ro(p),p!==y||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(g=gv,S="onMouseLeave",m="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(g=vv,S="onPointerLeave",m="onPointerEnter",v="pointer"),y=f==null?h:Ao(f),w=p==null?h:Ao(p),h=new g(S,v+"leave",f,n,u),h.target=y,h.relatedTarget=w,S=null,Ei(u)===c&&(g=new g(m,v+"enter",p,n,u),g.target=w,g.relatedTarget=y,S=g),y=S,f&&p)t:{for(g=f,m=p,v=0,w=g;w;w=oo(w))v++;for(w=0,S=m;S;S=oo(S))w++;for(;0<v-w;)g=oo(g),v--;for(;0<w-v;)m=oo(m),w--;for(;v--;){if(g===m||m!==null&&g===m.alternate)break t;g=oo(g),m=oo(m)}g=null}else g=null;f!==null&&Ov(d,h,f,g,!1),p!==null&&y!==null&&Ov(d,y,p,g,!0)}}e:{if(h=c?Ao(c):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var T=cO;else if(bv(h))if(Dk)T=fO;else{T=dO;var E=uO}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(T=hO);if(T&&(T=T(t,c))){Mk(d,T,n,u);break e}E&&E(t,h,c),t==="focusout"&&(E=h._wrapperState)&&E.controlled&&h.type==="number"&&Ip(h,"number",h.value)}switch(E=c?Ao(c):window,t){case"focusin":(bv(E)||E.contentEditable==="true")&&(To=E,Hp=c,el=null);break;case"focusout":el=Hp=To=null;break;case"mousedown":Wp=!0;break;case"contextmenu":case"mouseup":case"dragend":Wp=!1,Tv(d,n,u);break;case"selectionchange":if(gO)break;case"keydown":case"keyup":Tv(d,n,u)}var O;if(Gg)e:{switch(t){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Co?Ik(t,n)&&(b="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(b="onCompositionStart");b&&(Nk&&n.locale!=="ko"&&(Co||b!=="onCompositionStart"?b==="onCompositionEnd"&&Co&&(O=Rk()):(Ds=u,Wg="value"in Ds?Ds.value:Ds.textContent,Co=!0)),E=Wu(c,b),0<E.length&&(b=new yv(b,t,null,n,u),d.push({event:b,listeners:E}),O?b.data=O:(O=Pk(n),O!==null&&(b.data=O)))),(O=sO?iO(t,n):oO(t,n))&&(c=Wu(c,"onBeforeInput"),0<c.length&&(u=new yv("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=O))}Wk(d,e)})}function Nl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Wu(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=El(t,n),i!=null&&r.unshift(Nl(t,i,s)),i=El(t,e),i!=null&&r.push(Nl(t,i,s))),t=t.return}return r}function oo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Ov(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,s?(l=El(n,i),l!=null&&o.unshift(Nl(n,l,a))):s||(l=El(n,i),l!=null&&o.push(Nl(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var xO=/\r\n?/g,bO=/\u0000|\uFFFD/g;function Rv(t){return(typeof t=="string"?t:""+t).replace(xO,`
`).replace(bO,"")}function Fc(t,e,n){if(e=Rv(e),Rv(t)!==e&&n)throw Error(ne(425))}function Ku(){}var Kp=null,qp=null;function Gp(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Jp=typeof setTimeout=="function"?setTimeout:void 0,kO=typeof clearTimeout=="function"?clearTimeout:void 0,Nv=typeof Promise=="function"?Promise:void 0,SO=typeof queueMicrotask=="function"?queueMicrotask:typeof Nv<"u"?function(t){return Nv.resolve(null).then(t).catch(EO)}:Jp;function EO(t){setTimeout(function(){throw t})}function pf(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),_l(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);_l(e)}function Vs(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Iv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var va=Math.random().toString(36).slice(2),Ir="__reactFiber$"+va,Il="__reactProps$"+va,cs="__reactContainer$"+va,Yp="__reactEvents$"+va,CO="__reactListeners$"+va,TO="__reactHandles$"+va;function Ei(t){var e=t[Ir];if(e)return e;for(var n=t.parentNode;n;){if(e=n[cs]||n[Ir]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Iv(t);t!==null;){if(n=t[Ir])return n;t=Iv(t)}return e}t=n,n=t.parentNode}return null}function gc(t){return t=t[Ir]||t[cs],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ao(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ne(33))}function gh(t){return t[Il]||null}var Qp=[],Oo=-1;function oi(t){return{current:t}}function Je(t){0>Oo||(t.current=Qp[Oo],Qp[Oo]=null,Oo--)}function He(t,e){Oo++,Qp[Oo]=t.current,t.current=e}var ti={},Qt=oi(ti),xn=oi(!1),Wi=ti;function na(t,e){var n=t.type.contextTypes;if(!n)return ti;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function bn(t){return t=t.childContextTypes,t!=null}function qu(){Je(xn),Je(Qt)}function Pv(t,e,n){if(Qt.current!==ti)throw Error(ne(168));He(Qt,e),He(xn,n)}function qk(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(ne(108,uA(t)||"Unknown",s));return st({},n,r)}function Gu(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ti,Wi=Qt.current,He(Qt,t),He(xn,xn.current),!0}function Mv(t,e,n){var r=t.stateNode;if(!r)throw Error(ne(169));n?(t=qk(t,e,Wi),r.__reactInternalMemoizedMergedChildContext=t,Je(xn),Je(Qt),He(Qt,t)):Je(xn),He(xn,n)}var Xr=null,yh=!1,mf=!1;function Gk(t){Xr===null?Xr=[t]:Xr.push(t)}function _O(t){yh=!0,Gk(t)}function ai(){if(!mf&&Xr!==null){mf=!0;var t=0,e=Fe;try{var n=Xr;for(Fe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Xr=null,yh=!1}catch(s){throw Xr!==null&&(Xr=Xr.slice(t+1)),wk(Ug,ai),s}finally{Fe=e,mf=!1}}return null}var Ro=[],No=0,Ju=null,Yu=0,Jn=[],Yn=0,Ki=null,Zr=1,es="";function gi(t,e){Ro[No++]=Yu,Ro[No++]=Ju,Ju=t,Yu=e}function Jk(t,e,n){Jn[Yn++]=Zr,Jn[Yn++]=es,Jn[Yn++]=Ki,Ki=t;var r=Zr;t=es;var s=32-kr(r)-1;r&=~(1<<s),n+=1;var i=32-kr(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Zr=1<<32-kr(e)+s|n<<s|r,es=i+t}else Zr=1<<i|n<<s|r,es=t}function Yg(t){t.return!==null&&(gi(t,1),Jk(t,1,0))}function Qg(t){for(;t===Ju;)Ju=Ro[--No],Ro[No]=null,Yu=Ro[--No],Ro[No]=null;for(;t===Ki;)Ki=Jn[--Yn],Jn[Yn]=null,es=Jn[--Yn],Jn[Yn]=null,Zr=Jn[--Yn],Jn[Yn]=null}var $n=null,jn=null,Ye=!1,xr=null;function Yk(t,e){var n=Xn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Dv(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,$n=t,jn=Vs(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,$n=t,jn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ki!==null?{id:Zr,overflow:es}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Xn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,$n=t,jn=null,!0):!1;default:return!1}}function Xp(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Zp(t){if(Ye){var e=jn;if(e){var n=e;if(!Dv(t,e)){if(Xp(t))throw Error(ne(418));e=Vs(n.nextSibling);var r=$n;e&&Dv(t,e)?Yk(r,n):(t.flags=t.flags&-4097|2,Ye=!1,$n=t)}}else{if(Xp(t))throw Error(ne(418));t.flags=t.flags&-4097|2,Ye=!1,$n=t}}}function jv(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;$n=t}function Bc(t){if(t!==$n)return!1;if(!Ye)return jv(t),Ye=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Gp(t.type,t.memoizedProps)),e&&(e=jn)){if(Xp(t))throw Qk(),Error(ne(418));for(;e;)Yk(t,e),e=Vs(e.nextSibling)}if(jv(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ne(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){jn=Vs(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}jn=null}}else jn=$n?Vs(t.stateNode.nextSibling):null;return!0}function Qk(){for(var t=jn;t;)t=Vs(t.nextSibling)}function ra(){jn=$n=null,Ye=!1}function Xg(t){xr===null?xr=[t]:xr.push(t)}var AO=gs.ReactCurrentBatchConfig;function Ia(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ne(309));var r=n.stateNode}if(!r)throw Error(ne(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(ne(284));if(!n._owner)throw Error(ne(290,t))}return t}function Uc(t,e){throw t=Object.prototype.toString.call(e),Error(ne(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Lv(t){var e=t._init;return e(t._payload)}function Xk(t){function e(m,v){if(t){var w=m.deletions;w===null?(m.deletions=[v],m.flags|=16):w.push(v)}}function n(m,v){if(!t)return null;for(;v!==null;)e(m,v),v=v.sibling;return null}function r(m,v){for(m=new Map;v!==null;)v.key!==null?m.set(v.key,v):m.set(v.index,v),v=v.sibling;return m}function s(m,v){return m=qs(m,v),m.index=0,m.sibling=null,m}function i(m,v,w){return m.index=w,t?(w=m.alternate,w!==null?(w=w.index,w<v?(m.flags|=2,v):w):(m.flags|=2,v)):(m.flags|=1048576,v)}function o(m){return t&&m.alternate===null&&(m.flags|=2),m}function a(m,v,w,S){return v===null||v.tag!==6?(v=kf(w,m.mode,S),v.return=m,v):(v=s(v,w),v.return=m,v)}function l(m,v,w,S){var T=w.type;return T===Eo?u(m,v,w.props.children,S,w.key):v!==null&&(v.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Ss&&Lv(T)===v.type)?(S=s(v,w.props),S.ref=Ia(m,v,w),S.return=m,S):(S=ku(w.type,w.key,w.props,null,m.mode,S),S.ref=Ia(m,v,w),S.return=m,S)}function c(m,v,w,S){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=Sf(w,m.mode,S),v.return=m,v):(v=s(v,w.children||[]),v.return=m,v)}function u(m,v,w,S,T){return v===null||v.tag!==7?(v=ji(w,m.mode,S,T),v.return=m,v):(v=s(v,w),v.return=m,v)}function d(m,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=kf(""+v,m.mode,w),v.return=m,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Rc:return w=ku(v.type,v.key,v.props,null,m.mode,w),w.ref=Ia(m,null,v),w.return=m,w;case So:return v=Sf(v,m.mode,w),v.return=m,v;case Ss:var S=v._init;return d(m,S(v._payload),w)}if(Ba(v)||_a(v))return v=ji(v,m.mode,w,null),v.return=m,v;Uc(m,v)}return null}function h(m,v,w,S){var T=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return T!==null?null:a(m,v,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Rc:return w.key===T?l(m,v,w,S):null;case So:return w.key===T?c(m,v,w,S):null;case Ss:return T=w._init,h(m,v,T(w._payload),S)}if(Ba(w)||_a(w))return T!==null?null:u(m,v,w,S,null);Uc(m,w)}return null}function f(m,v,w,S,T){if(typeof S=="string"&&S!==""||typeof S=="number")return m=m.get(w)||null,a(v,m,""+S,T);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Rc:return m=m.get(S.key===null?w:S.key)||null,l(v,m,S,T);case So:return m=m.get(S.key===null?w:S.key)||null,c(v,m,S,T);case Ss:var E=S._init;return f(m,v,w,E(S._payload),T)}if(Ba(S)||_a(S))return m=m.get(w)||null,u(v,m,S,T,null);Uc(v,S)}return null}function p(m,v,w,S){for(var T=null,E=null,O=v,b=v=0,k=null;O!==null&&b<w.length;b++){O.index>b?(k=O,O=null):k=O.sibling;var N=h(m,O,w[b],S);if(N===null){O===null&&(O=k);break}t&&O&&N.alternate===null&&e(m,O),v=i(N,v,b),E===null?T=N:E.sibling=N,E=N,O=k}if(b===w.length)return n(m,O),Ye&&gi(m,b),T;if(O===null){for(;b<w.length;b++)O=d(m,w[b],S),O!==null&&(v=i(O,v,b),E===null?T=O:E.sibling=O,E=O);return Ye&&gi(m,b),T}for(O=r(m,O);b<w.length;b++)k=f(O,m,b,w[b],S),k!==null&&(t&&k.alternate!==null&&O.delete(k.key===null?b:k.key),v=i(k,v,b),E===null?T=k:E.sibling=k,E=k);return t&&O.forEach(function(M){return e(m,M)}),Ye&&gi(m,b),T}function g(m,v,w,S){var T=_a(w);if(typeof T!="function")throw Error(ne(150));if(w=T.call(w),w==null)throw Error(ne(151));for(var E=T=null,O=v,b=v=0,k=null,N=w.next();O!==null&&!N.done;b++,N=w.next()){O.index>b?(k=O,O=null):k=O.sibling;var M=h(m,O,N.value,S);if(M===null){O===null&&(O=k);break}t&&O&&M.alternate===null&&e(m,O),v=i(M,v,b),E===null?T=M:E.sibling=M,E=M,O=k}if(N.done)return n(m,O),Ye&&gi(m,b),T;if(O===null){for(;!N.done;b++,N=w.next())N=d(m,N.value,S),N!==null&&(v=i(N,v,b),E===null?T=N:E.sibling=N,E=N);return Ye&&gi(m,b),T}for(O=r(m,O);!N.done;b++,N=w.next())N=f(O,m,b,N.value,S),N!==null&&(t&&N.alternate!==null&&O.delete(N.key===null?b:N.key),v=i(N,v,b),E===null?T=N:E.sibling=N,E=N);return t&&O.forEach(function(L){return e(m,L)}),Ye&&gi(m,b),T}function y(m,v,w,S){if(typeof w=="object"&&w!==null&&w.type===Eo&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Rc:e:{for(var T=w.key,E=v;E!==null;){if(E.key===T){if(T=w.type,T===Eo){if(E.tag===7){n(m,E.sibling),v=s(E,w.props.children),v.return=m,m=v;break e}}else if(E.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Ss&&Lv(T)===E.type){n(m,E.sibling),v=s(E,w.props),v.ref=Ia(m,E,w),v.return=m,m=v;break e}n(m,E);break}else e(m,E);E=E.sibling}w.type===Eo?(v=ji(w.props.children,m.mode,S,w.key),v.return=m,m=v):(S=ku(w.type,w.key,w.props,null,m.mode,S),S.ref=Ia(m,v,w),S.return=m,m=S)}return o(m);case So:e:{for(E=w.key;v!==null;){if(v.key===E)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){n(m,v.sibling),v=s(v,w.children||[]),v.return=m,m=v;break e}else{n(m,v);break}else e(m,v);v=v.sibling}v=Sf(w,m.mode,S),v.return=m,m=v}return o(m);case Ss:return E=w._init,y(m,v,E(w._payload),S)}if(Ba(w))return p(m,v,w,S);if(_a(w))return g(m,v,w,S);Uc(m,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(n(m,v.sibling),v=s(v,w),v.return=m,m=v):(n(m,v),v=kf(w,m.mode,S),v.return=m,m=v),o(m)):n(m,v)}return y}var sa=Xk(!0),Zk=Xk(!1),Qu=oi(null),Xu=null,Io=null,Zg=null;function e0(){Zg=Io=Xu=null}function t0(t){var e=Qu.current;Je(Qu),t._currentValue=e}function em(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Go(t,e){Xu=t,Zg=Io=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(yn=!0),t.firstContext=null)}function ir(t){var e=t._currentValue;if(Zg!==t)if(t={context:t,memoizedValue:e,next:null},Io===null){if(Xu===null)throw Error(ne(308));Io=t,Xu.dependencies={lanes:0,firstContext:t}}else Io=Io.next=t;return e}var Ci=null;function n0(t){Ci===null?Ci=[t]:Ci.push(t)}function eS(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,n0(e)):(n.next=s.next,s.next=n),e.interleaved=n,us(t,r)}function us(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Es=!1;function r0(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function tS(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function rs(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Hs(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,$e&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,us(t,n)}return s=r.interleaved,s===null?(e.next=e,n0(r)):(e.next=s.next,s.next=e),r.interleaved=e,us(t,n)}function gu(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,zg(t,n)}}function $v(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Zu(t,e,n,r){var s=t.updateQueue;Es=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?i=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(i!==null){var d=s.baseState;o=0,u=c=l=null,a=i;do{var h=a.lane,f=a.eventTime;if((r&h)===h){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,g=a;switch(h=e,f=n,g.tag){case 1:if(p=g.payload,typeof p=="function"){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,h=typeof p=="function"?p.call(f,d,h):p,h==null)break e;d=st({},d,h);break e;case 2:Es=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=s.effects,h===null?s.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=f,l=d):u=u.next=f,o|=h;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;h=a,a=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(1);if(u===null&&(l=d),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Gi|=o,t.lanes=o,t.memoizedState=d}}function Fv(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(ne(191,s));s.call(r)}}}var yc={},Dr=oi(yc),Pl=oi(yc),Ml=oi(yc);function Ti(t){if(t===yc)throw Error(ne(174));return t}function s0(t,e){switch(He(Ml,e),He(Pl,t),He(Dr,yc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Mp(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Mp(e,t)}Je(Dr),He(Dr,e)}function ia(){Je(Dr),Je(Pl),Je(Ml)}function nS(t){Ti(Ml.current);var e=Ti(Dr.current),n=Mp(e,t.type);e!==n&&(He(Pl,t),He(Dr,n))}function i0(t){Pl.current===t&&(Je(Dr),Je(Pl))}var tt=oi(0);function ed(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var gf=[];function o0(){for(var t=0;t<gf.length;t++)gf[t]._workInProgressVersionPrimary=null;gf.length=0}var yu=gs.ReactCurrentDispatcher,yf=gs.ReactCurrentBatchConfig,qi=0,rt=null,bt=null,_t=null,td=!1,tl=!1,Dl=0,OO=0;function Ht(){throw Error(ne(321))}function a0(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Er(t[n],e[n]))return!1;return!0}function l0(t,e,n,r,s,i){if(qi=i,rt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,yu.current=t===null||t.memoizedState===null?PO:MO,t=n(r,s),tl){i=0;do{if(tl=!1,Dl=0,25<=i)throw Error(ne(301));i+=1,_t=bt=null,e.updateQueue=null,yu.current=DO,t=n(r,s)}while(tl)}if(yu.current=nd,e=bt!==null&&bt.next!==null,qi=0,_t=bt=rt=null,td=!1,e)throw Error(ne(300));return t}function c0(){var t=Dl!==0;return Dl=0,t}function _r(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _t===null?rt.memoizedState=_t=t:_t=_t.next=t,_t}function or(){if(bt===null){var t=rt.alternate;t=t!==null?t.memoizedState:null}else t=bt.next;var e=_t===null?rt.memoizedState:_t.next;if(e!==null)_t=e,bt=t;else{if(t===null)throw Error(ne(310));bt=t,t={memoizedState:bt.memoizedState,baseState:bt.baseState,baseQueue:bt.baseQueue,queue:bt.queue,next:null},_t===null?rt.memoizedState=_t=t:_t=_t.next=t}return _t}function jl(t,e){return typeof e=="function"?e(t):e}function vf(t){var e=or(),n=e.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=t;var r=bt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,c=i;do{var u=c.lane;if((qi&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,o=r):l=l.next=d,rt.lanes|=u,Gi|=u}c=c.next}while(c!==null&&c!==i);l===null?o=r:l.next=a,Er(r,e.memoizedState)||(yn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,rt.lanes|=i,Gi|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function wf(t){var e=or(),n=e.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Er(i,e.memoizedState)||(yn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function rS(){}function sS(t,e){var n=rt,r=or(),s=e(),i=!Er(r.memoizedState,s);if(i&&(r.memoizedState=s,yn=!0),r=r.queue,u0(aS.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||_t!==null&&_t.memoizedState.tag&1){if(n.flags|=2048,Ll(9,oS.bind(null,n,r,s,e),void 0,null),Rt===null)throw Error(ne(349));qi&30||iS(n,e,s)}return s}function iS(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=rt.updateQueue,e===null?(e={lastEffect:null,stores:null},rt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function oS(t,e,n,r){e.value=n,e.getSnapshot=r,lS(e)&&cS(t)}function aS(t,e,n){return n(function(){lS(e)&&cS(t)})}function lS(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Er(t,n)}catch{return!0}}function cS(t){var e=us(t,1);e!==null&&Sr(e,t,1,-1)}function Bv(t){var e=_r();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:jl,lastRenderedState:t},e.queue=t,t=t.dispatch=IO.bind(null,rt,t),[e.memoizedState,t]}function Ll(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=rt.updateQueue,e===null?(e={lastEffect:null,stores:null},rt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function uS(){return or().memoizedState}function vu(t,e,n,r){var s=_r();rt.flags|=t,s.memoizedState=Ll(1|e,n,void 0,r===void 0?null:r)}function vh(t,e,n,r){var s=or();r=r===void 0?null:r;var i=void 0;if(bt!==null){var o=bt.memoizedState;if(i=o.destroy,r!==null&&a0(r,o.deps)){s.memoizedState=Ll(e,n,i,r);return}}rt.flags|=t,s.memoizedState=Ll(1|e,n,i,r)}function Uv(t,e){return vu(8390656,8,t,e)}function u0(t,e){return vh(2048,8,t,e)}function dS(t,e){return vh(4,2,t,e)}function hS(t,e){return vh(4,4,t,e)}function fS(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function pS(t,e,n){return n=n!=null?n.concat([t]):null,vh(4,4,fS.bind(null,e,t),n)}function d0(){}function mS(t,e){var n=or();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&a0(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function gS(t,e){var n=or();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&a0(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function yS(t,e,n){return qi&21?(Er(n,e)||(n=kk(),rt.lanes|=n,Gi|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,yn=!0),t.memoizedState=n)}function RO(t,e){var n=Fe;Fe=n!==0&&4>n?n:4,t(!0);var r=yf.transition;yf.transition={};try{t(!1),e()}finally{Fe=n,yf.transition=r}}function vS(){return or().memoizedState}function NO(t,e,n){var r=Ks(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},wS(t))xS(e,n);else if(n=eS(t,e,n,r),n!==null){var s=ln();Sr(n,t,r,s),bS(n,e,r)}}function IO(t,e,n){var r=Ks(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(wS(t))xS(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,Er(a,o)){var l=e.interleaved;l===null?(s.next=s,n0(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=eS(t,e,s,r),n!==null&&(s=ln(),Sr(n,t,r,s),bS(n,e,r))}}function wS(t){var e=t.alternate;return t===rt||e!==null&&e===rt}function xS(t,e){tl=td=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function bS(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,zg(t,n)}}var nd={readContext:ir,useCallback:Ht,useContext:Ht,useEffect:Ht,useImperativeHandle:Ht,useInsertionEffect:Ht,useLayoutEffect:Ht,useMemo:Ht,useReducer:Ht,useRef:Ht,useState:Ht,useDebugValue:Ht,useDeferredValue:Ht,useTransition:Ht,useMutableSource:Ht,useSyncExternalStore:Ht,useId:Ht,unstable_isNewReconciler:!1},PO={readContext:ir,useCallback:function(t,e){return _r().memoizedState=[t,e===void 0?null:e],t},useContext:ir,useEffect:Uv,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,vu(4194308,4,fS.bind(null,e,t),n)},useLayoutEffect:function(t,e){return vu(4194308,4,t,e)},useInsertionEffect:function(t,e){return vu(4,2,t,e)},useMemo:function(t,e){var n=_r();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=_r();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=NO.bind(null,rt,t),[r.memoizedState,t]},useRef:function(t){var e=_r();return t={current:t},e.memoizedState=t},useState:Bv,useDebugValue:d0,useDeferredValue:function(t){return _r().memoizedState=t},useTransition:function(){var t=Bv(!1),e=t[0];return t=RO.bind(null,t[1]),_r().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=rt,s=_r();if(Ye){if(n===void 0)throw Error(ne(407));n=n()}else{if(n=e(),Rt===null)throw Error(ne(349));qi&30||iS(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Uv(aS.bind(null,r,i,t),[t]),r.flags|=2048,Ll(9,oS.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=_r(),e=Rt.identifierPrefix;if(Ye){var n=es,r=Zr;n=(r&~(1<<32-kr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Dl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=OO++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},MO={readContext:ir,useCallback:mS,useContext:ir,useEffect:u0,useImperativeHandle:pS,useInsertionEffect:dS,useLayoutEffect:hS,useMemo:gS,useReducer:vf,useRef:uS,useState:function(){return vf(jl)},useDebugValue:d0,useDeferredValue:function(t){var e=or();return yS(e,bt.memoizedState,t)},useTransition:function(){var t=vf(jl)[0],e=or().memoizedState;return[t,e]},useMutableSource:rS,useSyncExternalStore:sS,useId:vS,unstable_isNewReconciler:!1},DO={readContext:ir,useCallback:mS,useContext:ir,useEffect:u0,useImperativeHandle:pS,useInsertionEffect:dS,useLayoutEffect:hS,useMemo:gS,useReducer:wf,useRef:uS,useState:function(){return wf(jl)},useDebugValue:d0,useDeferredValue:function(t){var e=or();return bt===null?e.memoizedState=t:yS(e,bt.memoizedState,t)},useTransition:function(){var t=wf(jl)[0],e=or().memoizedState;return[t,e]},useMutableSource:rS,useSyncExternalStore:sS,useId:vS,unstable_isNewReconciler:!1};function gr(t,e){if(t&&t.defaultProps){e=st({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function tm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:st({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var wh={isMounted:function(t){return(t=t._reactInternals)?ro(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=ln(),s=Ks(t),i=rs(r,s);i.payload=e,n!=null&&(i.callback=n),e=Hs(t,i,s),e!==null&&(Sr(e,t,s,r),gu(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=ln(),s=Ks(t),i=rs(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Hs(t,i,s),e!==null&&(Sr(e,t,s,r),gu(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ln(),r=Ks(t),s=rs(n,r);s.tag=2,e!=null&&(s.callback=e),e=Hs(t,s,r),e!==null&&(Sr(e,t,r,n),gu(e,t,r))}};function zv(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Ol(n,r)||!Ol(s,i):!0}function kS(t,e,n){var r=!1,s=ti,i=e.contextType;return typeof i=="object"&&i!==null?i=ir(i):(s=bn(e)?Wi:Qt.current,r=e.contextTypes,i=(r=r!=null)?na(t,s):ti),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=wh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Vv(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&wh.enqueueReplaceState(e,e.state,null)}function nm(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},r0(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=ir(i):(i=bn(e)?Wi:Qt.current,s.context=na(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(tm(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&wh.enqueueReplaceState(s,s.state,null),Zu(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function oa(t,e){try{var n="",r=e;do n+=cA(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function xf(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function rm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var jO=typeof WeakMap=="function"?WeakMap:Map;function SS(t,e,n){n=rs(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){sd||(sd=!0,fm=r),rm(t,e)},n}function ES(t,e,n){n=rs(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){rm(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){rm(t,e),typeof r!="function"&&(Ws===null?Ws=new Set([this]):Ws.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Hv(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new jO;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=YO.bind(null,t,e,n),e.then(t,t))}function Wv(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Kv(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=rs(-1,1),e.tag=2,Hs(n,e,1))),n.lanes|=1),t)}var LO=gs.ReactCurrentOwner,yn=!1;function sn(t,e,n,r){e.child=t===null?Zk(e,null,n,r):sa(e,t.child,n,r)}function qv(t,e,n,r,s){n=n.render;var i=e.ref;return Go(e,s),r=l0(t,e,n,r,i,s),n=c0(),t!==null&&!yn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ds(t,e,s)):(Ye&&n&&Yg(e),e.flags|=1,sn(t,e,r,s),e.child)}function Gv(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!w0(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,CS(t,e,i,r,s)):(t=ku(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Ol,n(o,r)&&t.ref===e.ref)return ds(t,e,s)}return e.flags|=1,t=qs(i,r),t.ref=e.ref,t.return=e,e.child=t}function CS(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Ol(i,r)&&t.ref===e.ref)if(yn=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(yn=!0);else return e.lanes=t.lanes,ds(t,e,s)}return sm(t,e,n,r,s)}function TS(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},He(Mo,In),In|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,He(Mo,In),In|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,He(Mo,In),In|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,He(Mo,In),In|=r;return sn(t,e,s,n),e.child}function _S(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function sm(t,e,n,r,s){var i=bn(n)?Wi:Qt.current;return i=na(e,i),Go(e,s),n=l0(t,e,n,r,i,s),r=c0(),t!==null&&!yn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ds(t,e,s)):(Ye&&r&&Yg(e),e.flags|=1,sn(t,e,n,s),e.child)}function Jv(t,e,n,r,s){if(bn(n)){var i=!0;Gu(e)}else i=!1;if(Go(e,s),e.stateNode===null)wu(t,e),kS(e,n,r),nm(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=ir(c):(c=bn(n)?Wi:Qt.current,c=na(e,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&Vv(e,o,r,c),Es=!1;var h=e.memoizedState;o.state=h,Zu(e,r,o,s),l=e.memoizedState,a!==r||h!==l||xn.current||Es?(typeof u=="function"&&(tm(e,n,u,r),l=e.memoizedState),(a=Es||zv(e,n,a,r,h,l,c))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,tS(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:gr(e.type,a),o.props=c,d=e.pendingProps,h=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=ir(l):(l=bn(n)?Wi:Qt.current,l=na(e,l));var f=n.getDerivedStateFromProps;(u=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||h!==l)&&Vv(e,o,r,l),Es=!1,h=e.memoizedState,o.state=h,Zu(e,r,o,s);var p=e.memoizedState;a!==d||h!==p||xn.current||Es?(typeof f=="function"&&(tm(e,n,f,r),p=e.memoizedState),(c=Es||zv(e,n,c,r,h,p,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),o.props=r,o.state=p,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return im(t,e,n,r,i,s)}function im(t,e,n,r,s,i){_S(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&Mv(e,n,!1),ds(t,e,i);r=e.stateNode,LO.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=sa(e,t.child,null,i),e.child=sa(e,null,a,i)):sn(t,e,a,i),e.memoizedState=r.state,s&&Mv(e,n,!0),e.child}function AS(t){var e=t.stateNode;e.pendingContext?Pv(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Pv(t,e.context,!1),s0(t,e.containerInfo)}function Yv(t,e,n,r,s){return ra(),Xg(s),e.flags|=256,sn(t,e,n,r),e.child}var om={dehydrated:null,treeContext:null,retryLane:0};function am(t){return{baseLanes:t,cachePool:null,transitions:null}}function OS(t,e,n){var r=e.pendingProps,s=tt.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),He(tt,s&1),t===null)return Zp(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=kh(o,r,0,null),t=ji(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=am(n),e.memoizedState=om,t):h0(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return $O(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=qs(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=qs(a,i):(i=ji(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?am(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=om,r}return i=t.child,t=i.sibling,r=qs(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function h0(t,e){return e=kh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function zc(t,e,n,r){return r!==null&&Xg(r),sa(e,t.child,null,n),t=h0(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function $O(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=xf(Error(ne(422))),zc(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=kh({mode:"visible",children:r.children},s,0,null),i=ji(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&sa(e,t.child,null,o),e.child.memoizedState=am(o),e.memoizedState=om,i);if(!(e.mode&1))return zc(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(ne(419)),r=xf(i,r,void 0),zc(t,e,o,r)}if(a=(o&t.childLanes)!==0,yn||a){if(r=Rt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,us(t,s),Sr(r,t,s,-1))}return v0(),r=xf(Error(ne(421))),zc(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=QO.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,jn=Vs(s.nextSibling),$n=e,Ye=!0,xr=null,t!==null&&(Jn[Yn++]=Zr,Jn[Yn++]=es,Jn[Yn++]=Ki,Zr=t.id,es=t.overflow,Ki=e),e=h0(e,r.children),e.flags|=4096,e)}function Qv(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),em(t.return,e,n)}function bf(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function RS(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(sn(t,e,r.children,n),r=tt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Qv(t,n,e);else if(t.tag===19)Qv(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(He(tt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&ed(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),bf(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&ed(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}bf(e,!0,n,null,i);break;case"together":bf(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function wu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ds(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Gi|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ne(153));if(e.child!==null){for(t=e.child,n=qs(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=qs(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function FO(t,e,n){switch(e.tag){case 3:AS(e),ra();break;case 5:nS(e);break;case 1:bn(e.type)&&Gu(e);break;case 4:s0(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;He(Qu,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(He(tt,tt.current&1),e.flags|=128,null):n&e.child.childLanes?OS(t,e,n):(He(tt,tt.current&1),t=ds(t,e,n),t!==null?t.sibling:null);He(tt,tt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return RS(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),He(tt,tt.current),r)break;return null;case 22:case 23:return e.lanes=0,TS(t,e,n)}return ds(t,e,n)}var NS,lm,IS,PS;NS=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};lm=function(){};IS=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Ti(Dr.current);var i=null;switch(n){case"input":s=Rp(t,s),r=Rp(t,r),i=[];break;case"select":s=st({},s,{value:void 0}),r=st({},r,{value:void 0}),i=[];break;case"textarea":s=Pp(t,s),r=Pp(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Ku)}Dp(n,r);var o;n=null;for(c in s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var a=s[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(kl.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var l=r[c];if(a=s!=null?s[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(kl.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&qe("scroll",t),i||a===l||(i=[])):(i=i||[]).push(c,l))}n&&(i=i||[]).push("style",n);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};PS=function(t,e,n,r){n!==r&&(e.flags|=4)};function Pa(t,e){if(!Ye)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Wt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function BO(t,e,n){var r=e.pendingProps;switch(Qg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wt(e),null;case 1:return bn(e.type)&&qu(),Wt(e),null;case 3:return r=e.stateNode,ia(),Je(xn),Je(Qt),o0(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Bc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,xr!==null&&(gm(xr),xr=null))),lm(t,e),Wt(e),null;case 5:i0(e);var s=Ti(Ml.current);if(n=e.type,t!==null&&e.stateNode!=null)IS(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ne(166));return Wt(e),null}if(t=Ti(Dr.current),Bc(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Ir]=e,r[Il]=i,t=(e.mode&1)!==0,n){case"dialog":qe("cancel",r),qe("close",r);break;case"iframe":case"object":case"embed":qe("load",r);break;case"video":case"audio":for(s=0;s<za.length;s++)qe(za[s],r);break;case"source":qe("error",r);break;case"img":case"image":case"link":qe("error",r),qe("load",r);break;case"details":qe("toggle",r);break;case"input":ov(r,i),qe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},qe("invalid",r);break;case"textarea":lv(r,i),qe("invalid",r)}Dp(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&Fc(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Fc(r.textContent,a,t),s=["children",""+a]):kl.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&qe("scroll",r)}switch(n){case"input":Nc(r),av(r,i,!0);break;case"textarea":Nc(r),cv(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Ku)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=ak(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Ir]=e,t[Il]=r,NS(t,e,!1,!1),e.stateNode=t;e:{switch(o=jp(n,r),n){case"dialog":qe("cancel",t),qe("close",t),s=r;break;case"iframe":case"object":case"embed":qe("load",t),s=r;break;case"video":case"audio":for(s=0;s<za.length;s++)qe(za[s],t);s=r;break;case"source":qe("error",t),s=r;break;case"img":case"image":case"link":qe("error",t),qe("load",t),s=r;break;case"details":qe("toggle",t),s=r;break;case"input":ov(t,r),s=Rp(t,r),qe("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=st({},r,{value:void 0}),qe("invalid",t);break;case"textarea":lv(t,r),s=Pp(t,r),qe("invalid",t);break;default:s=r}Dp(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?uk(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&lk(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Sl(t,l):typeof l=="number"&&Sl(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(kl.hasOwnProperty(i)?l!=null&&i==="onScroll"&&qe("scroll",t):l!=null&&jg(t,i,l,o))}switch(n){case"input":Nc(t),av(t,r,!1);break;case"textarea":Nc(t),cv(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ei(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Ho(t,!!r.multiple,i,!1):r.defaultValue!=null&&Ho(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Ku)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Wt(e),null;case 6:if(t&&e.stateNode!=null)PS(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ne(166));if(n=Ti(Ml.current),Ti(Dr.current),Bc(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ir]=e,(i=r.nodeValue!==n)&&(t=$n,t!==null))switch(t.tag){case 3:Fc(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Fc(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ir]=e,e.stateNode=r}return Wt(e),null;case 13:if(Je(tt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ye&&jn!==null&&e.mode&1&&!(e.flags&128))Qk(),ra(),e.flags|=98560,i=!1;else if(i=Bc(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(ne(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ne(317));i[Ir]=e}else ra(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Wt(e),i=!1}else xr!==null&&(gm(xr),xr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||tt.current&1?kt===0&&(kt=3):v0())),e.updateQueue!==null&&(e.flags|=4),Wt(e),null);case 4:return ia(),lm(t,e),t===null&&Rl(e.stateNode.containerInfo),Wt(e),null;case 10:return t0(e.type._context),Wt(e),null;case 17:return bn(e.type)&&qu(),Wt(e),null;case 19:if(Je(tt),i=e.memoizedState,i===null)return Wt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Pa(i,!1);else{if(kt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=ed(t),o!==null){for(e.flags|=128,Pa(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return He(tt,tt.current&1|2),e.child}t=t.sibling}i.tail!==null&&ft()>aa&&(e.flags|=128,r=!0,Pa(i,!1),e.lanes=4194304)}else{if(!r)if(t=ed(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Pa(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ye)return Wt(e),null}else 2*ft()-i.renderingStartTime>aa&&n!==1073741824&&(e.flags|=128,r=!0,Pa(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=ft(),e.sibling=null,n=tt.current,He(tt,r?n&1|2:n&1),e):(Wt(e),null);case 22:case 23:return y0(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?In&1073741824&&(Wt(e),e.subtreeFlags&6&&(e.flags|=8192)):Wt(e),null;case 24:return null;case 25:return null}throw Error(ne(156,e.tag))}function UO(t,e){switch(Qg(e),e.tag){case 1:return bn(e.type)&&qu(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ia(),Je(xn),Je(Qt),o0(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return i0(e),null;case 13:if(Je(tt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ne(340));ra()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Je(tt),null;case 4:return ia(),null;case 10:return t0(e.type._context),null;case 22:case 23:return y0(),null;case 24:return null;default:return null}}var Vc=!1,Gt=!1,zO=typeof WeakSet=="function"?WeakSet:Set,he=null;function Po(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){dt(t,e,r)}else n.current=null}function cm(t,e,n){try{n()}catch(r){dt(t,e,r)}}var Xv=!1;function VO(t,e){if(Kp=Vu,t=$k(),Jg(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,u=0,d=t,h=null;t:for(;;){for(var f;d!==n||s!==0&&d.nodeType!==3||(a=o+s),d!==i||r!==0&&d.nodeType!==3||(l=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===t)break t;if(h===n&&++c===s&&(a=o),h===i&&++u===r&&(l=o),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(qp={focusedElem:t,selectionRange:n},Vu=!1,he=e;he!==null;)if(e=he,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,he=t;else for(;he!==null;){e=he;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var g=p.memoizedProps,y=p.memoizedState,m=e.stateNode,v=m.getSnapshotBeforeUpdate(e.elementType===e.type?g:gr(e.type,g),y);m.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ne(163))}}catch(S){dt(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,he=t;break}he=e.return}return p=Xv,Xv=!1,p}function nl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&cm(e,n,i)}s=s.next}while(s!==r)}}function xh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function um(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function MS(t){var e=t.alternate;e!==null&&(t.alternate=null,MS(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ir],delete e[Il],delete e[Yp],delete e[CO],delete e[TO])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function DS(t){return t.tag===5||t.tag===3||t.tag===4}function Zv(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||DS(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function dm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Ku));else if(r!==4&&(t=t.child,t!==null))for(dm(t,e,n),t=t.sibling;t!==null;)dm(t,e,n),t=t.sibling}function hm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(hm(t,e,n),t=t.sibling;t!==null;)hm(t,e,n),t=t.sibling}var Lt=null,vr=!1;function ws(t,e,n){for(n=n.child;n!==null;)jS(t,e,n),n=n.sibling}function jS(t,e,n){if(Mr&&typeof Mr.onCommitFiberUnmount=="function")try{Mr.onCommitFiberUnmount(hh,n)}catch{}switch(n.tag){case 5:Gt||Po(n,e);case 6:var r=Lt,s=vr;Lt=null,ws(t,e,n),Lt=r,vr=s,Lt!==null&&(vr?(t=Lt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Lt.removeChild(n.stateNode));break;case 18:Lt!==null&&(vr?(t=Lt,n=n.stateNode,t.nodeType===8?pf(t.parentNode,n):t.nodeType===1&&pf(t,n),_l(t)):pf(Lt,n.stateNode));break;case 4:r=Lt,s=vr,Lt=n.stateNode.containerInfo,vr=!0,ws(t,e,n),Lt=r,vr=s;break;case 0:case 11:case 14:case 15:if(!Gt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&cm(n,e,o),s=s.next}while(s!==r)}ws(t,e,n);break;case 1:if(!Gt&&(Po(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){dt(n,e,a)}ws(t,e,n);break;case 21:ws(t,e,n);break;case 22:n.mode&1?(Gt=(r=Gt)||n.memoizedState!==null,ws(t,e,n),Gt=r):ws(t,e,n);break;default:ws(t,e,n)}}function e1(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new zO),e.forEach(function(r){var s=XO.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function dr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Lt=a.stateNode,vr=!1;break e;case 3:Lt=a.stateNode.containerInfo,vr=!0;break e;case 4:Lt=a.stateNode.containerInfo,vr=!0;break e}a=a.return}if(Lt===null)throw Error(ne(160));jS(i,o,s),Lt=null,vr=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){dt(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)LS(e,t),e=e.sibling}function LS(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(dr(e,t),Tr(t),r&4){try{nl(3,t,t.return),xh(3,t)}catch(g){dt(t,t.return,g)}try{nl(5,t,t.return)}catch(g){dt(t,t.return,g)}}break;case 1:dr(e,t),Tr(t),r&512&&n!==null&&Po(n,n.return);break;case 5:if(dr(e,t),Tr(t),r&512&&n!==null&&Po(n,n.return),t.flags&32){var s=t.stateNode;try{Sl(s,"")}catch(g){dt(t,t.return,g)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&ik(s,i),jp(a,o);var c=jp(a,i);for(o=0;o<l.length;o+=2){var u=l[o],d=l[o+1];u==="style"?uk(s,d):u==="dangerouslySetInnerHTML"?lk(s,d):u==="children"?Sl(s,d):jg(s,u,d,c)}switch(a){case"input":Np(s,i);break;case"textarea":ok(s,i);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var f=i.value;f!=null?Ho(s,!!i.multiple,f,!1):h!==!!i.multiple&&(i.defaultValue!=null?Ho(s,!!i.multiple,i.defaultValue,!0):Ho(s,!!i.multiple,i.multiple?[]:"",!1))}s[Il]=i}catch(g){dt(t,t.return,g)}}break;case 6:if(dr(e,t),Tr(t),r&4){if(t.stateNode===null)throw Error(ne(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(g){dt(t,t.return,g)}}break;case 3:if(dr(e,t),Tr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{_l(e.containerInfo)}catch(g){dt(t,t.return,g)}break;case 4:dr(e,t),Tr(t);break;case 13:dr(e,t),Tr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(m0=ft())),r&4&&e1(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(Gt=(c=Gt)||u,dr(e,t),Gt=c):dr(e,t),Tr(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(he=t,u=t.child;u!==null;){for(d=he=u;he!==null;){switch(h=he,f=h.child,h.tag){case 0:case 11:case 14:case 15:nl(4,h,h.return);break;case 1:Po(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(g){dt(r,n,g)}}break;case 5:Po(h,h.return);break;case 22:if(h.memoizedState!==null){n1(d);continue}}f!==null?(f.return=h,he=f):n1(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{s=d.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=ck("display",o))}catch(g){dt(t,t.return,g)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(g){dt(t,t.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:dr(e,t),Tr(t),r&4&&e1(t);break;case 21:break;default:dr(e,t),Tr(t)}}function Tr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(DS(n)){var r=n;break e}n=n.return}throw Error(ne(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Sl(s,""),r.flags&=-33);var i=Zv(t);hm(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Zv(t);dm(t,a,o);break;default:throw Error(ne(161))}}catch(l){dt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function HO(t,e,n){he=t,$S(t)}function $S(t,e,n){for(var r=(t.mode&1)!==0;he!==null;){var s=he,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Vc;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||Gt;a=Vc;var c=Gt;if(Vc=o,(Gt=l)&&!c)for(he=s;he!==null;)o=he,l=o.child,o.tag===22&&o.memoizedState!==null?r1(s):l!==null?(l.return=o,he=l):r1(s);for(;i!==null;)he=i,$S(i),i=i.sibling;he=s,Vc=a,Gt=c}t1(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,he=i):t1(t)}}function t1(t){for(;he!==null;){var e=he;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Gt||xh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Gt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:gr(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Fv(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Fv(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&_l(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ne(163))}Gt||e.flags&512&&um(e)}catch(h){dt(e,e.return,h)}}if(e===t){he=null;break}if(n=e.sibling,n!==null){n.return=e.return,he=n;break}he=e.return}}function n1(t){for(;he!==null;){var e=he;if(e===t){he=null;break}var n=e.sibling;if(n!==null){n.return=e.return,he=n;break}he=e.return}}function r1(t){for(;he!==null;){var e=he;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{xh(4,e)}catch(l){dt(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){dt(e,s,l)}}var i=e.return;try{um(e)}catch(l){dt(e,i,l)}break;case 5:var o=e.return;try{um(e)}catch(l){dt(e,o,l)}}}catch(l){dt(e,e.return,l)}if(e===t){he=null;break}var a=e.sibling;if(a!==null){a.return=e.return,he=a;break}he=e.return}}var WO=Math.ceil,rd=gs.ReactCurrentDispatcher,f0=gs.ReactCurrentOwner,er=gs.ReactCurrentBatchConfig,$e=0,Rt=null,yt=null,zt=0,In=0,Mo=oi(0),kt=0,$l=null,Gi=0,bh=0,p0=0,rl=null,pn=null,m0=0,aa=1/0,Jr=null,sd=!1,fm=null,Ws=null,Hc=!1,js=null,id=0,sl=0,pm=null,xu=-1,bu=0;function ln(){return $e&6?ft():xu!==-1?xu:xu=ft()}function Ks(t){return t.mode&1?$e&2&&zt!==0?zt&-zt:AO.transition!==null?(bu===0&&(bu=kk()),bu):(t=Fe,t!==0||(t=window.event,t=t===void 0?16:Ok(t.type)),t):1}function Sr(t,e,n,r){if(50<sl)throw sl=0,pm=null,Error(ne(185));pc(t,n,r),(!($e&2)||t!==Rt)&&(t===Rt&&(!($e&2)&&(bh|=n),kt===4&&Ns(t,zt)),kn(t,r),n===1&&$e===0&&!(e.mode&1)&&(aa=ft()+500,yh&&ai()))}function kn(t,e){var n=t.callbackNode;AA(t,e);var r=zu(t,t===Rt?zt:0);if(r===0)n!==null&&hv(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&hv(n),e===1)t.tag===0?_O(s1.bind(null,t)):Gk(s1.bind(null,t)),SO(function(){!($e&6)&&ai()}),n=null;else{switch(Sk(r)){case 1:n=Ug;break;case 4:n=xk;break;case 16:n=Uu;break;case 536870912:n=bk;break;default:n=Uu}n=KS(n,FS.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function FS(t,e){if(xu=-1,bu=0,$e&6)throw Error(ne(327));var n=t.callbackNode;if(Jo()&&t.callbackNode!==n)return null;var r=zu(t,t===Rt?zt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=od(t,r);else{e=r;var s=$e;$e|=2;var i=US();(Rt!==t||zt!==e)&&(Jr=null,aa=ft()+500,Di(t,e));do try{GO();break}catch(a){BS(t,a)}while(1);e0(),rd.current=i,$e=s,yt!==null?e=0:(Rt=null,zt=0,e=kt)}if(e!==0){if(e===2&&(s=Up(t),s!==0&&(r=s,e=mm(t,s))),e===1)throw n=$l,Di(t,0),Ns(t,r),kn(t,ft()),n;if(e===6)Ns(t,r);else{if(s=t.current.alternate,!(r&30)&&!KO(s)&&(e=od(t,r),e===2&&(i=Up(t),i!==0&&(r=i,e=mm(t,i))),e===1))throw n=$l,Di(t,0),Ns(t,r),kn(t,ft()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(ne(345));case 2:yi(t,pn,Jr);break;case 3:if(Ns(t,r),(r&130023424)===r&&(e=m0+500-ft(),10<e)){if(zu(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){ln(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Jp(yi.bind(null,t,pn,Jr),e);break}yi(t,pn,Jr);break;case 4:if(Ns(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-kr(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=ft()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*WO(r/1960))-r,10<r){t.timeoutHandle=Jp(yi.bind(null,t,pn,Jr),r);break}yi(t,pn,Jr);break;case 5:yi(t,pn,Jr);break;default:throw Error(ne(329))}}}return kn(t,ft()),t.callbackNode===n?FS.bind(null,t):null}function mm(t,e){var n=rl;return t.current.memoizedState.isDehydrated&&(Di(t,e).flags|=256),t=od(t,e),t!==2&&(e=pn,pn=n,e!==null&&gm(e)),t}function gm(t){pn===null?pn=t:pn.push.apply(pn,t)}function KO(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Er(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ns(t,e){for(e&=~p0,e&=~bh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-kr(e),r=1<<n;t[n]=-1,e&=~r}}function s1(t){if($e&6)throw Error(ne(327));Jo();var e=zu(t,0);if(!(e&1))return kn(t,ft()),null;var n=od(t,e);if(t.tag!==0&&n===2){var r=Up(t);r!==0&&(e=r,n=mm(t,r))}if(n===1)throw n=$l,Di(t,0),Ns(t,e),kn(t,ft()),n;if(n===6)throw Error(ne(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,yi(t,pn,Jr),kn(t,ft()),null}function g0(t,e){var n=$e;$e|=1;try{return t(e)}finally{$e=n,$e===0&&(aa=ft()+500,yh&&ai())}}function Ji(t){js!==null&&js.tag===0&&!($e&6)&&Jo();var e=$e;$e|=1;var n=er.transition,r=Fe;try{if(er.transition=null,Fe=1,t)return t()}finally{Fe=r,er.transition=n,$e=e,!($e&6)&&ai()}}function y0(){In=Mo.current,Je(Mo)}function Di(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,kO(n)),yt!==null)for(n=yt.return;n!==null;){var r=n;switch(Qg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&qu();break;case 3:ia(),Je(xn),Je(Qt),o0();break;case 5:i0(r);break;case 4:ia();break;case 13:Je(tt);break;case 19:Je(tt);break;case 10:t0(r.type._context);break;case 22:case 23:y0()}n=n.return}if(Rt=t,yt=t=qs(t.current,null),zt=In=e,kt=0,$l=null,p0=bh=Gi=0,pn=rl=null,Ci!==null){for(e=0;e<Ci.length;e++)if(n=Ci[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Ci=null}return t}function BS(t,e){do{var n=yt;try{if(e0(),yu.current=nd,td){for(var r=rt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}td=!1}if(qi=0,_t=bt=rt=null,tl=!1,Dl=0,f0.current=null,n===null||n.return===null){kt=1,$l=e,yt=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=zt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=Wv(o);if(f!==null){f.flags&=-257,Kv(f,o,a,i,e),f.mode&1&&Hv(i,c,e),e=f,l=c;var p=e.updateQueue;if(p===null){var g=new Set;g.add(l),e.updateQueue=g}else p.add(l);break e}else{if(!(e&1)){Hv(i,c,e),v0();break e}l=Error(ne(426))}}else if(Ye&&a.mode&1){var y=Wv(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),Kv(y,o,a,i,e),Xg(oa(l,a));break e}}i=l=oa(l,a),kt!==4&&(kt=2),rl===null?rl=[i]:rl.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var m=SS(i,l,e);$v(i,m);break e;case 1:a=l;var v=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Ws===null||!Ws.has(w)))){i.flags|=65536,e&=-e,i.lanes|=e;var S=ES(i,a,e);$v(i,S);break e}}i=i.return}while(i!==null)}VS(n)}catch(T){e=T,yt===n&&n!==null&&(yt=n=n.return);continue}break}while(1)}function US(){var t=rd.current;return rd.current=nd,t===null?nd:t}function v0(){(kt===0||kt===3||kt===2)&&(kt=4),Rt===null||!(Gi&268435455)&&!(bh&268435455)||Ns(Rt,zt)}function od(t,e){var n=$e;$e|=2;var r=US();(Rt!==t||zt!==e)&&(Jr=null,Di(t,e));do try{qO();break}catch(s){BS(t,s)}while(1);if(e0(),$e=n,rd.current=r,yt!==null)throw Error(ne(261));return Rt=null,zt=0,kt}function qO(){for(;yt!==null;)zS(yt)}function GO(){for(;yt!==null&&!wA();)zS(yt)}function zS(t){var e=WS(t.alternate,t,In);t.memoizedProps=t.pendingProps,e===null?VS(t):yt=e,f0.current=null}function VS(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=UO(n,e),n!==null){n.flags&=32767,yt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{kt=6,yt=null;return}}else if(n=BO(n,e,In),n!==null){yt=n;return}if(e=e.sibling,e!==null){yt=e;return}yt=e=t}while(e!==null);kt===0&&(kt=5)}function yi(t,e,n){var r=Fe,s=er.transition;try{er.transition=null,Fe=1,JO(t,e,n,r)}finally{er.transition=s,Fe=r}return null}function JO(t,e,n,r){do Jo();while(js!==null);if($e&6)throw Error(ne(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ne(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(OA(t,i),t===Rt&&(yt=Rt=null,zt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Hc||(Hc=!0,KS(Uu,function(){return Jo(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=er.transition,er.transition=null;var o=Fe;Fe=1;var a=$e;$e|=4,f0.current=null,VO(t,n),LS(n,t),mO(qp),Vu=!!Kp,qp=Kp=null,t.current=n,HO(n),xA(),$e=a,Fe=o,er.transition=i}else t.current=n;if(Hc&&(Hc=!1,js=t,id=s),i=t.pendingLanes,i===0&&(Ws=null),SA(n.stateNode),kn(t,ft()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(sd)throw sd=!1,t=fm,fm=null,t;return id&1&&t.tag!==0&&Jo(),i=t.pendingLanes,i&1?t===pm?sl++:(sl=0,pm=t):sl=0,ai(),null}function Jo(){if(js!==null){var t=Sk(id),e=er.transition,n=Fe;try{if(er.transition=null,Fe=16>t?16:t,js===null)var r=!1;else{if(t=js,js=null,id=0,$e&6)throw Error(ne(331));var s=$e;for($e|=4,he=t.current;he!==null;){var i=he,o=i.child;if(he.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(he=c;he!==null;){var u=he;switch(u.tag){case 0:case 11:case 15:nl(8,u,i)}var d=u.child;if(d!==null)d.return=u,he=d;else for(;he!==null;){u=he;var h=u.sibling,f=u.return;if(MS(u),u===c){he=null;break}if(h!==null){h.return=f,he=h;break}he=f}}}var p=i.alternate;if(p!==null){var g=p.child;if(g!==null){p.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}he=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,he=o;else e:for(;he!==null;){if(i=he,i.flags&2048)switch(i.tag){case 0:case 11:case 15:nl(9,i,i.return)}var m=i.sibling;if(m!==null){m.return=i.return,he=m;break e}he=i.return}}var v=t.current;for(he=v;he!==null;){o=he;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,he=w;else e:for(o=v;he!==null;){if(a=he,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:xh(9,a)}}catch(T){dt(a,a.return,T)}if(a===o){he=null;break e}var S=a.sibling;if(S!==null){S.return=a.return,he=S;break e}he=a.return}}if($e=s,ai(),Mr&&typeof Mr.onPostCommitFiberRoot=="function")try{Mr.onPostCommitFiberRoot(hh,t)}catch{}r=!0}return r}finally{Fe=n,er.transition=e}}return!1}function i1(t,e,n){e=oa(n,e),e=SS(t,e,1),t=Hs(t,e,1),e=ln(),t!==null&&(pc(t,1,e),kn(t,e))}function dt(t,e,n){if(t.tag===3)i1(t,t,n);else for(;e!==null;){if(e.tag===3){i1(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ws===null||!Ws.has(r))){t=oa(n,t),t=ES(e,t,1),e=Hs(e,t,1),t=ln(),e!==null&&(pc(e,1,t),kn(e,t));break}}e=e.return}}function YO(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=ln(),t.pingedLanes|=t.suspendedLanes&n,Rt===t&&(zt&n)===n&&(kt===4||kt===3&&(zt&130023424)===zt&&500>ft()-m0?Di(t,0):p0|=n),kn(t,e)}function HS(t,e){e===0&&(t.mode&1?(e=Mc,Mc<<=1,!(Mc&130023424)&&(Mc=4194304)):e=1);var n=ln();t=us(t,e),t!==null&&(pc(t,e,n),kn(t,n))}function QO(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),HS(t,n)}function XO(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ne(314))}r!==null&&r.delete(e),HS(t,n)}var WS;WS=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||xn.current)yn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return yn=!1,FO(t,e,n);yn=!!(t.flags&131072)}else yn=!1,Ye&&e.flags&1048576&&Jk(e,Yu,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;wu(t,e),t=e.pendingProps;var s=na(e,Qt.current);Go(e,n),s=l0(null,e,r,t,s,n);var i=c0();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,bn(r)?(i=!0,Gu(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,r0(e),s.updater=wh,e.stateNode=s,s._reactInternals=e,nm(e,r,t,n),e=im(null,e,r,!0,i,n)):(e.tag=0,Ye&&i&&Yg(e),sn(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(wu(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=eR(r),t=gr(r,t),s){case 0:e=sm(null,e,r,t,n);break e;case 1:e=Jv(null,e,r,t,n);break e;case 11:e=qv(null,e,r,t,n);break e;case 14:e=Gv(null,e,r,gr(r.type,t),n);break e}throw Error(ne(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:gr(r,s),sm(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:gr(r,s),Jv(t,e,r,s,n);case 3:e:{if(AS(e),t===null)throw Error(ne(387));r=e.pendingProps,i=e.memoizedState,s=i.element,tS(t,e),Zu(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=oa(Error(ne(423)),e),e=Yv(t,e,r,n,s);break e}else if(r!==s){s=oa(Error(ne(424)),e),e=Yv(t,e,r,n,s);break e}else for(jn=Vs(e.stateNode.containerInfo.firstChild),$n=e,Ye=!0,xr=null,n=Zk(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ra(),r===s){e=ds(t,e,n);break e}sn(t,e,r,n)}e=e.child}return e;case 5:return nS(e),t===null&&Zp(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Gp(r,s)?o=null:i!==null&&Gp(r,i)&&(e.flags|=32),_S(t,e),sn(t,e,o,n),e.child;case 6:return t===null&&Zp(e),null;case 13:return OS(t,e,n);case 4:return s0(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=sa(e,null,r,n):sn(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:gr(r,s),qv(t,e,r,s,n);case 7:return sn(t,e,e.pendingProps,n),e.child;case 8:return sn(t,e,e.pendingProps.children,n),e.child;case 12:return sn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,He(Qu,r._currentValue),r._currentValue=o,i!==null)if(Er(i.value,o)){if(i.children===s.children&&!xn.current){e=ds(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=rs(-1,n&-n),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),em(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(ne(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),em(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}sn(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Go(e,n),s=ir(s),r=r(s),e.flags|=1,sn(t,e,r,n),e.child;case 14:return r=e.type,s=gr(r,e.pendingProps),s=gr(r.type,s),Gv(t,e,r,s,n);case 15:return CS(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:gr(r,s),wu(t,e),e.tag=1,bn(r)?(t=!0,Gu(e)):t=!1,Go(e,n),kS(e,r,s),nm(e,r,s,n),im(null,e,r,!0,t,n);case 19:return RS(t,e,n);case 22:return TS(t,e,n)}throw Error(ne(156,e.tag))};function KS(t,e){return wk(t,e)}function ZO(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xn(t,e,n,r){return new ZO(t,e,n,r)}function w0(t){return t=t.prototype,!(!t||!t.isReactComponent)}function eR(t){if(typeof t=="function")return w0(t)?1:0;if(t!=null){if(t=t.$$typeof,t===$g)return 11;if(t===Fg)return 14}return 2}function qs(t,e){var n=t.alternate;return n===null?(n=Xn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ku(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")w0(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Eo:return ji(n.children,s,i,e);case Lg:o=8,s|=8;break;case Tp:return t=Xn(12,n,e,s|2),t.elementType=Tp,t.lanes=i,t;case _p:return t=Xn(13,n,e,s),t.elementType=_p,t.lanes=i,t;case Ap:return t=Xn(19,n,e,s),t.elementType=Ap,t.lanes=i,t;case nk:return kh(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case ek:o=10;break e;case tk:o=9;break e;case $g:o=11;break e;case Fg:o=14;break e;case Ss:o=16,r=null;break e}throw Error(ne(130,t==null?t:typeof t,""))}return e=Xn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ji(t,e,n,r){return t=Xn(7,t,r,e),t.lanes=n,t}function kh(t,e,n,r){return t=Xn(22,t,r,e),t.elementType=nk,t.lanes=n,t.stateNode={isHidden:!1},t}function kf(t,e,n){return t=Xn(6,t,null,e),t.lanes=n,t}function Sf(t,e,n){return e=Xn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function tR(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=nf(0),this.expirationTimes=nf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=nf(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function x0(t,e,n,r,s,i,o,a,l){return t=new tR(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Xn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},r0(i),t}function nR(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:So,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function qS(t){if(!t)return ti;t=t._reactInternals;e:{if(ro(t)!==t||t.tag!==1)throw Error(ne(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(bn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ne(171))}if(t.tag===1){var n=t.type;if(bn(n))return qk(t,n,e)}return e}function GS(t,e,n,r,s,i,o,a,l){return t=x0(n,r,!0,t,s,i,o,a,l),t.context=qS(null),n=t.current,r=ln(),s=Ks(n),i=rs(r,s),i.callback=e??null,Hs(n,i,s),t.current.lanes=s,pc(t,s,r),kn(t,r),t}function Sh(t,e,n,r){var s=e.current,i=ln(),o=Ks(s);return n=qS(n),e.context===null?e.context=n:e.pendingContext=n,e=rs(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Hs(s,e,o),t!==null&&(Sr(t,s,o,i),gu(t,s,o)),o}function ad(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function o1(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function b0(t,e){o1(t,e),(t=t.alternate)&&o1(t,e)}function rR(){return null}var JS=typeof reportError=="function"?reportError:function(t){console.error(t)};function k0(t){this._internalRoot=t}Eh.prototype.render=k0.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ne(409));Sh(t,e,null,null)};Eh.prototype.unmount=k0.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ji(function(){Sh(null,t,null,null)}),e[cs]=null}};function Eh(t){this._internalRoot=t}Eh.prototype.unstable_scheduleHydration=function(t){if(t){var e=Tk();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Rs.length&&e!==0&&e<Rs[n].priority;n++);Rs.splice(n,0,t),n===0&&Ak(t)}};function S0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ch(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function a1(){}function sR(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var c=ad(o);i.call(c)}}var o=GS(e,r,t,0,null,!1,!1,"",a1);return t._reactRootContainer=o,t[cs]=o.current,Rl(t.nodeType===8?t.parentNode:t),Ji(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var c=ad(l);a.call(c)}}var l=x0(t,0,!1,null,null,!1,!1,"",a1);return t._reactRootContainer=l,t[cs]=l.current,Rl(t.nodeType===8?t.parentNode:t),Ji(function(){Sh(e,l,n,r)}),l}function Th(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=ad(o);a.call(l)}}Sh(e,o,t,s)}else o=sR(n,e,t,s,r);return ad(o)}Ek=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ua(e.pendingLanes);n!==0&&(zg(e,n|1),kn(e,ft()),!($e&6)&&(aa=ft()+500,ai()))}break;case 13:Ji(function(){var r=us(t,1);if(r!==null){var s=ln();Sr(r,t,1,s)}}),b0(t,1)}};Vg=function(t){if(t.tag===13){var e=us(t,134217728);if(e!==null){var n=ln();Sr(e,t,134217728,n)}b0(t,134217728)}};Ck=function(t){if(t.tag===13){var e=Ks(t),n=us(t,e);if(n!==null){var r=ln();Sr(n,t,e,r)}b0(t,e)}};Tk=function(){return Fe};_k=function(t,e){var n=Fe;try{return Fe=t,e()}finally{Fe=n}};$p=function(t,e,n){switch(e){case"input":if(Np(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=gh(r);if(!s)throw Error(ne(90));sk(r),Np(r,s)}}}break;case"textarea":ok(t,n);break;case"select":e=n.value,e!=null&&Ho(t,!!n.multiple,e,!1)}};fk=g0;pk=Ji;var iR={usingClientEntryPoint:!1,Events:[gc,Ao,gh,dk,hk,g0]},Ma={findFiberByHostInstance:Ei,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},oR={bundleType:Ma.bundleType,version:Ma.version,rendererPackageName:Ma.rendererPackageName,rendererConfig:Ma.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:gs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=yk(t),t===null?null:t.stateNode},findFiberByHostInstance:Ma.findFiberByHostInstance||rR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wc.isDisabled&&Wc.supportsFiber)try{hh=Wc.inject(oR),Mr=Wc}catch{}}Bn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=iR;Bn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!S0(e))throw Error(ne(200));return nR(t,e,null,n)};Bn.createRoot=function(t,e){if(!S0(t))throw Error(ne(299));var n=!1,r="",s=JS;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=x0(t,1,!1,null,null,n,!1,r,s),t[cs]=e.current,Rl(t.nodeType===8?t.parentNode:t),new k0(e)};Bn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ne(188)):(t=Object.keys(t).join(","),Error(ne(268,t)));return t=yk(e),t=t===null?null:t.stateNode,t};Bn.flushSync=function(t){return Ji(t)};Bn.hydrate=function(t,e,n){if(!Ch(e))throw Error(ne(200));return Th(null,t,e,!0,n)};Bn.hydrateRoot=function(t,e,n){if(!S0(t))throw Error(ne(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=JS;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=GS(e,null,t,1,n??null,s,!1,i,o),t[cs]=e.current,Rl(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Eh(e)};Bn.render=function(t,e,n){if(!Ch(e))throw Error(ne(200));return Th(null,t,e,!1,n)};Bn.unmountComponentAtNode=function(t){if(!Ch(t))throw Error(ne(40));return t._reactRootContainer?(Ji(function(){Th(null,null,t,!1,function(){t._reactRootContainer=null,t[cs]=null})}),!0):!1};Bn.unstable_batchedUpdates=g0;Bn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Ch(n))throw Error(ne(200));if(t==null||t._reactInternals===void 0)throw Error(ne(38));return Th(t,e,n,!1,r)};Bn.version="18.3.1-next-f1338f8080-20240426";function YS(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(YS)}catch(t){console.error(t)}}YS(),Yb.exports=Bn;var E0=Yb.exports;const aR=$b(E0);var l1=E0;Ep.createRoot=l1.createRoot,Ep.hydrateRoot=l1.hydrateRoot;const lR="modulepreload",cR=function(t){return"/"+t},c1={},uR=function(e,n,r){if(!n||n.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(n.map(i=>{if(i=cR(i),i in c1)return;c1[i]=!0;const o=i.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let u=s.length-1;u>=0;u--){const d=s[u];if(d.href===i&&(!o||d.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${a}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":lR,o||(c.as="script",c.crossOrigin=""),c.href=i,document.head.appendChild(c),o)return new Promise((u,d)=>{c.addEventListener("load",u),c.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})};var u1="popstate";function dR(t={}){function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return ym("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:Fl(s)}return fR(e,n,null,t)}function Xe(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function ar(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function hR(){return Math.random().toString(36).substring(2,10)}function d1(t,e){return{usr:t.state,key:t.key,idx:e}}function ym(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?wa(e):e,state:n,key:e&&e.key||r||hR()}}function Fl({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function wa(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function fR(t,e,n,r={}){let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a="POP",l=null,c=u();c==null&&(c=0,o.replaceState({...o.state,idx:c},""));function u(){return(o.state||{idx:null}).idx}function d(){a="POP";let y=u(),m=y==null?null:y-c;c=y,l&&l({action:a,location:g.location,delta:m})}function h(y,m){a="PUSH";let v=ym(g.location,y,m);n&&n(v,y),c=u()+1;let w=d1(v,c),S=g.createHref(v);try{o.pushState(w,"",S)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;s.location.assign(S)}i&&l&&l({action:a,location:g.location,delta:1})}function f(y,m){a="REPLACE";let v=ym(g.location,y,m);n&&n(v,y),c=u();let w=d1(v,c),S=g.createHref(v);o.replaceState(w,"",S),i&&l&&l({action:a,location:g.location,delta:0})}function p(y){return pR(y)}let g={get action(){return a},get location(){return t(s,o)},listen(y){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(u1,d),l=y,()=>{s.removeEventListener(u1,d),l=null}},createHref(y){return e(s,y)},createURL:p,encodeLocation(y){let m=p(y);return{pathname:m.pathname,search:m.search,hash:m.hash}},push:h,replace:f,go(y){return o.go(y)}};return g}function pR(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Xe(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:Fl(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function QS(t,e,n="/"){return mR(t,e,n,!1)}function mR(t,e,n,r){let s=typeof e=="string"?wa(e):e,i=hs(s.pathname||"/",n);if(i==null)return null;let o=XS(t);gR(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=_R(i);a=CR(o[l],c,r)}return a}function XS(t,e=[],n=[],r="",s=!1){let i=(o,a,l=s,c)=>{let u={relativePath:c===void 0?o.path||"":c,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};if(u.relativePath.startsWith("/")){if(!u.relativePath.startsWith(r)&&l)return;Xe(u.relativePath.startsWith(r),`Absolute route path "${u.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(r.length)}let d=ss([r,u.relativePath]),h=n.concat(u);o.children&&o.children.length>0&&(Xe(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${d}".`),XS(o.children,e,h,d,l)),!(o.path==null&&!o.index)&&e.push({path:d,score:SR(d,o.index),routesMeta:h})};return t.forEach((o,a)=>{var l;if(o.path===""||!((l=o.path)!=null&&l.includes("?")))i(o,a);else for(let c of ZS(o.path))i(o,a,!0,c)}),e}function ZS(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=ZS(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function gR(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:ER(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var yR=/^:[\w-]+$/,vR=3,wR=2,xR=1,bR=10,kR=-2,h1=t=>t==="*";function SR(t,e){let n=t.split("/"),r=n.length;return n.some(h1)&&(r+=kR),e&&(r+=wR),n.filter(s=>!h1(s)).reduce((s,i)=>s+(yR.test(i)?vR:i===""?xR:bR),r)}function ER(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function CR(t,e,n=!1){let{routesMeta:r}=t,s={},i="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],c=a===r.length-1,u=i==="/"?e:e.slice(i.length)||"/",d=ld({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),h=l.route;if(!d&&c&&n&&!r[r.length-1].route.index&&(d=ld({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!d)return null;Object.assign(s,d.params),o.push({params:s,pathname:ss([i,d.pathname]),pathnameBase:NR(ss([i,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(i=ss([i,d.pathnameBase]))}return o}function ld(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=TR(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((c,{paramName:u,isOptional:d},h)=>{if(u==="*"){let p=a[h]||"";o=i.slice(0,i.length-p.length).replace(/(.)\/+$/,"$1")}const f=a[h];return d&&!f?c[u]=void 0:c[u]=(f||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:o,pattern:t}}function TR(t,e=!1,n=!0){ar(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function _R(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ar(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function hs(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}var eE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,AR=t=>eE.test(t);function OR(t,e="/"){let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?wa(t):t,i;if(n)if(AR(n))i=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),ar(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${n}`)}n.startsWith("/")?i=f1(n.substring(1),"/"):i=f1(n,e)}else i=e;return{pathname:i,search:IR(r),hash:PR(s)}}function f1(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Ef(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function RR(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function C0(t){let e=RR(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function T0(t,e,n,r=!1){let s;typeof t=="string"?s=wa(t):(s={...t},Xe(!s.pathname||!s.pathname.includes("?"),Ef("?","pathname","search",s)),Xe(!s.pathname||!s.pathname.includes("#"),Ef("#","pathname","hash",s)),Xe(!s.search||!s.search.includes("#"),Ef("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=n;else{let d=e.length-1;if(!r&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),d-=1;s.pathname=h.join("/")}a=d>=0?e[d]:"/"}let l=OR(s,a),c=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}var ss=t=>t.join("/").replace(/\/\/+/g,"/"),NR=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),IR=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,PR=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,MR=class{constructor(t,e,n,r=!1){this.status=t,this.statusText=e||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function DR(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function jR(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var tE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function nE(t,e){let n=t;if(typeof n!="string"||!eE.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let r=n,s=!1;if(tE)try{let i=new URL(window.location.href),o=n.startsWith("//")?new URL(i.protocol+n):new URL(n),a=hs(o.pathname,e);o.origin===i.origin&&a!=null?n=a+o.search+o.hash:s=!0}catch{ar(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:s,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var rE=["POST","PUT","PATCH","DELETE"];new Set(rE);var LR=["GET",...rE];new Set(LR);var xa=A.createContext(null);xa.displayName="DataRouter";var _h=A.createContext(null);_h.displayName="DataRouterState";var $R=A.createContext(!1),sE=A.createContext({isTransitioning:!1});sE.displayName="ViewTransition";var FR=A.createContext(new Map);FR.displayName="Fetchers";var BR=A.createContext(null);BR.displayName="Await";var zn=A.createContext(null);zn.displayName="Navigation";var vc=A.createContext(null);vc.displayName="Location";var Br=A.createContext({outlet:null,matches:[],isDataRoute:!1});Br.displayName="Route";var _0=A.createContext(null);_0.displayName="RouteError";var iE="REACT_ROUTER_ERROR",UR="REDIRECT",zR="ROUTE_ERROR_RESPONSE";function VR(t){if(t.startsWith(`${iE}:${UR}:{`))try{let e=JSON.parse(t.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function HR(t){if(t.startsWith(`${iE}:${zR}:{`))try{let e=JSON.parse(t.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new MR(e.status,e.statusText,e.data)}catch{}}function WR(t,{relative:e}={}){Xe(ba(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=A.useContext(zn),{hash:s,pathname:i,search:o}=wc(t,{relative:e}),a=i;return n!=="/"&&(a=i==="/"?n:ss([n,i])),r.createHref({pathname:a,search:o,hash:s})}function ba(){return A.useContext(vc)!=null}function li(){return Xe(ba(),"useLocation() may be used only in the context of a <Router> component."),A.useContext(vc).location}var oE="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function aE(t){A.useContext(zn).static||A.useLayoutEffect(t)}function lE(){let{isDataRoute:t}=A.useContext(Br);return t?sN():KR()}function KR(){Xe(ba(),"useNavigate() may be used only in the context of a <Router> component.");let t=A.useContext(xa),{basename:e,navigator:n}=A.useContext(zn),{matches:r}=A.useContext(Br),{pathname:s}=li(),i=JSON.stringify(C0(r)),o=A.useRef(!1);return aE(()=>{o.current=!0}),A.useCallback((l,c={})=>{if(ar(o.current,oE),!o.current)return;if(typeof l=="number"){n.go(l);return}let u=T0(l,JSON.parse(i),s,c.relative==="path");t==null&&e!=="/"&&(u.pathname=u.pathname==="/"?e:ss([e,u.pathname])),(c.replace?n.replace:n.push)(u,c.state,c)},[e,n,i,s,t])}A.createContext(null);function wc(t,{relative:e}={}){let{matches:n}=A.useContext(Br),{pathname:r}=li(),s=JSON.stringify(C0(n));return A.useMemo(()=>T0(t,JSON.parse(s),r,e==="path"),[t,s,r,e])}function qR(t,e){return cE(t,e)}function cE(t,e,n,r,s){var v;Xe(ba(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=A.useContext(zn),{matches:o}=A.useContext(Br),a=o[o.length-1],l=a?a.params:{},c=a?a.pathname:"/",u=a?a.pathnameBase:"/",d=a&&a.route;{let w=d&&d.path||"";dE(c,!d||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let h=li(),f;if(e){let w=typeof e=="string"?wa(e):e;Xe(u==="/"||((v=w.pathname)==null?void 0:v.startsWith(u)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${w.pathname}" was given in the \`location\` prop.`),f=w}else f=h;let p=f.pathname||"/",g=p;if(u!=="/"){let w=u.replace(/^\//,"").split("/");g="/"+p.replace(/^\//,"").split("/").slice(w.length).join("/")}let y=QS(t,{pathname:g});ar(d||y!=null,`No routes matched location "${f.pathname}${f.search}${f.hash}" `),ar(y==null||y[y.length-1].route.element!==void 0||y[y.length-1].route.Component!==void 0||y[y.length-1].route.lazy!==void 0,`Matched leaf route at location "${f.pathname}${f.search}${f.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let m=XR(y&&y.map(w=>Object.assign({},w,{params:Object.assign({},l,w.params),pathname:ss([u,i.encodeLocation?i.encodeLocation(w.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?u:ss([u,i.encodeLocation?i.encodeLocation(w.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:w.pathnameBase])})),o,n,r,s);return e&&m?A.createElement(vc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...f},navigationType:"POP"}},m):m}function GR(){let t=rN(),e=DR(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=A.createElement(A.Fragment,null,A.createElement("p",null," Hey developer "),A.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",A.createElement("code",{style:i},"ErrorBoundary")," or"," ",A.createElement("code",{style:i},"errorElement")," prop on your route.")),A.createElement(A.Fragment,null,A.createElement("h2",null,"Unexpected Application Error!"),A.createElement("h3",{style:{fontStyle:"italic"}},e),n?A.createElement("pre",{style:s},n):null,o)}var JR=A.createElement(GR,null),uE=class extends A.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const n=HR(t.digest);n&&(t=n)}let e=t!==void 0?A.createElement(Br.Provider,{value:this.props.routeContext},A.createElement(_0.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?A.createElement(YR,{error:t},e):e}};uE.contextType=$R;var Cf=new WeakMap;function YR({children:t,error:e}){let{basename:n}=A.useContext(zn);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let r=VR(e.digest);if(r){let s=Cf.get(e);if(s)throw s;let i=nE(r.location,n);if(tE&&!Cf.get(e))if(i.isExternal||r.reloadDocument)window.location.href=i.absoluteURL||i.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(i.to,{replace:r.replace}));throw Cf.set(e,o),o}return A.createElement("meta",{httpEquiv:"refresh",content:`0;url=${i.absoluteURL||i.to}`})}}return t}function QR({routeContext:t,match:e,children:n}){let r=A.useContext(xa);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),A.createElement(Br.Provider,{value:t},n)}function XR(t,e=[],n=null,r=null,s=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let i=t,o=n==null?void 0:n.errors;if(o!=null){let u=i.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);Xe(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,u+1))}let a=!1,l=-1;if(n)for(let u=0;u<i.length;u++){let d=i[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(l=u),d.route.id){let{loaderData:h,errors:f}=n,p=d.route.loader&&!h.hasOwnProperty(d.route.id)&&(!f||f[d.route.id]===void 0);if(d.route.lazy||p){a=!0,l>=0?i=i.slice(0,l+1):i=[i[0]];break}}}let c=n&&r?(u,d)=>{var h,f;r(u,{location:n.location,params:((f=(h=n.matches)==null?void 0:h[0])==null?void 0:f.params)??{},unstable_pattern:jR(n.matches),errorInfo:d})}:void 0;return i.reduceRight((u,d,h)=>{let f,p=!1,g=null,y=null;n&&(f=o&&d.route.id?o[d.route.id]:void 0,g=d.route.errorElement||JR,a&&(l<0&&h===0?(dE("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),p=!0,y=null):l===h&&(p=!0,y=d.route.hydrateFallbackElement||null)));let m=e.concat(i.slice(0,h+1)),v=()=>{let w;return f?w=g:p?w=y:d.route.Component?w=A.createElement(d.route.Component,null):d.route.element?w=d.route.element:w=u,A.createElement(QR,{match:d,routeContext:{outlet:u,matches:m,isDataRoute:n!=null},children:w})};return n&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?A.createElement(uE,{location:n.location,revalidation:n.revalidation,component:g,error:f,children:v(),routeContext:{outlet:null,matches:m,isDataRoute:!0},onError:c}):v()},null)}function A0(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ZR(t){let e=A.useContext(xa);return Xe(e,A0(t)),e}function eN(t){let e=A.useContext(_h);return Xe(e,A0(t)),e}function tN(t){let e=A.useContext(Br);return Xe(e,A0(t)),e}function O0(t){let e=tN(t),n=e.matches[e.matches.length-1];return Xe(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function nN(){return O0("useRouteId")}function rN(){var r;let t=A.useContext(_0),e=eN("useRouteError"),n=O0("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function sN(){let{router:t}=ZR("useNavigate"),e=O0("useNavigate"),n=A.useRef(!1);return aE(()=>{n.current=!0}),A.useCallback(async(s,i={})=>{ar(n.current,oE),n.current&&(typeof s=="number"?await t.navigate(s):await t.navigate(s,{fromRouteId:e,...i}))},[t,e])}var p1={};function dE(t,e,n){!e&&!p1[t]&&(p1[t]=!0,ar(!1,n))}A.memo(iN);function iN({routes:t,future:e,state:n,onError:r}){return cE(t,void 0,n,r,e)}function m1({to:t,replace:e,state:n,relative:r}){Xe(ba(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=A.useContext(zn);ar(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=A.useContext(Br),{pathname:o}=li(),a=lE(),l=T0(t,C0(i),o,r==="path"),c=JSON.stringify(l);return A.useEffect(()=>{a(JSON.parse(c),{replace:e,state:n,relative:r})},[a,c,r,e,n]),null}function vm(t){Xe(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function oN({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:s,static:i=!1,unstable_useTransitions:o}){Xe(!ba(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=t.replace(/^\/*/,"/"),l=A.useMemo(()=>({basename:a,navigator:s,static:i,unstable_useTransitions:o,future:{}}),[a,s,i,o]);typeof n=="string"&&(n=wa(n));let{pathname:c="/",search:u="",hash:d="",state:h=null,key:f="default"}=n,p=A.useMemo(()=>{let g=hs(c,a);return g==null?null:{location:{pathname:g,search:u,hash:d,state:h,key:f},navigationType:r}},[a,c,u,d,h,f,r]);return ar(p!=null,`<Router basename="${a}"> is not able to match the URL "${c}${u}${d}" because it does not start with the basename, so the <Router> won't render anything.`),p==null?null:A.createElement(zn.Provider,{value:l},A.createElement(vc.Provider,{children:e,value:p}))}function aN({children:t,location:e}){return qR(wm(t),e)}function wm(t,e=[]){let n=[];return A.Children.forEach(t,(r,s)=>{if(!A.isValidElement(r))return;let i=[...e,s];if(r.type===A.Fragment){n.push.apply(n,wm(r.props.children,i));return}Xe(r.type===vm,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Xe(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=wm(r.props.children,i)),n.push(o)}),n}var Su="get",Eu="application/x-www-form-urlencoded";function Ah(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function lN(t){return Ah(t)&&t.tagName.toLowerCase()==="button"}function cN(t){return Ah(t)&&t.tagName.toLowerCase()==="form"}function uN(t){return Ah(t)&&t.tagName.toLowerCase()==="input"}function dN(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function hN(t,e){return t.button===0&&(!e||e==="_self")&&!dN(t)}var Kc=null;function fN(){if(Kc===null)try{new FormData(document.createElement("form"),0),Kc=!1}catch{Kc=!0}return Kc}var pN=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Tf(t){return t!=null&&!pN.has(t)?(ar(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Eu}"`),null):t}function mN(t,e){let n,r,s,i,o;if(cN(t)){let a=t.getAttribute("action");r=a?hs(a,e):null,n=t.getAttribute("method")||Su,s=Tf(t.getAttribute("enctype"))||Eu,i=new FormData(t)}else if(lN(t)||uN(t)&&(t.type==="submit"||t.type==="image")){let a=t.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=t.getAttribute("formaction")||a.getAttribute("action");if(r=l?hs(l,e):null,n=t.getAttribute("formmethod")||a.getAttribute("method")||Su,s=Tf(t.getAttribute("formenctype"))||Tf(a.getAttribute("enctype"))||Eu,i=new FormData(a,t),!fN()){let{name:c,type:u,value:d}=t;if(u==="image"){let h=c?`${c}.`:"";i.append(`${h}x`,"0"),i.append(`${h}y`,"0")}else c&&i.append(c,d)}}else{if(Ah(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Su,r=null,s=Eu,o=t}return i&&s==="text/plain"&&(o=i,i=void 0),{action:r,method:n.toLowerCase(),encType:s,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function R0(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function gN(t,e,n){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname=`_root.${n}`:e&&hs(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function yN(t,e){if(t.id in e)return e[t.id];try{let n=await uR(()=>import(t.module),[]);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function vN(t){return t!=null&&typeof t.page=="string"}function wN(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function xN(t,e,n){let r=await Promise.all(t.map(async s=>{let i=e.routes[s.route.id];if(i){let o=await yN(i,n);return o.links?o.links():[]}return[]}));return EN(r.flat(1).filter(wN).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function g1(t,e,n,r,s,i){let o=(l,c)=>n[c]?l.route.id!==n[c].route.id:!0,a=(l,c)=>{var u;return n[c].pathname!==l.pathname||((u=n[c].route.path)==null?void 0:u.endsWith("*"))&&n[c].params["*"]!==l.params["*"]};return i==="assets"?e.filter((l,c)=>o(l,c)||a(l,c)):i==="data"?e.filter((l,c)=>{var d;let u=r.routes[l.route.id];if(!u||!u.hasLoader)return!1;if(o(l,c)||a(l,c))return!0;if(l.route.shouldRevalidate){let h=l.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((d=n[0])==null?void 0:d.params)||{},nextUrl:new URL(t,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof h=="boolean")return h}return!0}):[]}function bN(t,e,{includeHydrateFallback:n}={}){return kN(t.map(r=>{let s=e.routes[r.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),n&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function kN(t){return[...new Set(t)]}function SN(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function EN(t,e){let n=new Set,r=new Set(e);return t.reduce((s,i)=>{if(e&&!vN(i)&&i.as==="script"&&i.href&&r.has(i.href))return s;let a=JSON.stringify(SN(i));return n.has(a)||(n.add(a),s.push({key:a,link:i})),s},[])}function hE(){let t=A.useContext(xa);return R0(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function CN(){let t=A.useContext(_h);return R0(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var N0=A.createContext(void 0);N0.displayName="FrameworkContext";function fE(){let t=A.useContext(N0);return R0(t,"You must render this element inside a <HydratedRouter> element"),t}function TN(t,e){let n=A.useContext(N0),[r,s]=A.useState(!1),[i,o]=A.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:c,onMouseLeave:u,onTouchStart:d}=e,h=A.useRef(null);A.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let g=m=>{m.forEach(v=>{o(v.isIntersecting)})},y=new IntersectionObserver(g,{threshold:.5});return h.current&&y.observe(h.current),()=>{y.disconnect()}}},[t]),A.useEffect(()=>{if(r){let g=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(g)}}},[r]);let f=()=>{s(!0)},p=()=>{s(!1),o(!1)};return n?t!=="intent"?[i,h,{}]:[i,h,{onFocus:Da(a,f),onBlur:Da(l,p),onMouseEnter:Da(c,f),onMouseLeave:Da(u,p),onTouchStart:Da(d,f)}]:[!1,h,{}]}function Da(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function _N({page:t,...e}){let{router:n}=hE(),r=A.useMemo(()=>QS(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?A.createElement(ON,{page:t,matches:r,...e}):null}function AN(t){let{manifest:e,routeModules:n}=fE(),[r,s]=A.useState([]);return A.useEffect(()=>{let i=!1;return xN(t,e,n).then(o=>{i||s(o)}),()=>{i=!0}},[t,e,n]),r}function ON({page:t,matches:e,...n}){let r=li(),{manifest:s,routeModules:i}=fE(),{basename:o}=hE(),{loaderData:a,matches:l}=CN(),c=A.useMemo(()=>g1(t,e,l,s,r,"data"),[t,e,l,s,r]),u=A.useMemo(()=>g1(t,e,l,s,r,"assets"),[t,e,l,s,r]),d=A.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let p=new Set,g=!1;if(e.forEach(m=>{var w;let v=s.routes[m.route.id];!v||!v.hasLoader||(!c.some(S=>S.route.id===m.route.id)&&m.route.id in a&&((w=i[m.route.id])!=null&&w.shouldRevalidate)||v.hasClientLoader?g=!0:p.add(m.route.id))}),p.size===0)return[];let y=gN(t,o,"data");return g&&p.size>0&&y.searchParams.set("_routes",e.filter(m=>p.has(m.route.id)).map(m=>m.route.id).join(",")),[y.pathname+y.search]},[o,a,r,s,c,e,t,i]),h=A.useMemo(()=>bN(u,s),[u,s]),f=AN(u);return A.createElement(A.Fragment,null,d.map(p=>A.createElement("link",{key:p,rel:"prefetch",as:"fetch",href:p,...n})),h.map(p=>A.createElement("link",{key:p,rel:"modulepreload",href:p,...n})),f.map(({key:p,link:g})=>A.createElement("link",{key:p,nonce:n.nonce,...g})))}function RN(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var NN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{NN&&(window.__reactRouterVersion="7.11.0")}catch{}function IN({basename:t,children:e,unstable_useTransitions:n,window:r}){let s=A.useRef();s.current==null&&(s.current=dR({window:r,v5Compat:!0}));let i=s.current,[o,a]=A.useState({action:i.action,location:i.location}),l=A.useCallback(c=>{n===!1?a(c):A.startTransition(()=>a(c))},[n]);return A.useLayoutEffect(()=>i.listen(l),[i,l]),A.createElement(oN,{basename:t,children:e,location:o.location,navigationType:o.action,navigator:i,unstable_useTransitions:n})}var pE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,mE=A.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:s,reloadDocument:i,replace:o,state:a,target:l,to:c,preventScrollReset:u,viewTransition:d,unstable_defaultShouldRevalidate:h,...f},p){let{basename:g,unstable_useTransitions:y}=A.useContext(zn),m=typeof c=="string"&&pE.test(c),v=nE(c,g);c=v.to;let w=WR(c,{relative:s}),[S,T,E]=TN(r,f),O=jN(c,{replace:o,state:a,target:l,preventScrollReset:u,relative:s,viewTransition:d,unstable_defaultShouldRevalidate:h,unstable_useTransitions:y});function b(N){e&&e(N),N.defaultPrevented||O(N)}let k=A.createElement("a",{...f,...E,href:v.absoluteURL||w,onClick:v.isExternal||i?e:b,ref:RN(p,T),target:l,"data-discover":!m&&n==="render"?"true":void 0});return S&&!m?A.createElement(A.Fragment,null,k,A.createElement(_N,{page:w})):k});mE.displayName="Link";var PN=A.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:s=!1,style:i,to:o,viewTransition:a,children:l,...c},u){let d=wc(o,{relative:c.relative}),h=li(),f=A.useContext(_h),{navigator:p,basename:g}=A.useContext(zn),y=f!=null&&UN(d)&&a===!0,m=p.encodeLocation?p.encodeLocation(d).pathname:d.pathname,v=h.pathname,w=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;n||(v=v.toLowerCase(),w=w?w.toLowerCase():null,m=m.toLowerCase()),w&&g&&(w=hs(w,g)||w);const S=m!=="/"&&m.endsWith("/")?m.length-1:m.length;let T=v===m||!s&&v.startsWith(m)&&v.charAt(S)==="/",E=w!=null&&(w===m||!s&&w.startsWith(m)&&w.charAt(m.length)==="/"),O={isActive:T,isPending:E,isTransitioning:y},b=T?e:void 0,k;typeof r=="function"?k=r(O):k=[r,T?"active":null,E?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let N=typeof i=="function"?i(O):i;return A.createElement(mE,{...c,"aria-current":b,className:k,ref:u,style:N,to:o,viewTransition:a},typeof l=="function"?l(O):l)});PN.displayName="NavLink";var MN=A.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:s,state:i,method:o=Su,action:a,onSubmit:l,relative:c,preventScrollReset:u,viewTransition:d,unstable_defaultShouldRevalidate:h,...f},p)=>{let{unstable_useTransitions:g}=A.useContext(zn),y=FN(),m=BN(a,{relative:c}),v=o.toLowerCase()==="get"?"get":"post",w=typeof a=="string"&&pE.test(a),S=T=>{if(l&&l(T),T.defaultPrevented)return;T.preventDefault();let E=T.nativeEvent.submitter,O=(E==null?void 0:E.getAttribute("formmethod"))||o,b=()=>y(E||T.currentTarget,{fetcherKey:e,method:O,navigate:n,replace:s,state:i,relative:c,preventScrollReset:u,viewTransition:d,unstable_defaultShouldRevalidate:h});g&&n!==!1?A.startTransition(()=>b()):b()};return A.createElement("form",{ref:p,method:v,action:m,onSubmit:r?l:S,...f,"data-discover":!w&&t==="render"?"true":void 0})});MN.displayName="Form";function DN(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function gE(t){let e=A.useContext(xa);return Xe(e,DN(t)),e}function jN(t,{target:e,replace:n,state:r,preventScrollReset:s,relative:i,viewTransition:o,unstable_defaultShouldRevalidate:a,unstable_useTransitions:l}={}){let c=lE(),u=li(),d=wc(t,{relative:i});return A.useCallback(h=>{if(hN(h,e)){h.preventDefault();let f=n!==void 0?n:Fl(u)===Fl(d),p=()=>c(t,{replace:f,state:r,preventScrollReset:s,relative:i,viewTransition:o,unstable_defaultShouldRevalidate:a});l?A.startTransition(()=>p()):p()}},[u,c,d,n,r,e,t,s,i,o,a,l])}var LN=0,$N=()=>`__${String(++LN)}__`;function FN(){let{router:t}=gE("useSubmit"),{basename:e}=A.useContext(zn),n=nN(),r=t.fetch,s=t.navigate;return A.useCallback(async(i,o={})=>{let{action:a,method:l,encType:c,formData:u,body:d}=mN(i,e);if(o.navigate===!1){let h=o.fetcherKey||$N();await r(h,n,o.action||a,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:u,body:d,formMethod:o.method||l,formEncType:o.encType||c,flushSync:o.flushSync})}else await s(o.action||a,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:u,body:d,formMethod:o.method||l,formEncType:o.encType||c,replace:o.replace,state:o.state,fromRouteId:n,flushSync:o.flushSync,viewTransition:o.viewTransition})},[r,s,e,n])}function BN(t,{relative:e}={}){let{basename:n}=A.useContext(zn),r=A.useContext(Br);Xe(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),i={...wc(t||".",{relative:e})},o=li();if(t==null){i.search=o.search;let a=new URLSearchParams(i.search),l=a.getAll("index");if(l.some(u=>u==="")){a.delete("index"),l.filter(d=>d).forEach(d=>a.append("index",d));let u=a.toString();i.search=u?`?${u}`:""}}return(!t||t===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(i.pathname=i.pathname==="/"?n:ss([n,i.pathname])),Fl(i)}function UN(t,{relative:e}={}){let n=A.useContext(sE);Xe(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=gE("useViewTransitionState"),s=wc(t,{relative:e});if(!n.isTransitioning)return!1;let i=hs(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=hs(n.nextLocation.pathname,r)||n.nextLocation.pathname;return ld(s.pathname,o)!=null||ld(s.pathname,i)!=null}function Oh(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function zN(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})}const VN=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class I0 extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class HN extends I0{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class y1 extends I0{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class v1 extends I0{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var xm;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(xm||(xm={}));class WN{constructor(e,{headers:n={},customFetch:r,region:s=xm.Any}={}){this.url=e,this.headers=n,this.region=s,this.fetch=VN(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return zN(this,arguments,void 0,function*(n,r={}){var s;let i,o;try{const{headers:a,method:l,body:c,signal:u,timeout:d}=r;let h={},{region:f}=r;f||(f=this.region);const p=new URL(`${this.url}/${n}`);f&&f!=="any"&&(h["x-region"]=f,p.searchParams.set("forceFunctionRegion",f));let g;c&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",g=c):typeof c=="string"?(h["Content-Type"]="text/plain",g=c):typeof FormData<"u"&&c instanceof FormData?g=c:(h["Content-Type"]="application/json",g=JSON.stringify(c)):g=c;let y=u;d&&(o=new AbortController,i=setTimeout(()=>o.abort(),d),u?(y=o.signal,u.addEventListener("abort",()=>o.abort())):y=o.signal);const m=yield this.fetch(p.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),a),body:g,signal:y}).catch(T=>{throw new HN(T)}),v=m.headers.get("x-relay-error");if(v&&v==="true")throw new y1(m);if(!m.ok)throw new v1(m);let w=((s=m.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),S;return w==="application/json"?S=yield m.json():w==="application/octet-stream"||w==="application/pdf"?S=yield m.blob():w==="text/event-stream"?S=m:w==="multipart/form-data"?S=yield m.formData():S=yield m.text(),{data:S,error:null,response:m}}catch(a){return{data:null,error:a,response:a instanceof v1||a instanceof y1?a.context:void 0}}finally{i&&clearTimeout(i)}})}}var KN=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},qN=class{constructor(t){var e,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var n=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const r=this.fetch;let s=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let o=null,a=null,l=null,c=i.status,u=i.statusText;if(i.ok){var d,h;if(n.method!=="HEAD"){var f;const m=await i.text();m===""||(n.headers.get("Accept")==="text/csv"||n.headers.get("Accept")&&(!((f=n.headers.get("Accept"))===null||f===void 0)&&f.includes("application/vnd.pgrst.plan+text"))?a=m:a=JSON.parse(m))}const g=(d=n.headers.get("Prefer"))===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),y=(h=i.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");g&&y&&y.length>1&&(l=parseInt(y[1])),n.isMaybeSingle&&n.method==="GET"&&Array.isArray(a)&&(a.length>1?(o={code:"PGRST116",details:`Results contain ${a.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},a=null,l=null,c=406,u="Not Acceptable"):a.length===1?a=a[0]:a=null)}else{var p;const g=await i.text();try{o=JSON.parse(g),Array.isArray(o)&&i.status===404&&(a=[],o=null,c=200,u="OK")}catch{i.status===404&&g===""?(c=204,u="No Content"):o={message:g}}if(o&&n.isMaybeSingle&&(!(o==null||(p=o.details)===null||p===void 0)&&p.includes("0 rows"))&&(o=null,c=200,u="OK"),o&&n.shouldThrowOnError)throw new KN(o)}return{error:o,data:a,count:l,status:c,statusText:u}});return this.shouldThrowOnError||(s=s.catch(i=>{var o;let a="";const l=i==null?void 0:i.cause;if(l){var c,u,d,h;const p=(c=l==null?void 0:l.message)!==null&&c!==void 0?c:"",g=(u=l==null?void 0:l.code)!==null&&u!==void 0?u:"";a=`${(d=i==null?void 0:i.name)!==null&&d!==void 0?d:"FetchError"}: ${i==null?void 0:i.message}`,a+=`

Caused by: ${(h=l==null?void 0:l.name)!==null&&h!==void 0?h:"Error"}: ${p}`,g&&(a+=` (${g})`),l!=null&&l.stack&&(a+=`
${l.stack}`)}else{var f;a=(f=i==null?void 0:i.stack)!==null&&f!==void 0?f:""}return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:a,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),s.then(t,e)}returns(){return this}overrideTypes(){return this}},GN=class extends qN{select(t){let e=!1;const n=(t??"*").split("").map(r=>/\s/.test(r)&&!e?"":(r==='"'&&(e=!e),r)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:n,foreignTable:r,referencedTable:s=r}={}){const i=s?`${s}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${t}.${e?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:n=e}={}){const r=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(r,`${t}`),this}range(t,e,{foreignTable:n,referencedTable:r=n}={}){const s=typeof r>"u"?"offset":`${r}.offset`,i=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(i,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:n=!1,buffers:r=!1,wal:s=!1,format:i="text"}={}){var o;const a=[t?"analyze":null,e?"verbose":null,n?"settings":null,r?"buffers":null,s?"wal":null].filter(Boolean).join("|"),l=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${l}"; options=${a};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const w1=new RegExp("[,()]");var yo=class extends GN{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const n=Array.from(new Set(e)).map(r=>typeof r=="string"&&w1.test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}notIn(t,e){const n=Array.from(new Set(e)).map(r=>typeof r=="string"&&w1.test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(t,`not.in.(${n})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:n,type:r}={}){let s="";r==="plain"?s="pl":r==="phrase"?s="ph":r==="websearch"&&(s="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${s}fts${i}.${e}`),this}match(t){return Object.entries(t).forEach(([e,n])=>{this.url.searchParams.append(e,`eq.${n}`)}),this}not(t,e,n){return this.url.searchParams.append(t,`not.${e}.${n}`),this}or(t,{foreignTable:e,referencedTable:n=e}={}){const r=n?`${n}.or`:"or";return this.url.searchParams.append(r,`(${t})`),this}filter(t,e,n){return this.url.searchParams.append(t,`${e}.${n}`),this}},JN=class{constructor(t,{headers:e={},schema:n,fetch:r}){this.url=t,this.headers=new Headers(e),this.schema=n,this.fetch=r}select(t,e){const{head:n=!1,count:r}=e??{},s=n?"HEAD":"GET";let i=!1;const o=(t??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),r&&this.headers.append("Prefer",`count=${r}`),new yo({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:e,defaultToNull:n=!0}={}){var r;const s="POST";if(e&&this.headers.append("Prefer",`count=${e}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const i=t.reduce((o,a)=>o.concat(Object.keys(a)),[]);if(i.length>0){const o=[...new Set(i)].map(a=>`"${a}"`);this.url.searchParams.set("columns",o.join(","))}}return new yo({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}upsert(t,{onConflict:e,ignoreDuplicates:n=!1,count:r,defaultToNull:s=!0}={}){var i;const o="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),e!==void 0&&this.url.searchParams.set("on_conflict",e),r&&this.headers.append("Prefer",`count=${r}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const a=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(a.length>0){const l=[...new Set(a)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new yo({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(t,{count:e}={}){var n;const r="PATCH";return e&&this.headers.append("Prefer",`count=${e}`),new yo({method:r,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var e;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new yo({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},YN=class yE{constructor(e,{headers:n={},schema:r,fetch:s}={}){this.url=e,this.headers=new Headers(n),this.schemaName=r,this.fetch=s}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new JN(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new yE(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:r=!1,get:s=!1,count:i}={}){var o;let a;const l=new URL(`${this.url}/rpc/${e}`);let c;r||s?(a=r?"HEAD":"GET",Object.entries(n).filter(([d,h])=>h!==void 0).map(([d,h])=>[d,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([d,h])=>{l.searchParams.append(d,h)})):(a="POST",c=n);const u=new Headers(this.headers);return i&&u.set("Prefer",`count=${i}`),new yo({method:a,url:l,headers:u,schema:this.schemaName,body:c,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};class QN{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const r=n.node,s=parseInt(r.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const r=this.getWebSocketConstructor();return new r(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const XN="2.89.0",ZN=`realtime-js/${XN}`,vE="1.0.0",eI="2.0.0",x1=vE,bm=1e4,tI=1e3,nI=100;var Cs;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Cs||(Cs={}));var wt;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(wt||(wt={}));var wr;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(wr||(wr={}));var km;(function(t){t.websocket="websocket"})(km||(km={}));var xi;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(xi||(xi={}));class rI{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,n){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return n(this._binaryEncodeUserBroadcastPush(e));let r=[e.join_ref,e.ref,e.topic,e.event,e.payload];return n(JSON.stringify(r))}_binaryEncodeUserBroadcastPush(e){var n;return this._isArrayBuffer((n=e.payload)===null||n===void 0?void 0:n.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var n,r;const s=(r=(n=e.payload)===null||n===void 0?void 0:n.payload)!==null&&r!==void 0?r:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(e){var n,r;const s=(r=(n=e.payload)===null||n===void 0?void 0:n.payload)!==null&&r!==void 0?r:{},o=new TextEncoder().encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(e,n,r){var s,i;const o=e.topic,a=(s=e.ref)!==null&&s!==void 0?s:"",l=(i=e.join_ref)!==null&&i!==void 0?i:"",c=e.payload.event,u=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},d=Object.keys(u).length===0?"":JSON.stringify(u);if(l.length>255)throw new Error(`joinRef length ${l.length} exceeds maximum of 255`);if(a.length>255)throw new Error(`ref length ${a.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`userEvent length ${c.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`metadata length ${d.length} exceeds maximum of 255`);const h=this.USER_BROADCAST_PUSH_META_LENGTH+l.length+a.length+o.length+c.length+d.length,f=new ArrayBuffer(this.HEADER_LENGTH+h);let p=new DataView(f),g=0;p.setUint8(g++,this.KINDS.userBroadcastPush),p.setUint8(g++,l.length),p.setUint8(g++,a.length),p.setUint8(g++,o.length),p.setUint8(g++,c.length),p.setUint8(g++,d.length),p.setUint8(g++,n),Array.from(l,m=>p.setUint8(g++,m.charCodeAt(0))),Array.from(a,m=>p.setUint8(g++,m.charCodeAt(0))),Array.from(o,m=>p.setUint8(g++,m.charCodeAt(0))),Array.from(c,m=>p.setUint8(g++,m.charCodeAt(0))),Array.from(d,m=>p.setUint8(g++,m.charCodeAt(0)));var y=new Uint8Array(f.byteLength+r.byteLength);return y.set(new Uint8Array(f),0),y.set(new Uint8Array(r),f.byteLength),y.buffer}decode(e,n){if(this._isArrayBuffer(e)){let r=this._binaryDecode(e);return n(r)}if(typeof e=="string"){const r=JSON.parse(e),[s,i,o,a,l]=r;return n({join_ref:s,ref:i,topic:o,event:a,payload:l})}return n({})}_binaryDecode(e){const n=new DataView(e),r=n.getUint8(0),s=new TextDecoder;switch(r){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,n,s)}}_decodeUserBroadcast(e,n,r){const s=n.getUint8(1),i=n.getUint8(2),o=n.getUint8(3),a=n.getUint8(4);let l=this.HEADER_LENGTH+4;const c=r.decode(e.slice(l,l+s));l=l+s;const u=r.decode(e.slice(l,l+i));l=l+i;const d=r.decode(e.slice(l,l+o));l=l+o;const h=e.slice(l,e.byteLength),f=a===this.JSON_ENCODING?JSON.parse(r.decode(h)):h,p={type:this.BROADCAST_EVENT,event:u,payload:f};return o>0&&(p.meta=JSON.parse(d)),{join_ref:null,ref:null,topic:c,event:this.BROADCAST_EVENT,payload:p}}_isArrayBuffer(e){var n;return e instanceof ArrayBuffer||((n=e==null?void 0:e.constructor)===null||n===void 0?void 0:n.name)==="ArrayBuffer"}_pick(e,n){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([r])=>n.includes(r)))}}class wE{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ve;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Ve||(Ve={}));const b1=(t,e,n={})=>{var r;const s=(r=n.skipTypes)!==null&&r!==void 0?r:[];return e?Object.keys(e).reduce((i,o)=>(i[o]=sI(o,t,e,s),i),{}):{}},sI=(t,e,n,r)=>{const s=e.find(a=>a.name===t),i=s==null?void 0:s.type,o=n[t];return i&&!r.includes(i)?xE(i,o):Sm(o)},xE=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return lI(e,n)}switch(t){case Ve.bool:return iI(e);case Ve.float4:case Ve.float8:case Ve.int2:case Ve.int4:case Ve.int8:case Ve.numeric:case Ve.oid:return oI(e);case Ve.json:case Ve.jsonb:return aI(e);case Ve.timestamp:return cI(e);case Ve.abstime:case Ve.date:case Ve.daterange:case Ve.int4range:case Ve.int8range:case Ve.money:case Ve.reltime:case Ve.text:case Ve.time:case Ve.timestamptz:case Ve.timetz:case Ve.tsrange:case Ve.tstzrange:return Sm(e);default:return Sm(e)}},Sm=t=>t,iI=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},oI=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},aI=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},lI=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let i;const o=t.slice(1,n);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>xE(e,a))}return t},cI=t=>typeof t=="string"?t.replace(" ","T"):t,bE=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class _f{constructor(e,n,r={},s=bm){this.channel=e,this.event=n,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var k1;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(k1||(k1={}));class il{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=il.syncState(this.state,s,i,o),this.pendingDiffs.forEach(l=>{this.state=il.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(r.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=il.syncDiff(this.state,s,i,o),a())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,s){const i=this.cloneDeep(e),o=this.transformState(n),a={},l={};return this.map(i,(c,u)=>{o[c]||(l[c]=u)}),this.map(o,(c,u)=>{const d=i[c];if(d){const h=u.map(y=>y.presence_ref),f=d.map(y=>y.presence_ref),p=u.filter(y=>f.indexOf(y.presence_ref)<0),g=d.filter(y=>h.indexOf(y.presence_ref)<0);p.length>0&&(a[c]=p),g.length>0&&(l[c]=g)}else a[c]=u}),this.syncDiff(i,{joins:a,leaves:l},r,s)}static syncDiff(e,n,r,s){const{joins:i,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(i,(a,l)=>{var c;const u=(c=e[a])!==null&&c!==void 0?c:[];if(e[a]=this.cloneDeep(l),u.length>0){const d=e[a].map(f=>f.presence_ref),h=u.filter(f=>d.indexOf(f.presence_ref)<0);e[a].unshift(...h)}r(a,u,l)}),this.map(o,(a,l)=>{let c=e[a];if(!c)return;const u=l.map(d=>d.presence_ref);c=c.filter(d=>u.indexOf(d.presence_ref)<0),e[a]=c,s(a,c,l),c.length===0&&delete e[a]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const s=e[r];return"metas"in s?n[r]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):n[r]=s,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var S1;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(S1||(S1={}));var ol;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(ol||(ol={}));var Yr;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Yr||(Yr={}));class Do{constructor(e,n={config:{}},r){var s,i;if(this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=wt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new _f(this,wr.join,this.params,this.timeout),this.rejoinTimer=new wE(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=wt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=wt.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=wt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=wt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=wt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(wr.reply,{},(o,a)=>{this._trigger(this._replyEventName(a),o)}),this.presence=new il(this),this.broadcastEndpointURL=bE(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,n=this.timeout){var r,s,i;if(this.socket.isConnected()||this.socket.connect(),this.state==wt.closed){const{config:{broadcast:o,presence:a,private:l}}=this.params,c=(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(f=>f.filter))!==null&&s!==void 0?s:[],u=!!this.bindings[ol.PRESENCE]&&this.bindings[ol.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,d={},h={broadcast:o,presence:Object.assign(Object.assign({},a),{enabled:u}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(f=>e==null?void 0:e(Yr.CHANNEL_ERROR,f)),this._onClose(()=>e==null?void 0:e(Yr.CLOSED)),this.updateJoinPayload(Object.assign({config:h},d)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:f})=>{var p;if(this.socket._isManualToken()||this.socket.setAuth(),f===void 0){e==null||e(Yr.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,y=(p=g==null?void 0:g.length)!==null&&p!==void 0?p:0,m=[];for(let v=0;v<y;v++){const w=g[v],{filter:{event:S,schema:T,table:E,filter:O}}=w,b=f&&f[v];if(b&&b.event===S&&Do.isFilterValueEqual(b.schema,T)&&Do.isFilterValueEqual(b.table,E)&&Do.isFilterValueEqual(b.filter,O))m.push(Object.assign(Object.assign({},w),{id:b.id}));else{this.unsubscribe(),this.state=wt.errored,e==null||e(Yr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=m,e&&e(Yr.SUBSCRIBED);return}}).receive("error",f=>{this.state=wt.errored,e==null||e(Yr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Yr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this.state===wt.joined&&e===ol.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,n,r)}async httpSend(e,n,r={}){var s;if(n==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:n,private:this.private}]})},a=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);if(a.status===202)return{success:!0};let l=a.statusText;try{const c=await a.json();l=c.error||c.message||l}catch{}return Promise.reject(new Error(l))}async send(e,n={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=e,a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=c.body)===null||s===void 0?void 0:s.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,l;const c=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=wt.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(wr.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new _f(this,wr.leave,{},e),r.receive("ok",()=>{n(),s("ok")}).receive("timeout",()=>{n(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=wt.closed,this.bindings={}}async _fetchWithTimeout(e,n,r){const s=new AbortController,i=setTimeout(()=>s.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:s.signal}));return clearTimeout(i),o}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new _f(this,e,n,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>nI){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var s,i;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=wr;if(r&&[a,l,c,u].indexOf(o)>=0&&r!==this._joinRef())return;let h=this._onMessage(o,n,r);if(n&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(f=>{var p,g,y;return((p=f.filter)===null||p===void 0?void 0:p.event)==="*"||((y=(g=f.filter)===null||g===void 0?void 0:g.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===o}).map(f=>f.callback(h,r)):(i=this.bindings[o])===null||i===void 0||i.filter(f=>{var p,g,y,m,v,w;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const S=f.id,T=(p=f.filter)===null||p===void 0?void 0:p.event;return S&&((g=n.ids)===null||g===void 0?void 0:g.includes(S))&&(T==="*"||(T==null?void 0:T.toLocaleLowerCase())===((y=n.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const S=(v=(m=f==null?void 0:f.filter)===null||m===void 0?void 0:m.event)===null||v===void 0?void 0:v.toLocaleLowerCase();return S==="*"||S===((w=n==null?void 0:n.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof h=="object"&&"ids"in h){const p=h.data,{schema:g,table:y,commit_timestamp:m,type:v,errors:w}=p;h=Object.assign(Object.assign({},{schema:g,table:y,commit_timestamp:m,eventType:v,new:{},old:{},errors:w}),this._getPayloadRecords(p))}f.callback(h,r)})}_isClosed(){return this.state===wt.closed}_isJoined(){return this.state===wt.joined}_isJoining(){return this.state===wt.joining}_isLeaving(){return this.state===wt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const s=e.toLocaleLowerCase(),i={type:s,filter:n,callback:r};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&Do.isEqual(s.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}static isFilterValueEqual(e,n){return(e??void 0)===(n??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(wr.close,{},e)}_onError(e){this._on(wr.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=wt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=b1(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=b1(e.columns,e.old_record)),n}}const Af=()=>{},qc={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},uI=[1e3,2e3,5e3,1e4],dI=1e4,hI=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class fI{constructor(e,n){var r;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=bm,this.transport=null,this.heartbeatIntervalMs=qc.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Af,this.ref=0,this.reconnectTimer=null,this.vsn=x1,this.logger=Af,this.conn=null,this.sendBuffer=[],this.serializer=new rI,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>s?(...i)=>s(...i):(...i)=>fetch(...i),!(!((r=n==null?void 0:n.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${km.websocket}`,this.httpEndpoint=bE(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=QN.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,n??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Cs.connecting:return xi.Connecting;case Cs.open:return xi.Open;case Cs.closing:return xi.Closing;default:return xi.Closed}}isConnected(){return this.connectionState()===xi.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const r=`realtime:${e}`,s=this.getChannels().find(i=>i.topic===r);if(s)return s;{const i=new Do(`realtime:${e}`,n,this);return this.channels.push(i),i}}push(e){const{topic:n,event:r,payload:s,ref:i}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${n} ${r} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(tI,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},qc.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:s,payload:i,ref:o}=n,a=o?`(${o})`:"",l=i.status||"";this.log("receive",`${l} ${r} ${s} ${a}`.trim(),i),this.channels.filter(c=>c._isMember(r)).forEach(c=>c._trigger(s,i,o)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===Cs.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Cs.open||this.conn.readyState===Cs.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(n=>{this.log("error","error waiting for auth on connect",n),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this._terminateWorker()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(wr.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(n);return`${e}${r}${s}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([hI],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n,r=!1;if(e)n=e,r=!0;else if(this.accessToken)try{n=await this.accessToken()}catch(s){this.log("error","Error fetching access token from callback",s),n=this.accessTokenValue}else n=this.accessTokenValue;r?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(s=>{const i={access_token:n,version:ZN};n&&s.updateJoinPayload(i),s.joinedOnce&&s._isJoined()&&s._push(wr.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(n=>{this.log("error",`Error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(n)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new wE(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},qc.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,r,s,i,o,a,l,c,u,d,h,f;switch(this.transport=(n=e==null?void 0:e.transport)!==null&&n!==void 0?n:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:bm,this.heartbeatIntervalMs=(s=e==null?void 0:e.heartbeatIntervalMs)!==null&&s!==void 0?s:qc.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(a=e==null?void 0:e.heartbeatCallback)!==null&&a!==void 0?a:Af,this.vsn=(l=e==null?void 0:e.vsn)!==null&&l!==void 0?l:x1,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=e==null?void 0:e.reconnectAfterMs)!==null&&c!==void 0?c:p=>uI[p-1]||dI,this.vsn){case vE:this.encode=(u=e==null?void 0:e.encode)!==null&&u!==void 0?u:(p,g)=>g(JSON.stringify(p)),this.decode=(d=e==null?void 0:e.decode)!==null&&d!==void 0?d:(p,g)=>g(JSON.parse(p));break;case eI:this.encode=(h=e==null?void 0:e.encode)!==null&&h!==void 0?h:this.serializer.encode.bind(this.serializer),this.decode=(f=e==null?void 0:e.decode)!==null&&f!==void 0?f:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var Bl=class extends Error{constructor(t,e){var n;super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((n=e.icebergType)==null?void 0:n.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function pI(t,e,n){const r=new URL(e,t);if(n)for(const[s,i]of Object.entries(n))i!==void 0&&r.searchParams.set(s,i);return r.toString()}async function mI(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function gI(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:n,path:r,query:s,body:i,headers:o}){const a=pI(t.baseUrl,r,s),l=await mI(t.auth),c=await e(a,{method:n,headers:{...i?{"Content-Type":"application/json"}:{},...l,...o},body:i?JSON.stringify(i):void 0}),u=await c.text(),d=(c.headers.get("content-type")||"").includes("application/json"),h=d&&u?JSON.parse(u):u;if(!c.ok){const f=d?h:void 0,p=f==null?void 0:f.error;throw new Bl((p==null?void 0:p.message)??`Request failed with status ${c.status}`,{status:c.status,icebergType:p==null?void 0:p.type,icebergCode:p==null?void 0:p.code,details:f})}return{status:c.status,headers:c.headers,data:h}}}}function Gc(t){return t.join("")}var yI=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:Gc(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(r=>({namespace:r}))}async createNamespace(t,e){const n={namespace:t.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:n})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Gc(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Gc(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Gc(t.namespace)}`}),!0}catch(e){if(e instanceof Bl&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(n){if(n instanceof Bl&&n.status===409)return;throw n}}};function ao(t){return t.join("")}var vI=class{constructor(t,e="",n){this.client=t,this.prefix=e,this.accessDelegation=n}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ao(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const n={};return this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ao(t.namespace)}/tables`,body:e,headers:n})).data.metadata}async updateTable(t,e){const n=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ao(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":n.data["metadata-location"],metadata:n.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${ao(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ao(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${ao(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(n){if(n instanceof Bl&&n.status===404)return!1;throw n}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(n){if(n instanceof Bl&&n.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw n}}},wI=class{constructor(t){var r;let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const n=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=gI({baseUrl:n,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=(r=t.accessDelegation)==null?void 0:r.join(","),this.namespaceOps=new yI(this.client,e),this.tableOps=new vI(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},Rh=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function et(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var xI=class extends Rh{constructor(t,e,n){super(t),this.name="StorageApiError",this.status=e,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Em=class extends Rh{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}};const P0=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),bI=()=>Response,Cm=t=>{if(Array.isArray(t))return t.map(n=>Cm(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const s=n.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=Cm(r)}),e},kI=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},SI=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function Ul(t){"@babel/helpers - typeof";return Ul=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ul(t)}function EI(t,e){if(Ul(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Ul(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function CI(t){var e=EI(t,"string");return Ul(e)=="symbol"?e:e+""}function TI(t,e,n){return(e=CI(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E1(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Ee(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?E1(Object(n),!0).forEach(function(r){TI(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):E1(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}const Of=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},_I=async(t,e,n)=>{t instanceof await bI()&&!(n!=null&&n.noResolveJson)?t.json().then(r=>{const s=t.status||500,i=(r==null?void 0:r.statusCode)||s+"";e(new xI(Of(r),s,i))}).catch(r=>{e(new Em(Of(r),r))}):e(new Em(Of(t),t))},AI=(t,e,n,r)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!r?s:(kI(r)?(s.headers=Ee({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(r)):s.body=r,e!=null&&e.duplex&&(s.duplex=e.duplex),Ee(Ee({},s),n))};async function xc(t,e,n,r,s,i){return new Promise((o,a)=>{t(n,AI(e,r,s,i)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>_I(l,a,r))})}async function zl(t,e,n,r){return xc(t,"GET",e,n,r)}async function yr(t,e,n,r,s){return xc(t,"POST",e,r,s,n)}async function Tm(t,e,n,r,s){return xc(t,"PUT",e,r,s,n)}async function OI(t,e,n,r){return xc(t,"HEAD",e,Ee(Ee({},n),{},{noResolveJson:!0}),r)}async function M0(t,e,n,r,s){return xc(t,"DELETE",e,r,s,n)}var RI=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(et(e))return{data:null,error:e};throw e}}};let kE;kE=Symbol.toStringTag;var NI=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[kE]="BlobDownloadBuilder",this.promise=null}asStream(){return new RI(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(et(e))return{data:null,error:e};throw e}}};const II={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},C1={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var PI=class{constructor(t,e={},n,r){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.bucketId=n,this.fetch=P0(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(t,e,n,r){var s=this;try{let i;const o=Ee(Ee({},C1),r);let a=Ee(Ee({},s.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",s.encodeMetadata(l)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),l&&!i.has("metadata")&&i.append("metadata",s.encodeMetadata(l))):(i=n,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=s.toBase64(s.encodeMetadata(l))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),r!=null&&r.headers&&(a=Ee(Ee({},a),r.headers));const c=s._removeEmptyFolders(e),u=s._getFinalPath(c),d=await(t=="PUT"?Tm:yr)(s.fetch,`${s.url}/object/${u}`,i,Ee({headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:c,id:d.Id,fullPath:d.Key},error:null}}catch(i){if(s.shouldThrowOnError)throw i;if(et(i))return{data:null,error:i};throw i}}async upload(t,e,n){return this.uploadOrUpdate("POST",t,e,n)}async uploadToSignedUrl(t,e,n,r){var s=this;const i=s._removeEmptyFolders(t),o=s._getFinalPath(i),a=new URL(s.url+`/object/upload/sign/${o}`);a.searchParams.set("token",e);try{let l;const c=Ee({upsert:C1.upsert},r),u=Ee(Ee({},s.headers),{"x-upsert":String(c.upsert)});return typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType),{data:{path:i,fullPath:(await Tm(s.fetch,a.toString(),l,{headers:u})).Key},error:null}}catch(l){if(s.shouldThrowOnError)throw l;if(et(l))return{data:null,error:l};throw l}}async createSignedUploadUrl(t,e){var n=this;try{let r=n._getFinalPath(t);const s=Ee({},n.headers);e!=null&&e.upsert&&(s["x-upsert"]="true");const i=await yr(n.fetch,`${n.url}/object/upload/sign/${r}`,{},{headers:s}),o=new URL(n.url+i.url),a=o.searchParams.get("token");if(!a)throw new Rh("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:a},error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(et(r))return{data:null,error:r};throw r}}async update(t,e,n){return this.uploadOrUpdate("PUT",t,e,n)}async move(t,e,n){var r=this;try{return{data:await yr(r.fetch,`${r.url}/object/move`,{bucketId:r.bucketId,sourceKey:t,destinationKey:e,destinationBucket:n==null?void 0:n.destinationBucket},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(et(s))return{data:null,error:s};throw s}}async copy(t,e,n){var r=this;try{return{data:{path:(await yr(r.fetch,`${r.url}/object/copy`,{bucketId:r.bucketId,sourceKey:t,destinationKey:e,destinationBucket:n==null?void 0:n.destinationBucket},{headers:r.headers})).Key},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(et(s))return{data:null,error:s};throw s}}async createSignedUrl(t,e,n){var r=this;try{let s=r._getFinalPath(t),i=await yr(r.fetch,`${r.url}/object/sign/${s}`,Ee({expiresIn:e},n!=null&&n.transform?{transform:n.transform}:{}),{headers:r.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${r.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(et(s))return{data:null,error:s};throw s}}async createSignedUrls(t,e,n){var r=this;try{const s=await yr(r.fetch,`${r.url}/object/sign/${r.bucketId}`,{expiresIn:e,paths:t},{headers:r.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(o=>Ee(Ee({},o),{},{signedUrl:o.signedURL?encodeURI(`${r.url}${o.signedURL}${i}`):null})),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(et(s))return{data:null,error:s};throw s}}download(t,e){const n=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",r=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),s=r?`?${r}`:"",i=this._getFinalPath(t),o=()=>zl(this.fetch,`${this.url}/${n}/${i}${s}`,{headers:this.headers,noResolveJson:!0});return new NI(o,this.shouldThrowOnError)}async info(t){var e=this;const n=e._getFinalPath(t);try{return{data:Cm(await zl(e.fetch,`${e.url}/object/info/${n}`,{headers:e.headers})),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(et(r))return{data:null,error:r};throw r}}async exists(t){var e=this;const n=e._getFinalPath(t);try{return await OI(e.fetch,`${e.url}/object/${n}`,{headers:e.headers}),{data:!0,error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(et(r)&&r instanceof Em){const s=r.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:r}}throw r}}getPublicUrl(t,e){const n=this._getFinalPath(t),r=[],s=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";s!==""&&r.push(s);const i=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",o=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});o!==""&&r.push(o);let a=r.join("&");return a!==""&&(a=`?${a}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${n}${a}`)}}}async remove(t){var e=this;try{return{data:await M0(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(et(n))return{data:null,error:n};throw n}}async list(t,e,n){var r=this;try{const s=Ee(Ee(Ee({},II),e),{},{prefix:t||""});return{data:await yr(r.fetch,`${r.url}/object/list/${r.bucketId}`,s,{headers:r.headers},n),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(et(s))return{data:null,error:s};throw s}}async listV2(t,e){var n=this;try{const r=Ee({},t);return{data:await yr(n.fetch,`${n.url}/object/list-v2/${n.bucketId}`,r,{headers:n.headers},e),error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(et(r))return{data:null,error:r};throw r}}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const SE="2.89.0",EE={"X-Client-Info":`storage-js/${SE}`};var MI=class{constructor(t,e={},n,r){this.shouldThrowOnError=!1;const s=new URL(t);r!=null&&r.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=Ee(Ee({},EE),e),this.fetch=P0(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(t){var e=this;try{const n=e.listBucketOptionsToQueryString(t);return{data:await zl(e.fetch,`${e.url}/bucket${n}`,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(et(n))return{data:null,error:n};throw n}}async getBucket(t){var e=this;try{return{data:await zl(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(et(n))return{data:null,error:n};throw n}}async createBucket(t,e={public:!1}){var n=this;try{return{data:await yr(n.fetch,`${n.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:n.headers}),error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(et(r))return{data:null,error:r};throw r}}async updateBucket(t,e){var n=this;try{return{data:await Tm(n.fetch,`${n.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:n.headers}),error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(et(r))return{data:null,error:r};throw r}}async emptyBucket(t){var e=this;try{return{data:await yr(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(et(n))return{data:null,error:n};throw n}}async deleteBucket(t){var e=this;try{return{data:await M0(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(et(n))return{data:null,error:n};throw n}}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},DI=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Ee(Ee({},EE),e),this.fetch=P0(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await yr(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(et(n))return{data:null,error:n};throw n}}async listBuckets(t){var e=this;try{const n=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&n.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&n.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&n.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&n.set("sortOrder",t.sortOrder),t!=null&&t.search&&n.set("search",t.search);const r=n.toString(),s=r?`${e.url}/bucket?${r}`:`${e.url}/bucket`;return{data:await zl(e.fetch,s,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(et(n))return{data:null,error:n};throw n}}async deleteBucket(t){var e=this;try{return{data:await M0(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(et(n))return{data:null,error:n};throw n}}from(t){var e=this;if(!SI(t))throw new Rh("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const n=new wI({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),r=this.shouldThrowOnError;return new Proxy(n,{get(s,i){const o=s[i];return typeof o!="function"?o:async(...a)=>{try{return{data:await o.apply(s,a),error:null}}catch(l){if(r)throw l;return{data:null,error:l}}}}})}};const D0={"X-Client-Info":`storage-js/${SE}`,"Content-Type":"application/json"};var CE=class extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Pn(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}var Rf=class extends CE{constructor(t,e,n){super(t),this.name="StorageVectorsApiError",this.status=e,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},jI=class extends CE{constructor(t,e){super(t),this.name="StorageVectorsUnknownError",this.originalError=e}};const j0=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),LI=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},T1=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),$I=async(t,e,n)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(n!=null&&n.noResolveJson)){const r=t.status||500,s=t;if(typeof s.json=="function")s.json().then(i=>{const o=(i==null?void 0:i.statusCode)||(i==null?void 0:i.code)||r+"";e(new Rf(T1(i),r,o))}).catch(()=>{const i=r+"";e(new Rf(s.statusText||`HTTP ${r} error`,r,i))});else{const i=r+"";e(new Rf(s.statusText||`HTTP ${r} error`,r,i))}}else e(new jI(T1(t),t))},FI=(t,e,n,r)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!r?s:(LI(r)?(s.headers=Ee({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(r)):s.body=r,Ee(Ee({},s),n))};async function BI(t,e,n,r,s,i){return new Promise((o,a)=>{t(n,FI(e,r,s,i)).then(l=>{if(!l.ok)throw l;if(r!=null&&r.noResolveJson)return l;const c=l.headers.get("content-type");return!c||!c.includes("application/json")?{}:l.json()}).then(l=>o(l)).catch(l=>$I(l,a,r))})}async function Mn(t,e,n,r,s){return BI(t,"POST",e,r,s,n)}var UI=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Ee(Ee({},D0),e),this.fetch=j0(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(t){var e=this;try{return{data:await Mn(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Pn(n))return{data:null,error:n};throw n}}async getIndex(t,e){var n=this;try{return{data:await Mn(n.fetch,`${n.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:n.headers}),error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(Pn(r))return{data:null,error:r};throw r}}async listIndexes(t){var e=this;try{return{data:await Mn(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Pn(n))return{data:null,error:n};throw n}}async deleteIndex(t,e){var n=this;try{return{data:await Mn(n.fetch,`${n.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:n.headers})||{},error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(Pn(r))return{data:null,error:r};throw r}}},zI=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Ee(Ee({},D0),e),this.fetch=j0(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(t){var e=this;try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Mn(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Pn(n))return{data:null,error:n};throw n}}async getVectors(t){var e=this;try{return{data:await Mn(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Pn(n))return{data:null,error:n};throw n}}async listVectors(t){var e=this;try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:await Mn(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Pn(n))return{data:null,error:n};throw n}}async queryVectors(t){var e=this;try{return{data:await Mn(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Pn(n))return{data:null,error:n};throw n}}async deleteVectors(t){var e=this;try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Mn(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Pn(n))return{data:null,error:n};throw n}}},VI=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Ee(Ee({},D0),e),this.fetch=j0(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await Mn(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Pn(n))return{data:null,error:n};throw n}}async getBucket(t){var e=this;try{return{data:await Mn(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Pn(n))return{data:null,error:n};throw n}}async listBuckets(t={}){var e=this;try{return{data:await Mn(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Pn(n))return{data:null,error:n};throw n}}async deleteBucket(t){var e=this;try{return{data:await Mn(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Pn(n))return{data:null,error:n};throw n}}},HI=class extends VI{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new WI(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,n=this;return e().call(n,t)}async getBucket(t){var e=()=>super.getBucket,n=this;return e().call(n,t)}async listBuckets(t={}){var e=()=>super.listBuckets,n=this;return e().call(n,t)}async deleteBucket(t){var e=()=>super.deleteBucket,n=this;return e().call(n,t)}},WI=class extends UI{constructor(t,e,n,r){super(t,e,r),this.vectorBucketName=n}async createIndex(t){var e=()=>super.createIndex,n=this;return e().call(n,Ee(Ee({},t),{},{vectorBucketName:n.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,n=this;return e().call(n,Ee(Ee({},t),{},{vectorBucketName:n.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,n=this;return e().call(n,n.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,n=this;return e().call(n,n.vectorBucketName,t)}index(t){return new KI(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},KI=class extends zI{constructor(t,e,n,r,s){super(t,e,s),this.vectorBucketName=n,this.indexName=r}async putVectors(t){var e=()=>super.putVectors,n=this;return e().call(n,Ee(Ee({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async getVectors(t){var e=()=>super.getVectors,n=this;return e().call(n,Ee(Ee({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,n=this;return e().call(n,Ee(Ee({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,n=this;return e().call(n,Ee(Ee({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,n=this;return e().call(n,Ee(Ee({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}},qI=class extends MI{constructor(t,e={},n,r){super(t,e,n,r)}from(t){return new PI(this.url,this.headers,t,this.fetch)}get vectors(){return new HI(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new DI(this.url+"/iceberg",this.headers,this.fetch)}};const TE="2.89.0",vo=30*1e3,_m=3,Nf=_m*vo,GI="http://localhost:9999",JI="supabase.auth.token",YI={"X-Client-Info":`gotrue-js/${TE}`},Am="X-Supabase-Api-Version",_E={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},QI=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,XI=10*60*1e3;class Vl extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function ye(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class ZI extends Vl{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function eP(t){return ye(t)&&t.name==="AuthApiError"}class bi extends Vl{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class ys extends Vl{constructor(e,n,r,s){super(e,r,s),this.name=n,this.status=r}}class Nn extends ys{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function tP(t){return ye(t)&&t.name==="AuthSessionMissingError"}class lo extends ys{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Jc extends ys{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Yc extends ys{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function nP(t){return ye(t)&&t.name==="AuthImplicitGrantRedirectError"}class _1 extends ys{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class rP extends ys{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Om extends ys{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function If(t){return ye(t)&&t.name==="AuthRetryableFetchError"}class A1 extends ys{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class Rm extends ys{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const cd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),O1=` 	
\r=`.split(""),sP=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<O1.length;e+=1)t[O1[e].charCodeAt(0)]=-2;for(let e=0;e<cd.length;e+=1)t[cd[e].charCodeAt(0)]=e;return t})();function R1(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(cd[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(cd[r]),e.queuedBits-=6}}function AE(t,e,n){const r=sP[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function N1(t){const e=[],n=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=o=>{aP(o,r,n)};for(let o=0;o<t.length;o+=1)AE(t.charCodeAt(o),s,i);return e.join("")}function iP(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function oP(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|s)+65536,n+=1}iP(r,e)}}function aP(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if(!(t>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function Yo(t){const e=[],n={queue:0,queuedBits:0},r=s=>{e.push(s)};for(let s=0;s<t.length;s+=1)AE(t.charCodeAt(s),n,r);return new Uint8Array(e)}function lP(t){const e=[];return oP(t,n=>e.push(n)),new Uint8Array(e)}function _i(t){const e=[],n={queue:0,queuedBits:0},r=s=>{e.push(s)};return t.forEach(s=>R1(s,n,r)),R1(null,n,r),e.join("")}function cP(t){return Math.round(Date.now()/1e3)+t}function uP(){return Symbol("auth-callback")}const jt=()=>typeof window<"u"&&typeof document<"u",fi={tested:!1,writable:!1},OE=()=>{if(!jt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(fi.tested)return fi.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),fi.tested=!0,fi.writable=!0}catch{fi.tested=!0,fi.writable=!1}return fi.writable};function dP(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return n.searchParams.forEach((r,s)=>{e[s]=r}),e}const RE=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),hP=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",wo=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},pi=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Dt=async(t,e)=>{await t.removeItem(e)};class Nh{constructor(){this.promise=new Nh.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}Nh.promiseConstructor=Promise;function Pf(t){const e=t.split(".");if(e.length!==3)throw new Rm("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!QI.test(e[r]))throw new Rm("JWT not in base64url format");return{header:JSON.parse(N1(e[0])),payload:JSON.parse(N1(e[1])),signature:Yo(e[2]),raw:{header:e[0],payload:e[1]}}}async function fP(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function pP(t,e){return new Promise((r,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){r(o);return}}catch(o){if(!e(i,o)){s(o);return}}})()})}function mP(t){return("0"+t.toString(16)).substr(-2)}function gP(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let s="";for(let i=0;i<56;i++)s+=n.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,mP).join("")}async function yP(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),s=new Uint8Array(r);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function vP(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await yP(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function co(t,e,n=!1){const r=gP();let s=r;n&&(s+="/PASSWORD_RECOVERY"),await wo(t,`${e}-code-verifier`,s);const i=await vP(r);return[i,r===i?"plain":"s256"]}const wP=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function xP(t){const e=t.headers.get(Am);if(!e||!e.match(wP))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function bP(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function kP(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const SP=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function uo(t){if(!SP.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Mf(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function EP(t,e){return new Proxy(t,{get:(n,r,s)=>{if(r==="__isInsecureUserWarningProxy")return!0;if(typeof r=="symbol"){const i=r.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(n,r,s)}return!e.value&&typeof r=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(n,r,s)}})}function I1(t){return JSON.parse(JSON.stringify(t))}const vi=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),CP=[502,503,504];async function P1(t){var e;if(!hP(t))throw new Om(vi(t),0);if(CP.includes(t.status))throw new Om(vi(t),t.status);let n;try{n=await t.json()}catch(i){throw new bi(vi(i),i)}let r;const s=xP(t);if(s&&s.getTime()>=_E["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new A1(vi(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Nn}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new A1(vi(n),t.status,n.weak_password.reasons);throw new ZI(vi(n),t.status||500,r)}const TP=(t,e,n,r)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),n))};async function Se(t,e,n,r){var s;const i=Object.assign({},r==null?void 0:r.headers);i[Am]||(i[Am]=_E["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(s=r==null?void 0:r.query)!==null&&s!==void 0?s:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await _P(t,e,n+a,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function _P(t,e,n,r,s,i){const o=TP(e,r,s,i);let a;try{a=await t(n,Object.assign({},o))}catch(l){throw console.error(l),new Om(vi(l),0)}if(a.ok||await P1(a),r!=null&&r.noResolveJson)return a;try{return await a.json()}catch(l){await P1(l)}}function fr(t){var e;let n=null;RP(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=cP(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function M1(t){const e=fr(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Is(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function AP(t){return{data:t,error:null}}function OP(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:s,verification_type:i}=t,o=Oh(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:n,hashed_token:r,redirect_to:s,verification_type:i},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function D1(t){return t}function RP(t){return t.access_token&&t.refresh_token&&t.expires_in}const Df=["global","local","others"];class NP{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=RE(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,n=Df[0]){if(Df.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Df.join(", ")}`);try{return await Se(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(ye(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await Se(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Is})}catch(r){if(ye(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=Oh(e,["options"]),s=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(s.new_email=r==null?void 0:r.newEmail,delete s.newEmail),await Se(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:OP,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(ye(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await Se(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Is})}catch(n){if(ye(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,s,i,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Se(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:D1});if(u.error)throw u.error;const d=await u.json(),h=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(p=>{const g=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(p.split(";")[1].split("=")[1]);c[`${y}Page`]=g}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(ye(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){uo(e);try{return await Se(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Is})}catch(n){if(ye(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){uo(e);try{return await Se(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Is})}catch(r){if(ye(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){uo(e);try{return await Se(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Is})}catch(r){if(ye(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){uo(e.userId);try{const{data:n,error:r}=await Se(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:n,error:r}}catch(n){if(ye(n))return{data:null,error:n};throw n}}async _deleteFactor(e){uo(e.userId),uo(e.id);try{return{data:await Se(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(ye(n))return{data:null,error:n};throw n}}async _listOAuthClients(e){var n,r,s,i,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Se(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:D1});if(u.error)throw u.error;const d=await u.json(),h=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(p=>{const g=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(p.split(";")[1].split("=")[1]);c[`${y}Page`]=g}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(ye(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(e){try{return await Se(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ye(n))return{data:null,error:n};throw n}}async _getOAuthClient(e){try{return await Se(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ye(n))return{data:null,error:n};throw n}}async _updateOAuthClient(e,n){try{return await Se(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:n,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ye(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(e){try{return await Se(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(n){if(ye(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(e){try{return await Se(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ye(n))return{data:null,error:n};throw n}}}function j1(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}const ho={debug:!!(globalThis&&OE()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class NE extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class IP extends NE{}async function PP(t,e,n){ho.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),ho.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){ho.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,s.name);try{return await n()}finally{ho.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,s.name)}}else{if(e===0)throw ho.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new IP(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(ho.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function MP(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function IE(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function DP(t){return parseInt(t,16)}function jP(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,r=>r.toString(16).padStart(2,"0")).join("")}function LP(t){var e;const{chainId:n,domain:r,expirationTime:s,issuedAt:i=new Date,nonce:o,notBefore:a,requestId:l,resources:c,scheme:u,uri:d,version:h}=t;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!r)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!d)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const f=IE(t.address),p=u?`${u}://${r}`:r,g=t.statement?`${t.statement}
`:"",y=`${p} wants you to sign in with your Ethereum account:
${f}

${g}`;let m=`URI: ${d}
Version: ${h}
Chain ID: ${n}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(s&&(m+=`
Expiration Time: ${s.toISOString()}`),a&&(m+=`
Not Before: ${a.toISOString()}`),l&&(m+=`
Request ID: ${l}`),c){let v=`
Resources:`;for(const w of c){if(!w||typeof w!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${w}`);v+=`
- ${w}`}m+=v}return`${y}
${m}`}class pt extends Error{constructor({message:e,code:n,cause:r,name:s}){var i;super(e,{cause:r}),this.__isWebAuthnError=!0,this.name=(i=s??(r instanceof Error?r.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=n}}class ud extends pt{constructor(e,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:e}),this.name="WebAuthnUnknownError",this.originalError=n}}function $P({error:t,options:e}){var n,r,s;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new pt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((n=i.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new pt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((r=i.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new pt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new pt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new pt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new pt({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return i.pubKeyCredParams.filter(a=>a.type==="public-key").length===0?new pt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new pt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const o=window.location.hostname;if(PE(o)){if(i.rp.id!==o)return new pt({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new pt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new pt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new pt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new pt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function FP({error:t,options:e}){const{publicKey:n}=e;if(!n)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new pt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new pt({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const r=window.location.hostname;if(PE(r)){if(n.rpId!==r)return new pt({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new pt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new pt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new pt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class BP{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const UP=new BP;function zP(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:n,excludeCredentials:r}=t,s=Oh(t,["challenge","user","excludeCredentials"]),i=Yo(e).buffer,o=Object.assign(Object.assign({},n),{id:Yo(n.id).buffer}),a=Object.assign(Object.assign({},s),{challenge:i,user:o});if(r&&r.length>0){a.excludeCredentials=new Array(r.length);for(let l=0;l<r.length;l++){const c=r[l];a.excludeCredentials[l]=Object.assign(Object.assign({},c),{id:Yo(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return a}function VP(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:n}=t,r=Oh(t,["challenge","allowCredentials"]),s=Yo(e).buffer,i=Object.assign(Object.assign({},r),{challenge:s});if(n&&n.length>0){i.allowCredentials=new Array(n.length);for(let o=0;o<n.length;o++){const a=n[o];i.allowCredentials[o]=Object.assign(Object.assign({},a),{id:Yo(a.id).buffer,type:a.type||"public-key",transports:a.transports})}}return i}function HP(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t;return{id:t.id,rawId:t.id,response:{attestationObject:_i(new Uint8Array(t.response.attestationObject)),clientDataJSON:_i(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function WP(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t,r=t.getClientExtensionResults(),s=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:_i(new Uint8Array(s.authenticatorData)),clientDataJSON:_i(new Uint8Array(s.clientDataJSON)),signature:_i(new Uint8Array(s.signature)),userHandle:s.userHandle?_i(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function PE(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function L1(){var t,e;return!!(jt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function KP(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new ud("Browser returned unexpected credential type",e)}:{data:null,error:new ud("Empty credential response",e)}}catch(e){return{data:null,error:$P({error:e,options:t})}}}async function qP(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new ud("Browser returned unexpected credential type",e)}:{data:null,error:new ud("Empty credential response",e)}}catch(e){return{data:null,error:FP({error:e,options:t})}}}const GP={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},JP={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function dd(...t){const e=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),n=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),r={};for(const s of t)if(s)for(const i in s){const o=s[i];if(o!==void 0)if(Array.isArray(o))r[i]=o;else if(n(o))r[i]=o;else if(e(o)){const a=r[i];e(a)?r[i]=dd(a,o):r[i]=dd(o)}else r[i]=o}return r}function YP(t,e){return dd(GP,t,e||{})}function QP(t,e){return dd(JP,t,e||{})}class XP{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:n,friendlyName:r,signal:s},i){try{const{data:o,error:a}=await this.client.mfa.challenge({factorId:e,webauthn:n});if(!o)return{data:null,error:a};const l=s??UP.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:c}=o.webauthn.credential_options.publicKey;c.name||(c.name=`${c.id}:${r}`),c.displayName||(c.displayName=c.name)}switch(o.webauthn.type){case"create":{const c=YP(o.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:u,error:d}=await KP({publicKey:c,signal:l});return u?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:u}},error:null}:{data:null,error:d}}case"request":{const c=QP(o.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:u,error:d}=await qP(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:c,signal:l}));return u?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:u}},error:null}:{data:null,error:d}}}}catch(o){return ye(o)?{data:null,error:o}:{data:null,error:new bi("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:n,webauthn:r}){return this.client.mfa.verify({factorId:n,challengeId:e,webauthn:r})}async _authenticate({factorId:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},i){if(!n)return{data:null,error:new Vl("rpId is required for WebAuthn authentication")};try{if(!L1())return{data:null,error:new bi("Browser does not support WebAuthn",null)};const{data:o,error:a}=await this.challenge({factorId:e,webauthn:{rpId:n,rpOrigins:r},signal:s},{request:i});if(!o)return{data:null,error:a};const{webauthn:l}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:l.type,rpId:n,rpOrigins:r,credential_response:l.credential_response}})}catch(o){return ye(o)?{data:null,error:o}:{data:null,error:new bi("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},i){if(!n)return{data:null,error:new Vl("rpId is required for WebAuthn registration")};try{if(!L1())return{data:null,error:new bi("Browser does not support WebAuthn",null)};const{data:o,error:a}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(u=>{var d;return(d=u.data)===null||d===void 0?void 0:d.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===e&&h.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u==null?void 0:u.id}):void 0),{data:null,error:a};const{data:l,error:c}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:n,rpOrigins:r},signal:s},{create:i});return l?this._verify({factorId:o.id,challengeId:l.challengeId,webauthn:{rpId:n,rpOrigins:r,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:c}}catch(o){return ye(o)?{data:null,error:o}:{data:null,error:new bi("Unexpected error in register",o)}}}}MP();const ZP={url:GI,storageKey:JI,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:YI,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function $1(t,e,n){return await n()}const fo={};class Hl{get jwks(){var e,n;return(n=(e=fo[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){fo[this.storageKey]=Object.assign(Object.assign({},fo[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=fo[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){fo[this.storageKey]=Object.assign(Object.assign({},fo[this.storageKey]),{cachedAt:e})}constructor(e){var n,r,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},ZP),e);if(this.storageKey=i.storageKey,this.instanceID=(n=Hl.nextInstanceID[this.storageKey])!==null&&n!==void 0?n:0,Hl.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&jt()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new NP({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=RE(i.fetch),this.lock=i.lock||$1,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,i.lock?this.lock=i.lock:this.persistSession&&jt()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=PP:this.lock=$1,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new XP(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:OE()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=j1(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=j1(this.memoryStorage)),jt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${TE}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let n={},r="none";if(jt()&&(n=dP(window.location.href),this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce")),jt()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:i}=await this._getSessionFromURL(n,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),nP(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:a}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return ye(n)?this._returnResult({error:n}):this._returnResult({error:new bi("Unexpected error during initialization",n)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,s;try{const i=await Se(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:fr}),{data:o,error:a}=i;if(a||!o)return this._returnResult({data:{user:null,session:null},error:a});const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(i){if(ye(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(e){var n,r,s;try{let i;if("email"in e){const{email:u,password:d,options:h}=e;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await co(this.storage,this.storageKey)),i=await Se(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:u,password:d,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:f,code_challenge_method:p},xform:fr})}else if("phone"in e){const{phone:u,password:d,options:h}=e;i=await Se(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:d,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},channel:(s=h==null?void 0:h.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:fr})}else throw new Jc("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return await Dt(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:a});const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(i){if(await Dt(this.storage,`${this.storageKey}-code-verifier`),ye(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(e){try{let n;if("email"in e){const{email:i,password:o,options:a}=e;n=await Se(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:M1})}else if("phone"in e){const{phone:i,password:o,options:a}=e;n=await Se(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:M1})}else throw new Jc("You must provide either an email or phone number and a password");const{data:r,error:s}=n;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!r||!r.session||!r.user){const i=new lo;return this._returnResult({data:{user:null,session:null},error:i})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(n){if(ye(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOAuth(e){var n,r,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;switch(n){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(e){var n,r,s,i,o,a,l,c,u,d,h;let f,p;if("message"in e)f=e.message,p=e.signature;else{const{chain:g,wallet:y,statement:m,options:v}=e;let w;if(jt())if(typeof y=="object")w=y;else{const k=window;if("ethereum"in k&&typeof k.ethereum=="object"&&"request"in k.ethereum&&typeof k.ethereum.request=="function")w=k.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=y}const S=new URL((n=v==null?void 0:v.url)!==null&&n!==void 0?n:window.location.href),T=await w.request({method:"eth_requestAccounts"}).then(k=>k).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!T||T.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const E=IE(T[0]);let O=(r=v==null?void 0:v.signInWithEthereum)===null||r===void 0?void 0:r.chainId;if(!O){const k=await w.request({method:"eth_chainId"});O=DP(k)}const b={domain:S.host,address:E,statement:m,uri:S.href,version:"1",chainId:O,nonce:(s=v==null?void 0:v.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(o=(i=v==null?void 0:v.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(a=v==null?void 0:v.signInWithEthereum)===null||a===void 0?void 0:a.expirationTime,notBefore:(l=v==null?void 0:v.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(c=v==null?void 0:v.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(u=v==null?void 0:v.signInWithEthereum)===null||u===void 0?void 0:u.resources};f=LP(b),p=await w.request({method:"personal_sign",params:[jP(f),E]})}try{const{data:g,error:y}=await Se(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:f,signature:p},!((d=e.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(h=e.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:fr});if(y)throw y;if(!g||!g.session||!g.user){const m=new lo;return this._returnResult({data:{user:null,session:null},error:m})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:y})}catch(g){if(ye(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async signInWithSolana(e){var n,r,s,i,o,a,l,c,u,d,h,f;let p,g;if("message"in e)p=e.message,g=e.signature;else{const{chain:y,wallet:m,statement:v,options:w}=e;let S;if(jt())if(typeof m=="object")S=m;else{const E=window;if("solana"in E&&typeof E.solana=="object"&&("signIn"in E.solana&&typeof E.solana.signIn=="function"||"signMessage"in E.solana&&typeof E.solana.signMessage=="function"))S=E.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof m!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=m}const T=new URL((n=w==null?void 0:w.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in S&&S.signIn){const E=await S.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:T.host,uri:T.href}),v?{statement:v}:null));let O;if(Array.isArray(E)&&E[0]&&typeof E[0]=="object")O=E[0];else if(E&&typeof E=="object"&&"signedMessage"in E&&"signature"in E)O=E;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in O&&"signature"in O&&(typeof O.signedMessage=="string"||O.signedMessage instanceof Uint8Array)&&O.signature instanceof Uint8Array)p=typeof O.signedMessage=="string"?O.signedMessage:new TextDecoder().decode(O.signedMessage),g=O.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in S)||typeof S.signMessage!="function"||!("publicKey"in S)||typeof S!="object"||!S.publicKey||!("toBase58"in S.publicKey)||typeof S.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${T.host} wants you to sign in with your Solana account:`,S.publicKey.toBase58(),...v?["",v,""]:[""],"Version: 1",`URI: ${T.href}`,`Issued At: ${(s=(r=w==null?void 0:w.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=w==null?void 0:w.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((o=w==null?void 0:w.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((a=w==null?void 0:w.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((l=w==null?void 0:w.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((c=w==null?void 0:w.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((d=(u=w==null?void 0:w.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||d===void 0)&&d.length?["Resources",...w.signInWithSolana.resources.map(O=>`- ${O}`)]:[]].join(`
`);const E=await S.signMessage(new TextEncoder().encode(p),"utf8");if(!E||!(E instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=E}}try{const{data:y,error:m}=await Se(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:_i(g)},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:fr});if(m)throw m;if(!y||!y.session||!y.user){const v=new lo;return this._returnResult({data:{user:null,session:null},error:v})}return y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),this._returnResult({data:Object.assign({},y),error:m})}catch(y){if(ye(y))return this._returnResult({data:{user:null,session:null},error:y});throw y}}async _exchangeCodeForSession(e){const n=await pi(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(n??"").split("/");try{if(!r&&this.flowType==="pkce")throw new rP;const{data:i,error:o}=await Se(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:fr});if(await Dt(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const a=new lo;return this._returnResult({data:{user:null,session:null,redirectType:null},error:a})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}catch(i){if(await Dt(this.storage,`${this.storageKey}-code-verifier`),ye(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(e){try{const{options:n,provider:r,token:s,access_token:i,nonce:o}=e,a=await Se(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:fr}),{data:l,error:c}=a;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l||!l.session||!l.user){const u=new lo;return this._returnResult({data:{user:null,session:null},error:u})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:c})}catch(n){if(ye(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOtp(e){var n,r,s,i,o;try{if("email"in e){const{email:a,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await co(this.storage,this.storageKey));const{error:d}=await Se(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:d})}if("phone"in e){const{phone:a,options:l}=e,{data:c,error:u}=await Se(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(s=l==null?void 0:l.data)!==null&&s!==void 0?s:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u})}throw new Jc("You must provide either an email or phone number.")}catch(a){if(await Dt(this.storage,`${this.storageKey}-code-verifier`),ye(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async verifyOtp(e){var n,r;try{let s,i;"options"in e&&(s=(n=e.options)===null||n===void 0?void 0:n.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:a}=await Se(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:fr});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,c=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(s){if(ye(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(e){var n,r,s,i,o;try{let a=null,l=null;this.flowType==="pkce"&&([a,l]=await co(this.storage,this.storageKey));const c=await Se(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:l}),headers:this.headers,xform:AP});return!((i=c.data)===null||i===void 0)&&i.url&&jt()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(c.data.url),this._returnResult(c)}catch(a){if(await Dt(this.storage,`${this.storageKey}-code-verifier`),ye(a))return this._returnResult({data:null,error:a});throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new Nn;const{error:s}=await Se(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(e){if(ye(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:i}=e,{error:o}=await Se(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:r,type:s,options:i}=e,{data:o,error:a}=await Se(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a})}throw new Jc("You must provide either an email or phone number and a type")}catch(n){if(ye(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await pi(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<Nf:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const o=await pi(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=Mf()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=EP(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const n=await this._acquireLock(-1,async()=>await this._getUser());return n.data.user&&(this.suppressGetSessionWarning=!0),n}async _getUser(e){try{return e?await Se(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Is}):await this._useSession(async n=>{var r,s,i;const{data:o,error:a}=n;if(a)throw a;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Nn}:await Se(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:Is})})}catch(n){if(ye(n))return tP(n)&&(await this._removeSession(),await Dt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:n});throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:s,error:i}=r;if(i)throw i;if(!s.session)throw new Nn;const o=s.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await co(this.storage,this.storageKey));const{data:c,error:u}=await Se(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:Is});if(u)throw u;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(r){if(await Dt(this.storage,`${this.storageKey}-code-verifier`),ye(r))return this._returnResult({data:{user:null},error:r});throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Nn;const n=Date.now()/1e3;let r=n,s=!0,i=null;const{payload:o}=Pf(e.access_token);if(o.exp&&(r=o.exp,s=r<=n),s){const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(n){if(ye(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:o,error:a}=n;if(a)throw a;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new Nn;const{data:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(n){if(ye(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async _getSessionFromURL(e,n){try{if(!jt())throw new Yc("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Yc(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new _1("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Yc("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new _1("No code detected.");const{data:v,error:w}=await this._exchangeCodeForSession(e.code);if(w)throw w;const S=new URL(window.location.href);return S.searchParams.delete("code"),window.history.replaceState(window.history.state,"",S.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:a,expires_at:l,token_type:c}=e;if(!i||!a||!o||!c)throw new Yc("No session defined in URL");const u=Math.round(Date.now()/1e3),d=parseInt(a);let h=u+d;l&&(h=parseInt(l));const f=h-u;f*1e3<=vo&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${d}s`);const p=h-d;u-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,h,u):u-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,h,u);const{data:g,error:y}=await this._getUser(i);if(y)throw y;const m={provider_token:r,provider_refresh_token:s,access_token:i,expires_in:d,expires_at:h,refresh_token:o,token_type:c,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:m,redirectType:e.type},error:null})}catch(r){if(ye(r))return this._returnResult({data:{session:null,redirectType:null},error:r});throw r}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await pi(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:s,error:i}=n;if(i)return this._returnResult({error:i});const o=(r=s.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(eP(a)&&(a.status===404||a.status===401||a.status===403)))return this._returnResult({error:a})}return e!=="others"&&(await this._removeSession(),await Dt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const n=uP(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,s;try{const{data:{session:i},error:o}=n;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,n={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await co(this.storage,this.storageKey,!0));try{return await Se(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(i){if(await Dt(this.storage,`${this.storageKey}-code-verifier`),ye(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(n){if(ye(n))return this._returnResult({data:null,error:n});throw n}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var n;try{const{data:r,error:s}=await this._useSession(async i=>{var o,a,l,c,u;const{data:d,error:h}=i;if(h)throw h;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Se(this.fetch,"GET",f,{headers:this.headers,jwt:(u=(c=d.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(s)throw s;return jt()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),this._returnResult({data:{provider:e.provider,url:r==null?void 0:r.url},error:null})}catch(r){if(ye(r))return this._returnResult({data:{provider:e.provider,url:null},error:r});throw r}}async linkIdentityIdToken(e){return await this._useSession(async n=>{var r;try{const{error:s,data:{session:i}}=n;if(s)throw s;const{options:o,provider:a,token:l,access_token:c,nonce:u}=e,d=await Se(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(r=i==null?void 0:i.access_token)!==null&&r!==void 0?r:void 0,body:{provider:a,id_token:l,access_token:c,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:fr}),{data:h,error:f}=d;return f?this._returnResult({data:{user:null,session:null},error:f}):!h||!h.session||!h.user?this._returnResult({data:{user:null,session:null},error:new lo}):(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:f}))}catch(s){if(await Dt(this.storage,`${this.storageKey}-code-verifier`),ye(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,s;const{data:i,error:o}=n;if(o)throw o;return await Se(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(n){if(ye(n))return this._returnResult({data:null,error:n});throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await pP(async s=>(s>0&&await fP(200*Math.pow(2,s-1)),this._debug(n,"refreshing attempt",s),await Se(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:fr})),(s,i)=>{const o=200*Math.pow(2,s);return i&&If(i)&&Date.now()+o-r<vo})}catch(r){if(this._debug(n,"error",r),ye(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),jt()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await pi(this.storage,this.storageKey);if(s&&this.userStorage){let o=await pi(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await wo(this.userStorage,this.storageKey+"-user",o)),s.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:Mf()}else if(s&&!s.user&&!s.user){const o=await pi(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(s.user=o.user,await Dt(this.storage,this.storageKey+"-user"),await wo(this.storage,this.storageKey,s)):s.user=Mf()}if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&await this._removeSession();return}const i=((n=s.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<Nf;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${Nf}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),If(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:a}=await this._getUser(s.access_token);!a&&(o!=null&&o.user)?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new Nn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Nh;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new Nn;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={data:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(s,"error",i),ye(i)){const o={data:null,error:i};return If(i)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,n,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,n)}catch(l){i.push(l)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Dt(this.storage,`${this.storageKey}-code-verifier`);const n=Object.assign({},e),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await wo(this.userStorage,this.storageKey+"-user",{user:n.user});const s=Object.assign({},n);delete s.user;const i=I1(s);await wo(this.storage,this.storageKey,i)}else{const s=I1(n);await wo(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Dt(this.storage,this.storageKey),await Dt(this.storage,this.storageKey+"-code-verifier"),await Dt(this.storage,this.storageKey+"-user"),this.userStorage&&await Dt(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&jt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),vo);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/vo);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${vo}ms, refresh threshold is ${_m} ticks`),s<=_m&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof NE)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!jt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const s=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,o]=await co(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(a.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);s.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:s,error:i}=n;return i?this._returnResult({data:null,error:i}):await Se(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(ye(n))return this._returnResult({data:null,error:n});throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,s;const{data:i,error:o}=n;if(o)return this._returnResult({data:null,error:o});const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:l,error:c}=await Se(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return c?this._returnResult({data:null,error:c}):(e.factorType==="totp"&&l.type==="totp"&&(!((s=l==null?void 0:l.totp)===null||s===void 0)&&s.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(n){if(ye(n))return this._returnResult({data:null,error:n});throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:i}=n;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?HP(e.webauthn.credential_response):WP(e.webauthn.credential_response)})}:{code:e.code}),{data:a,error:l}=await Se(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),this._returnResult({data:a,error:l}))})}catch(n){if(ye(n))return this._returnResult({data:null,error:n});throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:i}=n;if(i)return this._returnResult({data:null,error:i});const o=await Se(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});if(o.error)return o;const{data:a}=o;if(a.type!=="webauthn")return{data:a,error:null};switch(a.webauthn.type){case"create":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:zP(a.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:VP(a.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(ye(n))return this._returnResult({data:null,error:n});throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){var e;const{data:{user:n},error:r}=await this.getUser();if(r)return{data:null,error:r};const s={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=n==null?void 0:n.factors)!==null&&e!==void 0?e:[])s.all.push(i),i.status==="verified"&&s[i.factor_type].push(i);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var e,n;const{data:{session:r},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=Pf(r.access_token);let o=null;i.aal&&(o=i.aal);let a=o;((n=(e=r.user.factors)===null||e===void 0?void 0:e.filter(u=>u.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(a="aal2");const c=i.amr||[];return{data:{currentLevel:o,nextLevel:a,currentAuthenticationMethods:c},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async n=>{const{data:{session:r},error:s}=n;return s?this._returnResult({data:null,error:s}):r?await Se(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:r.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Nn})})}catch(n){if(ye(n))return this._returnResult({data:null,error:n});throw n}}async _approveAuthorization(e,n){try{return await this._useSession(async r=>{const{data:{session:s},error:i}=r;if(i)return this._returnResult({data:null,error:i});if(!s)return this._returnResult({data:null,error:new Nn});const o=await Se(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:a=>({data:a,error:null})});return o.data&&o.data.redirect_url&&jt()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(r){if(ye(r))return this._returnResult({data:null,error:r});throw r}}async _denyAuthorization(e,n){try{return await this._useSession(async r=>{const{data:{session:s},error:i}=r;if(i)return this._returnResult({data:null,error:i});if(!s)return this._returnResult({data:null,error:new Nn});const o=await Se(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:a=>({data:a,error:null})});return o.data&&o.data.redirect_url&&jt()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(r){if(ye(r))return this._returnResult({data:null,error:r});throw r}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;return r?this._returnResult({data:null,error:r}):n?await Se(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new Nn})})}catch(e){if(ye(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async n=>{const{data:{session:r},error:s}=n;return s?this._returnResult({data:null,error:s}):r?(await Se(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Nn})})}catch(n){if(ye(n))return this._returnResult({data:null,error:n});throw n}}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(a=>a.kid===e);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(a=>a.kid===e),r&&this.jwks_cached_at+XI>s)return r;const{data:i,error:o}=await Se(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,r=i.keys.find(a=>a.kid===e),!r)?null:r}async getClaims(e,n={}){try{let r=e;if(!r){const{data:f,error:p}=await this.getSession();if(p||!f.session)return this._returnResult({data:null,error:p});r=f.session.access_token}const{header:s,payload:i,signature:o,raw:{header:a,payload:l}}=Pf(r);n!=null&&n.allowExpired||bP(i.exp);const c=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!c){const{error:f}=await this.getUser(r);if(f)throw f;return{data:{claims:i,header:s,signature:o},error:null}}const u=kP(s.alg),d=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,d,o,lP(`${a}.${l}`)))throw new Rm("Invalid JWT signature");return{data:{claims:i,header:s,signature:o},error:null}}catch(r){if(ye(r))return this._returnResult({data:null,error:r});throw r}}}Hl.nextInstanceID={};const eM=Hl,tM="2.89.0";let Va="";typeof Deno<"u"?Va="deno":typeof document<"u"?Va="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Va="react-native":Va="node";const nM={"X-Client-Info":`supabase-js-${Va}/${tM}`},rM={headers:nM},sM={schema:"public"},iM={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},oM={};function Wl(t){"@babel/helpers - typeof";return Wl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wl(t)}function aM(t,e){if(Wl(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Wl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lM(t){var e=aM(t,"string");return Wl(e)=="symbol"?e:e+""}function cM(t,e,n){return(e=lM(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F1(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function ct(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?F1(Object(n),!0).forEach(function(r){cM(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):F1(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}const uM=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),dM=()=>Headers,hM=(t,e,n)=>{const r=uM(n),s=dM();return async(i,o)=>{var a;const l=(a=await e())!==null&&a!==void 0?a:t;let c=new s(o==null?void 0:o.headers);return c.has("apikey")||c.set("apikey",t),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),r(i,ct(ct({},o),{},{headers:c}))}};function fM(t){return t.endsWith("/")?t:t+"/"}function pM(t,e){var n,r;const{db:s,auth:i,realtime:o,global:a}=t,{db:l,auth:c,realtime:u,global:d}=e,h={db:ct(ct({},l),s),auth:ct(ct({},c),i),realtime:ct(ct({},u),o),storage:{},global:ct(ct(ct({},d),a),{},{headers:ct(ct({},(n=d==null?void 0:d.headers)!==null&&n!==void 0?n:{}),(r=a==null?void 0:a.headers)!==null&&r!==void 0?r:{})}),accessToken:async()=>""};return t.accessToken?h.accessToken=t.accessToken:delete h.accessToken,h}function mM(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(fM(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var gM=class extends eM{constructor(t){super(t)}},yM=class{constructor(t,e,n){var r,s;this.supabaseUrl=t,this.supabaseKey=e;const i=mM(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const o=`sb-${i.hostname.split(".")[0]}-auth-token`,a={db:sM,realtime:oM,auth:ct(ct({},iM),{},{storageKey:o}),global:rM},l=pM(n??{},a);if(this.storageKey=(r=l.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(s=l.global.headers)!==null&&s!==void 0?s:{},l.accessToken)this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(u,d)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(d)} is not possible`)}});else{var c;this.auth=this._initSupabaseAuthClient((c=l.auth)!==null&&c!==void 0?c:{},this.headers,l.global.fetch)}this.fetch=hM(e,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(ct({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&this.accessToken().then(u=>this.realtime.setAuth(u)).catch(u=>console.warn("Failed to set initial Realtime auth token:",u)),this.rest=new YN(new URL("rest/v1",i).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new qI(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new WN(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,n)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,n;if(t.accessToken)return await t.accessToken();const{data:r}=await t.auth.getSession();return(e=(n=r.session)===null||n===void 0?void 0:n.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:r,userStorage:s,storageKey:i,flowType:o,lock:a,debug:l,throwOnError:c},u,d){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new gM({url:this.authUrl.href,headers:ct(ct({},h),u),storageKey:i,autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:r,userStorage:s,flowType:o,lock:a,debug:l,throwOnError:c,fetch:d,hasCustomAuthorizationHeader:Object.keys(this.headers).some(f=>f.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new fI(this.realtimeUrl.href,ct(ct({},t),{},{params:ct(ct({},{apikey:this.supabaseKey}),t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e==null?void 0:e.access_token)})}_handleTokenChanged(t,e,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const vM=(t,e,n)=>new yM(t,e,n);function wM(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}wM()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const ME="https://acrkclmderqewcwugsnl.supabase.co",Cu="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFjcmtjbG1kZXJxZXdjd3Vnc25sIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYyNTc0MzAsImV4cCI6MjA4MTgzMzQzMH0.UT2vJTXpPO5tR9sUD8YU0gJ_47Zpe3yJiLzllUljPDw";console.log("Supabase Config:",{url:ME,keyLength:Cu==null?void 0:Cu.length});let DE=null;try{DE=vM(ME,Cu)}catch(t){console.error("Error creating Supabase client:",t)}const le=DE,xM=(t,e)=>{const n=new Date,r=t.toLowerCase().trim();if(/^\d+$/.test(r)){const i=parseInt(r,10);let o=n.getMonth(),a=n.getFullYear();i<n.getDate()&&(o++,o>11&&(o=0,a++));const l=new Date(a,o,i);if(l.getMonth()===o)return l}if(["","today","td"].includes(r))return n;if(["","tmr","tm"].includes(r))return new Date(n.setDate(n.getDate()+1));if([""].includes(r))return new Date(n.setDate(n.getDate()+2));const s=r.match(/^\+(\d+)$/);return s?new Date(n.setDate(n.getDate()+parseInt(s[1]))):null},bM=t=>t?new Date(t).toLocaleDateString("zh-TW",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",jE=t=>{if(!t)return"";const e=new Date(t),n=new Date;n.setHours(0,0,0,0);const r=new Date(e.getTime());r.setHours(0,0,0,0);const s=Math.floor((r.getTime()-n.getTime())/(1e3*60*60*24));return s===0?"":s===1?"":s===-1?"":s<0?`${Math.abs(s)} `:`${e.getMonth()+1}/${e.getDate()}`},ts=(t,e)=>t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate(),Li=t=>t?ts(new Date(t),new Date):!1,Kl=t=>t?new Date(t).getTime()<new Date().setHours(0,0,0,0):!1,L0=(t,e,n)=>{if(!t)return!1;if(t===e)return!0;const r=n.find(s=>s.id===t);return r?L0(r.parent_id,e,n):!1},kM="v1.6.0",Nm=28,LE=new Image;LE.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";const vn={gray:{color:"#6b7280",bg:"bg-gray-50",text:"text-gray-600",accent:"text-gray-600",badge:"bg-gray-100 text-gray-600 border-gray-200",border:"border-gray-300",ring:"focus-within:ring-gray-200",buttonRing:"focus:ring-gray-200 focus:border-gray-300",dot:"bg-gray-400",breadcrumb:"bg-gray-50 text-gray-600 hover:bg-gray-100",indicator:"bg-gray-500",ringColor:"ring-gray-400"},blue:{color:"#3b82f6",bg:"bg-blue-50",text:"text-blue-600",accent:"text-blue-600",badge:"bg-blue-100 text-blue-600 border-blue-200",border:"border-blue-500",ring:"focus-within:ring-blue-200",buttonRing:"focus:ring-blue-200 focus:border-blue-300",dot:"bg-blue-400",breadcrumb:"bg-blue-50 text-blue-600 hover:bg-blue-100",indicator:"bg-blue-500",ringColor:"ring-blue-400"},indigo:{color:"#6366f1",bg:"bg-indigo-50",text:"text-indigo-600",accent:"text-indigo-600",badge:"bg-indigo-100 text-indigo-600 border-indigo-200",border:"border-indigo-500",ring:"focus-within:ring-indigo-200",buttonRing:"focus:ring-indigo-200 focus:border-indigo-300",dot:"bg-indigo-400",breadcrumb:"bg-indigo-50 text-indigo-600 hover:bg-indigo-100",indicator:"bg-indigo-500",ringColor:"ring-indigo-400"},red:{color:"#ef4444",bg:"bg-red-50",text:"text-red-600",accent:"text-red-600",badge:"bg-red-100 text-red-600 border-red-200",border:"border-red-500",ring:"focus-within:ring-red-200",buttonRing:"focus:ring-red-200 focus:border-red-300",dot:"bg-red-400",breadcrumb:"bg-red-50 text-red-600 hover:bg-red-100",indicator:"bg-red-500",ringColor:"ring-red-400"},orange:{color:"#f97316",bg:"bg-orange-50",text:"text-orange-600",accent:"text-orange-600",badge:"bg-orange-100 text-orange-600 border-orange-200",border:"border-orange-500",ring:"focus-within:ring-orange-200",buttonRing:"focus:ring-orange-200 focus:border-orange-300",dot:"bg-orange-400",breadcrumb:"bg-orange-50 text-orange-600 hover:bg-orange-100",indicator:"bg-orange-500",ringColor:"ring-orange-400"},amber:{color:"#f59e0b",bg:"bg-amber-50",text:"text-amber-600",accent:"text-amber-600",badge:"bg-amber-100 text-amber-600 border-amber-200",border:"border-amber-500",ring:"focus-within:ring-amber-200",buttonRing:"focus:ring-amber-200 focus:border-amber-300",dot:"bg-amber-400",breadcrumb:"bg-amber-50 text-amber-600 hover:bg-amber-100",indicator:"bg-amber-500",ringColor:"ring-amber-400"},green:{color:"#10b981",bg:"bg-green-50",text:"text-green-600",accent:"text-green-600",badge:"bg-green-100 text-green-600 border-green-200",border:"border-green-500",ring:"focus-within:ring-green-200",buttonRing:"focus:ring-green-200 focus:border-green-300",dot:"bg-green-400",breadcrumb:"bg-green-50 text-green-600 hover:bg-green-100",indicator:"bg-green-500",ringColor:"ring-green-400"},teal:{color:"#14b8a6",bg:"bg-teal-50",text:"text-teal-600",accent:"text-teal-600",badge:"bg-teal-100 text-teal-600 border-teal-200",border:"border-teal-500",ring:"focus-within:ring-teal-200",buttonRing:"focus:ring-teal-200 focus:border-teal-300",dot:"bg-teal-400",breadcrumb:"bg-teal-50 text-teal-600 hover:bg-teal-100",indicator:"bg-teal-500",ringColor:"ring-teal-400"},cyan:{color:"#06b6d4",bg:"bg-cyan-50",text:"text-cyan-600",accent:"text-cyan-600",badge:"bg-cyan-100 text-cyan-600 border-cyan-200",border:"border-cyan-500",ring:"focus-within:ring-cyan-200",buttonRing:"focus:ring-cyan-200 focus:border-cyan-300",dot:"bg-cyan-400",breadcrumb:"bg-cyan-50 text-cyan-600 hover:bg-cyan-100",indicator:"bg-cyan-500",ringColor:"ring-cyan-400"},sky:{color:"#0ea5e9",bg:"bg-sky-50",text:"text-sky-600",accent:"text-sky-600",badge:"bg-sky-100 text-sky-600 border-sky-200",border:"border-sky-500",ring:"focus-within:ring-sky-200",buttonRing:"focus:ring-sky-200 focus:border-sky-300",dot:"bg-sky-400",breadcrumb:"bg-sky-50 text-sky-600 hover:bg-sky-100",indicator:"bg-sky-500",ringColor:"ring-sky-400"},purple:{color:"#a855f7",bg:"bg-purple-50",text:"text-purple-600",accent:"text-purple-600",badge:"bg-purple-100 text-purple-600 border-purple-200",border:"border-purple-500",ring:"focus-within:ring-purple-200",buttonRing:"focus:ring-purple-200 focus:border-purple-300",dot:"bg-purple-400",breadcrumb:"bg-purple-50 text-purple-600 hover:bg-purple-100",indicator:"bg-purple-500",ringColor:"ring-purple-400"},fuchsia:{color:"#d946ef",bg:"bg-fuchsia-50",text:"text-fuchsia-600",accent:"text-fuchsia-600",badge:"bg-fuchsia-100 text-fuchsia-600 border-fuchsia-200",border:"border-fuchsia-500",ring:"focus-within:ring-fuchsia-200",buttonRing:"focus:ring-fuchsia-200 focus:border-fuchsia-300",dot:"bg-fuchsia-400",breadcrumb:"bg-fuchsia-50 text-fuchsia-600 hover:bg-fuchsia-100",indicator:"bg-fuchsia-500",ringColor:"ring-fuchsia-400"},pink:{color:"#ec4899",bg:"bg-pink-50",text:"text-pink-600",accent:"text-pink-600",badge:"bg-pink-100 text-pink-600 border-pink-200",border:"border-pink-500",ring:"focus-within:ring-pink-200",buttonRing:"focus:ring-pink-200 focus:border-pink-300",dot:"bg-pink-400",breadcrumb:"bg-pink-50 text-pink-600 hover:bg-pink-100",indicator:"bg-pink-500",ringColor:"ring-pink-400"},rose:{color:"#f43f5e",bg:"bg-rose-50",text:"text-rose-600",accent:"text-rose-600",badge:"bg-rose-100 text-rose-600 border-rose-200",border:"border-rose-500",ring:"focus-within:ring-rose-200",buttonRing:"focus:ring-rose-200 focus:border-rose-300",dot:"bg-rose-400",breadcrumb:"bg-rose-50 text-rose-600 hover:bg-rose-100",indicator:"bg-rose-500",ringColor:"ring-rose-400"}},Vn=A.createContext({}),SM=({children:t})=>{const[e,n]=A.useState(null),[r,s]=A.useState([]),[i,o]=A.useState([]),[a,l]=A.useState(!0),[c,u]=A.useState(null),[d,h]=A.useState("synced"),[f,p]=A.useState(null),[g,y]=A.useState([]),[m,v]=A.useState(null),[w,S]=A.useState(null),[T,E]=A.useState(null),[O,b]=A.useState(()=>{const V=localStorage.getItem(`expanded_tasks_${e==null?void 0:e.id}`);return V?JSON.parse(V):[]}),[k,N]=A.useState(()=>localStorage.getItem(`last_view_${e==null?void 0:e.id}`)||"inbox"),[M,L]=A.useState(null),[$,P]=A.useState({additionalTags:[],startDate:null,dueDate:null,color:null}),[U,R]=A.useState({fontWeight:"thin",fontSize:"normal"}),[C,D]=A.useState(null),[j,F]=A.useState(()=>parseInt(localStorage.getItem(`sidebar_width_${e==null?void 0:e.id}`)||"260")),[Y,Q]=A.useState(()=>{const V=localStorage.getItem(`expanded_tags_${e==null?void 0:e.id}`);return V?JSON.parse(V):[]}),[W,G]=A.useState([]),[H,se]=A.useState([]),[be,X]=A.useState([]),re=A.useRef([]),[ge,we]=A.useState({isDragging:!1,draggedId:null,originalDepth:0,dragOffsetX:0,dropIndex:null,dropDepth:0,indicatorTop:0,indicatorLeft:0,indicatorWidth:0,ghostPosition:{x:0,y:0}}),ue=A.useRef({}),J=A.useRef(null),fe=A.useRef(null);A.useEffect(()=>{if(!le){u("Supabase client not initialized"),l(!1);return}(async()=>{try{let B=localStorage.getItem("gtd_user_id");const K=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;let _=null;if(!B||!K.test(B))if(console.warn("No valid User ID found."),le){const{data:{session:I},error:z}=await le.auth.getSession();if(z)throw z;_=(I==null?void 0:I.user)||null,n(_)}else n(null);else if(le){const{data:{session:I},error:z}=await le.auth.getSession();if(z)throw z;_=(I==null?void 0:I.user)||{id:B},n(_)}else _={id:B},n(_);if(_!=null&&_.id){const I=localStorage.getItem(`expanded_tasks_${_.id}`);I&&b(JSON.parse(I));const z=localStorage.getItem(`last_view_${_.id}`);z&&N(z);const q=localStorage.getItem(`sidebar_width_${_.id}`);q&&F(parseInt(q));const ae=localStorage.getItem(`expanded_tags_${_.id}`);ae&&Q(JSON.parse(ae))}}catch(B){console.error("Initialization error:",B),u(B.message||"Failed to initialize app"),l(!1)}})()},[]),A.useEffect(()=>{re.current=r},[r]),A.useEffect(()=>{if(!e||!le)return;(async()=>{try{if(le){const{data:_}=await le.from("tasks").select("*").eq("user_id",e.id).order("order_index",{ascending:!0}).order("created_at",{ascending:!0});let I=null,{data:z,error:q}=await le.from("tags").select("*").eq("user_id",e.id).order("order_index",{ascending:!0}).order("created_at",{ascending:!0});if(q){console.warn("Failed to fetch tags with order_index, falling back to created_at",q);const{data:ae,error:ve}=await le.from("tags").select("*").eq("user_id",e.id);ve?console.error("Failed to fetch tags even with fallback:",ve):I=ae==null?void 0:ae.sort((Ne,_e)=>{var Z;return((Z=Ne.created_at)==null?void 0:Z.localeCompare(_e.created_at||""))||0})}else I=z;if(_){const ae=_.map(ve=>({...ve,tags:ve.tags||[],images:ve.images||[]}));s(ae),re.current=ae}I&&o(I)}}catch(_){console.error("Error fetching data:",_)}finally{l(!1)}})();const B=le.channel("tasks_changes").on("postgres_changes",{event:"*",schema:"public",table:"tasks",filter:`user_id=eq.${e.id}`},_=>{if(!(_.new&&ue.current[_.new.id]&&Date.now()-ue.current[_.new.id]<2e3))if(_.eventType==="INSERT"){const I={..._.new,tags:_.new.tags||[],images:_.new.images||[]};s(z=>z.some(q=>q.id===I.id)?z:[I,...z].sort((q,ae)=>(q.order_index||0)-(ae.order_index||0)||q.created_at.localeCompare(ae.created_at)))}else if(_.eventType==="UPDATE"){const I={..._.new,tags:_.new.tags||[],images:_.new.images||[]};s(z=>z.map(q=>q.id===I.id?I:q).sort((q,ae)=>(q.order_index||0)-(ae.order_index||0)||q.created_at.localeCompare(ae.created_at)))}else _.eventType==="DELETE"&&s(I=>I.filter(z=>z.id!==_.old.id))}).subscribe(),K=le.channel("tags_changes").on("postgres_changes",{event:"*",schema:"public",table:"tags",filter:`user_id=eq.${e.id}`},_=>{_.eventType==="INSERT"?o(I=>I.some(z=>z.id===_.new.id)?I:[...I,_.new]):_.eventType==="DELETE"&&o(I=>I.filter(z=>z.id!==_.old.id))}).subscribe();return()=>{B.unsubscribe(),K.unsubscribe()}},[e]);const de=V=>{console.error(V),h("error"),p({msg:`Sync Failed: ${V.message||"Unknown error"}`,type:"error"})},ie=V=>{ue.current[V]=Date.now()},oe=async V=>{const B=new Date,K=[];for(let q=1;q<=10;q++){const ae=new Date(B);ae.setDate(B.getDate()+q),ae.setHours(0,0,0,0);const ve=r.filter(Ne=>{if(!Ne.start_date)return!1;const _e=new Date(Ne.start_date);return ts(_e,ae)&&!Ne.completed_at}).length;K.push({date:ae,count:ve})}const _=Math.min(...K.map(q=>q.count)),I=K.filter(q=>q.count===_),z=I[Math.floor(Math.random()*I.length)];await Ur(V,{start_date:z.date.toISOString()}),p({msg:` ${z.date.getMonth()+1}/${z.date.getDate()} (: ${z.count})`,type:"info"})},Oe=async()=>{const V=r.filter(K=>!!K.completed_at&&K.status!=="logged");if(V.length===0)return;const B=V.map(K=>K.id);if(s(K=>K.map(_=>B.includes(_.id)?{..._,status:"logged"}:_)),le){const{error:K}=await le.from("tasks").update({status:"logged"}).in("id",B);K&&de(K)}p({msg:` ${B.length} `,type:"info"})},We=async()=>{Be(),h("syncing");const V=[...r];if(s([]),re.current=[],G([]),se([]),le){const{error:B}=await le.from("tasks").delete().neq("id","00000000-0000-0000-0000-000000000000");if(B){de(B),s(V);return}}h("synced"),p({msg:"",type:"info"})},Be=()=>{const V={tasks:r,tags:i,user_id:e.id,version:1,exported_at:new Date().toISOString()},B=new Blob([JSON.stringify(V,null,2)],{type:"application/json"}),K=URL.createObjectURL(B),_=document.createElement("a");_.href=K,_.download=`things-clone-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(_),_.click(),document.body.removeChild(_),URL.revokeObjectURL(K),p({msg:"",type:"info"})},Re=async V=>{if(!le)return;const B=new FileReader;B.onload=async K=>{var _;try{const I=(_=K.target)==null?void 0:_.result,z=JSON.parse(I);if(!z.tasks||!z.tags)throw new Error("");if(h("syncing"),z.tags.length>0){const{error:q}=await le.from("tags").upsert(z.tags.map(ae=>({...ae,user_id:e.id})));if(q)throw q}if(z.tasks.length>0){const{error:q}=await le.from("tasks").upsert(z.tasks.map(ae=>({...ae,user_id:e.id})));if(q)throw q}p({msg:"...",type:"info"}),setTimeout(()=>window.location.reload(),1e3)}catch(I){de(I)}},B.readAsText(V)},Ke=async()=>{le&&await le.auth.signOut(),localStorage.removeItem("gtd_user_id"),n(null),s([]),o([])},me=V=>{G(B=>[...B,V]),se([])},Me=async()=>{if(W.length===0)return;const V=W[W.length-1];if(G(W.slice(0,-1)),se(B=>[...B,V]),V.type==="ADD"){const B=V.payload.data.id;ie(B),s(K=>K.filter(_=>_.id!==B)),le&&await le.from("tasks").delete().eq("id",B)}else if(V.type==="DELETE"){const B=V.payload.data;ie(B.id),s(K=>[...K,B].sort((_,I)=>(_.order_index||0)-(I.order_index||0)||_.created_at.localeCompare(I.created_at))),le&&await le.from("tasks").insert([B])}else if(V.type==="UPDATE"){const{id:B,before:K}=V.payload;ie(B),s(_=>_.map(I=>I.id===B?{...I,...K}:I).sort((I,z)=>(I.order_index||0)-(z.order_index||0)||I.created_at.localeCompare(z.created_at))),le&&await le.from("tasks").update(K).eq("id",B)}else if(V.type==="BATCH_UPDATE"){const B=V.payload,K=[...re.current];B.forEach(_=>{const I=K.findIndex(z=>z.id===_.id);I!==-1&&(K[I]={...K[I],..._.before},ie(_.id))}),K.sort((_,I)=>(_.order_index||0)-(I.order_index||0)||_.created_at.localeCompare(I.created_at)),s(K),le&&await Promise.all(B.map(_=>le.from("tasks").update(_.before).eq("id",_.id)))}else if(V.type==="ADD_TAG"){const B=V.payload.data.id;o(K=>K.filter(_=>_.id!==B)),le&&await le.from("tags").delete().eq("id",B)}else if(V.type==="DELETE_TAG"){const B=V.payload.data;o(K=>[...K,B].sort((_,I)=>(_.order_index||0)-(I.order_index||0))),le&&await le.from("tags").insert([B])}else if(V.type==="UPDATE_TAG"){const{id:B,before:K}=V.payload;o(_=>_.map(I=>I.id===B?{...I,...K}:I).sort((I,z)=>(I.order_index||0)-(z.order_index||0))),le&&await le.from("tags").update(K).eq("id",B)}p({msg:"",type:"info"})},Le=async()=>{if(H.length===0)return;const V=H[H.length-1];if(se(H.slice(0,-1)),G(B=>[...B,V]),V.type==="ADD"){const B=V.payload.data;ie(B.id),s(K=>[...K,B].sort((_,I)=>(_.order_index||0)-(I.order_index||0)||_.created_at.localeCompare(I.created_at))),le&&await le.from("tasks").insert([B])}else if(V.type==="DELETE"){const B=V.payload.data.id;ie(B),s(K=>K.filter(_=>_.id!==B)),le&&await le.from("tasks").delete().eq("id",B)}else if(V.type==="UPDATE"){const{id:B,after:K}=V.payload;ie(B),s(_=>_.map(I=>I.id===B?{...I,...K}:I).sort((I,z)=>(I.order_index||0)-(z.order_index||0)||I.created_at.localeCompare(z.created_at))),le&&await le.from("tasks").update(K).eq("id",B)}else if(V.type==="BATCH_UPDATE"){const B=V.payload,K=[...re.current];B.forEach(_=>{const I=K.findIndex(z=>z.id===_.id);I!==-1&&(K[I]={...K[I],..._.after},ie(_.id))}),K.sort((_,I)=>(_.order_index||0)-(I.order_index||0)||_.created_at.localeCompare(I.created_at)),s(K),le&&await Promise.all(B.map(_=>le.from("tasks").update(_.after).eq("id",_.id)))}else if(V.type==="ADD_TAG"){const B=V.payload.data;o(K=>[...K,B].sort((_,I)=>(_.order_index||0)-(I.order_index||0))),le&&await le.from("tags").insert([B])}else if(V.type==="DELETE_TAG"){const B=V.payload.data.id;o(K=>K.filter(_=>_.id!==B)),le&&await le.from("tags").delete().eq("id",B)}else if(V.type==="UPDATE_TAG"){const{id:B,after:K}=V.payload;o(_=>_.map(I=>I.id===B?{...I,...K}:I).sort((I,z)=>(I.order_index||0)-(z.order_index||0))),le&&await le.from("tags").update(K).eq("id",B)}p({msg:"",type:"info"})};A.useEffect(()=>{const V=B=>{(B.metaKey||B.ctrlKey)&&B.key==="z"&&(B.preventDefault(),B.shiftKey?Le():Me())};return window.addEventListener("keydown",V),()=>window.removeEventListener("keydown",V)},[W,H,r]);const it=V=>{X(K=>[...K,{view:k,focusedId:w}]),N("all"),S(V);let B=r.find(K=>K.id===V);for(;B&&B.parent_id;)O.includes(B.parent_id)||nn(B.parent_id,!0),B=r.find(K=>K.id===(B==null?void 0:B.parent_id))},lr=()=>{if(be.length===0)return;const V=be[be.length-1];X(B=>B.slice(0,-1)),N(V.view),S(V.focusedId)},ot=A.useCallback((V,B,K,_,I)=>{if(B==="schedule")return V.filter(Z=>(!!Z.due_date||!!Z.start_date)&&Z.status!=="deleted"&&Z.status!=="logged").sort((Z,ke)=>{const Tt=new Date(Z.start_date||Z.due_date||0).getTime(),Ue=new Date(ke.start_date||ke.due_date||0).getTime();return Tt-Ue}).map((Z,ke)=>({data:Z,depth:0,hasChildren:!1,isExpanded:!1,path:[],index:ke}));if(B==="next"){const Z=V.filter(Ue=>(Ue.status==="inbox"||Ue.status==="active")&&!Ue.parent_id&&Ue.status!=="logged"&&Ue.status!=="deleted"),ke=[];let Tt=0;return Z.forEach(Ue=>{let rn=Ue;const An=[];for(;;){const On=V.filter(Rn=>Rn.parent_id===rn.id&&Rn.status!=="logged"&&Rn.status!=="deleted").sort((Rn,Cr)=>(Rn.order_index||0)-(Cr.order_index||0)||Rn.created_at.localeCompare(Cr.created_at));if(On.length>0)An.push(rn),rn=On[0];else{ke.push({data:rn,depth:0,hasChildren:!1,isExpanded:!1,path:[],index:Tt++,breadcrumbs:An.length>0?An:void 0});break}}}),ke}const q=(()=>{if(K)return Z=>{var ke;return!((ke=Z.tags)!=null&&ke.includes(K))||I.additionalTags.length>0&&!I.additionalTags.every(Tt=>{var Ue;return(Ue=Z.tags)==null?void 0:Ue.includes(Tt)})||I.color&&Z.color!==I.color||I.startDate&&(!Z.start_date||new Date(Z.start_date)<new Date(I.startDate))||I.dueDate&&(!Z.due_date||new Date(Z.due_date)>new Date(I.dueDate))?!1:Z.status!=="deleted"&&Z.status!=="logged"};switch(B){case"inbox":return Z=>Z.status==="inbox"&&!Z.parent_id;case"today":return Z=>{const ke=Li(Z.due_date)||Li(Z.start_date),Tt=(Kl(Z.due_date)||Kl(Z.start_date))&&!Z.completed_at,Ue=Z.completed_at&&Li(Z.completed_at);if(!(Z.status!=="logged"&&Z.status!=="deleted"&&(ke||Tt||Ue)))return!1;let An=Z;for(;An.parent_id;){const On=V.find(Cr=>Cr.id===An.parent_id);if(!On)break;if(!(On.status!=="logged"&&On.status!=="deleted"))return!1;An=On}return!0};case"projects":return Z=>(Z.is_project||V.some(ke=>ke.parent_id===Z.id))&&Z.status!=="deleted"&&!Z.parent_id&&Z.status!=="logged";case"all":return Z=>Z.status!=="deleted"&&Z.status!=="logged";case"waiting":return Z=>Z.status==="waiting"&&Z.status!=="logged";case"log":return Z=>Z.status==="logged";case"trash":return Z=>Z.status==="deleted";default:return Z=>Z.status!=="deleted"&&Z.status!=="logged"}})(),ae=V.filter(q).sort((Z,ke)=>(Z.order_index||0)-(ke.order_index||0)||Z.created_at.localeCompare(ke.created_at)),ve=new Set;let Ne=0;const _e=(Z,ke=0,Tt=[])=>{let Ue=[];return Z.forEach(rn=>{if(ve.has(rn.id))return;ve.add(rn.id);const An=V.filter(Hr=>Hr.parent_id===rn.id&&Hr.status!=="logged"&&Hr.status!=="deleted").sort((Hr,Zy)=>(Hr.order_index||0)-(Zy.order_index||0)||Hr.created_at.localeCompare(Zy.created_at)),On=An.length>0,Rn=_.includes(rn.id),Cr=[...Tt,rn.id];Ue.push({data:rn,depth:ke,hasChildren:On,isExpanded:Rn,path:Cr,index:Ne++}),On&&Rn&&(Ue=[...Ue,..._e(An,ke+1,Cr)])}),Ue};return _e(ae)},[]),at=A.useMemo(()=>ot(r,k,M,O,$),[r,k,M,O,$,ot]),Ze=(V,B)=>{S(B);const K=V.shiftKey||V.shiftKey,_=V.ctrlKey||V.metaKey;if(K){const I=m||w||B;v(I);const z=at.findIndex(ae=>ae.data.id===I),q=at.findIndex(ae=>ae.data.id===B);if(z!==-1&&q!==-1){const[ae,ve]=z<q?[z,q]:[q,z],Ne=at.slice(ae,ve+1).map(_e=>_e.data.id);y(Ne)}}else _?(v(B),y(I=>I.includes(B)?I.filter(z=>z!==B):[...I,B])):(v(B),y([B]))},Et=A.useCallback((V,B)=>{we(K=>({...K,ghostPosition:{x:V,y:B}}))},[]);A.useEffect(()=>{fe.current=document.querySelector("main")},[]);const Ct=(V,B)=>{if(k==="schedule"){V.preventDefault();return}g.includes(B.data.id)||y([B.data.id]),V.dataTransfer.setData("text/plain",B.data.id),V.dataTransfer.effectAllowed="move",V.dataTransfer.setDragImage(LE,0,0);const K=V.currentTarget.getBoundingClientRect(),_=V.clientX-K.left;we(I=>({...I,isDragging:!0,draggedId:B.data.id,originalDepth:B.depth,dragOffsetX:_,ghostPosition:{x:V.clientX,y:V.clientY}}))},Cn=V=>{we(B=>({...B,...V}))},fn=async()=>{J.current&&(clearInterval(J.current),J.current=null);const{draggedId:V,dropIndex:B,dropDepth:K}=ge;if(we(Z=>({...Z,isDragging:!1,draggedId:null,dropIndex:null})),!V||B===null)return;const _=g.includes(V)?g:[V],I=r.filter(Z=>_.includes(Z.id)).sort((Z,ke)=>(Z.order_index||0)-(ke.order_index||0));let z=null;if(B>0){const Z=at[B-1];if(K>Z.depth)z=Z.data.id,O.includes(z)||nn(z,!0);else if(K===Z.depth)z=Z.data.parent_id;else{let ke=B-1;for(;ke>=0;){if(at[ke].depth===K-1){z=at[ke].data.id;break}if(at[ke].depth<K-1)break;ke--}K===0&&(z=null)}}else z=null;for(const Z of I){if(L0(z,Z.id,r)){p({msg:"",type:"error"});return}if(z){const ke=r.find(Tt=>Tt.id===z);if(ke&&!ke.is_project&&Z.is_project){p({msg:"",type:"error"});return}}}let q=-1e4,ae=999999999;for(let Z=B-1;Z>=0;Z--){const ke=at[Z];if(!_.includes(ke.data.id)){if(ke.depth===K){q=ke.data.order_index;break}else if(ke.depth<K)break}}for(let Z=B;Z<at.length;Z++){const ke=at[Z];if(!_.includes(ke.data.id)){if(ke.depth===K){ae=ke.data.order_index;break}else if(ke.depth<K)break}}q===-1e4&&ae===999999999?(q=0,ae=2e4):q===-1e4?q=ae-2e4:ae===999999999&&(ae=q+2e4);const ve=I.length,Ne=(ae-q)/(ve+1),_e=I.map((Z,ke)=>({id:Z.id,parent_id:z,order_index:q+Ne*(ke+1)}));Tn(_e)},cr=async(V,B)=>{const K=re.current,_=K.find(I=>I.id===V);if(_){if(ie(V),B==="up"||B==="down"){const I=K.filter(q=>q.parent_id===_.parent_id&&q.status!=="deleted"&&q.status!=="logged").sort((q,ae)=>(q.order_index||0)-(ae.order_index||0)),z=I.findIndex(q=>q.id===V);if(z===-1)return;if(B==="up"){if(z===0)return;const q=I[z-1],ae=I[z-2];let ve;ae?ve=(ae.order_index+q.order_index)/2:ve=q.order_index-1e4,Tn([{id:_.id,order_index:ve}])}else{if(z===I.length-1)return;const q=I[z+1],ae=I[z+2];let ve;ae?ve=(q.order_index+ae.order_index)/2:ve=q.order_index+1e4,Tn([{id:_.id,order_index:ve}])}}else if(B==="right"){const I=K.filter(_e=>_e.parent_id===_.parent_id&&_e.status!=="deleted"&&_e.status!=="logged").sort((_e,Z)=>(_e.order_index||0)-(Z.order_index||0)),z=I.findIndex(_e=>_e.id===V);if(z<=0)return;const q=I[z-1].id,ae=K.filter(_e=>_e.parent_id===q&&_e.status!=="deleted"&&_e.status!=="logged").sort((_e,Z)=>(_e.order_index||0)-(Z.order_index||0)),ve=ae[ae.length-1],Ne=ve?ve.order_index+1e4:1e4;O.includes(q)||nn(q,!0),Tn([{id:_.id,parent_id:q,order_index:Ne}]),p({msg:"",type:"info"})}else if(B==="left"){if(!_.parent_id)return;const I=K.find(_e=>_e.id===_.parent_id);if(!I)return;const z=I.parent_id,q=K.filter(_e=>_e.parent_id===z&&_e.status!=="deleted"&&_e.status!=="logged").sort((_e,Z)=>(_e.order_index||0)-(Z.order_index||0)),ae=q.findIndex(_e=>_e.id===I.id),ve=q[ae+1];let Ne;ve?Ne=(I.order_index+ve.order_index)/2:Ne=I.order_index+1e4,Tn([{id:_.id,parent_id:z,order_index:Ne}]),p({msg:"",type:"info"})}}},Tn=async V=>{const B=V.map(_=>{const I=re.current.find(ae=>ae.id===_.id),z={},q={};return I&&Object.keys(_).forEach(ae=>{ae!=="id"&&(z[ae]=I[ae],q[ae]=_[ae])}),{id:_.id,before:z,after:q}});me({type:"BATCH_UPDATE",payload:B});const K=re.current.map(_=>{const I=V.find(z=>z.id===_.id);return I?{..._,...I}:_}).sort((_,I)=>(_.order_index||0)-(I.order_index||0)||_.created_at.localeCompare(I.created_at));if(re.current=K,s(K),le){const _=le;await Promise.all(V.map(I=>_.from("tasks").update(I).eq("id",I.id)))}},_n=async(V,B=[],K)=>{if(!le)return"";h("syncing");const _=K||crypto.randomUUID(),I=r.length>0?Math.max(...r.map(ve=>ve.order_index||0)):0,z=V.order_index!==void 0?V.order_index:I+1e4;ie(_);const q={...V,id:_,user_id:e.id,created_at:new Date().toISOString(),tags:V.tags||[],images:V.images||[],order_index:z};me({type:"ADD",payload:{data:q}}),s(ve=>[...ve,q].sort((Ne,_e)=>(Ne.order_index||0)-(_e.order_index||0)||Ne.created_at.localeCompare(_e.created_at)));const{error:ae}=await le.from("tasks").insert([{...V,id:_,user_id:e.id,order_index:z}]);return ae?(console.error("Task Insert Error:",ae),s(ve=>ve.filter(Ne=>Ne.id!==_)),de(ae),""):(B.length>0&&le&&(s(ve=>ve.map(Ne=>B.includes(Ne.id)?{...Ne,parent_id:_}:Ne)),await le.from("tasks").update({parent_id:_}).in("id",B)),h("synced"),_)},Ur=async(V,B,K=[])=>{if(!le)return;h("syncing"),ie(V);const _=r.find(z=>z.id===V);if(_){const z={};Object.keys(B).forEach(q=>z[q]=_[q]),me({type:"UPDATE",payload:{id:V,before:z,after:B}})}s(z=>z.map(q=>q.id===V?{...q,...B}:q));const{error:I}=await le.from("tasks").update(B).eq("id",V);if(I){_&&s(z=>z.map(q=>q.id===V?_:q)),de(I);return}K.length>0&&await le.from("tasks").update({parent_id:V}).in("id",K),h("synced")},vs=async V=>{h("syncing"),ie(V);const B=r.find(K=>K.id===V);if(B&&me({type:"DELETE",payload:{data:B}}),s(K=>K.filter(_=>_.id!==V)),le){const{error:K}=await le.from("tasks").delete().eq("id",V);if(K){de(K),B&&s(_=>[B,..._]);return}}h("synced"),p({msg:"",undo:()=>Me()}),setTimeout(()=>p(null),5e3)},zr=async(V,B=null)=>{if(!le||!V.trim())return null;const K=crypto.randomUUID(),I=i.filter(ve=>ve.parent_id===B).reduce((ve,Ne)=>Math.max(ve,Ne.order_index||0),0)+1e4,z={id:K,name:V,parent_id:B,user_id:e.id,color:"#4f46e5",order_index:I};me({type:"ADD_TAG",payload:{data:z}}),o(ve=>[...ve,z].sort((Ne,_e)=>(Ne.order_index||0)-(_e.order_index||0)));const{data:q,error:ae}=await le.from("tags").insert([{name:V,parent_id:B,user_id:e.id,color:"#4f46e5",order_index:I}]).select();return ae?(o(ve=>ve.filter(Ne=>Ne.id!==K)),null):(o(ve=>{const Ne=q[0];return ve.some(Z=>Z.id===Ne.id)?ve.filter(Z=>Z.id!==K):ve.map(Z=>Z.id===K?Ne:Z).sort((Z,ke)=>(Z.order_index||0)-(ke.order_index||0))}),q[0].id)},Ta=async(V,B)=>{if(!le)return;const K=i.find(_=>_.id===V);if(K){const _={};Object.keys(B).forEach(I=>_[I]=K[I]),me({type:"UPDATE_TAG",payload:{id:V,before:_,after:B}})}o(_=>_.map(I=>I.id===V?{...I,...B}:I).sort((I,z)=>(I.order_index||0)-(z.order_index||0))),await le.from("tags").update(B).eq("id",V)},Hn=async V=>{if(!le)return;const B=i.find(K=>K.id===V);B&&me({type:"DELETE_TAG",payload:{data:B}}),o(K=>K.filter(_=>_.id!==V)),await le.from("tags").delete().eq("id",V)},nn=(V,B)=>{b(K=>{const _=K.includes(V),I=B!==void 0?B?_?K:[...K,V]:K.filter(z=>z!==V):_?K.filter(z=>z!==V):[...K,V];return e!=null&&e.id&&localStorage.setItem(`expanded_tasks_${e.id}`,JSON.stringify(I)),I})},ur=V=>{N(B=>{const K=typeof V=="function"?V(B):V;return e!=null&&e.id&&localStorage.setItem(`last_view_${e.id}`,K),K})},Vr=V=>{F(V),e!=null&&e.id&&localStorage.setItem(`sidebar_width_${e.id}`,V.toString())},io=V=>{Q(B=>{const K=typeof V=="function"?V(B):V;return e!=null&&e.id&&localStorage.setItem(`expanded_tags_${e.id}`,JSON.stringify(K)),K})};return x.jsx(Vn.Provider,{value:{user:e,tasks:r,tags:i,visibleTasks:at,loading:a,syncStatus:d,dragState:ge,startDrag:Ct,updateDropState:Cn,endDrag:fn,updateGhostPosition:Et,addTask:_n,updateTask:Ur,deleteTask:vs,addTag:zr,updateTag:Ta,deleteTag:Hn,keyboardMove:cr,smartReschedule:oe,archiveCompletedTasks:Oe,clearAllTasks:We,exportData:Be,importData:Re,logout:Ke,undo:Me,redo:Le,canUndo:W.length>0,canRedo:H.length>0,navigateToTask:it,navigateBack:lr,canNavigateBack:be.length>0,toast:f,setToast:p,selectedTaskIds:g,setSelectedTaskIds:y,handleSelection:Ze,selectionAnchor:m,setSelectionAnchor:v,focusedTaskId:w,setFocusedTaskId:S,editingTaskId:T,setEditingTaskId:E,expandedTaskIds:O,toggleExpansion:nn,view:k,setView:ur,tagFilter:M,setTagFilter:L,advancedFilters:$,setAdvancedFilters:P,themeSettings:U,setThemeSettings:R,calculateVisibleTasks:ot,pendingFocusTaskId:C,setPendingFocusTaskId:D,initError:c,sidebarWidth:j,setSidebarWidth:Vr,expandedTags:Y,setExpandedTags:io},children:t})};var EM={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const CM=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),TM=(t,e)=>{const n=A.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,children:a,...l},c)=>A.createElement("svg",{ref:c,...EM,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:`lucide lucide-${CM(t)}`,...l},[...e.map(([u,d])=>A.createElement(u,d)),...(Array.isArray(a)?a:[a])||[]]));return n.displayName=`${t}`,n};var Te=TM;const _M=Te("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),AM=Te("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),OM=Te("Archive",[["rect",{width:"20",height:"5",x:"2",y:"4",rx:"2",key:"uhwcea"}],["path",{d:"M4 9v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9",key:"shkvi4"}],["path",{d:"M10 13h4",key:"ytezjc"}]]),$E=Te("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),RM=Te("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20",key:"t4utmx"}]]),$0=Te("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),Ih=Te("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),F0=Te("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),FE=Te("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),ql=Te("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),NM=Te("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),BE=Te("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),IM=Te("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),PM=Te("CloudLightning",[["path",{d:"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973",key:"1cez44"}],["path",{d:"m13 12-3 5h4l-3 5",key:"1t22er"}]]),MM=Te("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]),DM=Te("CornerDownRight",[["polyline",{points:"15 10 20 15 15 20",key:"1q7qjw"}],["path",{d:"M4 4v7a4 4 0 0 0 4 4h12",key:"z08zvw"}]]),jM=Te("CornerUpLeft",[["polyline",{points:"9 14 4 9 9 4",key:"881910"}],["path",{d:"M20 20v-7a4 4 0 0 0-4-4H4",key:"1nkjon"}]]),UE=Te("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),LM=Te("GraduationCap",[["path",{d:"M22 10v6M2 10l10-5 10 5-10 5z",key:"1ef52a"}],["path",{d:"M6 12v5c3 3 9 3 12 0v-5",key:"1f75yj"}]]),$M=Te("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]),FM=Te("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),Im=Te("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),BM=Te("Inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]),UM=Te("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),zE=Te("Layers",[["polygon",{points:"12 2 2 7 12 12 22 7 12 2",key:"1b0ttc"}],["polyline",{points:"2 17 12 22 22 17",key:"imjtdl"}],["polyline",{points:"2 12 12 17 22 12",key:"5dexcv"}]]),VE=Te("Layout",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["line",{x1:"3",x2:"21",y1:"9",y2:"9",key:"1vqk6q"}],["line",{x1:"9",x2:"9",y1:"21",y2:"9",key:"wpwpyp"}]]),Ha=Te("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),zM=Te("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),VM=Te("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),HM=Te("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),WM=Te("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),KM=Te("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]),qM=Te("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),GM=Te("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),HE=Te("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),WE=Te("Redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]),JM=Te("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),B1=Te("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),B0=Te("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),YM=Te("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]),hd=Te("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),KE=Te("Undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]),QM=Te("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),XM=Te("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),ZM=Te("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),is=Te("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function Gl(t,e){A.useEffect(()=>{const n=r=>{!t.current||t.current.contains(r.target)||e()};return document.addEventListener("mousedown",n),document.addEventListener("touchstart",n),()=>{document.removeEventListener("mousedown",n),document.removeEventListener("touchstart",n)}},[t,e])}const eD=["#ef4444","#f97316","#f59e0b","#84cc16","#22c55e","#06b6d4","#3b82f6","#6366f1","#a855f7","#d946ef"],U1=({view:t,setView:e,tagFilter:n,setTagFilter:r})=>{const{tasks:s,tags:i,themeSettings:o,setThemeSettings:a,deleteTag:l,updateTag:c,clearAllTasks:u,exportData:d,importData:h,expandedTags:f,setExpandedTags:p}=A.useContext(Vn),[g,y]=A.useState(!1),[m,v]=A.useState({provider:localStorage.getItem("ai_provider")||"gemini",googleKey:localStorage.getItem("google_ai_key")||"",openaiKey:localStorage.getItem("openai_api_key")||"",baseUrl:localStorage.getItem("ai_base_url")||"https://api.openai.com/v1",modelName:localStorage.getItem("ai_model")||"gpt-3.5-turbo"}),[w,S]=A.useState(null),[T,E]=A.useState(null),[O,b]=A.useState(null),[k,N]=A.useState(""),[M,L]=A.useState(null),$=A.useRef(null),P=A.useRef(null),U=A.useRef(null),R=A.useRef(null);Gl(P,()=>y(!1)),Gl(U,()=>L(null)),A.useEffect(()=>{O?R.current=O:R.current&&setTimeout(()=>{const J=document.querySelector(`[data-tag-id="${R.current}"]`);J&&J.focus(),R.current=null},50)},[O]);const C={inbox:s.filter(J=>J.status==="inbox"&&!J.parent_id).length,todayOverdue:s.filter(J=>J.status!=="completed"&&J.status!=="deleted"&&J.status!=="logged"&&Kl(J.due_date||J.start_date)).length,todayScheduled:s.filter(J=>J.status!=="completed"&&J.status!=="deleted"&&J.status!=="logged"&&!Kl(J.due_date||J.start_date)&&(Li(J.due_date)||Li(J.start_date))).length},D={small:"text-xs",normal:"text-sm",large:"text-base"}[o.fontSize]||"text-sm",j=o.fontWeight==="thin"?"font-light":"",F=({id:J,label:fe,active:de,overdueCount:ie,normalCount:oe})=>x.jsxs("button",{onClick:()=>{e(J),r(null)},className:`w-full flex items-center justify-between px-3 py-1.5 rounded-lg mb-0.5 transition-colors ${D} ${j} ${de?"bg-gray-100 text-gray-900 font-bold":"text-gray-500 hover:bg-gray-50 hover:text-gray-900"}`,children:[" ",x.jsx("span",{children:fe})," ",x.jsxs("div",{className:"flex gap-1.5 items-center",children:[" ",ie>0&&x.jsx("span",{className:"text-[10px] font-bold text-red-500",children:ie})," ",oe>0&&x.jsx("span",{className:"text-[10px] text-gray-400",children:oe})," "]})," "]}),Y=A.useMemo(()=>{const J=(fe,de)=>i.filter(ie=>ie.parent_id===fe).sort((ie,oe)=>(ie.order_index||0)-(oe.order_index||0)).map(ie=>({id:ie.id,name:ie.name,depth:de,parent_id:ie.parent_id,data:ie,isExpanded:f.includes(ie.id),children:J(ie.id,de+1)}));return J(null,0)},[i,f]),Q=(J,fe)=>{fe.stopPropagation(),p(de=>de.includes(J)?de.filter(ie=>ie!==J):[...de,J])},W=(J,fe)=>{J.dataTransfer.setData("tag_id",fe),S(fe)},G=(J,fe)=>{if(J.preventDefault(),w===fe)return;const de=J.currentTarget.getBoundingClientRect(),ie=J.clientY-de.top,oe=de.height;let Oe="inside";ie<oe*.25?Oe="top":ie>oe*.75&&(Oe="bottom"),E({id:fe,position:Oe})},H=async(J,fe)=>{J.preventDefault();const de=J.dataTransfer.getData("tag_id");if(!de||de===fe){E(null),S(null);return}const ie=i.find(Re=>Re.id===de),oe=i.find(Re=>Re.id===fe);if(!ie||!oe)return;let Oe=oe;for(;Oe.parent_id;){if(Oe.parent_id===de){E(null),S(null);return}const Re=i.find(Ke=>Ke.id===Oe.parent_id);if(!Re)break;Oe=Re}let We=ie.parent_id,Be=ie.order_index||0;if((T==null?void 0:T.position)==="inside")We=fe,Be=i.filter(me=>me.parent_id===fe).reduce((me,Me)=>Math.max(me,Me.order_index||0),0)+1e4,f.includes(fe)||p(me=>[...me,fe]);else{We=oe.parent_id;const Re=i.filter(me=>me.parent_id===oe.parent_id).sort((me,Me)=>(me.order_index||0)-(Me.order_index||0)),Ke=Re.findIndex(me=>me.id===fe);if((T==null?void 0:T.position)==="top"){const me=Re[Ke-1],Me=(me==null?void 0:me.order_index)||0,Le=oe.order_index||0;Be=me?(Me+Le)/2:Le-1e4}else{const me=Re[Ke+1],Me=(me==null?void 0:me.order_index)||0,Le=oe.order_index||0;Be=me?(Le+Me)/2:Le+1e4}}await c(de,{parent_id:We,order_index:Be}),E(null),S(null)},se=async J=>{n===J&&r(null),await l(J)},be=J=>{b(J.id),N(J.name),L(null)},X=async()=>{O&&k.trim()&&(await c(O,{name:k}),b(null))},re=()=>{localStorage.setItem("ai_provider",m.provider),localStorage.setItem("google_ai_key",m.googleKey.trim()),localStorage.setItem("openai_api_key",m.openaiKey.trim()),localStorage.setItem("ai_base_url",m.baseUrl.trim()),localStorage.setItem("ai_model",m.modelName.trim()),alert("AI Settings Saved!")},ge=J=>{J.target.files&&J.target.files[0]&&(h(J.target.files[0]),y(!1))},we=(J,fe)=>{if(O!==fe){if(J.key==="ArrowRight"&&(J.preventDefault(),i.find(ie=>ie.id===fe)&&i.some(ie=>ie.parent_id===fe)&&(f.includes(fe)||p(ie=>[...ie,fe]))),J.key==="ArrowLeft"){J.preventDefault();const de=i.find(ie=>ie.id===fe);if(de){if(f.includes(fe))p(ie=>ie.filter(oe=>oe!==fe));else if(de.parent_id){const ie=document.querySelector(`[data-tag-id="${de.parent_id}"]`);ie&&ie.focus()}}}if(J.key==="ArrowDown"||J.key==="ArrowUp"){J.preventDefault();const de=Array.from(document.querySelectorAll("[data-tag-id]")),ie=de.findIndex(Oe=>Oe.getAttribute("data-tag-id")===fe);if(ie===-1)return;const oe=J.key==="ArrowDown"?(ie+1)%de.length:(ie-1+de.length)%de.length;de[oe].focus()}if(J.key==="Enter"){J.preventDefault();const de=i.find(ie=>ie.id===fe);de&&be(de)}(J.key==="Delete"||J.key==="Backspace")&&(J.preventDefault(),J.stopPropagation(),confirm("Delete this tag?")&&se(fe))}},ue=J=>{const fe=(T==null?void 0:T.id)===J.id;let de="border-transparent";fe&&((T==null?void 0:T.position)==="top"?de="border-t-2 border-t-indigo-500":(T==null?void 0:T.position)==="bottom"?de="border-b-2 border-b-indigo-500":de="bg-indigo-50 ring-1 ring-indigo-500");const ie=O===J.id;return x.jsxs("div",{className:"relative",children:[x.jsxs("div",{"data-tag-id":J.id,draggable:!ie,onDragStart:oe=>W(oe,J.id),onDragOver:oe=>G(oe,J.id),onDrop:oe=>H(oe,J.id),onDragLeave:()=>E(null),className:`relative group flex items-center gap-1 py-1 rounded pr-2 transition-all ${D} ${j} ${n===J.id?"bg-gray-100 text-indigo-600 font-bold":"text-gray-500 hover:text-gray-900 hover:bg-gray-50"} ${de}`,style:{paddingLeft:`${J.depth*12+12}px`},onClick:()=>!ie&&r(J.id),tabIndex:0,onKeyDown:oe=>we(oe,J.id),children:[J.children.length>0?x.jsx("button",{onClick:oe=>Q(J.id,oe),className:"p-0.5 hover:bg-gray-200 rounded text-gray-400",children:J.isExpanded?x.jsx(F0,{size:12}):x.jsx(ql,{size:12})}):x.jsx("div",{className:"w-[16px]"}),ie?x.jsxs("div",{className:"flex items-center flex-1 gap-1",children:[x.jsx("input",{autoFocus:!0,className:"flex-1 min-w-0 bg-white border border-indigo-300 rounded px-1 py-0.5 text-xs outline-none focus:ring-1 focus:ring-indigo-500",value:k,onChange:oe=>N(oe.target.value),onKeyDown:oe=>{oe.key==="Enter"?X():oe.key==="Escape"&&b(null)},onClick:oe=>oe.stopPropagation()}),x.jsx("button",{onClick:oe=>{oe.stopPropagation(),X()},className:"text-green-600 hover:bg-green-100 p-0.5 rounded",children:x.jsx(Ih,{size:12})}),x.jsx("button",{onClick:oe=>{oe.stopPropagation(),b(null)},className:"text-red-500 hover:bg-red-100 p-0.5 rounded",children:x.jsx(is,{size:12})})]}):x.jsxs(x.Fragment,{children:[x.jsx(FM,{size:12,style:{color:J.data.color}}),x.jsx("span",{className:"truncate flex-1 text-left",children:J.name})]})]}),M===J.id&&x.jsxs("div",{ref:U,className:"absolute left-full top-0 ml-2 bg-white rounded-lg shadow-xl border border-gray-200 p-3 z-50 w-48 animate-in fade-in zoom-in duration-100",onClick:oe=>oe.stopPropagation(),children:[x.jsxs("div",{className:"mb-3",children:[x.jsx("p",{className:"text-[10px] font-bold text-gray-400 mb-2 uppercase",children:"Color"}),x.jsx("div",{className:"grid grid-cols-5 gap-1",children:eD.map(oe=>x.jsx("button",{className:`w-6 h-6 rounded-full hover:scale-110 transition-transform ${J.data.color===oe?"ring-2 ring-offset-1 ring-indigo-500":""}`,style:{backgroundColor:oe},onClick:()=>c(J.id,{color:oe})},oe))})]}),x.jsxs("div",{className:"space-y-1",children:[x.jsxs("button",{onClick:()=>be(J),className:"w-full flex items-center gap-2 px-2 py-1.5 hover:bg-gray-100 rounded text-xs text-gray-600",children:[x.jsx(GM,{size:12})," Rename"]}),x.jsxs("button",{onClick:()=>se(J.id),className:"w-full flex items-center gap-2 px-2 py-1.5 hover:bg-red-50 rounded text-xs text-red-600",children:[x.jsx(hd,{size:12})," Delete"]})]})]}),J.isExpanded&&J.children.map(oe=>ue(oe))]},J.id)};return x.jsxs("aside",{className:"w-full bg-[#fbfbfb] border-r border-gray-100 h-screen flex flex-col p-5 sticky top-0 overflow-hidden",children:[x.jsxs("div",{className:"mb-8 px-1 flex items-center gap-2 opacity-60",children:[x.jsx(VE,{size:18})," ",x.jsx("span",{className:"text-xs font-bold tracking-widest uppercase",children:"Workspace"})]}),x.jsxs("nav",{className:"flex-1 space-y-6 overflow-y-auto no-scrollbar",children:[x.jsxs("div",{children:[x.jsx("p",{className:"text-[10px] font-bold text-gray-300 mb-2 px-3",children:"COLLECT"}),x.jsx(F,{id:"inbox",label:"Inbox",normalCount:C.inbox,active:t==="inbox"&&!n})]}),x.jsxs("div",{children:[x.jsx("p",{className:"text-[10px] font-bold text-gray-300 mb-2 px-3",children:"FOCUS"}),x.jsx(F,{id:"today",label:"Today",overdueCount:C.todayOverdue,normalCount:C.todayScheduled,active:t==="today"&&!n}),x.jsx(F,{id:"schedule",label:"Schedule",active:t==="schedule"&&!n}),x.jsx(F,{id:"calendar",label:"Calendar",active:t==="calendar"&&!n}),x.jsx(F,{id:"next",label:"Next Actions",active:t==="next"&&!n})]}),x.jsxs("div",{children:[x.jsx("p",{className:"text-[10px] font-bold text-gray-300 mb-2 px-3",children:"ORGANIZE"}),x.jsx(F,{id:"projects",label:"Projects",active:t==="projects"&&!n}),x.jsx(F,{id:"all",label:"All Tasks",active:t==="all"&&!n}),x.jsx(F,{id:"waiting",label:"Waiting For",active:t==="waiting"&&!n}),x.jsx(F,{id:"journal",label:"Journal",active:t==="journal"&&!n})]}),x.jsxs("div",{children:[x.jsx("p",{className:"text-[10px] font-bold text-gray-300 mb-2 px-3",children:"TAGS"}),x.jsx("div",{className:"space-y-0.5",children:Y.map(J=>ue(J))})]})]}),x.jsxs("div",{className:"mt-auto pt-4 border-t border-gray-200 relative",children:[x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsxs("div",{className:"text-[10px] text-gray-400 flex items-center gap-1",children:[x.jsx(UM,{size:10})," ",kM," (UI Polish & AI Expert)"]}),x.jsx("button",{onClick:()=>y(!g),"aria-label":"Settings",className:"text-gray-400 hover:text-gray-600 p-1 rounded hover:bg-gray-100 transition-colors",children:x.jsx(JM,{size:14})})]}),g&&x.jsxs("div",{ref:P,className:"absolute bottom-full left-0 mb-2 w-full bg-white rounded-lg shadow-xl border border-gray-200 p-3 z-50 animate-in fade-in zoom-in duration-100",children:[x.jsx("h3",{className:"text-xs font-bold text-gray-500 mb-3 uppercase tracking-wider",children:"Appearance"}),x.jsxs("div",{className:"space-y-3 mb-4",children:[x.jsxs("div",{children:[x.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-600 mb-1",children:[" ",x.jsx("span",{className:"flex items-center gap-1",children:"Font Weight"})," "]}),x.jsxs("div",{className:"flex bg-gray-100 rounded p-0.5",children:[x.jsx("button",{onClick:()=>a(J=>({...J,fontWeight:"normal"})),className:`flex-1 text-[10px] py-1 rounded ${o.fontWeight==="normal"?"bg-white shadow-sm font-bold text-indigo-600":"text-gray-500"}`,children:"Normal"}),x.jsx("button",{onClick:()=>a(J=>({...J,fontWeight:"thin"})),className:`flex-1 text-[10px] py-1 rounded ${o.fontWeight==="thin"?"bg-white shadow-sm font-bold text-indigo-600":"text-gray-500"}`,children:"Thin"})]})]}),x.jsxs("div",{children:[x.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-600 mb-1",children:[" ",x.jsx("span",{className:"flex items-center gap-1",children:"Text Size"})," "]}),x.jsxs("div",{className:"flex bg-gray-100 rounded p-0.5",children:[x.jsx("button",{onClick:()=>a(J=>({...J,fontSize:"small"})),className:`flex-1 text-[10px] py-1 rounded ${o.fontSize==="small"?"bg-white shadow-sm font-bold text-indigo-600":"text-gray-500"}`,children:"Small"}),x.jsx("button",{onClick:()=>a(J=>({...J,fontSize:"normal"})),className:`flex-1 text-[10px] py-1 rounded ${o.fontSize==="normal"?"bg-white shadow-sm font-bold text-indigo-600":"text-gray-500"}`,children:"Normal"}),x.jsx("button",{onClick:()=>a(J=>({...J,fontSize:"large"})),className:`flex-1 text-[10px] py-1 rounded ${o.fontSize==="large"?"bg-white shadow-sm font-bold text-indigo-600":"text-gray-500"}`,children:"Large"})]})]})]}),x.jsx("h3",{className:"text-xs font-bold text-gray-500 mb-3 uppercase tracking-wider border-t border-gray-100 pt-3",children:"AI Settings"}),x.jsxs("div",{className:"mb-4 space-y-3",children:[x.jsxs("div",{children:[x.jsx("label",{className:"block text-[10px] font-bold text-gray-400 uppercase mb-1",children:"Provider"}),x.jsxs("select",{value:m.provider,onChange:J=>v(fe=>({...fe,provider:J.target.value})),className:"w-full bg-gray-50 border border-gray-200 rounded px-2 py-1 text-xs outline-none focus:ring-1 focus:ring-indigo-500",children:[x.jsx("option",{value:"gemini",children:"Google Gemini"}),x.jsx("option",{value:"openai",children:"OpenAI Compatible (DeepSeek/Moonshot)"})]})]}),m.provider==="gemini"?x.jsxs("div",{children:[x.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[x.jsx("span",{className:"text-xs text-gray-600",children:"Gemini API Key"}),x.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-[10px] text-indigo-500 hover:underline",children:"Get Key"})]}),x.jsx("input",{type:"password",className:"w-full bg-gray-50 border border-gray-200 rounded px-2 py-1 text-xs outline-none focus:ring-1 focus:ring-indigo-500",placeholder:"AIza...",value:m.googleKey,onChange:J=>v(fe=>({...fe,googleKey:J.target.value}))})]}):x.jsxs(x.Fragment,{children:[x.jsxs("div",{children:[x.jsx("label",{className:"block text-[10px] text-gray-600 mb-1",children:"Base URL"}),x.jsx("input",{type:"text",className:"w-full bg-gray-50 border border-gray-200 rounded px-2 py-1 text-xs outline-none focus:ring-1 focus:ring-indigo-500",placeholder:"https://api.deepseek.com",value:m.baseUrl,onChange:J=>v(fe=>({...fe,baseUrl:J.target.value}))})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-[10px] text-gray-600 mb-1",children:"API Key"}),x.jsx("input",{type:"password",className:"w-full bg-gray-50 border border-gray-200 rounded px-2 py-1 text-xs outline-none focus:ring-1 focus:ring-indigo-500",placeholder:"sk-...",value:m.openaiKey,onChange:J=>v(fe=>({...fe,openaiKey:J.target.value}))})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-[10px] text-gray-600 mb-1",children:"Model Name"}),x.jsx("input",{type:"text",className:"w-full bg-gray-50 border border-gray-200 rounded px-2 py-1 text-xs outline-none focus:ring-1 focus:ring-indigo-500",placeholder:"e.g. deepseek-chat",value:m.modelName,onChange:J=>v(fe=>({...fe,modelName:J.target.value}))})]})]}),x.jsx("button",{onClick:re,className:"w-full bg-indigo-600 text-white px-2 py-1.5 rounded text-xs hover:bg-indigo-700 transition-colors font-medium",children:"Save Settings"})]}),x.jsx("h3",{className:"text-xs font-bold text-gray-500 mb-3 uppercase tracking-wider border-t border-gray-100 pt-3",children:"Data"}),x.jsxs("div",{className:"space-y-1",children:[x.jsxs("button",{onClick:()=>{confirm("")&&u()},className:"w-full flex items-center gap-2 px-2 py-1.5 hover:bg-gray-100 rounded text-xs text-gray-600",children:[x.jsx(hd,{size:12})," Delete All Tasks"]}),x.jsxs("button",{onClick:d,className:"w-full flex items-center gap-2 px-2 py-1.5 hover:bg-gray-100 rounded text-xs text-gray-600",children:[x.jsx(UE,{size:12})," Backup Data"]}),x.jsxs("button",{onClick:()=>{var J;return(J=$.current)==null?void 0:J.click()},className:"w-full flex items-center gap-2 px-2 py-1.5 hover:bg-gray-100 rounded text-xs text-gray-600",children:[x.jsx(QM,{size:12})," Import Data"]}),x.jsx("input",{type:"file",ref:$,className:"hidden",accept:".json",onChange:ge})]})]})]})]})},qE=({checked:t,onChange:e,size:n=18,color:r="blue",isRoot:s=!1})=>{const i={blue:{root:"bg-blue-500 border-blue-500 text-white",sub:"bg-blue-100 border-blue-200 text-blue-500",hover:"hover:border-blue-400"},green:{root:"bg-emerald-500 border-emerald-500 text-white",sub:"bg-emerald-100 border-emerald-200 text-emerald-600",hover:"hover:border-emerald-400"},amber:{root:"bg-amber-500 border-amber-500 text-white",sub:"bg-amber-100 border-amber-200 text-amber-600",hover:"hover:border-amber-400"},purple:{root:"bg-purple-500 border-purple-500 text-white",sub:"bg-purple-100 border-purple-200 text-purple-600",hover:"hover:border-purple-400"}},o=i[r]||i.blue,a=s?o.root:o.sub,l=`bg-white border-slate-300 ${o.hover}`;return x.jsx("div",{onClick:e,className:`group relative cursor-pointer flex items-center justify-center transition-all duration-200 ease-out border shadow-sm ${t?a:l}`,style:{width:n,height:n,borderRadius:n*.25},children:x.jsx(Ih,{size:n*.7,className:`transition-all duration-300 ease-back-out ${t?"scale-100 opacity-100":"scale-50 opacity-0"}`,strokeWidth:3})})},fd=({label:t,value:e,onChange:n,theme:r,tasks:s,innerRef:i,colorClass:o})=>{const{themeSettings:a}=A.useContext(Vn),[l,c]=A.useState(""),[u,d]=A.useState(!1),[h,f]=A.useState(new Date),[p,g]=A.useState(null),[y,m]=A.useState(null),[v,w]=A.useState("09:00"),S=A.useRef(null),T=A.useRef(!1),E=A.useRef(!1),O=A.useRef(null),b=i||O;Gl(S,()=>{d(!1),c(""),m(null)}),A.useEffect(()=>{if(e){const W=new Date(e);isNaN(W.getTime())||(f(W),w(`${String(W.getHours()).padStart(2,"0")}:${String(W.getMinutes()).padStart(2,"0")}`))}},[e]);const k=W=>{const G=W.target.value;c(G);const H=xM(G);H?(f(H),m(H),g(H)):m(null)},N=()=>{var G;const W=y||p||h;if(W){const[H,se]=v.split(":").map(Number);W.setHours(H,se),n(W.toISOString()),d(!1),c(""),E.current=!0,(G=b.current)==null||G.focus(),setTimeout(()=>E.current=!1,200)}},M=W=>{var G;W.key==="Enter"?(W.preventDefault(),W.stopPropagation(),u?N():d(!0)):W.key==="Escape"?(W.preventDefault(),u&&(W.stopPropagation(),d(!1),c(""),E.current=!0,(G=b.current)==null||G.focus(),setTimeout(()=>E.current=!1,200))):W.key===" "&&(W.preventDefault(),W.stopPropagation(),d(!0))},L=W=>{S.current&&!S.current.contains(W.relatedTarget)&&d(!1)},$=W=>{T.current||E.current||d(!0)},P=W=>s.filter(G=>{if(G.status==="completed"||G.status==="deleted")return!1;const H=G.start_date?new Date(G.start_date):null,se=G.due_date?new Date(G.due_date):null;return H&&ts(H,W)||se&&ts(se,W)}),U=W=>{const G=new Date(h.getFullYear(),h.getMonth(),W);f(G),g(G),m(G)},R=()=>{const W=new Date(h.getFullYear(),h.getMonth()+1,0).getDate(),G=new Date(h.getFullYear(),h.getMonth(),1).getDay(),H=[];for(let se=0;se<G;se++)H.push(x.jsx("div",{className:"h-8 w-8"},`empty-${se}`));for(let se=1;se<=W;se++){const be=new Date(h.getFullYear(),h.getMonth(),se),X=e&&ts(new Date(e),be),re=y&&ts(y,be),we=P(be).length;let ue="bg-transparent";we>=1&&we<=3?ue="bg-green-400":we>=4&&we<=10?ue="bg-yellow-400":we>10&&(ue="bg-red-500"),H.push(x.jsxs("button",{type:"button",onClick:()=>U(se),onMouseEnter:()=>g(be),className:`h-8 w-8 rounded-full flex items-center justify-center text-xs relative transition-all ${re?"bg-indigo-600/80 text-white font-bold shadow-md":X?"bg-black text-white font-bold":"hover:bg-gray-100"} ${Li(be.toISOString())&&!X&&!re?"text-indigo-600 font-bold":""}`,children:[" ",se," ",!X&&!re&&we>0&&x.jsx("div",{className:`absolute bottom-1 w-1 h-1 rounded-full ${ue}`})," "]},se))}return H},C=y||p||(e?new Date(e):null),D=C?P(C):[],j=(r==null?void 0:r.buttonRing)||"focus:ring-indigo-300 focus:border-indigo-300",F=o||(r==null?void 0:r.text)||"text-gray-400",Y={small:"text-[11px]",normal:"text-xs",large:"text-sm"}[a.fontSize]||"text-xs",Q=a.fontWeight==="thin"?"font-light":"font-medium";return x.jsxs("div",{className:"relative",ref:S,onBlur:L,children:[x.jsxs("button",{ref:b,type:"button",onMouseDown:()=>{T.current=!0,setTimeout(()=>T.current=!1,200)},onClick:()=>d(!u),onKeyDown:M,onFocus:$,className:`flex items-center gap-1.5 px-2.5 py-1.5 rounded-md transition-all border ${e?`${F} bg-white border-transparent shadow-sm ring-1 ring-gray-100`:"text-gray-400 border-transparent hover:bg-gray-100"} focus:outline-none focus:bg-white focus:ring-1 ${j} ${Y} ${Q}`,children:[x.jsx($0,{size:13})," ",x.jsx("span",{children:e?jE(e):t})," ",e&&x.jsx(is,{size:12,className:"hover:text-red-500",onClick:W=>{W.stopPropagation(),n(null)}})]}),u&&x.jsxs("div",{className:"absolute top-full mt-2 left-0 bg-white rounded-xl shadow-2xl border border-gray-100 p-4 z-50 w-72 max-w-[90vw] animate-in fade-in zoom-in duration-100",children:[" ",x.jsxs("div",{className:"mb-3 relative",children:[" ",x.jsx("input",{autoFocus:!0,type:"text",placeholder:": 5, , ...",className:"w-full text-xs border border-gray-200 rounded p-2 focus:ring-2 focus:ring-indigo-100 outline-none pr-8",value:l,onChange:k,onKeyDown:M})," ",y&&x.jsxs("div",{className:"absolute right-2 top-2 text-[10px] text-indigo-500 font-bold bg-indigo-50 px-1 rounded animate-pulse",children:[": ",bM(y.toISOString())]})," "]})," ",x.jsxs("div",{className:"flex justify-between items-center mb-2",children:[" ",x.jsx("button",{type:"button",onClick:()=>f(new Date(h.getFullYear(),h.getMonth()-1,1)),className:"p-1 hover:bg-gray-100 rounded",children:x.jsx(FE,{size:16})})," ",x.jsx("span",{className:"font-bold text-sm text-gray-800",children:h.toLocaleString("default",{month:"long",year:"numeric"})})," ",x.jsx("button",{type:"button",onClick:()=>f(new Date(h.getFullYear(),h.getMonth()+1,1)),className:"p-1 hover:bg-gray-100 rounded",children:x.jsx(ql,{size:16})})," "]})," ",x.jsxs("div",{className:"grid grid-cols-7 gap-1 mb-2 text-center text-xs font-bold text-gray-400",children:[["","","","","","",""].map(W=>x.jsx("span",{children:W},W)),R()]})," ",x.jsxs("div",{className:"flex items-center justify-between border-t border-gray-100 pt-3 mt-2",children:[" ",x.jsxs("span",{className:"text-xs text-gray-500 flex items-center gap-1",children:[x.jsx(IM,{size:12})," "]})," ",x.jsx("input",{type:"time",value:v,onChange:W=>w(W.target.value),className:"text-sm bg-gray-50 border border-gray-200 rounded px-1 py-0.5 outline-none"})," "]})," ",x.jsxs("div",{className:"border-t border-gray-100 pt-3 mt-3",children:[" ",x.jsxs("div",{className:"text-[10px] font-bold text-gray-400 mb-2 flex justify-between items-center",children:[" ",x.jsx("span",{children:C?`${C.getMonth()+1}/${C.getDate()} `:""})," ",x.jsx("span",{className:"bg-gray-100 px-1.5 rounded text-gray-500",children:D.length})," "]})," ",x.jsxs("div",{className:"max-h-24 overflow-y-auto space-y-1",children:[" ",D.length>0?D.map(W=>x.jsx("div",{className:"text-[10px] bg-gray-50 p-1 rounded truncate border-l-2 border-indigo-400 pl-2 text-gray-600",children:W.title},W.id)):x.jsx("div",{className:"text-[10px] text-gray-300 italic text-center py-2",children:""})," "]})," "]})," ",x.jsx("button",{type:"button",onClick:N,className:"w-full mt-3 bg-indigo-600 text-white text-xs font-bold py-1.5 rounded hover:bg-indigo-700 transition-colors",children:""})," "]})]})},Tu=({icon:t,label:e,items:n,selectedIds:r,onSelect:s,onSearch:i,placeholder:o,allowAdd:a,onDeleteItem:l,innerRef:c,multiSelect:u=!1,theme:d})=>{const{themeSettings:h}=A.useContext(Vn),[f,p]=A.useState(!1),[g,y]=A.useState(""),[m,v]=A.useState(-1),w=A.useRef(null),S=A.useRef(!1),T=A.useRef(!1),E=A.useRef(null),O=A.useRef(null),b=c||O;Gl(w,()=>p(!1));const k=A.useMemo(()=>!n||!Array.isArray(n)?[]:n.filter(Y=>Y?(Y.title||Y.name||"").toLowerCase().includes(g.toLowerCase()):!1),[n,g]),N=a&&g.trim()&&!k.some(Y=>(Y.title||Y.name||"").toLowerCase()===g.trim().toLowerCase()),M=k.length+(N?1:0),L=A.useMemo(()=>r.length===0?null:n.find(Y=>r.includes(Y.id)),[n,r]),$=L&&(L.title||L.name)||e,P=(Y,Q)=>{var W;s(Y,Q),u?(y(""),v(-1),p(!0),setTimeout(()=>{var G;return(G=E.current)==null?void 0:G.focus()},0)):(y(""),p(!1),S.current=!0,(W=b.current)==null||W.focus(),setTimeout(()=>S.current=!1,200))},U=Y=>{var Q;Y.key==="ArrowDown"?(Y.preventDefault(),p(!0),v(W=>W===-1?0:(W+1)%M)):Y.key==="ArrowUp"?(Y.preventDefault(),p(!0),v(W=>W<=0?M-1:W-1)):Y.key==="Enter"?(Y.preventDefault(),Y.stopPropagation(),f?m>=0&&m<k.length?P(k[m].id):N&&(m===k.length||m===-1)&&P(null,g):p(!0)):Y.key==="Escape"&&(Y.preventDefault(),f&&(Y.stopPropagation(),p(!1),S.current=!0,(Q=b.current)==null||Q.focus(),setTimeout(()=>S.current=!1,200)))},R=Y=>{w.current&&!w.current.contains(Y.relatedTarget)&&p(!1)},C=Y=>{T.current||S.current||p(!0)},D=(d==null?void 0:d.buttonRing)||"focus:ring-indigo-300 focus:border-indigo-300",j={small:"text-[11px]",normal:"text-xs",large:"text-sm"}[h.fontSize]||"text-xs",F=h.fontWeight==="thin"?"font-light":"font-medium";return x.jsxs("div",{className:"relative",ref:w,onBlur:R,children:[x.jsxs("button",{ref:b,type:"button",onMouseDown:()=>{T.current=!0,setTimeout(()=>T.current=!1,200)},onClick:()=>p(!f),onKeyDown:U,onFocus:C,className:`flex items-center gap-1.5 px-2.5 py-1.5 rounded-md transition-all border ${r.length>0?"text-indigo-600 bg-white shadow-sm ring-1 ring-indigo-50 border-transparent":"text-gray-400 border-transparent hover:bg-gray-100"} focus:outline-none focus:bg-white focus:ring-1 ${D} ${j} ${F}`,children:[x.jsx(t,{size:13})," ",x.jsx("span",{className:"truncate max-w-[80px]",children:$})]}),f&&x.jsxs("div",{className:"absolute top-full mt-2 left-0 bg-white rounded-lg shadow-xl border border-gray-100 z-50 w-60 p-2 animate-in fade-in zoom-in duration-100",children:[x.jsx("input",{ref:E,autoFocus:!0,type:"text",placeholder:o,className:"w-full text-xs bg-gray-50 border-none rounded p-2 mb-1 focus:ring-1 focus:ring-indigo-200 outline-none",value:g,onChange:Y=>{y(Y.target.value),v(-1),i&&i(Y.target.value)},onKeyDown:U}),x.jsxs("div",{className:"max-h-48 overflow-y-auto space-y-0.5",children:[k.map((Y,Q)=>x.jsxs("div",{onMouseDown:W=>{W.preventDefault(),P(Y.id)},onMouseEnter:()=>v(Q),className:`px-2 py-1.5 text-xs rounded cursor-pointer flex items-center justify-between group ${Q===m?"bg-indigo-50 text-indigo-700":"text-gray-600 hover:bg-gray-50"}`,children:[x.jsx("span",{className:"truncate",children:Y.title||Y.name}),x.jsxs("div",{className:"flex items-center gap-2",children:[r.includes(Y.id)&&x.jsx(Ih,{size:12,className:"text-indigo-600"}),l&&x.jsx(hd,{size:12,className:"text-gray-300 opacity-0 group-hover:opacity-100 hover:text-red-500",onClick:W=>{W.stopPropagation(),l(Y.id)}})]})]},Y.id)),N&&x.jsxs("div",{onMouseEnter:()=>v(k.length),className:`px-2 py-1.5 text-xs cursor-pointer rounded flex items-center gap-1 ${m===k.length?"bg-indigo-50 text-indigo-700":"text-indigo-600 hover:bg-indigo-50"}`,onMouseDown:Y=>{Y.preventDefault(),P(null,g)},children:[x.jsx(HE,{size:12}),'  "',g,'"']})]})]})]})},Pm=({tag:t,onRemove:e,size:n="normal"})=>{const{themeSettings:r}=A.useContext(Vn),s={small:{text:{small:"text-[8px]",normal:"text-[9px]",large:"text-[10px]"},padding:"px-1.5 py-0.5"},normal:{text:{small:"text-[9px]",normal:"text-[10px]",large:"text-xs"},padding:"px-2 py-0.5"}},i=s[n].text[r.fontSize]||s[n].text.normal,o=s[n].padding,a=r.fontWeight==="thin"?"font-light":"font-normal";return x.jsxs("div",{className:`inline-flex items-center gap-1 bg-slate-50 text-slate-600 ${o} rounded-md border border-slate-200 ${i} ${a}`,children:[x.jsx("div",{className:"w-1.5 h-1.5 rounded-full",style:{backgroundColor:t.color}}),x.jsx("span",{children:t.name}),e&&x.jsx("button",{type:"button",onClick:e,className:"hover:text-slate-900",children:x.jsx(is,{size:10})})]})};function tD(t,e){return e.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(r){if(r!=="default"&&!(r in t)){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}})}),Object.freeze(t)}function GE(t,e){return new Promise(function(n,r){let s;return nD(t).then(function(i){try{return s=i,n(new Blob([e.slice(0,2),s,e.slice(2)],{type:"image/jpeg"}))}catch(o){return r(o)}},r)})}const nD=t=>new Promise((e,n)=>{const r=new FileReader;r.addEventListener("load",({target:{result:s}})=>{const i=new DataView(s);let o=0;if(i.getUint16(o)!==65496)return n("not a valid JPEG");for(o+=2;;){const a=i.getUint16(o);if(a===65498)break;const l=i.getUint16(o+2);if(a===65505&&i.getUint32(o+4)===1165519206){const c=o+10;let u;switch(i.getUint16(c)){case 18761:u=!0;break;case 19789:u=!1;break;default:return n("TIFF header contains invalid endian")}if(i.getUint16(c+2,u)!==42)return n("TIFF header contains invalid version");const d=i.getUint32(c+4,u),h=c+d+2+12*i.getUint16(c+d,u);for(let f=c+d+2;f<h;f+=12)if(i.getUint16(f,u)==274){if(i.getUint16(f+2,u)!==3)return n("Orientation data type is invalid");if(i.getUint32(f+4,u)!==1)return n("Orientation data count is invalid");i.setUint16(f+8,1,u);break}return e(s.slice(o,o+2+l))}o+=2+l}return e(new Blob)}),r.readAsArrayBuffer(t)});var pd={},rD={get exports(){return pd},set exports(t){pd=t}};(function(t){var e,n,r={};rD.exports=r,r.parse=function(s,i){for(var o=r.bin.readUshort,a=r.bin.readUint,l=0,c={},u=new Uint8Array(s),d=u.length-4;a(u,d)!=101010256;)d--;l=d,l+=4;var h=o(u,l+=4);o(u,l+=2);var f=a(u,l+=2),p=a(u,l+=4);l+=4,l=p;for(var g=0;g<h;g++){a(u,l),l+=4,l+=4,l+=4,a(u,l+=4),f=a(u,l+=4);var y=a(u,l+=4),m=o(u,l+=4),v=o(u,l+2),w=o(u,l+4);l+=6;var S=a(u,l+=8);l+=4,l+=m+v+w,r._readLocal(u,S,c,f,y,i)}return c},r._readLocal=function(s,i,o,a,l,c){var u=r.bin.readUshort,d=r.bin.readUint;d(s,i),u(s,i+=4),u(s,i+=2);var h=u(s,i+=2);d(s,i+=2),d(s,i+=4),i+=4;var f=u(s,i+=8),p=u(s,i+=2);i+=2;var g=r.bin.readUTF8(s,i,f);if(i+=f,i+=p,c)o[g]={size:l,csize:a};else{var y=new Uint8Array(s.buffer,i);if(h==0)o[g]=new Uint8Array(y.buffer.slice(i,i+a));else{if(h!=8)throw"unknown compression method: "+h;var m=new Uint8Array(l);r.inflateRaw(y,m),o[g]=m}}},r.inflateRaw=function(s,i){return r.F.inflate(s,i)},r.inflate=function(s,i){return s[0],s[1],r.inflateRaw(new Uint8Array(s.buffer,s.byteOffset+2,s.length-6),i)},r.deflate=function(s,i){i==null&&(i={level:6});var o=0,a=new Uint8Array(50+Math.floor(1.1*s.length));a[o]=120,a[o+1]=156,o+=2,o=r.F.deflateRaw(s,a,o,i.level);var l=r.adler(s,0,s.length);return a[o+0]=l>>>24&255,a[o+1]=l>>>16&255,a[o+2]=l>>>8&255,a[o+3]=l>>>0&255,new Uint8Array(a.buffer,0,o+4)},r.deflateRaw=function(s,i){i==null&&(i={level:6});var o=new Uint8Array(50+Math.floor(1.1*s.length)),a=r.F.deflateRaw(s,o,a,i.level);return new Uint8Array(o.buffer,0,a)},r.encode=function(s,i){i==null&&(i=!1);var o=0,a=r.bin.writeUint,l=r.bin.writeUshort,c={};for(var u in s){var d=!r._noNeed(u)&&!i,h=s[u],f=r.crc.crc(h,0,h.length);c[u]={cpr:d,usize:h.length,crc:f,file:d?r.deflateRaw(h):h}}for(var u in c)o+=c[u].file.length+30+46+2*r.bin.sizeUTF8(u);o+=22;var p=new Uint8Array(o),g=0,y=[];for(var u in c){var m=c[u];y.push(g),g=r._writeHeader(p,g,u,m,0)}var v=0,w=g;for(var u in c)m=c[u],y.push(g),g=r._writeHeader(p,g,u,m,1,y[v++]);var S=g-w;return a(p,g,101010256),g+=4,l(p,g+=4,v),l(p,g+=2,v),a(p,g+=2,S),a(p,g+=4,w),g+=4,g+=2,p.buffer},r._noNeed=function(s){var i=s.split(".").pop().toLowerCase();return"png,jpg,jpeg,zip".indexOf(i)!=-1},r._writeHeader=function(s,i,o,a,l,c){var u=r.bin.writeUint,d=r.bin.writeUshort,h=a.file;return u(s,i,l==0?67324752:33639248),i+=4,l==1&&(i+=2),d(s,i,20),d(s,i+=2,0),d(s,i+=2,a.cpr?8:0),u(s,i+=2,0),u(s,i+=4,a.crc),u(s,i+=4,h.length),u(s,i+=4,a.usize),d(s,i+=4,r.bin.sizeUTF8(o)),d(s,i+=2,0),i+=2,l==1&&(i+=2,i+=2,u(s,i+=6,c),i+=4),i+=r.bin.writeUTF8(s,i,o),l==0&&(s.set(h,i),i+=h.length),i},r.crc={table:function(){for(var s=new Uint32Array(256),i=0;i<256;i++){for(var o=i,a=0;a<8;a++)1&o?o=3988292384^o>>>1:o>>>=1;s[i]=o}return s}(),update:function(s,i,o,a){for(var l=0;l<a;l++)s=r.crc.table[255&(s^i[o+l])]^s>>>8;return s},crc:function(s,i,o){return 4294967295^r.crc.update(4294967295,s,i,o)}},r.adler=function(s,i,o){for(var a=1,l=0,c=i,u=i+o;c<u;){for(var d=Math.min(c+5552,u);c<d;)l+=a+=s[c++];a%=65521,l%=65521}return l<<16|a},r.bin={readUshort:function(s,i){return s[i]|s[i+1]<<8},writeUshort:function(s,i,o){s[i]=255&o,s[i+1]=o>>8&255},readUint:function(s,i){return 16777216*s[i+3]+(s[i+2]<<16|s[i+1]<<8|s[i])},writeUint:function(s,i,o){s[i]=255&o,s[i+1]=o>>8&255,s[i+2]=o>>16&255,s[i+3]=o>>24&255},readASCII:function(s,i,o){for(var a="",l=0;l<o;l++)a+=String.fromCharCode(s[i+l]);return a},writeASCII:function(s,i,o){for(var a=0;a<o.length;a++)s[i+a]=o.charCodeAt(a)},pad:function(s){return s.length<2?"0"+s:s},readUTF8:function(s,i,o){for(var a,l="",c=0;c<o;c++)l+="%"+r.bin.pad(s[i+c].toString(16));try{a=decodeURIComponent(l)}catch{return r.bin.readASCII(s,i,o)}return a},writeUTF8:function(s,i,o){for(var a=o.length,l=0,c=0;c<a;c++){var u=o.charCodeAt(c);if(!(4294967168&u))s[i+l]=u,l++;else if(!(4294965248&u))s[i+l]=192|u>>6,s[i+l+1]=128|u>>0&63,l+=2;else if(!(4294901760&u))s[i+l]=224|u>>12,s[i+l+1]=128|u>>6&63,s[i+l+2]=128|u>>0&63,l+=3;else{if(4292870144&u)throw"e";s[i+l]=240|u>>18,s[i+l+1]=128|u>>12&63,s[i+l+2]=128|u>>6&63,s[i+l+3]=128|u>>0&63,l+=4}}return l},sizeUTF8:function(s){for(var i=s.length,o=0,a=0;a<i;a++){var l=s.charCodeAt(a);if(!(4294967168&l))o++;else if(!(4294965248&l))o+=2;else if(!(4294901760&l))o+=3;else{if(4292870144&l)throw"e";o+=4}}return o}},r.F={},r.F.deflateRaw=function(s,i,o,a){var l=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][a],c=r.F.U,u=r.F._goodIndex;r.F._hash;var d=r.F._putsE,h=0,f=o<<3,p=0,g=s.length;if(a==0){for(;h<g;)d(i,f,h+(M=Math.min(65535,g-h))==g?1:0),f=r.F._copyExact(s,h,M,i,f+8),h+=M;return f>>>3}var y=c.lits,m=c.strt,v=c.prev,w=0,S=0,T=0,E=0,O=0,b=0;for(g>2&&(m[b=r.F._hash(s,0)]=0),h=0;h<g;h++){if(O=b,h+1<g-2){b=r.F._hash(s,h+1);var k=h+1&32767;v[k]=m[b],m[b]=k}if(p<=h){(w>14e3||S>26697)&&g-h>100&&(p<h&&(y[w]=h-p,w+=2,p=h),f=r.F._writeBlock(h==g-1||p==g?1:0,y,w,E,s,T,h-T,i,f),w=S=E=0,T=h);var N=0;h<g-2&&(N=r.F._bestMatch(s,h,v,O,Math.min(l[2],g-h),l[3]));var M=N>>>16,L=65535&N;if(N!=0){L=65535&N;var $=u(M=N>>>16,c.of0);c.lhst[257+$]++;var P=u(L,c.df0);c.dhst[P]++,E+=c.exb[$]+c.dxb[P],y[w]=M<<23|h-p,y[w+1]=L<<16|$<<8|P,w+=2,p=h+M}else c.lhst[s[h]]++;S++}}for(T==h&&s.length!=0||(p<h&&(y[w]=h-p,w+=2,p=h),f=r.F._writeBlock(1,y,w,E,s,T,h-T,i,f),w=0,S=0,w=S=E=0,T=h);7&f;)f++;return f>>>3},r.F._bestMatch=function(s,i,o,a,l,c){var u=32767&i,d=o[u],h=u-d+32768&32767;if(d==u||a!=r.F._hash(s,i-h))return 0;for(var f=0,p=0,g=Math.min(32767,i);h<=g&&--c!=0&&d!=u;){if(f==0||s[i+f]==s[i+f-h]){var y=r.F._howLong(s,i,h);if(y>f){if(p=h,(f=y)>=l)break;h+2<y&&(y=h+2);for(var m=0,v=0;v<y-2;v++){var w=i-h+v+32768&32767,S=w-o[w]+32768&32767;S>m&&(m=S,d=w)}}}h+=(u=d)-(d=o[u])+32768&32767}return f<<16|p},r.F._howLong=function(s,i,o){if(s[i]!=s[i-o]||s[i+1]!=s[i+1-o]||s[i+2]!=s[i+2-o])return 0;var a=i,l=Math.min(s.length,i+258);for(i+=3;i<l&&s[i]==s[i-o];)i++;return i-a},r.F._hash=function(s,i){return(s[i]<<8|s[i+1])+(s[i+2]<<4)&65535},r.saved=0,r.F._writeBlock=function(s,i,o,a,l,c,u,d,h){var f,p,g,y,m,v,w,S,T,E=r.F.U,O=r.F._putsF,b=r.F._putsE;E.lhst[256]++,p=(f=r.F.getTrees())[0],g=f[1],y=f[2],m=f[3],v=f[4],w=f[5],S=f[6],T=f[7];var k=32+(h+3&7?8-(h+3&7):0)+(u<<3),N=a+r.F.contSize(E.fltree,E.lhst)+r.F.contSize(E.fdtree,E.dhst),M=a+r.F.contSize(E.ltree,E.lhst)+r.F.contSize(E.dtree,E.dhst);M+=14+3*w+r.F.contSize(E.itree,E.ihst)+(2*E.ihst[16]+3*E.ihst[17]+7*E.ihst[18]);for(var L=0;L<286;L++)E.lhst[L]=0;for(L=0;L<30;L++)E.dhst[L]=0;for(L=0;L<19;L++)E.ihst[L]=0;var $=k<N&&k<M?0:N<M?1:2;if(O(d,h,s),O(d,h+1,$),h+=3,$==0){for(;7&h;)h++;h=r.F._copyExact(l,c,u,d,h)}else{var P,U;if($==1&&(P=E.fltree,U=E.fdtree),$==2){r.F.makeCodes(E.ltree,p),r.F.revCodes(E.ltree,p),r.F.makeCodes(E.dtree,g),r.F.revCodes(E.dtree,g),r.F.makeCodes(E.itree,y),r.F.revCodes(E.itree,y),P=E.ltree,U=E.dtree,b(d,h,m-257),b(d,h+=5,v-1),b(d,h+=5,w-4),h+=4;for(var R=0;R<w;R++)b(d,h+3*R,E.itree[1+(E.ordr[R]<<1)]);h+=3*w,h=r.F._codeTiny(S,E.itree,d,h),h=r.F._codeTiny(T,E.itree,d,h)}for(var C=c,D=0;D<o;D+=2){for(var j=i[D],F=j>>>23,Y=C+(8388607&j);C<Y;)h=r.F._writeLit(l[C++],P,d,h);if(F!=0){var Q=i[D+1],W=Q>>16,G=Q>>8&255,H=255&Q;b(d,h=r.F._writeLit(257+G,P,d,h),F-E.of0[G]),h+=E.exb[G],O(d,h=r.F._writeLit(H,U,d,h),W-E.df0[H]),h+=E.dxb[H],C+=F}}h=r.F._writeLit(256,P,d,h)}return h},r.F._copyExact=function(s,i,o,a,l){var c=l>>>3;return a[c]=o,a[c+1]=o>>>8,a[c+2]=255-a[c],a[c+3]=255-a[c+1],c+=4,a.set(new Uint8Array(s.buffer,i,o),c),l+(o+4<<3)},r.F.getTrees=function(){for(var s=r.F.U,i=r.F._hufTree(s.lhst,s.ltree,15),o=r.F._hufTree(s.dhst,s.dtree,15),a=[],l=r.F._lenCodes(s.ltree,a),c=[],u=r.F._lenCodes(s.dtree,c),d=0;d<a.length;d+=2)s.ihst[a[d]]++;for(d=0;d<c.length;d+=2)s.ihst[c[d]]++;for(var h=r.F._hufTree(s.ihst,s.itree,7),f=19;f>4&&s.itree[1+(s.ordr[f-1]<<1)]==0;)f--;return[i,o,h,l,u,f,a,c]},r.F.getSecond=function(s){for(var i=[],o=0;o<s.length;o+=2)i.push(s[o+1]);return i},r.F.nonZero=function(s){for(var i="",o=0;o<s.length;o+=2)s[o+1]!=0&&(i+=(o>>1)+",");return i},r.F.contSize=function(s,i){for(var o=0,a=0;a<i.length;a++)o+=i[a]*s[1+(a<<1)];return o},r.F._codeTiny=function(s,i,o,a){for(var l=0;l<s.length;l+=2){var c=s[l],u=s[l+1];a=r.F._writeLit(c,i,o,a);var d=c==16?2:c==17?3:7;c>15&&(r.F._putsE(o,a,u,d),a+=d)}return a},r.F._lenCodes=function(s,i){for(var o=s.length;o!=2&&s[o-1]==0;)o-=2;for(var a=0;a<o;a+=2){var l=s[a+1],c=a+3<o?s[a+3]:-1,u=a+5<o?s[a+5]:-1,d=a==0?-1:s[a-1];if(l==0&&c==l&&u==l){for(var h=a+5;h+2<o&&s[h+2]==l;)h+=2;(f=Math.min(h+1-a>>>1,138))<11?i.push(17,f-3):i.push(18,f-11),a+=2*f-2}else if(l==d&&c==l&&u==l){for(h=a+5;h+2<o&&s[h+2]==l;)h+=2;var f=Math.min(h+1-a>>>1,6);i.push(16,f-3),a+=2*f-2}else i.push(l,0)}return o>>>1},r.F._hufTree=function(s,i,o){var a=[],l=s.length,c=i.length,u=0;for(u=0;u<c;u+=2)i[u]=0,i[u+1]=0;for(u=0;u<l;u++)s[u]!=0&&a.push({lit:u,f:s[u]});var d=a.length,h=a.slice(0);if(d==0)return 0;if(d==1){var f=a[0].lit;return h=f==0?1:0,i[1+(f<<1)]=1,i[1+(h<<1)]=1,1}a.sort(function(S,T){return S.f-T.f});var p=a[0],g=a[1],y=0,m=1,v=2;for(a[0]={lit:-1,f:p.f+g.f,l:p,r:g,d:0};m!=d-1;)p=y!=m&&(v==d||a[y].f<a[v].f)?a[y++]:a[v++],g=y!=m&&(v==d||a[y].f<a[v].f)?a[y++]:a[v++],a[m++]={lit:-1,f:p.f+g.f,l:p,r:g};var w=r.F.setDepth(a[m-1],0);for(w>o&&(r.F.restrictDepth(h,o,w),w=o),u=0;u<d;u++)i[1+(h[u].lit<<1)]=h[u].d;return w},r.F.setDepth=function(s,i){return s.lit!=-1?(s.d=i,i):Math.max(r.F.setDepth(s.l,i+1),r.F.setDepth(s.r,i+1))},r.F.restrictDepth=function(s,i,o){var a=0,l=1<<o-i,c=0;for(s.sort(function(d,h){return h.d==d.d?d.f-h.f:h.d-d.d}),a=0;a<s.length&&s[a].d>i;a++){var u=s[a].d;s[a].d=i,c+=l-(1<<o-u)}for(c>>>=o-i;c>0;)(u=s[a].d)<i?(s[a].d++,c-=1<<i-u-1):a++;for(;a>=0;a--)s[a].d==i&&c<0&&(s[a].d--,c++);c!=0&&console.log("debt left")},r.F._goodIndex=function(s,i){var o=0;return i[16|o]<=s&&(o|=16),i[8|o]<=s&&(o|=8),i[4|o]<=s&&(o|=4),i[2|o]<=s&&(o|=2),i[1|o]<=s&&(o|=1),o},r.F._writeLit=function(s,i,o,a){return r.F._putsF(o,a,i[s<<1]),a+i[1+(s<<1)]},r.F.inflate=function(s,i){var o=Uint8Array;if(s[0]==3&&s[1]==0)return i||new o(0);var a=r.F,l=a._bitsF,c=a._bitsE,u=a._decodeTiny,d=a.makeCodes,h=a.codes2map,f=a._get17,p=a.U,g=i==null;g&&(i=new o(s.length>>>2<<3));for(var y,m,v=0,w=0,S=0,T=0,E=0,O=0,b=0,k=0,N=0;v==0;)if(v=l(s,N,1),w=l(s,N+1,2),N+=3,w!=0){if(g&&(i=r.F._check(i,k+(1<<17))),w==1&&(y=p.flmap,m=p.fdmap,O=511,b=31),w==2){S=c(s,N,5)+257,T=c(s,N+5,5)+1,E=c(s,N+10,4)+4,N+=14;for(var M=0;M<38;M+=2)p.itree[M]=0,p.itree[M+1]=0;var L=1;for(M=0;M<E;M++){var $=c(s,N+3*M,3);p.itree[1+(p.ordr[M]<<1)]=$,$>L&&(L=$)}N+=3*E,d(p.itree,L),h(p.itree,L,p.imap),y=p.lmap,m=p.dmap,N=u(p.imap,(1<<L)-1,S+T,s,N,p.ttree);var P=a._copyOut(p.ttree,0,S,p.ltree);O=(1<<P)-1;var U=a._copyOut(p.ttree,S,T,p.dtree);b=(1<<U)-1,d(p.ltree,P),h(p.ltree,P,y),d(p.dtree,U),h(p.dtree,U,m)}for(;;){var R=y[f(s,N)&O];N+=15&R;var C=R>>>4;if(!(C>>>8))i[k++]=C;else{if(C==256)break;var D=k+C-254;if(C>264){var j=p.ldef[C-257];D=k+(j>>>3)+c(s,N,7&j),N+=7&j}var F=m[f(s,N)&b];N+=15&F;var Y=F>>>4,Q=p.ddef[Y],W=(Q>>>4)+l(s,N,15&Q);for(N+=15&Q,g&&(i=r.F._check(i,k+(1<<17)));k<D;)i[k]=i[k++-W],i[k]=i[k++-W],i[k]=i[k++-W],i[k]=i[k++-W];k=D}}}else{7&N&&(N+=8-(7&N));var G=4+(N>>>3),H=s[G-4]|s[G-3]<<8;g&&(i=r.F._check(i,k+H)),i.set(new o(s.buffer,s.byteOffset+G,H),k),N=G+H<<3,k+=H}return i.length==k?i:i.slice(0,k)},r.F._check=function(s,i){var o=s.length;if(i<=o)return s;var a=new Uint8Array(Math.max(o<<1,i));return a.set(s,0),a},r.F._decodeTiny=function(s,i,o,a,l,c){for(var u=r.F._bitsE,d=r.F._get17,h=0;h<o;){var f=s[d(a,l)&i];l+=15&f;var p=f>>>4;if(p<=15)c[h]=p,h++;else{var g=0,y=0;p==16?(y=3+u(a,l,2),l+=2,g=c[h-1]):p==17?(y=3+u(a,l,3),l+=3):p==18&&(y=11+u(a,l,7),l+=7);for(var m=h+y;h<m;)c[h]=g,h++}}return l},r.F._copyOut=function(s,i,o,a){for(var l=0,c=0,u=a.length>>>1;c<o;){var d=s[c+i];a[c<<1]=0,a[1+(c<<1)]=d,d>l&&(l=d),c++}for(;c<u;)a[c<<1]=0,a[1+(c<<1)]=0,c++;return l},r.F.makeCodes=function(s,i){for(var o,a,l,c,u=r.F.U,d=s.length,h=u.bl_count,f=0;f<=i;f++)h[f]=0;for(f=1;f<d;f+=2)h[s[f]]++;var p=u.next_code;for(o=0,h[0]=0,a=1;a<=i;a++)o=o+h[a-1]<<1,p[a]=o;for(l=0;l<d;l+=2)(c=s[l+1])!=0&&(s[l]=p[c],p[c]++)},r.F.codes2map=function(s,i,o){for(var a=s.length,l=r.F.U.rev15,c=0;c<a;c+=2)if(s[c+1]!=0)for(var u=c>>1,d=s[c+1],h=u<<4|d,f=i-d,p=s[c]<<f,g=p+(1<<f);p!=g;)o[l[p]>>>15-i]=h,p++},r.F.revCodes=function(s,i){for(var o=r.F.U.rev15,a=15-i,l=0;l<s.length;l+=2){var c=s[l]<<i-s[l+1];s[l]=o[c]>>>a}},r.F._putsE=function(s,i,o){o<<=7&i;var a=i>>>3;s[a]|=o,s[a+1]|=o>>>8},r.F._putsF=function(s,i,o){o<<=7&i;var a=i>>>3;s[a]|=o,s[a+1]|=o>>>8,s[a+2]|=o>>>16},r.F._bitsE=function(s,i,o){return(s[i>>>3]|s[1+(i>>>3)]<<8)>>>(7&i)&(1<<o)-1},r.F._bitsF=function(s,i,o){return(s[i>>>3]|s[1+(i>>>3)]<<8|s[2+(i>>>3)]<<16)>>>(7&i)&(1<<o)-1},r.F._get17=function(s,i){return(s[i>>>3]|s[1+(i>>>3)]<<8|s[2+(i>>>3)]<<16)>>>(7&i)},r.F._get25=function(s,i){return(s[i>>>3]|s[1+(i>>>3)]<<8|s[2+(i>>>3)]<<16|s[3+(i>>>3)]<<24)>>>(7&i)},r.F.U=(e=Uint16Array,n=Uint32Array,{next_code:new e(16),bl_count:new e(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new e(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new n(32),flmap:new e(512),fltree:[],fdmap:new e(32),fdtree:[],lmap:new e(32768),ltree:[],ttree:[],dmap:new e(32768),dtree:[],imap:new e(512),itree:[],rev15:new e(32768),lhst:new n(286),dhst:new n(30),ihst:new n(19),lits:new n(15e3),strt:new e(65536),prev:new e(32768)}),function(){for(var s=r.F.U,i=0;i<32768;i++){var o=i;o=(4278255360&(o=(4042322160&(o=(3435973836&(o=(2863311530&o)>>>1|(1431655765&o)<<1))>>>2|(858993459&o)<<2))>>>4|(252645135&o)<<4))>>>8|(16711935&o)<<8,s.rev15[i]=(o>>>16|o<<16)>>>17}function a(l,c,u){for(;c--!=0;)l.push(0,u)}for(i=0;i<32;i++)s.ldef[i]=s.of0[i]<<3|s.exb[i],s.ddef[i]=s.df0[i]<<4|s.dxb[i];a(s.fltree,144,8),a(s.fltree,112,9),a(s.fltree,24,7),a(s.fltree,8,8),r.F.makeCodes(s.fltree,9),r.F.codes2map(s.fltree,9,s.flmap),r.F.revCodes(s.fltree,9),a(s.fdtree,32,5),r.F.makeCodes(s.fdtree,5),r.F.codes2map(s.fdtree,5,s.fdmap),r.F.revCodes(s.fdtree,5),a(s.itree,19,0),a(s.ltree,286,0),a(s.dtree,30,0),a(s.ttree,320,0)}()})();var sD=tD({__proto__:null,default:pd},[pd]);const pr=function(){var t={nextZero(u,d){for(;u[d]!=0;)d++;return d},readUshort:(u,d)=>u[d]<<8|u[d+1],writeUshort(u,d,h){u[d]=h>>8&255,u[d+1]=255&h},readUint:(u,d)=>16777216*u[d]+(u[d+1]<<16|u[d+2]<<8|u[d+3]),writeUint(u,d,h){u[d]=h>>24&255,u[d+1]=h>>16&255,u[d+2]=h>>8&255,u[d+3]=255&h},readASCII(u,d,h){let f="";for(let p=0;p<h;p++)f+=String.fromCharCode(u[d+p]);return f},writeASCII(u,d,h){for(let f=0;f<h.length;f++)u[d+f]=h.charCodeAt(f)},readBytes(u,d,h){const f=[];for(let p=0;p<h;p++)f.push(u[d+p]);return f},pad:u=>u.length<2?`0${u}`:u,readUTF8(u,d,h){let f,p="";for(let g=0;g<h;g++)p+=`%${t.pad(u[d+g].toString(16))}`;try{f=decodeURIComponent(p)}catch{return t.readASCII(u,d,h)}return f}};function e(u,d,h,f){const p=d*h,g=i(f),y=Math.ceil(d*g/8),m=new Uint8Array(4*p),v=new Uint32Array(m.buffer),{ctype:w}=f,{depth:S}=f,T=t.readUshort;if(w==6){const j=p<<2;if(S==8)for(var E=0;E<j;E+=4)m[E]=u[E],m[E+1]=u[E+1],m[E+2]=u[E+2],m[E+3]=u[E+3];if(S==16)for(E=0;E<j;E++)m[E]=u[E<<1]}else if(w==2){const j=f.tabs.tRNS;if(j==null){if(S==8)for(E=0;E<p;E++){var O=3*E;v[E]=255<<24|u[O+2]<<16|u[O+1]<<8|u[O]}if(S==16)for(E=0;E<p;E++)O=6*E,v[E]=255<<24|u[O+4]<<16|u[O+2]<<8|u[O]}else{var b=j[0];const F=j[1],Y=j[2];if(S==8)for(E=0;E<p;E++){var k=E<<2;O=3*E,v[E]=255<<24|u[O+2]<<16|u[O+1]<<8|u[O],u[O]==b&&u[O+1]==F&&u[O+2]==Y&&(m[k+3]=0)}if(S==16)for(E=0;E<p;E++)k=E<<2,O=6*E,v[E]=255<<24|u[O+4]<<16|u[O+2]<<8|u[O],T(u,O)==b&&T(u,O+2)==F&&T(u,O+4)==Y&&(m[k+3]=0)}}else if(w==3){const j=f.tabs.PLTE,F=f.tabs.tRNS,Y=F?F.length:0;if(S==1)for(var N=0;N<h;N++){var M=N*y,L=N*d;for(E=0;E<d;E++){k=L+E<<2;var $=3*(P=u[M+(E>>3)]>>7-((7&E)<<0)&1);m[k]=j[$],m[k+1]=j[$+1],m[k+2]=j[$+2],m[k+3]=P<Y?F[P]:255}}if(S==2)for(N=0;N<h;N++)for(M=N*y,L=N*d,E=0;E<d;E++)k=L+E<<2,$=3*(P=u[M+(E>>2)]>>6-((3&E)<<1)&3),m[k]=j[$],m[k+1]=j[$+1],m[k+2]=j[$+2],m[k+3]=P<Y?F[P]:255;if(S==4)for(N=0;N<h;N++)for(M=N*y,L=N*d,E=0;E<d;E++)k=L+E<<2,$=3*(P=u[M+(E>>1)]>>4-((1&E)<<2)&15),m[k]=j[$],m[k+1]=j[$+1],m[k+2]=j[$+2],m[k+3]=P<Y?F[P]:255;if(S==8)for(E=0;E<p;E++){var P;k=E<<2,$=3*(P=u[E]),m[k]=j[$],m[k+1]=j[$+1],m[k+2]=j[$+2],m[k+3]=P<Y?F[P]:255}}else if(w==4){if(S==8)for(E=0;E<p;E++){k=E<<2;var U=u[R=E<<1];m[k]=U,m[k+1]=U,m[k+2]=U,m[k+3]=u[R+1]}if(S==16)for(E=0;E<p;E++){var R;k=E<<2,U=u[R=E<<2],m[k]=U,m[k+1]=U,m[k+2]=U,m[k+3]=u[R+2]}}else if(w==0)for(b=f.tabs.tRNS?f.tabs.tRNS:-1,N=0;N<h;N++){const j=N*y,F=N*d;if(S==1)for(var C=0;C<d;C++){var D=(U=255*(u[j+(C>>>3)]>>>7-(7&C)&1))==255*b?0:255;v[F+C]=D<<24|U<<16|U<<8|U}else if(S==2)for(C=0;C<d;C++)D=(U=85*(u[j+(C>>>2)]>>>6-((3&C)<<1)&3))==85*b?0:255,v[F+C]=D<<24|U<<16|U<<8|U;else if(S==4)for(C=0;C<d;C++)D=(U=17*(u[j+(C>>>1)]>>>4-((1&C)<<2)&15))==17*b?0:255,v[F+C]=D<<24|U<<16|U<<8|U;else if(S==8)for(C=0;C<d;C++)D=(U=u[j+C])==b?0:255,v[F+C]=D<<24|U<<16|U<<8|U;else if(S==16)for(C=0;C<d;C++)U=u[j+(C<<1)],D=T(u,j+(C<<1))==b?0:255,v[F+C]=D<<24|U<<16|U<<8|U}return m}function n(u,d,h,f){const p=i(u),g=Math.ceil(h*p/8),y=new Uint8Array((g+1+u.interlace)*f);return d=u.tabs.CgBI?s(d,y):r(d,y),u.interlace==0?d=o(d,u,0,h,f):u.interlace==1&&(d=function(v,w){const S=w.width,T=w.height,E=i(w),O=E>>3,b=Math.ceil(S*E/8),k=new Uint8Array(T*b);let N=0;const M=[0,0,4,0,2,0,1],L=[0,4,0,2,0,1,0],$=[8,8,8,4,4,2,2],P=[8,8,4,4,2,2,1];let U=0;for(;U<7;){const C=$[U],D=P[U];let j=0,F=0,Y=M[U];for(;Y<T;)Y+=C,F++;let Q=L[U];for(;Q<S;)Q+=D,j++;const W=Math.ceil(j*E/8);o(v,w,N,j,F);let G=0,H=M[U];for(;H<T;){let se=L[U],be=N+G*W<<3;for(;se<S;){var R;if(E==1&&(R=(R=v[be>>3])>>7-(7&be)&1,k[H*b+(se>>3)]|=R<<7-((7&se)<<0)),E==2&&(R=(R=v[be>>3])>>6-(7&be)&3,k[H*b+(se>>2)]|=R<<6-((3&se)<<1)),E==4&&(R=(R=v[be>>3])>>4-(7&be)&15,k[H*b+(se>>1)]|=R<<4-((1&se)<<2)),E>=8){const X=H*b+se*O;for(let re=0;re<O;re++)k[X+re]=v[(be>>3)+re]}be+=E,se+=D}G++,H+=C}j*F!=0&&(N+=F*(1+W)),U+=1}return k}(d,u)),d}function r(u,d){return s(new Uint8Array(u.buffer,2,u.length-6),d)}var s=function(){const u={H:{}};return u.H.N=function(d,h){const f=Uint8Array;let p,g,y=0,m=0,v=0,w=0,S=0,T=0,E=0,O=0,b=0;if(d[0]==3&&d[1]==0)return h||new f(0);const k=u.H,N=k.b,M=k.e,L=k.R,$=k.n,P=k.A,U=k.Z,R=k.m,C=h==null;for(C&&(h=new f(d.length>>>2<<5));y==0;)if(y=N(d,b,1),m=N(d,b+1,2),b+=3,m!=0){if(C&&(h=u.H.W(h,O+(1<<17))),m==1&&(p=R.J,g=R.h,T=511,E=31),m==2){v=M(d,b,5)+257,w=M(d,b+5,5)+1,S=M(d,b+10,4)+4,b+=14;let j=1;for(var D=0;D<38;D+=2)R.Q[D]=0,R.Q[D+1]=0;for(D=0;D<S;D++){const Q=M(d,b+3*D,3);R.Q[1+(R.X[D]<<1)]=Q,Q>j&&(j=Q)}b+=3*S,$(R.Q,j),P(R.Q,j,R.u),p=R.w,g=R.d,b=L(R.u,(1<<j)-1,v+w,d,b,R.v);const F=k.V(R.v,0,v,R.C);T=(1<<F)-1;const Y=k.V(R.v,v,w,R.D);E=(1<<Y)-1,$(R.C,F),P(R.C,F,p),$(R.D,Y),P(R.D,Y,g)}for(;;){const j=p[U(d,b)&T];b+=15&j;const F=j>>>4;if(!(F>>>8))h[O++]=F;else{if(F==256)break;{let Y=O+F-254;if(F>264){const se=R.q[F-257];Y=O+(se>>>3)+M(d,b,7&se),b+=7&se}const Q=g[U(d,b)&E];b+=15&Q;const W=Q>>>4,G=R.c[W],H=(G>>>4)+N(d,b,15&G);for(b+=15&G;O<Y;)h[O]=h[O++-H],h[O]=h[O++-H],h[O]=h[O++-H],h[O]=h[O++-H];O=Y}}}}else{7&b&&(b+=8-(7&b));const j=4+(b>>>3),F=d[j-4]|d[j-3]<<8;C&&(h=u.H.W(h,O+F)),h.set(new f(d.buffer,d.byteOffset+j,F),O),b=j+F<<3,O+=F}return h.length==O?h:h.slice(0,O)},u.H.W=function(d,h){const f=d.length;if(h<=f)return d;const p=new Uint8Array(f<<1);return p.set(d,0),p},u.H.R=function(d,h,f,p,g,y){const m=u.H.e,v=u.H.Z;let w=0;for(;w<f;){const S=d[v(p,g)&h];g+=15&S;const T=S>>>4;if(T<=15)y[w]=T,w++;else{let E=0,O=0;T==16?(O=3+m(p,g,2),g+=2,E=y[w-1]):T==17?(O=3+m(p,g,3),g+=3):T==18&&(O=11+m(p,g,7),g+=7);const b=w+O;for(;w<b;)y[w]=E,w++}}return g},u.H.V=function(d,h,f,p){let g=0,y=0;const m=p.length>>>1;for(;y<f;){const v=d[y+h];p[y<<1]=0,p[1+(y<<1)]=v,v>g&&(g=v),y++}for(;y<m;)p[y<<1]=0,p[1+(y<<1)]=0,y++;return g},u.H.n=function(d,h){const f=u.H.m,p=d.length;let g,y,m,v;const w=f.j;for(var S=0;S<=h;S++)w[S]=0;for(S=1;S<p;S+=2)w[d[S]]++;const T=f.K;for(g=0,w[0]=0,y=1;y<=h;y++)g=g+w[y-1]<<1,T[y]=g;for(m=0;m<p;m+=2)v=d[m+1],v!=0&&(d[m]=T[v],T[v]++)},u.H.A=function(d,h,f){const p=d.length,g=u.H.m.r;for(let y=0;y<p;y+=2)if(d[y+1]!=0){const m=y>>1,v=d[y+1],w=m<<4|v,S=h-v;let T=d[y]<<S;const E=T+(1<<S);for(;T!=E;)f[g[T]>>>15-h]=w,T++}},u.H.l=function(d,h){const f=u.H.m.r,p=15-h;for(let g=0;g<d.length;g+=2){const y=d[g]<<h-d[g+1];d[g]=f[y]>>>p}},u.H.M=function(d,h,f){f<<=7&h;const p=h>>>3;d[p]|=f,d[p+1]|=f>>>8},u.H.I=function(d,h,f){f<<=7&h;const p=h>>>3;d[p]|=f,d[p+1]|=f>>>8,d[p+2]|=f>>>16},u.H.e=function(d,h,f){return(d[h>>>3]|d[1+(h>>>3)]<<8)>>>(7&h)&(1<<f)-1},u.H.b=function(d,h,f){return(d[h>>>3]|d[1+(h>>>3)]<<8|d[2+(h>>>3)]<<16)>>>(7&h)&(1<<f)-1},u.H.Z=function(d,h){return(d[h>>>3]|d[1+(h>>>3)]<<8|d[2+(h>>>3)]<<16)>>>(7&h)},u.H.i=function(d,h){return(d[h>>>3]|d[1+(h>>>3)]<<8|d[2+(h>>>3)]<<16|d[3+(h>>>3)]<<24)>>>(7&h)},u.H.m=function(){const d=Uint16Array,h=Uint32Array;return{K:new d(16),j:new d(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new d(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new h(32),J:new d(512),_:[],h:new d(32),$:[],w:new d(32768),C:[],v:[],d:new d(32768),D:[],u:new d(512),Q:[],r:new d(32768),s:new h(286),Y:new h(30),a:new h(19),t:new h(15e3),k:new d(65536),g:new d(32768)}}(),function(){const d=u.H.m;for(var h=0;h<32768;h++){let p=h;p=(2863311530&p)>>>1|(1431655765&p)<<1,p=(3435973836&p)>>>2|(858993459&p)<<2,p=(4042322160&p)>>>4|(252645135&p)<<4,p=(4278255360&p)>>>8|(16711935&p)<<8,d.r[h]=(p>>>16|p<<16)>>>17}function f(p,g,y){for(;g--!=0;)p.push(0,y)}for(h=0;h<32;h++)d.q[h]=d.S[h]<<3|d.T[h],d.c[h]=d.p[h]<<4|d.z[h];f(d._,144,8),f(d._,112,9),f(d._,24,7),f(d._,8,8),u.H.n(d._,9),u.H.A(d._,9,d.J),u.H.l(d._,9),f(d.$,32,5),u.H.n(d.$,5),u.H.A(d.$,5,d.h),u.H.l(d.$,5),f(d.Q,19,0),f(d.C,286,0),f(d.D,30,0),f(d.v,320,0)}(),u.H.N}();function i(u){return[1,null,3,1,2,null,4][u.ctype]*u.depth}function o(u,d,h,f,p){let g=i(d);const y=Math.ceil(f*g/8);let m,v;g=Math.ceil(g/8);let w=u[h],S=0;if(w>1&&(u[h]=[0,0,1][w-2]),w==3)for(S=g;S<y;S++)u[S+1]=u[S+1]+(u[S+1-g]>>>1)&255;for(let T=0;T<p;T++)if(m=h+T*y,v=m+T+1,w=u[v-1],S=0,w==0)for(;S<y;S++)u[m+S]=u[v+S];else if(w==1){for(;S<g;S++)u[m+S]=u[v+S];for(;S<y;S++)u[m+S]=u[v+S]+u[m+S-g]}else if(w==2)for(;S<y;S++)u[m+S]=u[v+S]+u[m+S-y];else if(w==3){for(;S<g;S++)u[m+S]=u[v+S]+(u[m+S-y]>>>1);for(;S<y;S++)u[m+S]=u[v+S]+(u[m+S-y]+u[m+S-g]>>>1)}else{for(;S<g;S++)u[m+S]=u[v+S]+a(0,u[m+S-y],0);for(;S<y;S++)u[m+S]=u[v+S]+a(u[m+S-g],u[m+S-y],u[m+S-g-y])}return u}function a(u,d,h){const f=u+d-h,p=f-u,g=f-d,y=f-h;return p*p<=g*g&&p*p<=y*y?u:g*g<=y*y?d:h}function l(u,d,h){h.width=t.readUint(u,d),d+=4,h.height=t.readUint(u,d),d+=4,h.depth=u[d],d++,h.ctype=u[d],d++,h.compress=u[d],d++,h.filter=u[d],d++,h.interlace=u[d],d++}function c(u,d,h,f,p,g,y,m,v){const w=Math.min(d,p),S=Math.min(h,g);let T=0,E=0;for(let U=0;U<S;U++)for(let R=0;R<w;R++)if(y>=0&&m>=0?(T=U*d+R<<2,E=(m+U)*p+y+R<<2):(T=(-m+U)*d-y+R<<2,E=U*p+R<<2),v==0)f[E]=u[T],f[E+1]=u[T+1],f[E+2]=u[T+2],f[E+3]=u[T+3];else if(v==1){var O=u[T+3]*.00392156862745098,b=u[T]*O,k=u[T+1]*O,N=u[T+2]*O,M=f[E+3]*(1/255),L=f[E]*M,$=f[E+1]*M,P=f[E+2]*M;const C=1-O,D=O+M*C,j=D==0?0:1/D;f[E+3]=255*D,f[E+0]=(b+L*C)*j,f[E+1]=(k+$*C)*j,f[E+2]=(N+P*C)*j}else if(v==2)O=u[T+3],b=u[T],k=u[T+1],N=u[T+2],M=f[E+3],L=f[E],$=f[E+1],P=f[E+2],O==M&&b==L&&k==$&&N==P?(f[E]=0,f[E+1]=0,f[E+2]=0,f[E+3]=0):(f[E]=b,f[E+1]=k,f[E+2]=N,f[E+3]=O);else if(v==3){if(O=u[T+3],b=u[T],k=u[T+1],N=u[T+2],M=f[E+3],L=f[E],$=f[E+1],P=f[E+2],O==M&&b==L&&k==$&&N==P)continue;if(O<220&&M>20)return!1}return!0}return{decode:function(d){const h=new Uint8Array(d);let f=8;const p=t,g=p.readUshort,y=p.readUint,m={tabs:{},frames:[]},v=new Uint8Array(h.length);let w,S=0,T=0;const E=[137,80,78,71,13,10,26,10];for(var O=0;O<8;O++)if(h[O]!=E[O])throw"The input is not a PNG file!";for(;f<h.length;){const U=p.readUint(h,f);f+=4;const R=p.readASCII(h,f,4);if(f+=4,R=="IHDR")l(h,f,m);else if(R=="iCCP"){for(var b=f;h[b]!=0;)b++;p.readASCII(h,f,b-f),h[b+1];const C=h.slice(b+2,f+U);let D=null;try{D=r(C)}catch{D=s(C)}m.tabs[R]=D}else if(R=="CgBI")m.tabs[R]=h.slice(f,f+4);else if(R=="IDAT"){for(O=0;O<U;O++)v[S+O]=h[f+O];S+=U}else if(R=="acTL")m.tabs[R]={num_frames:y(h,f),num_plays:y(h,f+4)},w=new Uint8Array(h.length);else if(R=="fcTL"){T!=0&&((P=m.frames[m.frames.length-1]).data=n(m,w.slice(0,T),P.rect.width,P.rect.height),T=0);const C={x:y(h,f+12),y:y(h,f+16),width:y(h,f+4),height:y(h,f+8)};let D=g(h,f+22);D=g(h,f+20)/(D==0?100:D);const j={rect:C,delay:Math.round(1e3*D),dispose:h[f+24],blend:h[f+25]};m.frames.push(j)}else if(R=="fdAT"){for(O=0;O<U-4;O++)w[T+O]=h[f+O+4];T+=U-4}else if(R=="pHYs")m.tabs[R]=[p.readUint(h,f),p.readUint(h,f+4),h[f+8]];else if(R=="cHRM")for(m.tabs[R]=[],O=0;O<8;O++)m.tabs[R].push(p.readUint(h,f+4*O));else if(R=="tEXt"||R=="zTXt"){m.tabs[R]==null&&(m.tabs[R]={});var k=p.nextZero(h,f),N=p.readASCII(h,f,k-f),M=f+U-k-1;if(R=="tEXt")$=p.readASCII(h,k+1,M);else{var L=r(h.slice(k+2,k+2+M));$=p.readUTF8(L,0,L.length)}m.tabs[R][N]=$}else if(R=="iTXt"){m.tabs[R]==null&&(m.tabs[R]={}),k=0,b=f,k=p.nextZero(h,b),N=p.readASCII(h,b,k-b);const C=h[b=k+1];var $;h[b+1],b+=2,k=p.nextZero(h,b),p.readASCII(h,b,k-b),b=k+1,k=p.nextZero(h,b),p.readUTF8(h,b,k-b),M=U-((b=k+1)-f),C==0?$=p.readUTF8(h,b,M):(L=r(h.slice(b,b+M)),$=p.readUTF8(L,0,L.length)),m.tabs[R][N]=$}else if(R=="PLTE")m.tabs[R]=p.readBytes(h,f,U);else if(R=="hIST"){const C=m.tabs.PLTE.length/3;for(m.tabs[R]=[],O=0;O<C;O++)m.tabs[R].push(g(h,f+2*O))}else if(R=="tRNS")m.ctype==3?m.tabs[R]=p.readBytes(h,f,U):m.ctype==0?m.tabs[R]=g(h,f):m.ctype==2&&(m.tabs[R]=[g(h,f),g(h,f+2),g(h,f+4)]);else if(R=="gAMA")m.tabs[R]=p.readUint(h,f)/1e5;else if(R=="sRGB")m.tabs[R]=h[f];else if(R=="bKGD")m.ctype==0||m.ctype==4?m.tabs[R]=[g(h,f)]:m.ctype==2||m.ctype==6?m.tabs[R]=[g(h,f),g(h,f+2),g(h,f+4)]:m.ctype==3&&(m.tabs[R]=h[f]);else if(R=="IEND")break;f+=U,p.readUint(h,f),f+=4}var P;return T!=0&&((P=m.frames[m.frames.length-1]).data=n(m,w.slice(0,T),P.rect.width,P.rect.height)),m.data=n(m,v,m.width,m.height),delete m.compress,delete m.interlace,delete m.filter,m},toRGBA8:function(d){const h=d.width,f=d.height;if(d.tabs.acTL==null)return[e(d.data,h,f,d).buffer];const p=[];d.frames[0].data==null&&(d.frames[0].data=d.data);const g=h*f*4,y=new Uint8Array(g),m=new Uint8Array(g),v=new Uint8Array(g);for(let S=0;S<d.frames.length;S++){const T=d.frames[S],E=T.rect.x,O=T.rect.y,b=T.rect.width,k=T.rect.height,N=e(T.data,b,k,d);if(S!=0)for(var w=0;w<g;w++)v[w]=y[w];if(T.blend==0?c(N,b,k,y,h,f,E,O,0):T.blend==1&&c(N,b,k,y,h,f,E,O,1),p.push(y.buffer.slice(0)),T.dispose!=0){if(T.dispose==1)c(m,b,k,y,h,f,E,O,0);else if(T.dispose==2)for(w=0;w<g;w++)y[w]=v[w]}}return p},_paeth:a,_copyTile:c,_bin:t}}();(function(){const{_copyTile:t}=pr,{_bin:e}=pr,n=pr._paeth;var r={table:function(){const b=new Uint32Array(256);for(let k=0;k<256;k++){let N=k;for(let M=0;M<8;M++)1&N?N=3988292384^N>>>1:N>>>=1;b[k]=N}return b}(),update(b,k,N,M){for(let L=0;L<M;L++)b=r.table[255&(b^k[N+L])]^b>>>8;return b},crc:(b,k,N)=>4294967295^r.update(4294967295,b,k,N)};function s(b,k,N,M){k[N]+=b[0]*M>>4,k[N+1]+=b[1]*M>>4,k[N+2]+=b[2]*M>>4,k[N+3]+=b[3]*M>>4}function i(b){return Math.max(0,Math.min(255,b))}function o(b,k){const N=b[0]-k[0],M=b[1]-k[1],L=b[2]-k[2],$=b[3]-k[3];return N*N+M*M+L*L+$*$}function a(b,k,N,M,L,$,P){P==null&&(P=1);const U=M.length,R=[];for(var C=0;C<U;C++){const H=M[C];R.push([H>>>0&255,H>>>8&255,H>>>16&255,H>>>24&255])}for(C=0;C<U;C++){let H=4294967295;for(var D=0,j=0;j<U;j++){var F=o(R[C],R[j]);j!=C&&F<H&&(H=F,D=j)}}const Y=new Uint32Array(L.buffer),Q=new Int16Array(k*N*4),W=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5];for(C=0;C<W.length;C++)W[C]=255*((W[C]+.5)/16-.5);for(let H=0;H<N;H++)for(let se=0;se<k;se++){var G;C=4*(H*k+se),P!=2?G=[i(b[C]+Q[C]),i(b[C+1]+Q[C+1]),i(b[C+2]+Q[C+2]),i(b[C+3]+Q[C+3])]:(F=W[4*(3&H)+(3&se)],G=[i(b[C]+F),i(b[C+1]+F),i(b[C+2]+F),i(b[C+3]+F)]),D=0;let be=16777215;for(j=0;j<U;j++){const ge=o(G,R[j]);ge<be&&(be=ge,D=j)}const X=R[D],re=[G[0]-X[0],G[1]-X[1],G[2]-X[2],G[3]-X[3]];P==1&&(se!=k-1&&s(re,Q,C+4,7),H!=N-1&&(se!=0&&s(re,Q,C+4*k-4,3),s(re,Q,C+4*k,5),se!=k-1&&s(re,Q,C+4*k+4,1))),$[C>>2]=D,Y[C>>2]=M[D]}}function l(b,k,N,M,L){L==null&&(L={});const{crc:$}=r,P=e.writeUint,U=e.writeUshort,R=e.writeASCII;let C=8;const D=b.frames.length>1;let j,F=!1,Y=33+(D?20:0);if(L.sRGB!=null&&(Y+=13),L.pHYs!=null&&(Y+=21),L.iCCP!=null&&(j=pako.deflate(L.iCCP),Y+=21+j.length+4),b.ctype==3){for(var Q=b.plte.length,W=0;W<Q;W++)b.plte[W]>>>24!=255&&(F=!0);Y+=8+3*Q+4+(F?8+1*Q+4:0)}for(var G=0;G<b.frames.length;G++)D&&(Y+=38),Y+=(X=b.frames[G]).cimg.length+12,G!=0&&(Y+=4);Y+=12;const H=new Uint8Array(Y),se=[137,80,78,71,13,10,26,10];for(W=0;W<8;W++)H[W]=se[W];if(P(H,C,13),C+=4,R(H,C,"IHDR"),C+=4,P(H,C,k),C+=4,P(H,C,N),C+=4,H[C]=b.depth,C++,H[C]=b.ctype,C++,H[C]=0,C++,H[C]=0,C++,H[C]=0,C++,P(H,C,$(H,C-17,17)),C+=4,L.sRGB!=null&&(P(H,C,1),C+=4,R(H,C,"sRGB"),C+=4,H[C]=L.sRGB,C++,P(H,C,$(H,C-5,5)),C+=4),L.iCCP!=null){const re=13+j.length;P(H,C,re),C+=4,R(H,C,"iCCP"),C+=4,R(H,C,"ICC profile"),C+=11,C+=2,H.set(j,C),C+=j.length,P(H,C,$(H,C-(re+4),re+4)),C+=4}if(L.pHYs!=null&&(P(H,C,9),C+=4,R(H,C,"pHYs"),C+=4,P(H,C,L.pHYs[0]),C+=4,P(H,C,L.pHYs[1]),C+=4,H[C]=L.pHYs[2],C++,P(H,C,$(H,C-13,13)),C+=4),D&&(P(H,C,8),C+=4,R(H,C,"acTL"),C+=4,P(H,C,b.frames.length),C+=4,P(H,C,L.loop!=null?L.loop:0),C+=4,P(H,C,$(H,C-12,12)),C+=4),b.ctype==3){for(P(H,C,3*(Q=b.plte.length)),C+=4,R(H,C,"PLTE"),C+=4,W=0;W<Q;W++){const re=3*W,ge=b.plte[W],we=255&ge,ue=ge>>>8&255,J=ge>>>16&255;H[C+re+0]=we,H[C+re+1]=ue,H[C+re+2]=J}if(C+=3*Q,P(H,C,$(H,C-3*Q-4,3*Q+4)),C+=4,F){for(P(H,C,Q),C+=4,R(H,C,"tRNS"),C+=4,W=0;W<Q;W++)H[C+W]=b.plte[W]>>>24&255;C+=Q,P(H,C,$(H,C-Q-4,Q+4)),C+=4}}let be=0;for(G=0;G<b.frames.length;G++){var X=b.frames[G];D&&(P(H,C,26),C+=4,R(H,C,"fcTL"),C+=4,P(H,C,be++),C+=4,P(H,C,X.rect.width),C+=4,P(H,C,X.rect.height),C+=4,P(H,C,X.rect.x),C+=4,P(H,C,X.rect.y),C+=4,U(H,C,M[G]),C+=2,U(H,C,1e3),C+=2,H[C]=X.dispose,C++,H[C]=X.blend,C++,P(H,C,$(H,C-30,30)),C+=4);const re=X.cimg;P(H,C,(Q=re.length)+(G==0?0:4)),C+=4;const ge=C;R(H,C,G==0?"IDAT":"fdAT"),C+=4,G!=0&&(P(H,C,be++),C+=4),H.set(re,C),C+=Q,P(H,C,$(H,ge,C-ge)),C+=4}return P(H,C,0),C+=4,R(H,C,"IEND"),C+=4,P(H,C,$(H,C-4,4)),C+=4,H.buffer}function c(b,k,N){for(let M=0;M<b.frames.length;M++){const L=b.frames[M];L.rect.width;const $=L.rect.height,P=new Uint8Array($*L.bpl+$);L.cimg=f(L.img,$,L.bpp,L.bpl,P,k,N)}}function u(b,k,N,M,L){const $=L[0],P=L[1],U=L[2],R=L[3],C=L[4],D=L[5];let j=6,F=8,Y=255;for(var Q=0;Q<b.length;Q++){const ie=new Uint8Array(b[Q]);for(var W=ie.length,G=0;G<W;G+=4)Y&=ie[G+3]}const H=Y!=255,se=function(oe,Oe,We,Be,Re,Ke){const me=[];for(var Me=0;Me<oe.length;Me++){const Ze=new Uint8Array(oe[Me]),Et=new Uint32Array(Ze.buffer);var Le;let Ct=0,Cn=0,fn=Oe,cr=We,Tn=Be?1:0;if(Me!=0){const _n=Ke||Be||Me==1||me[Me-2].dispose!=0?1:2;let Ur=0,vs=1e9;for(let zr=0;zr<_n;zr++){var it=new Uint8Array(oe[Me-1-zr]);const Ta=new Uint32Array(oe[Me-1-zr]);let Hn=Oe,nn=We,ur=-1,Vr=-1;for(let V=0;V<We;V++)for(let B=0;B<Oe;B++)Et[ot=V*Oe+B]!=Ta[ot]&&(B<Hn&&(Hn=B),B>ur&&(ur=B),V<nn&&(nn=V),V>Vr&&(Vr=V));ur==-1&&(Hn=nn=ur=Vr=0),Re&&((1&Hn)==1&&Hn--,(1&nn)==1&&nn--);const io=(ur-Hn+1)*(Vr-nn+1);io<vs&&(vs=io,Ur=zr,Ct=Hn,Cn=nn,fn=ur-Hn+1,cr=Vr-nn+1)}it=new Uint8Array(oe[Me-1-Ur]),Ur==1&&(me[Me-1].dispose=2),Le=new Uint8Array(fn*cr*4),t(it,Oe,We,Le,fn,cr,-Ct,-Cn,0),Tn=t(Ze,Oe,We,Le,fn,cr,-Ct,-Cn,3)?1:0,Tn==1?h(Ze,Oe,We,Le,{x:Ct,y:Cn,width:fn,height:cr}):t(Ze,Oe,We,Le,fn,cr,-Ct,-Cn,0)}else Le=Ze.slice(0);me.push({rect:{x:Ct,y:Cn,width:fn,height:cr},img:Le,blend:Tn,dispose:0})}if(Be)for(Me=0;Me<me.length;Me++){if((at=me[Me]).blend==1)continue;const Ze=at.rect,Et=me[Me-1].rect,Ct=Math.min(Ze.x,Et.x),Cn=Math.min(Ze.y,Et.y),fn={x:Ct,y:Cn,width:Math.max(Ze.x+Ze.width,Et.x+Et.width)-Ct,height:Math.max(Ze.y+Ze.height,Et.y+Et.height)-Cn};me[Me-1].dispose=1,Me-1!=0&&d(oe,Oe,We,me,Me-1,fn,Re),d(oe,Oe,We,me,Me,fn,Re)}let lr=0;if(oe.length!=1)for(var ot=0;ot<me.length;ot++){var at;lr+=(at=me[ot]).rect.width*at.rect.height}return me}(b,k,N,$,P,U),be={},X=[],re=[];if(M!=0){const ie=[];for(G=0;G<se.length;G++)ie.push(se[G].img.buffer);const oe=function(Re){let Ke=0;for(var me=0;me<Re.length;me++)Ke+=Re[me].byteLength;const Me=new Uint8Array(Ke);let Le=0;for(me=0;me<Re.length;me++){const it=new Uint8Array(Re[me]),lr=it.length;for(let ot=0;ot<lr;ot+=4){let at=it[ot],Ze=it[ot+1],Et=it[ot+2];const Ct=it[ot+3];Ct==0&&(at=Ze=Et=0),Me[Le+ot]=at,Me[Le+ot+1]=Ze,Me[Le+ot+2]=Et,Me[Le+ot+3]=Ct}Le+=lr}return Me.buffer}(ie),Oe=g(oe,M);for(G=0;G<Oe.plte.length;G++)X.push(Oe.plte[G].est.rgba);let We=0;for(G=0;G<se.length;G++){const Be=(we=se[G]).img.length;var ge=new Uint8Array(Oe.inds.buffer,We>>2,Be>>2);re.push(ge);const Re=new Uint8Array(Oe.abuf,We,Be);D&&a(we.img,we.rect.width,we.rect.height,X,Re,ge),we.img.set(Re),We+=Be}}else for(Q=0;Q<se.length;Q++){var we=se[Q];const ie=new Uint32Array(we.img.buffer);var ue=we.rect.width;for(W=ie.length,ge=new Uint8Array(W),re.push(ge),G=0;G<W;G++){const oe=ie[G];if(G!=0&&oe==ie[G-1])ge[G]=ge[G-1];else if(G>ue&&oe==ie[G-ue])ge[G]=ge[G-ue];else{let Oe=be[oe];if(Oe==null&&(be[oe]=Oe=X.length,X.push(oe),X.length>=300))break;ge[G]=Oe}}}const J=X.length;for(J<=256&&C==0&&(F=J<=2?1:J<=4?2:J<=16?4:8,F=Math.max(F,R)),Q=0;Q<se.length;Q++){(we=se[Q]).rect.x,we.rect.y,ue=we.rect.width;const ie=we.rect.height;let oe=we.img;new Uint32Array(oe.buffer);let Oe=4*ue,We=4;if(J<=256&&C==0){Oe=Math.ceil(F*ue/8);var fe=new Uint8Array(Oe*ie);const Be=re[Q];for(let Re=0;Re<ie;Re++){G=Re*Oe;const Ke=Re*ue;if(F==8)for(var de=0;de<ue;de++)fe[G+de]=Be[Ke+de];else if(F==4)for(de=0;de<ue;de++)fe[G+(de>>1)]|=Be[Ke+de]<<4-4*(1&de);else if(F==2)for(de=0;de<ue;de++)fe[G+(de>>2)]|=Be[Ke+de]<<6-2*(3&de);else if(F==1)for(de=0;de<ue;de++)fe[G+(de>>3)]|=Be[Ke+de]<<7-1*(7&de)}oe=fe,j=3,We=1}else if(H==0&&se.length==1){fe=new Uint8Array(ue*ie*3);const Be=ue*ie;for(G=0;G<Be;G++){const Re=3*G,Ke=4*G;fe[Re]=oe[Ke],fe[Re+1]=oe[Ke+1],fe[Re+2]=oe[Ke+2]}oe=fe,j=2,We=3,Oe=3*ue}we.img=oe,we.bpl=Oe,we.bpp=We}return{ctype:j,depth:F,plte:X,frames:se}}function d(b,k,N,M,L,$,P){const U=Uint8Array,R=Uint32Array,C=new U(b[L-1]),D=new R(b[L-1]),j=L+1<b.length?new U(b[L+1]):null,F=new U(b[L]),Y=new R(F.buffer);let Q=k,W=N,G=-1,H=-1;for(let be=0;be<$.height;be++)for(let X=0;X<$.width;X++){const re=$.x+X,ge=$.y+be,we=ge*k+re,ue=Y[we];ue==0||M[L-1].dispose==0&&D[we]==ue&&(j==null||j[4*we+3]!=0)||(re<Q&&(Q=re),re>G&&(G=re),ge<W&&(W=ge),ge>H&&(H=ge))}G==-1&&(Q=W=G=H=0),P&&((1&Q)==1&&Q--,(1&W)==1&&W--),$={x:Q,y:W,width:G-Q+1,height:H-W+1};const se=M[L];se.rect=$,se.blend=1,se.img=new Uint8Array($.width*$.height*4),M[L-1].dispose==0?(t(C,k,N,se.img,$.width,$.height,-$.x,-$.y,0),h(F,k,N,se.img,$)):t(F,k,N,se.img,$.width,$.height,-$.x,-$.y,0)}function h(b,k,N,M,L){t(b,k,N,M,L.width,L.height,-L.x,-L.y,2)}function f(b,k,N,M,L,$,P){const U=[];let R,C=[0,1,2,3,4];$!=-1?C=[$]:(k*M>5e5||N==1)&&(C=[0]),P&&(R={level:0});const D=sD;for(var j=0;j<C.length;j++){for(let Q=0;Q<k;Q++)p(L,b,Q,M,N,C[j]);U.push(D.deflate(L,R))}let F,Y=1e9;for(j=0;j<U.length;j++)U[j].length<Y&&(F=j,Y=U[j].length);return U[F]}function p(b,k,N,M,L,$){const P=N*M;let U=P+N;if(b[U]=$,U++,$==0)if(M<500)for(var R=0;R<M;R++)b[U+R]=k[P+R];else b.set(new Uint8Array(k.buffer,P,M),U);else if($==1){for(R=0;R<L;R++)b[U+R]=k[P+R];for(R=L;R<M;R++)b[U+R]=k[P+R]-k[P+R-L]+256&255}else if(N==0){for(R=0;R<L;R++)b[U+R]=k[P+R];if($==2)for(R=L;R<M;R++)b[U+R]=k[P+R];if($==3)for(R=L;R<M;R++)b[U+R]=k[P+R]-(k[P+R-L]>>1)+256&255;if($==4)for(R=L;R<M;R++)b[U+R]=k[P+R]-n(k[P+R-L],0,0)+256&255}else{if($==2)for(R=0;R<M;R++)b[U+R]=k[P+R]+256-k[P+R-M]&255;if($==3){for(R=0;R<L;R++)b[U+R]=k[P+R]+256-(k[P+R-M]>>1)&255;for(R=L;R<M;R++)b[U+R]=k[P+R]+256-(k[P+R-M]+k[P+R-L]>>1)&255}if($==4){for(R=0;R<L;R++)b[U+R]=k[P+R]+256-n(0,k[P+R-M],0)&255;for(R=L;R<M;R++)b[U+R]=k[P+R]+256-n(k[P+R-L],k[P+R-M],k[P+R-L-M])&255}}}function g(b,k){const N=new Uint8Array(b),M=N.slice(0),L=new Uint32Array(M.buffer),$=y(M,k),P=$[0],U=$[1],R=N.length,C=new Uint8Array(R>>2);let D;if(N.length<2e7)for(var j=0;j<R;j+=4)D=m(P,F=N[j]*(1/255),Y=N[j+1]*(1/255),Q=N[j+2]*(1/255),W=N[j+3]*(1/255)),C[j>>2]=D.ind,L[j>>2]=D.est.rgba;else for(j=0;j<R;j+=4){var F=N[j]*.00392156862745098,Y=N[j+1]*(1/255),Q=N[j+2]*(1/255),W=N[j+3]*(1/255);for(D=P;D.left;)D=v(D.est,F,Y,Q,W)<=0?D.left:D.right;C[j>>2]=D.ind,L[j>>2]=D.est.rgba}return{abuf:M.buffer,inds:C,plte:U}}function y(b,k,N){N==null&&(N=1e-4);const M=new Uint32Array(b.buffer),L={i0:0,i1:b.length,bst:null,est:null,tdst:0,left:null,right:null};L.bst=T(b,L.i0,L.i1),L.est=E(L.bst);const $=[L];for(;$.length<k;){let U=0,R=0;for(var P=0;P<$.length;P++)$[P].est.L>U&&(U=$[P].est.L,R=P);if(U<N)break;const C=$[R],D=w(b,M,C.i0,C.i1,C.est.e,C.est.eMq255);if(C.i0>=D||C.i1<=D){C.est.L=0;continue}const j={i0:C.i0,i1:D,bst:null,est:null,tdst:0,left:null,right:null};j.bst=T(b,j.i0,j.i1),j.est=E(j.bst);const F={i0:D,i1:C.i1,bst:null,est:null,tdst:0,left:null,right:null};for(F.bst={R:[],m:[],N:C.bst.N-j.bst.N},P=0;P<16;P++)F.bst.R[P]=C.bst.R[P]-j.bst.R[P];for(P=0;P<4;P++)F.bst.m[P]=C.bst.m[P]-j.bst.m[P];F.est=E(F.bst),C.left=j,C.right=F,$[R]=j,$.push(F)}for($.sort((U,R)=>R.bst.N-U.bst.N),P=0;P<$.length;P++)$[P].ind=P;return[L,$]}function m(b,k,N,M,L){if(b.left==null)return b.tdst=function(j,F,Y,Q,W){const G=F-j[0],H=Y-j[1],se=Q-j[2],be=W-j[3];return G*G+H*H+se*se+be*be}(b.est.q,k,N,M,L),b;const $=v(b.est,k,N,M,L);let P=b.left,U=b.right;$>0&&(P=b.right,U=b.left);const R=m(P,k,N,M,L);if(R.tdst<=$*$)return R;const C=m(U,k,N,M,L);return C.tdst<R.tdst?C:R}function v(b,k,N,M,L){const{e:$}=b;return $[0]*k+$[1]*N+$[2]*M+$[3]*L-b.eMq}function w(b,k,N,M,L,$){for(M-=4;N<M;){for(;S(b,N,L)<=$;)N+=4;for(;S(b,M,L)>$;)M-=4;if(N>=M)break;const P=k[N>>2];k[N>>2]=k[M>>2],k[M>>2]=P,N+=4,M-=4}for(;S(b,N,L)>$;)N-=4;return N+4}function S(b,k,N){return b[k]*N[0]+b[k+1]*N[1]+b[k+2]*N[2]+b[k+3]*N[3]}function T(b,k,N){const M=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],L=[0,0,0,0],$=N-k>>2;for(let P=k;P<N;P+=4){const U=b[P]*.00392156862745098,R=b[P+1]*(1/255),C=b[P+2]*(1/255),D=b[P+3]*(1/255);L[0]+=U,L[1]+=R,L[2]+=C,L[3]+=D,M[0]+=U*U,M[1]+=U*R,M[2]+=U*C,M[3]+=U*D,M[5]+=R*R,M[6]+=R*C,M[7]+=R*D,M[10]+=C*C,M[11]+=C*D,M[15]+=D*D}return M[4]=M[1],M[8]=M[2],M[9]=M[6],M[12]=M[3],M[13]=M[7],M[14]=M[11],{R:M,m:L,N:$}}function E(b){const{R:k}=b,{m:N}=b,{N:M}=b,L=N[0],$=N[1],P=N[2],U=N[3],R=M==0?0:1/M,C=[k[0]-L*L*R,k[1]-L*$*R,k[2]-L*P*R,k[3]-L*U*R,k[4]-$*L*R,k[5]-$*$*R,k[6]-$*P*R,k[7]-$*U*R,k[8]-P*L*R,k[9]-P*$*R,k[10]-P*P*R,k[11]-P*U*R,k[12]-U*L*R,k[13]-U*$*R,k[14]-U*P*R,k[15]-U*U*R],D=C,j=O;let F=[Math.random(),Math.random(),Math.random(),Math.random()],Y=0,Q=0;if(M!=0)for(let G=0;G<16&&(F=j.multVec(D,F),Q=Math.sqrt(j.dot(F,F)),F=j.sml(1/Q,F),!(G!=0&&Math.abs(Q-Y)<1e-9));G++)Y=Q;const W=[L*R,$*R,P*R,U*R];return{Cov:C,q:W,e:F,L:Y,eMq255:j.dot(j.sml(255,W),F),eMq:j.dot(F,W),rgba:(Math.round(255*W[3])<<24|Math.round(255*W[2])<<16|Math.round(255*W[1])<<8|Math.round(255*W[0])<<0)>>>0}}var O={multVec:(b,k)=>[b[0]*k[0]+b[1]*k[1]+b[2]*k[2]+b[3]*k[3],b[4]*k[0]+b[5]*k[1]+b[6]*k[2]+b[7]*k[3],b[8]*k[0]+b[9]*k[1]+b[10]*k[2]+b[11]*k[3],b[12]*k[0]+b[13]*k[1]+b[14]*k[2]+b[15]*k[3]],dot:(b,k)=>b[0]*k[0]+b[1]*k[1]+b[2]*k[2]+b[3]*k[3],sml:(b,k)=>[b*k[0],b*k[1],b*k[2],b*k[3]]};pr.encode=function(k,N,M,L,$,P,U){L==null&&(L=0),U==null&&(U=!1);const R=u(k,N,M,L,[!1,!1,!1,0,U,!1]);return c(R,-1),l(R,N,M,$,P)},pr.encodeLL=function(k,N,M,L,$,P,U,R){const C={ctype:0+(L==1?0:2)+($==0?0:4),depth:P,frames:[]},D=(L+$)*P,j=D*N;for(let F=0;F<k.length;F++)C.frames.push({rect:{x:0,y:0,width:N,height:M},img:new Uint8Array(k[F]),blend:0,dispose:1,bpp:Math.ceil(D/8),bpl:Math.ceil(j/8)});return c(C,0,!0),l(C,N,M,U,R)},pr.encode.compress=u,pr.encode.dither=a,pr.quantize=g,pr.quantize.getKDtree=y,pr.quantize.getNearest=m})();const JE={toArrayBuffer(t,e){const n=t.width,r=t.height,s=n<<2,i=t.getContext("2d").getImageData(0,0,n,r),o=new Uint32Array(i.data.buffer),a=(32*n+31)/32<<2,l=a*r,c=122+l,u=new ArrayBuffer(c),d=new DataView(u),h=1<<20;let f,p,g,y,m=h,v=0,w=0,S=0;function T(b){d.setUint16(w,b,!0),w+=2}function E(b){d.setUint32(w,b,!0),w+=4}function O(b){w+=b}T(19778),E(c),O(4),E(122),E(108),E(n),E(-r>>>0),T(1),T(32),E(3),E(l),E(2835),E(2835),O(8),E(16711680),E(65280),E(255),E(4278190080),E(1466527264),function b(){for(;v<r&&m>0;){for(y=122+v*a,f=0;f<s;)m--,p=o[S++],g=p>>>24,d.setUint32(y+f,p<<8|g),f+=4;v++}S<o.length?(m=h,setTimeout(b,JE._dly)):e(u)}()},toBlob(t,e){this.toArrayBuffer(t,n=>{e(new Blob([n],{type:"image/bmp"}))})},_dly:9};var mn={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",IOS:"IOS",ETC:"ETC"},iD={[mn.CHROME]:16384,[mn.FIREFOX]:11180,[mn.DESKTOP_SAFARI]:16384,[mn.IE]:8192,[mn.IOS]:4096,[mn.ETC]:8192};const U0=typeof window<"u",YE=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,md=U0&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),oD=(U0||YE)&&(md&&md.getOriginalSymbol(window,"File")||typeof File<"u"&&File),QE=(U0||YE)&&(md&&md.getOriginalSymbol(window,"FileReader")||typeof FileReader<"u"&&FileReader);function z0(t,e,n=Date.now()){return new Promise(r=>{const s=t.split(","),i=s[0].match(/:(.*?);/)[1],o=globalThis.atob(s[1]);let a=o.length;const l=new Uint8Array(a);for(;a--;)l[a]=o.charCodeAt(a);const c=new Blob([l],{type:i});c.name=e,c.lastModified=n,r(c)})}function XE(t){return new Promise((e,n)=>{const r=new QE;r.onload=()=>e(r.result),r.onerror=s=>n(s),r.readAsDataURL(t)})}function ZE(t){return new Promise((e,n)=>{const r=new Image;r.onload=()=>e(r),r.onerror=s=>n(s),r.src=t})}function Ai(){if(Ai.cachedResult!==void 0)return Ai.cachedResult;let t=mn.ETC;const{userAgent:e}=navigator;return/Chrom(e|ium)/i.test(e)?t=mn.CHROME:/iP(ad|od|hone)/i.test(e)&&/WebKit/i.test(e)?t=mn.IOS:/Safari/i.test(e)?t=mn.DESKTOP_SAFARI:/Firefox/i.test(e)?t=mn.FIREFOX:(/MSIE/i.test(e)||document.documentMode)&&(t=mn.IE),Ai.cachedResult=t,Ai.cachedResult}function eC(t,e){const n=Ai(),r=iD[n];let s=t,i=e,o=s*i;const a=s>i?i/s:s/i;for(;o>r*r;){const l=(r+s)/2,c=(r+i)/2;l<c?(i=c,s=c*a):(i=l*a,s=l),o=s*i}return{width:s,height:i}}function Ph(t,e){let n,r;try{if(n=new OffscreenCanvas(t,e),r=n.getContext("2d"),r===null)throw new Error("getContext of OffscreenCanvas returns null")}catch{n=document.createElement("canvas"),r=n.getContext("2d")}return n.width=t,n.height=e,[n,r]}function tC(t,e){const{width:n,height:r}=eC(t.width,t.height),[s,i]=Ph(n,r);return e&&/jpe?g/.test(e)&&(i.fillStyle="white",i.fillRect(0,0,s.width,s.height)),i.drawImage(t,0,0,s.width,s.height),s}function _u(){return _u.cachedResult!==void 0||(_u.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&typeof document<"u"&&"ontouchend"in document),_u.cachedResult}function gd(t,e={}){return new Promise(function(n,r){let s,i;var o=function(){try{return i=tC(s,e.fileType||t.type),n([s,i])}catch(l){return r(l)}},a=function(l){try{var c=function(u){try{throw u}catch(d){return r(d)}};try{let u;return XE(t).then(function(d){try{return u=d,ZE(u).then(function(h){try{return s=h,function(){try{return o()}catch(f){return r(f)}}()}catch(f){return c(f)}},c)}catch(h){return c(h)}},c)}catch(u){c(u)}}catch(u){return r(u)}};try{if(_u()||[mn.DESKTOP_SAFARI,mn.MOBILE_SAFARI].includes(Ai()))throw new Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(t).then(function(l){try{return s=l,o()}catch{return a()}},a)}catch{a()}})}function yd(t,e,n,r,s=1){return new Promise(function(i,o){let a;if(e==="image/png"){let d,h,f;return d=t.getContext("2d"),{data:h}=d.getImageData(0,0,t.width,t.height),f=pr.encode([h.buffer],t.width,t.height,4096*s),a=new Blob([f],{type:e}),a.name=n,a.lastModified=r,l.call(this)}{let d=function(){return l.call(this)};var c=d;if(e==="image/bmp")return new Promise(h=>JE.toBlob(t,h)).then((function(h){try{return a=h,a.name=n,a.lastModified=r,d.call(this)}catch(f){return o(f)}}).bind(this),o);{let h=function(){return d.call(this)};var u=h;if(typeof OffscreenCanvas=="function"&&t instanceof OffscreenCanvas)return t.convertToBlob({type:e,quality:s}).then((function(f){try{return a=f,a.name=n,a.lastModified=r,h.call(this)}catch(p){return o(p)}}).bind(this),o);{let f;return f=t.toDataURL(e,s),z0(f,n,r).then((function(p){try{return a=p,h.call(this)}catch(g){return o(g)}}).bind(this),o)}}}function l(){return i(a)}})}function Nr(t){t.width=0,t.height=0}function jo(){return new Promise(function(t,e){let n,r,s,i;return jo.cachedResult!==void 0?t(jo.cachedResult):z0("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then(function(o){try{return n=o,gd(n).then(function(a){try{return r=a[1],yd(r,n.type,n.name,n.lastModified).then(function(l){try{return s=l,Nr(r),gd(s).then(function(c){try{return i=c[0],jo.cachedResult=i.width===1&&i.height===2,t(jo.cachedResult)}catch(u){return e(u)}},e)}catch(c){return e(c)}},e)}catch(l){return e(l)}},e)}catch(a){return e(a)}},e)})}function nC(t){return new Promise((e,n)=>{const r=new QE;r.onload=s=>{const i=new DataView(s.target.result);if(i.getUint16(0,!1)!=65496)return e(-2);const o=i.byteLength;let a=2;for(;a<o;){if(i.getUint16(a+2,!1)<=8)return e(-1);const l=i.getUint16(a,!1);if(a+=2,l==65505){if(i.getUint32(a+=2,!1)!=1165519206)return e(-1);const c=i.getUint16(a+=6,!1)==18761;a+=i.getUint32(a+4,c);const u=i.getUint16(a,c);a+=2;for(let d=0;d<u;d++)if(i.getUint16(a+12*d,c)==274)return e(i.getUint16(a+12*d+8,c))}else{if((65280&l)!=65280)break;a+=i.getUint16(a,!1)}}return e(-1)},r.onerror=s=>n(s),r.readAsArrayBuffer(t)})}function rC(t,e){const{width:n}=t,{height:r}=t,{maxWidthOrHeight:s}=e;let i,o=t;return isFinite(s)&&(n>s||r>s)&&([o,i]=Ph(n,r),n>r?(o.width=s,o.height=r/n*s):(o.width=n/r*s,o.height=s),i.drawImage(t,0,0,o.width,o.height),Nr(t)),o}function sC(t,e){const{width:n}=t,{height:r}=t,[s,i]=Ph(n,r);switch(e>4&&e<9?(s.width=r,s.height=n):(s.width=n,s.height=r),e){case 2:i.transform(-1,0,0,1,n,0);break;case 3:i.transform(-1,0,0,-1,n,r);break;case 4:i.transform(1,0,0,-1,0,r);break;case 5:i.transform(0,1,1,0,0,0);break;case 6:i.transform(0,1,-1,0,r,0);break;case 7:i.transform(0,-1,-1,0,r,n);break;case 8:i.transform(0,-1,1,0,0,n)}return i.drawImage(t,0,0,n,r),Nr(t),s}function z1(t,e,n=0){return new Promise(function(r,s){let i,o,a,l,c,u,d,h,f,p,g,y,m,v,w,S,T,E,O,b;function k(M=5){if(e.signal&&e.signal.aborted)throw e.signal.reason;i+=M,e.onProgress(Math.min(i,100))}function N(M){if(e.signal&&e.signal.aborted)throw e.signal.reason;i=Math.min(Math.max(M,i),100),e.onProgress(i)}return i=n,o=e.maxIteration||10,a=1024*e.maxSizeMB*1024,k(),gd(t,e).then((function(M){try{return[,l]=M,k(),c=rC(l,e),k(),new Promise(function(L,$){var P;if(!(P=e.exifOrientation))return nC(t).then((function(R){try{return P=R,U.call(this)}catch(C){return $(C)}}).bind(this),$);function U(){return L(P)}return U.call(this)}).then((function(L){try{return u=L,k(),jo().then((function($){try{return d=$?c:sC(c,u),k(),h=e.initialQuality||1,f=e.fileType||t.type,yd(d,f,t.name,t.lastModified,h).then((function(P){try{{let D=function(){if(o--&&(w>a||w>m)){let F,Y;return F=b?.95*O.width:O.width,Y=b?.95*O.height:O.height,[T,E]=Ph(F,Y),E.drawImage(O,0,0,F,Y),h*=f==="image/png"?.85:.95,yd(T,f,t.name,t.lastModified,h).then(function(Q){try{return S=Q,Nr(O),O=T,w=S.size,N(Math.min(99,Math.floor((v-w)/(v-a)*100))),D}catch(W){return s(W)}},s)}return[1]},j=function(){return Nr(O),Nr(T),Nr(c),Nr(d),Nr(l),N(100),r(S)};var R=D,C=j;if(p=P,k(),g=p.size>a,y=p.size>t.size,!g&&!y)return N(100),r(p);var U;return m=t.size,v=p.size,w=v,O=d,b=!e.alwaysKeepResolution&&g,(U=(function(F){for(;F;){if(F.then)return void F.then(U,s);try{if(F.pop){if(F.length)return F.pop()?j.call(this):F;F=D}else F=F.call(this)}catch(Y){return s(Y)}}}).bind(this))(D)}}catch(D){return s(D)}}).bind(this),s)}catch(P){return s(P)}}).bind(this),s)}catch($){return s($)}}).bind(this),s)}catch(L){return s(L)}}).bind(this),s)})}const aD=`
let scriptImported = false
self.addEventListener('message', async (e) => {
  const { file, id, imageCompressionLibUrl, options } = e.data
  options.onProgress = (progress) => self.postMessage({ progress, id })
  try {
    if (!scriptImported) {
      // console.log('[worker] importScripts', imageCompressionLibUrl)
      self.importScripts(imageCompressionLibUrl)
      scriptImported = true
    }
    // console.log('[worker] self', self)
    const compressedFile = await imageCompression(file, options)
    self.postMessage({ file: compressedFile, id })
  } catch (e) {
    // console.error('[worker] error', e)
    self.postMessage({ error: e.message + '\\n' + e.stack, id })
  }
})
`;let jf;function lD(t,e){return new Promise((n,r)=>{jf||(jf=function(o){const a=[];return typeof o=="function"?a.push(`(${o})()`):a.push(o),URL.createObjectURL(new Blob(a))}(aD));const s=new Worker(jf);s.addEventListener("message",function(o){if(e.signal&&e.signal.aborted)s.terminate();else if(o.data.progress===void 0){if(o.data.error)return r(new Error(o.data.error)),void s.terminate();n(o.data.file),s.terminate()}else e.onProgress(o.data.progress)}),s.addEventListener("error",r),e.signal&&e.signal.addEventListener("abort",()=>{r(e.signal.reason),s.terminate()}),s.postMessage({file:t,imageCompressionLibUrl:e.libURL,options:{...e,onProgress:void 0,signal:void 0}})})}function Kt(t,e){return new Promise(function(n,r){let s,i,o,a,l,c;if(s={...e},o=0,{onProgress:a}=s,s.maxSizeMB=s.maxSizeMB||Number.POSITIVE_INFINITY,l=typeof s.useWebWorker!="boolean"||s.useWebWorker,delete s.useWebWorker,s.onProgress=f=>{o=f,typeof a=="function"&&a(o)},!(t instanceof Blob||t instanceof oD))return r(new Error("The file given is not an instance of Blob or File"));if(!/^image/.test(t.type))return r(new Error("The file given is not an image"));if(c=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,!l||typeof Worker!="function"||c)return z1(t,s).then((function(f){try{return i=f,h.call(this)}catch(p){return r(p)}}).bind(this),r);var u=(function(){try{return h.call(this)}catch(f){return r(f)}}).bind(this),d=function(f){try{return z1(t,s).then(function(p){try{return i=p,u()}catch(g){return r(g)}},r)}catch(p){return r(p)}};try{return s.libURL=s.libURL||"https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js",lD(t,s).then(function(f){try{return i=f,u()}catch{return d()}},d)}catch{d()}function h(){try{i.name=t.name,i.lastModified=t.lastModified}catch{}try{s.preserveExif&&t.type==="image/jpeg"&&(!s.fileType||s.fileType&&s.fileType===t.type)&&(i=GE(t,i))}catch{}return n(i)}})}Kt.getDataUrlFromFile=XE,Kt.getFilefromDataUrl=z0,Kt.loadImage=ZE,Kt.drawImageInCanvas=tC,Kt.drawFileInCanvas=gd,Kt.canvasToFile=yd,Kt.getExifOrientation=nC,Kt.handleMaxWidthOrHeight=rC,Kt.followExifOrientation=sC,Kt.cleanupCanvasMemory=Nr,Kt.isAutoOrientationInBrowser=jo,Kt.approximateBelowMaximumCanvasSizeOfBrowser=eC,Kt.copyExifWithoutOrientation=GE,Kt.getBrowserName=Ai,Kt.version="2.0.2";function $t(t){this.content=t}$t.prototype={constructor:$t,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,s=r.find(t),i=r.content.slice();return s==-1?i.push(n||t,e):(i[s+1]=e,n&&(i[s]=n)),new $t(i)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new $t(n)},addToStart:function(t,e){return new $t([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new $t(n)},addBefore:function(t,e,n){var r=this.remove(e),s=r.content.slice(),i=r.find(t);return s.splice(i==-1?s.length:i,0,e,n),new $t(s)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=$t.from(t),t.size?new $t(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=$t.from(t),t.size?new $t(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=$t.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}};$t.from=function(t){if(t instanceof $t)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new $t(e)};function iC(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let s=t.child(r),i=e.child(r);if(s==i){n+=s.nodeSize;continue}if(!s.sameMarkup(i))return n;if(s.isText&&s.text!=i.text){for(let o=0;s.text[o]==i.text[o];o++)n++;return n}if(s.content.size||i.content.size){let o=iC(s.content,i.content,n+1);if(o!=null)return o}n+=s.nodeSize}}function oC(t,e,n,r){for(let s=t.childCount,i=e.childCount;;){if(s==0||i==0)return s==i?null:{a:n,b:r};let o=t.child(--s),a=e.child(--i),l=o.nodeSize;if(o==a){n-=l,r-=l;continue}if(!o.sameMarkup(a))return{a:n,b:r};if(o.isText&&o.text!=a.text){let c=0,u=Math.min(o.text.length,a.text.length);for(;c<u&&o.text[o.text.length-c-1]==a.text[a.text.length-c-1];)c++,n--,r--;return{a:n,b:r}}if(o.content.size||a.content.size){let c=oC(o.content,a.content,n-1,r-1);if(c)return c}n-=l,r-=l}}class ee{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,n,r,s=0,i){for(let o=0,a=0;a<n;o++){let l=this.content[o],c=a+l.nodeSize;if(c>e&&r(l,s+a,i||null,o)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,n-u),r,s+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,r,s){let i="",o=!0;return this.nodesBetween(e,n,(a,l)=>{let c=a.isText?a.text.slice(Math.max(e,l)-l,n-l):a.isLeaf?s?typeof s=="function"?s(a):s:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&c||a.isTextblock)&&r&&(o?o=!1:i+=r),i+=c},0),i}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,r=e.firstChild,s=this.content.slice(),i=0;for(n.isText&&n.sameMarkup(r)&&(s[s.length-1]=n.withText(n.text+r.text),i=1);i<e.content.length;i++)s.push(e.content[i]);return new ee(s,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let r=[],s=0;if(n>e)for(let i=0,o=0;o<n;i++){let a=this.content[i],l=o+a.nodeSize;l>e&&((o<e||l>n)&&(a.isText?a=a.cut(Math.max(0,e-o),Math.min(a.text.length,n-o)):a=a.cut(Math.max(0,e-o-1),Math.min(a.content.size,n-o-1))),r.push(a),s+=a.nodeSize),o=l}return new ee(r,s)}cutByIndex(e,n){return e==n?ee.empty:e==0&&n==this.content.length?this:new ee(this.content.slice(e,n))}replaceChild(e,n){let r=this.content[e];if(r==n)return this;let s=this.content.slice(),i=this.size+n.nodeSize-r.nodeSize;return s[e]=n,new ee(s,i)}addToStart(e){return new ee([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new ee(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,r=0;n<this.content.length;n++){let s=this.content[n];e(s,r,n),r+=s.nodeSize}}findDiffStart(e,n=0){return iC(this,e,n)}findDiffEnd(e,n=this.size,r=e.size){return oC(this,e,n,r)}findIndex(e){if(e==0)return Qc(0,e);if(e==this.size)return Qc(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,r=0;;n++){let s=this.child(n),i=r+s.nodeSize;if(i>=e)return i==e?Qc(n+1,i):Qc(n,r);r=i}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return ee.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new ee(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return ee.empty;let n,r=0;for(let s=0;s<e.length;s++){let i=e[s];r+=i.nodeSize,s&&i.isText&&e[s-1].sameMarkup(i)?(n||(n=e.slice(0,s)),n[n.length-1]=i.withText(n[n.length-1].text+i.text)):n&&n.push(i)}return new ee(n||e,r)}static from(e){if(!e)return ee.empty;if(e instanceof ee)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new ee([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}ee.empty=new ee([],0);const Lf={index:0,offset:0};function Qc(t,e){return Lf.index=t,Lf.offset=e,Lf}function vd(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!vd(t[r],e[r]))return!1}else{for(let r in t)if(!(r in e)||!vd(t[r],e[r]))return!1;for(let r in e)if(!(r in t))return!1}return!0}let ze=class Mm{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,r=!1;for(let s=0;s<e.length;s++){let i=e[s];if(this.eq(i))return e;if(this.type.excludes(i.type))n||(n=e.slice(0,s));else{if(i.type.excludes(this.type))return e;!r&&i.type.rank>this.type.rank&&(n||(n=e.slice(0,s)),n.push(this),r=!0),n&&n.push(i)}}return n||(n=e.slice()),r||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&vd(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[n.type];if(!r)throw new RangeError(`There is no mark type ${n.type} in this schema`);let s=r.create(n.attrs);return r.checkAttrs(s.attrs),s}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(n[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return Mm.none;if(e instanceof Mm)return[e];let n=e.slice();return n.sort((r,s)=>r.type.rank-s.type.rank),n}};ze.none=[];class wd extends Error{}class ce{constructor(e,n,r){this.content=e,this.openStart=n,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let r=lC(this.content,e+this.openStart,n);return r&&new ce(r,this.openStart,this.openEnd)}removeBetween(e,n){return new ce(aC(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return ce.empty;let r=n.openStart||0,s=n.openEnd||0;if(typeof r!="number"||typeof s!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new ce(ee.fromJSON(e,n.content),r,s)}static maxOpen(e,n=!0){let r=0,s=0;for(let i=e.firstChild;i&&!i.isLeaf&&(n||!i.type.spec.isolating);i=i.firstChild)r++;for(let i=e.lastChild;i&&!i.isLeaf&&(n||!i.type.spec.isolating);i=i.lastChild)s++;return new ce(e,r,s)}}ce.empty=new ce(ee.empty,0,0);function aC(t,e,n){let{index:r,offset:s}=t.findIndex(e),i=t.maybeChild(r),{index:o,offset:a}=t.findIndex(n);if(s==e||i.isText){if(a!=n&&!t.child(o).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=o)throw new RangeError("Removing non-flat range");return t.replaceChild(r,i.copy(aC(i.content,e-s-1,n-s-1)))}function lC(t,e,n,r){let{index:s,offset:i}=t.findIndex(e),o=t.maybeChild(s);if(i==e||o.isText)return r&&!r.canReplace(s,s,n)?null:t.cut(0,e).append(n).append(t.cut(e));let a=lC(o.content,e-i-1,n,o);return a&&t.replaceChild(s,o.copy(a))}function cD(t,e,n){if(n.openStart>t.depth)throw new wd("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new wd("Inconsistent open depths");return cC(t,e,n,0)}function cC(t,e,n,r){let s=t.index(r),i=t.node(r);if(s==e.index(r)&&r<t.depth-n.openStart){let o=cC(t,e,n,r+1);return i.copy(i.content.replaceChild(s,o))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==r&&e.depth==r){let o=t.parent,a=o.content;return Fi(o,a.cut(0,t.parentOffset).append(n.content).append(a.cut(e.parentOffset)))}else{let{start:o,end:a}=uD(n,t);return Fi(i,dC(t,o,a,e,r))}else return Fi(i,xd(t,e,r))}function uC(t,e){if(!e.type.compatibleContent(t.type))throw new wd("Cannot join "+e.type.name+" onto "+t.type.name)}function Dm(t,e,n){let r=t.node(n);return uC(r,e.node(n)),r}function $i(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function al(t,e,n,r){let s=(e||t).node(n),i=0,o=e?e.index(n):s.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&($i(t.nodeAfter,r),i++));for(let a=i;a<o;a++)$i(s.child(a),r);e&&e.depth==n&&e.textOffset&&$i(e.nodeBefore,r)}function Fi(t,e){return t.type.checkContent(e),t.copy(e)}function dC(t,e,n,r,s){let i=t.depth>s&&Dm(t,e,s+1),o=r.depth>s&&Dm(n,r,s+1),a=[];return al(null,t,s,a),i&&o&&e.index(s)==n.index(s)?(uC(i,o),$i(Fi(i,dC(t,e,n,r,s+1)),a)):(i&&$i(Fi(i,xd(t,e,s+1)),a),al(e,n,s,a),o&&$i(Fi(o,xd(n,r,s+1)),a)),al(r,null,s,a),new ee(a)}function xd(t,e,n){let r=[];if(al(null,t,n,r),t.depth>n){let s=Dm(t,e,n+1);$i(Fi(s,xd(t,e,n+1)),r)}return al(e,null,n,r),new ee(r)}function uD(t,e){let n=e.depth-t.openStart,s=e.node(n).copy(t.content);for(let i=n-1;i>=0;i--)s=e.node(i).copy(ee.from(s));return{start:s.resolveNoCache(t.openStart+n),end:s.resolveNoCache(s.content.size-t.openEnd-n)}}class Jl{constructor(e,n,r){this.pos=e,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],s=e.child(n);return r?e.child(n).cut(r):s}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let r=this.path[n*3],s=n==0?0:this.path[n*3-1]+1;for(let i=0;i<e;i++)s+=r.child(i).nodeSize;return s}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return ze.none;if(this.textOffset)return e.child(n).marks;let r=e.maybeChild(n-1),s=e.maybeChild(n);if(!r){let a=r;r=s,s=a}let i=r.marks;for(var o=0;o<i.length;o++)i[o].type.spec.inclusive===!1&&(!s||!i[o].isInSet(s.marks))&&(i=i[o--].removeFromSet(i));return i}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let r=n.marks,s=e.parent.maybeChild(e.index());for(var i=0;i<r.length;i++)r[i].type.spec.inclusive===!1&&(!s||!r[i].isInSet(s.marks))&&(r=r[i--].removeFromSet(r));return r}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!n||n(this.node(r))))return new bd(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let r=[],s=0,i=n;for(let o=e;;){let{index:a,offset:l}=o.content.findIndex(i),c=i-l;if(r.push(o,a,s+l),!c||(o=o.child(a),o.isText))break;i=c-1,s+=l+1}return new Jl(n,r,i)}static resolveCached(e,n){let r=V1.get(e);if(r)for(let i=0;i<r.elts.length;i++){let o=r.elts[i];if(o.pos==n)return o}else V1.set(e,r=new dD);let s=r.elts[r.i]=Jl.resolve(e,n);return r.i=(r.i+1)%hD,s}}class dD{constructor(){this.elts=[],this.i=0}}const hD=12,V1=new WeakMap;class bd{constructor(e,n,r){this.$from=e,this.$to=n,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const fD=Object.create(null);let Gs=class jm{constructor(e,n,r,s=ze.none){this.type=e,this.attrs=n,this.marks=s,this.content=r||ee.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,r,s=0){this.content.nodesBetween(e,n,r,s,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,r,s){return this.content.textBetween(e,n,r,s)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,r){return this.type==e&&vd(this.attrs,n||e.defaultAttrs||fD)&&ze.sameSet(this.marks,r||ze.none)}copy(e=null){return e==this.content?this:new jm(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new jm(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,r=!1){if(e==n)return ce.empty;let s=this.resolve(e),i=this.resolve(n),o=r?0:s.sharedDepth(n),a=s.start(o),c=s.node(o).content.cut(s.pos-a,i.pos-a);return new ce(c,s.depth-o,i.depth-o)}replace(e,n,r){return cD(this.resolve(e),this.resolve(n),r)}nodeAt(e){for(let n=this;;){let{index:r,offset:s}=n.content.findIndex(e);if(n=n.maybeChild(r),!n)return null;if(s==e||n.isText)return n;e-=s+1}}childAfter(e){let{index:n,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(n),index:n,offset:r};let s=this.content.child(n-1);return{node:s,index:n-1,offset:r-s.nodeSize}}resolve(e){return Jl.resolveCached(this,e)}resolveNoCache(e){return Jl.resolve(this,e)}rangeHasMark(e,n,r){let s=!1;return n>e&&this.nodesBetween(e,n,i=>(r.isInSet(i.marks)&&(s=!0),!s)),s}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),hC(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,r=ee.empty,s=0,i=r.childCount){let o=this.contentMatchAt(e).matchFragment(r,s,i),a=o&&o.matchFragment(this.content,n);if(!a||!a.validEnd)return!1;for(let l=s;l<i;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,n,r,s){if(s&&!this.type.allowsMarks(s))return!1;let i=this.contentMatchAt(e).matchType(r),o=i&&i.matchFragment(this.content,n);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=ze.none;for(let n=0;n<this.marks.length;n++){let r=this.marks[n];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!ze.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let r;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,r)}let s=ee.fromJSON(e,n.content),i=e.nodeType(n.type).create(n.attrs,s,r);return i.type.checkAttrs(i.attrs),i}};Gs.prototype.text=void 0;class kd extends Gs{constructor(e,n,r,s){if(super(e,n,null,s),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):hC(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new kd(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new kd(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function hC(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class Yi{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let r=new pD(e,n);if(r.next==null)return Yi.empty;let s=fC(r);r.next&&r.err("Unexpected trailing text");let i=bD(xD(s));return kD(i,r),i}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,r=e.childCount){let s=this;for(let i=n;s&&i<r;i++)s=s.matchType(e.child(i).type);return s}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let r=0;r<e.next.length;r++)if(this.next[n].type==e.next[r].type)return!0;return!1}fillBefore(e,n=!1,r=0){let s=[this];function i(o,a){let l=o.matchFragment(e,r);if(l&&(!n||l.validEnd))return ee.from(a.map(c=>c.createAndFill()));for(let c=0;c<o.next.length;c++){let{type:u,next:d}=o.next[c];if(!(u.isText||u.hasRequiredAttrs())&&s.indexOf(d)==-1){s.push(d);let h=i(d,a.concat(u));if(h)return h}}return null}return i(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let s=r.shift(),i=s.match;if(i.matchType(e)){let o=[];for(let a=s;a.type;a=a.via)o.push(a.type);return o.reverse()}for(let o=0;o<i.next.length;o++){let{type:a,next:l}=i.next[o];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in n)&&(!s.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:s}),n[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(r){e.push(r);for(let s=0;s<r.next.length;s++)e.indexOf(r.next[s].next)==-1&&n(r.next[s].next)}return n(this),e.map((r,s)=>{let i=s+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)i+=(o?", ":"")+r.next[o].type.name+"->"+e.indexOf(r.next[o].next);return i}).join(`
`)}}Yi.empty=new Yi(!0);class pD{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function fC(t){let e=[];do e.push(mD(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function mD(t){let e=[];do e.push(gD(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function gD(t){let e=wD(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=yD(t,e);else break;return e}function H1(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function yD(t,e){let n=H1(t),r=n;return t.eat(",")&&(t.next!="}"?r=H1(t):r=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function vD(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let s=[];for(let i in n){let o=n[i];o.isInGroup(e)&&s.push(o)}return s.length==0&&t.err("No node type or group '"+e+"' found"),s}function wD(t){if(t.eat("(")){let e=fC(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=vD(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function xD(t){let e=[[]];return s(i(t,0),n()),e;function n(){return e.push([])-1}function r(o,a,l){let c={term:l,to:a};return e[o].push(c),c}function s(o,a){o.forEach(l=>l.to=a)}function i(o,a){if(o.type=="choice")return o.exprs.reduce((l,c)=>l.concat(i(c,a)),[]);if(o.type=="seq")for(let l=0;;l++){let c=i(o.exprs[l],a);if(l==o.exprs.length-1)return c;s(c,a=n())}else if(o.type=="star"){let l=n();return r(a,l),s(i(o.expr,l),l),[r(l)]}else if(o.type=="plus"){let l=n();return s(i(o.expr,a),l),s(i(o.expr,l),l),[r(l)]}else{if(o.type=="opt")return[r(a)].concat(i(o.expr,a));if(o.type=="range"){let l=a;for(let c=0;c<o.min;c++){let u=n();s(i(o.expr,l),u),l=u}if(o.max==-1)s(i(o.expr,l),l);else for(let c=o.min;c<o.max;c++){let u=n();r(l,u),s(i(o.expr,l),u),l=u}return[r(l)]}else{if(o.type=="name")return[r(a,void 0,o.value)];throw new Error("Unknown expr type")}}}}function pC(t,e){return e-t}function W1(t,e){let n=[];return r(e),n.sort(pC);function r(s){let i=t[s];if(i.length==1&&!i[0].term)return r(i[0].to);n.push(s);for(let o=0;o<i.length;o++){let{term:a,to:l}=i[o];!a&&n.indexOf(l)==-1&&r(l)}}}function bD(t){let e=Object.create(null);return n(W1(t,0));function n(r){let s=[];r.forEach(o=>{t[o].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let u=0;u<s.length;u++)s[u][0]==a&&(c=s[u][1]);W1(t,l).forEach(u=>{c||s.push([a,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let i=e[r.join(",")]=new Yi(r.indexOf(t.length-1)>-1);for(let o=0;o<s.length;o++){let a=s[o][1].sort(pC);i.next.push({type:s[o][0],next:e[a.join(",")]||n(a)})}return i}}function kD(t,e){for(let n=0,r=[t];n<r.length;n++){let s=r[n],i=!s.validEnd,o=[];for(let a=0;a<s.next.length;a++){let{type:l,next:c}=s.next[a];o.push(l.name),i&&!(l.isText||l.hasRequiredAttrs())&&(i=!1),r.indexOf(c)==-1&&r.push(c)}i&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function mC(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function gC(t,e){let n=Object.create(null);for(let r in t){let s=e&&e[r];if(s===void 0){let i=t[r];if(i.hasDefault)s=i.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=s}return n}function yC(t,e,n,r){for(let s in e)if(!(s in t))throw new RangeError(`Unsupported attribute ${s} for ${n} of type ${s}`);for(let s in t){let i=t[s];i.validate&&i.validate(e[s])}}function vC(t,e){let n=Object.create(null);if(e)for(let r in e)n[r]=new ED(t,r,e[r]);return n}let K1=class wC{constructor(e,n,r){this.name=e,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=vC(e,r.attrs),this.defaultAttrs=mC(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Yi.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:gC(this.attrs,e)}create(e=null,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Gs(this,this.computeAttrs(e),ee.from(n),ze.setFrom(r))}createChecked(e=null,n,r){return n=ee.from(n),this.checkContent(n),new Gs(this,this.computeAttrs(e),n,ze.setFrom(r))}createAndFill(e=null,n,r){if(e=this.computeAttrs(e),n=ee.from(n),n.size){let o=this.contentMatch.fillBefore(n);if(!o)return null;n=o.append(n)}let s=this.contentMatch.matchFragment(n),i=s&&s.fillBefore(ee.empty,!0);return i?new Gs(this,e,n.append(i),ze.setFrom(r)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){yC(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?n&&n.push(e[r]):n||(n=e.slice(0,r));return n?n.length?n:ze.none:e}static compile(e,n){let r=Object.create(null);e.forEach((i,o)=>r[i]=new wC(i,n,o));let s=n.spec.topNode||"doc";if(!r[s])throw new RangeError("Schema is missing its top node type ('"+s+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let i in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function SD(t,e,n){let r=n.split("|");return s=>{let i=s===null?"null":typeof s;if(r.indexOf(i)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${t}, got ${i}`)}}class ED{constructor(e,n,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?SD(e,n,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class Mh{constructor(e,n,r,s){this.name=e,this.rank=n,this.schema=r,this.spec=s,this.attrs=vC(e,s.attrs),this.excluded=null;let i=mC(this.attrs);this.instance=i?new ze(this,i):null}create(e=null){return!e&&this.instance?this.instance:new ze(this,gC(this.attrs,e))}static compile(e,n){let r=Object.create(null),s=0;return e.forEach((i,o)=>r[i]=new Mh(i,s++,n,o)),r}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}checkAttrs(e){yC(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class xC{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let s in e)n[s]=e[s];n.nodes=$t.from(e.nodes),n.marks=$t.from(e.marks||{}),this.nodes=K1.compile(this.spec.nodes,this),this.marks=Mh.compile(this.spec.marks,this);let r=Object.create(null);for(let s in this.nodes){if(s in this.marks)throw new RangeError(s+" can not be both a node and a mark");let i=this.nodes[s],o=i.spec.content||"",a=i.spec.marks;if(i.contentMatch=r[o]||(r[o]=Yi.parse(o,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!i.isInline||!i.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=i}i.markSet=a=="_"?null:a?q1(this,a.split(" ")):a==""||!i.inlineContent?[]:null}for(let s in this.marks){let i=this.marks[s],o=i.spec.excludes;i.excluded=o==null?[i]:o==""?[]:q1(this,o.split(" "))}this.nodeFromJSON=s=>Gs.fromJSON(this,s),this.markFromJSON=s=>ze.fromJSON(this,s),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,r,s){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof K1){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,r,s)}text(e,n){let r=this.nodes.text;return new kd(r,r.defaultAttrs,e,ze.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function q1(t,e){let n=[];for(let r=0;r<e.length;r++){let s=e[r],i=t.marks[s],o=i;if(i)n.push(i);else for(let a in t.marks){let l=t.marks[a];(s=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(s)>-1)&&n.push(o=l)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}function CD(t){return t.tag!=null}function TD(t){return t.style!=null}class Js{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[];let r=this.matchedStyles=[];n.forEach(s=>{if(CD(s))this.tags.push(s);else if(TD(s)){let i=/[^=]*/.exec(s.style)[0];r.indexOf(i)<0&&r.push(i),this.styles.push(s)}}),this.normalizeLists=!this.tags.some(s=>{if(!/^(ul|ol)\b/.test(s.tag)||!s.node)return!1;let i=e.nodes[s.node];return i.contentMatch.matchType(i)})}parse(e,n={}){let r=new J1(this,n,!1);return r.addAll(e,ze.none,n.from,n.to),r.finish()}parseSlice(e,n={}){let r=new J1(this,n,!0);return r.addAll(e,ze.none,n.from,n.to),ce.maxOpen(r.finish())}matchTag(e,n,r){for(let s=r?this.tags.indexOf(r)+1:0;s<this.tags.length;s++){let i=this.tags[s];if(OD(e,i.tag)&&(i.namespace===void 0||e.namespaceURI==i.namespace)&&(!i.context||n.matchesContext(i.context))){if(i.getAttrs){let o=i.getAttrs(e);if(o===!1)continue;i.attrs=o||void 0}return i}}}matchStyle(e,n,r,s){for(let i=s?this.styles.indexOf(s)+1:0;i<this.styles.length;i++){let o=this.styles[i],a=o.style;if(!(a.indexOf(e)!=0||o.context&&!r.matchesContext(o.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=n))){if(o.getAttrs){let l=o.getAttrs(n);if(l===!1)continue;o.attrs=l||void 0}return o}}}static schemaRules(e){let n=[];function r(s){let i=s.priority==null?50:s.priority,o=0;for(;o<n.length;o++){let a=n[o];if((a.priority==null?50:a.priority)<i)break}n.splice(o,0,s)}for(let s in e.marks){let i=e.marks[s].spec.parseDOM;i&&i.forEach(o=>{r(o=Y1(o)),o.mark||o.ignore||o.clearMark||(o.mark=s)})}for(let s in e.nodes){let i=e.nodes[s].spec.parseDOM;i&&i.forEach(o=>{r(o=Y1(o)),o.node||o.ignore||o.mark||(o.node=s)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Js(e,Js.schemaRules(e)))}}const bC={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},_D={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},kC={ol:!0,ul:!0},Yl=1,Lm=2,ll=4;function G1(t,e,n){return e!=null?(e?Yl:0)|(e==="full"?Lm:0):t&&t.whitespace=="pre"?Yl|Lm:n&~ll}class Xc{constructor(e,n,r,s,i,o){this.type=e,this.attrs=n,this.marks=r,this.solid=s,this.options=o,this.content=[],this.activeMarks=ze.none,this.match=i||(o&ll?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(ee.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let r=this.type.contentMatch,s;return(s=r.findWrapping(e.type))?(this.match=r,s):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Yl)){let r=this.content[this.content.length-1],s;if(r&&r.isText&&(s=/[ \t\r\n\u000c]+$/.exec(r.text))){let i=r;r.text.length==s[0].length?this.content.pop():this.content[this.content.length-1]=i.withText(i.text.slice(0,i.text.length-s[0].length))}}let n=ee.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(ee.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!bC.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class J1{constructor(e,n,r){this.parser=e,this.options=n,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let s=n.topNode,i,o=G1(null,n.preserveWhitespace,0)|(r?ll:0);s?i=new Xc(s.type,s.attrs,ze.none,!0,n.topMatch||s.type.contentMatch,o):r?i=new Xc(null,null,ze.none,!0,null,o):i=new Xc(e.schema.topNodeType,null,ze.none,!0,null,o),this.nodes=[i],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,n){e.nodeType==3?this.addTextNode(e,n):e.nodeType==1&&this.addElement(e,n)}addTextNode(e,n){let r=e.nodeValue,s=this.top,i=s.options&Lm?"full":this.localPreserveWS||(s.options&Yl)>0,{schema:o}=this.parser;if(i==="full"||s.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(i)if(i==="full")r=r.replace(/\r\n?/g,`
`);else if(o.linebreakReplacement&&/[\r\n]/.test(r)&&this.top.findWrapping(o.linebreakReplacement.create())){let a=r.split(/\r?\n|\r/);for(let l=0;l<a.length;l++)l&&this.insertNode(o.linebreakReplacement.create(),n,!0),a[l]&&this.insertNode(o.text(a[l]),n,!/\S/.test(a[l]));r=""}else r=r.replace(/\r?\n|\r/g," ");else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let a=s.content[s.content.length-1],l=e.previousSibling;(!a||l&&l.nodeName=="BR"||a.isText&&/[ \t\r\n\u000c]$/.test(a.text))&&(r=r.slice(1))}r&&this.insertNode(o.text(r),n,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,n,r){let s=this.localPreserveWS,i=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let o=e.nodeName.toLowerCase(),a;kC.hasOwnProperty(o)&&this.parser.normalizeLists&&AD(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(a=this.parser.matchTag(e,this,r));e:if(l?l.ignore:_D.hasOwnProperty(o))this.findInside(e),this.ignoreFallback(e,n);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let c,u=this.needsBlock;if(bC.hasOwnProperty(o))i.content.length&&i.content[0].isInline&&this.open&&(this.open--,i=this.top),c=!0,i.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,n);break e}let d=l&&l.skip?n:this.readStyles(e,n);d&&this.addAll(e,d),c&&this.sync(i),this.needsBlock=u}else{let c=this.readStyles(e,n);c&&this.addElementByRule(e,l,c,l.consuming===!1?a:void 0)}this.localPreserveWS=s}leafFallback(e,n){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),n)}ignoreFallback(e,n){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n,!0)}readStyles(e,n){let r=e.style;if(r&&r.length)for(let s=0;s<this.parser.matchedStyles.length;s++){let i=this.parser.matchedStyles[s],o=r.getPropertyValue(i);if(o)for(let a=void 0;;){let l=this.parser.matchStyle(i,o,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?n=n.filter(c=>!l.clearMark(c)):n=n.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)a=l;else break}}return n}addElementByRule(e,n,r,s){let i,o;if(n.node)if(o=this.parser.schema.nodes[n.node],o.isLeaf)this.insertNode(o.create(n.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let l=this.enter(o,n.attrs||null,r,n.preserveWhitespace);l&&(i=!0,r=l)}else{let l=this.parser.schema.marks[n.mark];r=r.concat(l.create(n.attrs))}let a=this.top;if(o&&o.isLeaf)this.findInside(e);else if(s)this.addElement(e,r,s);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l,r,!1));else{let l=e;typeof n.contentElement=="string"?l=e.querySelector(n.contentElement):typeof n.contentElement=="function"?l=n.contentElement(e):n.contentElement&&(l=n.contentElement),this.findAround(e,l,!0),this.addAll(l,r),this.findAround(e,l,!1)}i&&this.sync(a)&&this.open--}addAll(e,n,r,s){let i=r||0;for(let o=r?e.childNodes[r]:e.firstChild,a=s==null?null:e.childNodes[s];o!=a;o=o.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(o,n);this.findAtPoint(e,i)}findPlace(e,n,r){let s,i;for(let o=this.open,a=0;o>=0;o--){let l=this.nodes[o],c=l.findWrapping(e);if(c&&(!s||s.length>c.length+a)&&(s=c,i=l,!c.length))break;if(l.solid){if(r)break;a+=2}}if(!s)return null;this.sync(i);for(let o=0;o<s.length;o++)n=this.enterInner(s[o],null,n,!1);return n}insertNode(e,n,r){if(e.isInline&&this.needsBlock&&!this.top.type){let i=this.textblockFromContext();i&&(n=this.enterInner(i,null,n))}let s=this.findPlace(e,n,r);if(s){this.closeExtra();let i=this.top;i.match&&(i.match=i.match.matchType(e.type));let o=ze.none;for(let a of s.concat(e.marks))(i.type?i.type.allowsMarkType(a.type):Q1(a.type,e.type))&&(o=a.addToSet(o));return i.content.push(e.mark(o)),!0}return!1}enter(e,n,r,s){let i=this.findPlace(e.create(n),r,!1);return i&&(i=this.enterInner(e,n,r,!0,s)),i}enterInner(e,n,r,s=!1,i){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(e);let a=G1(e,i,o.options);o.options&ll&&o.content.length==0&&(a|=ll);let l=ze.none;return r=r.filter(c=>(o.type?o.type.allowsMarkType(c.type):Q1(c.type,e))?(l=c.addToSet(l),!1):!0),this.nodes.push(new Xc(e,n,l,s,null,a)),this.open++,r}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let n=this.open;n>=0;n--){if(this.nodes[n]==e)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=Yl)}return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let r=this.nodes[n].content;for(let s=r.length-1;s>=0;s--)e+=r[s].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,r){if(e!=n&&this.find)for(let s=0;s<this.find.length;s++)this.find[s].pos==null&&e.nodeType==1&&e.contains(this.find[s].node)&&n.compareDocumentPosition(this.find[s].node)&(r?2:4)&&(this.find[s].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),r=this.options.context,s=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(s?0:1),o=(a,l)=>{for(;a>=0;a--){let c=n[a];if(c==""){if(a==n.length-1||a==0)continue;for(;l>=i;l--)if(o(a-1,l))return!0;return!1}else{let u=l>0||l==0&&s?this.nodes[l].type:r&&l>=i?r.node(l-i).type:null;if(!u||u.name!=c&&!u.isInGroup(c))return!1;l--}}return!0};return o(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let n in this.parser.schema.nodes){let r=this.parser.schema.nodes[n];if(r.isTextblock&&r.defaultAttrs)return r}}}function AD(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&kC.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):r=="li"?n=e:r&&(n=null)}}function OD(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function Y1(t){let e={};for(let n in t)e[n]=t[n];return e}function Q1(t,e){let n=e.schema.nodes;for(let r in n){let s=n[r];if(!s.allowsMarkType(t))continue;let i=[],o=a=>{i.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==e||i.indexOf(u)<0&&o(u))return!0}};if(o(s.contentMatch))return!0}}class so{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},r){r||(r=$f(n).createDocumentFragment());let s=r,i=[];return e.forEach(o=>{if(i.length||o.marks.length){let a=0,l=0;for(;a<i.length&&l<o.marks.length;){let c=o.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(i[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<i.length;)s=i.pop()[1];for(;l<o.marks.length;){let c=o.marks[l++],u=this.serializeMark(c,o.isInline,n);u&&(i.push([c,s]),s.appendChild(u.dom),s=u.contentDOM||u.dom)}}s.appendChild(this.serializeNodeInner(o,n))}),r}serializeNodeInner(e,n){let{dom:r,contentDOM:s}=Au($f(n),this.nodes[e.type.name](e),null,e.attrs);if(s){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,s)}return r}serializeNode(e,n={}){let r=this.serializeNodeInner(e,n);for(let s=e.marks.length-1;s>=0;s--){let i=this.serializeMark(e.marks[s],e.isInline,n);i&&((i.contentDOM||i.dom).appendChild(r),r=i.dom)}return r}serializeMark(e,n,r={}){let s=this.marks[e.type.name];return s&&Au($f(r),s(e,n),null,e.attrs)}static renderSpec(e,n,r=null,s){return Au(e,n,r,s)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new so(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=X1(e.nodes);return n.text||(n.text=r=>r.text),n}static marksFromSchema(e){return X1(e.marks)}}function X1(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function $f(t){return t.document||window.document}const Z1=new WeakMap;function RD(t){let e=Z1.get(t);return e===void 0&&Z1.set(t,e=ND(t)),e}function ND(t){let e=null;function n(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let s=0;s<r.length;s++)n(r[s]);else for(let s in r)n(r[s])}return n(t),e}function Au(t,e,n,r){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let s=e[0],i;if(typeof s!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(i=RD(r))&&i.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let o=s.indexOf(" ");o>0&&(n=s.slice(0,o),s=s.slice(o+1));let a,l=n?t.createElementNS(n,s):t.createElement(s),c=e[1],u=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){u=2;for(let d in c)if(c[d]!=null){let h=d.indexOf(" ");h>0?l.setAttributeNS(d.slice(0,h),d.slice(h+1),c[d]):d=="style"&&l.style?l.style.cssText=c[d]:l.setAttribute(d,c[d])}}for(let d=u;d<e.length;d++){let h=e[d];if(h===0){if(d<e.length-1||d>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:f,contentDOM:p}=Au(t,h,n,r);if(l.appendChild(f),p){if(a)throw new RangeError("Multiple content holes");a=p}}}return{dom:l,contentDOM:a}}const SC=65535,EC=Math.pow(2,16);function ID(t,e){return t+e*EC}function ew(t){return t&SC}function PD(t){return(t-(t&SC))/EC}const CC=1,TC=2,Ou=4,_C=8;class $m{constructor(e,n,r){this.pos=e,this.delInfo=n,this.recover=r}get deleted(){return(this.delInfo&_C)>0}get deletedBefore(){return(this.delInfo&(CC|Ou))>0}get deletedAfter(){return(this.delInfo&(TC|Ou))>0}get deletedAcross(){return(this.delInfo&Ou)>0}}class Dn{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&Dn.empty)return Dn.empty}recover(e){let n=0,r=ew(e);if(!this.inverted)for(let s=0;s<r;s++)n+=this.ranges[s*3+2]-this.ranges[s*3+1];return this.ranges[r*3]+n+PD(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,r){let s=0,i=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?s:0);if(l>e)break;let c=this.ranges[a+i],u=this.ranges[a+o],d=l+c;if(e<=d){let h=c?e==l?-1:e==d?1:n:n,f=l+s+(h<0?0:u);if(r)return f;let p=e==(n<0?l:d)?null:ID(a/3,e-l),g=e==l?TC:e==d?CC:Ou;return(n<0?e!=l:e!=d)&&(g|=_C),new $m(f,g,p)}s+=u-c}return r?e+s:new $m(e+s,0,null)}touches(e,n){let r=0,s=ew(n),i=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+i],u=l+c;if(e<=u&&a==s*3)return!0;r+=this.ranges[a+o]-c}return!1}forEach(e){let n=this.inverted?2:1,r=this.inverted?1:2;for(let s=0,i=0;s<this.ranges.length;s+=3){let o=this.ranges[s],a=o-(this.inverted?i:0),l=o+(this.inverted?0:i),c=this.ranges[s+n],u=this.ranges[s+r];e(a,a+c,l,l+u),i+=u-c}}invert(){return new Dn(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Dn.empty:new Dn(e<0?[0,-e,0]:[0,0,e])}}Dn.empty=new Dn([]);class Ql{constructor(e,n,r=0,s=e?e.length:0){this.mirror=n,this.from=r,this.to=s,this._maps=e||[],this.ownData=!(e||n)}get maps(){return this._maps}slice(e=0,n=this.maps.length){return new Ql(this._maps,this.mirror,e,n)}appendMap(e,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),n!=null&&this.setMirror(this._maps.length-1,n)}appendMapping(e){for(let n=0,r=this._maps.length;n<e._maps.length;n++){let s=e.getMirror(n);this.appendMap(e._maps[n],s!=null&&s<n?r+s:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,r=this._maps.length+e._maps.length;n>=0;n--){let s=e.getMirror(n);this.appendMap(e._maps[n].invert(),s!=null&&s>n?r-s-1:void 0)}}invert(){let e=new Ql;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,r){let s=0;for(let i=this.from;i<this.to;i++){let o=this._maps[i],a=o.mapResult(e,n);if(a.recover!=null){let l=this.getMirror(i);if(l!=null&&l>i&&l<this.to){i=l,e=this._maps[l].recover(a.recover);continue}}s|=a.delInfo,e=a.pos}return r?e:new $m(e,s,null)}}const Ff=Object.create(null);class tn{getMap(){return Dn.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Ff[n.stepType];if(!r)throw new RangeError(`No step type ${n.stepType} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in Ff)throw new RangeError("Duplicate use of step JSON ID "+e);return Ff[e]=n,n.prototype.jsonID=e,n}}class vt{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new vt(e,null)}static fail(e){return new vt(null,e)}static fromReplace(e,n,r,s){try{return vt.ok(e.replace(n,r,s))}catch(i){if(i instanceof wd)return vt.fail(i.message);throw i}}}function V0(t,e,n){let r=[];for(let s=0;s<t.childCount;s++){let i=t.child(s);i.content.size&&(i=i.copy(V0(i.content,e,i))),i.isInline&&(i=e(i,n,s)),r.push(i)}return ee.fromArray(r)}class Ls extends tn{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=e.resolve(this.from),s=r.node(r.sharedDepth(this.to)),i=new ce(V0(n.content,(o,a)=>!o.isAtom||!a.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),s),n.openStart,n.openEnd);return vt.fromReplace(e,this.from,this.to,i)}invert(){return new Pr(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new Ls(n.pos,r.pos,this.mark)}merge(e){return e instanceof Ls&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Ls(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Ls(n.from,n.to,e.markFromJSON(n.mark))}}tn.jsonID("addMark",Ls);class Pr extends tn{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=new ce(V0(n.content,s=>s.mark(this.mark.removeFromSet(s.marks)),e),n.openStart,n.openEnd);return vt.fromReplace(e,this.from,this.to,r)}invert(){return new Ls(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new Pr(n.pos,r.pos,this.mark)}merge(e){return e instanceof Pr&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Pr(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Pr(n.from,n.to,e.markFromJSON(n.mark))}}tn.jsonID("removeMark",Pr);class $s extends tn{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return vt.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return vt.fromReplace(e,this.pos,this.pos+1,new ce(ee.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(let s=0;s<n.marks.length;s++)if(!n.marks[s].isInSet(r))return new $s(this.pos,n.marks[s]);return new $s(this.pos,this.mark)}}return new Qi(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new $s(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new $s(n.pos,e.markFromJSON(n.mark))}}tn.jsonID("addNodeMark",$s);class Qi extends tn{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return vt.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return vt.fromReplace(e,this.pos,this.pos+1,new ce(ee.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new $s(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Qi(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Qi(n.pos,e.markFromJSON(n.mark))}}tn.jsonID("removeNodeMark",Qi);class At extends tn{constructor(e,n,r,s=!1){super(),this.from=e,this.to=n,this.slice=r,this.structure=s}apply(e){return this.structure&&Fm(e,this.from,this.to)?vt.fail("Structure replace would overwrite content"):vt.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Dn([this.from,this.to-this.from,this.slice.size])}invert(e){return new At(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new At(n.pos,Math.max(n.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof At)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?ce.empty:new ce(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new At(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?ce.empty:new ce(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new At(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new At(n.from,n.to,ce.fromJSON(e,n.slice),!!n.structure)}}tn.jsonID("replace",At);class Nt extends tn{constructor(e,n,r,s,i,o,a=!1){super(),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=s,this.slice=i,this.insert=o,this.structure=a}apply(e){if(this.structure&&(Fm(e,this.from,this.gapFrom)||Fm(e,this.gapTo,this.to)))return vt.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return vt.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,n.content);return r?vt.fromReplace(e,this.from,this.to,r):vt.fail("Content does not fit in gap")}getMap(){return new Dn([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new Nt(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),s=this.from==this.gapFrom?n.pos:e.map(this.gapFrom,-1),i=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||s<n.pos||i>r.pos?null:new Nt(n.pos,r.pos,s,i,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Nt(n.from,n.to,n.gapFrom,n.gapTo,ce.fromJSON(e,n.slice),n.insert,!!n.structure)}}tn.jsonID("replaceAround",Nt);function Fm(t,e,n){let r=t.resolve(e),s=n-e,i=r.depth;for(;s>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,s--;if(s>0){let o=r.node(i).maybeChild(r.indexAfter(i));for(;s>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,s--}}return!1}function MD(t,e,n,r){let s=[],i=[],o,a;t.doc.nodesBetween(e,n,(l,c,u)=>{if(!l.isInline)return;let d=l.marks;if(!r.isInSet(d)&&u.type.allowsMarkType(r.type)){let h=Math.max(c,e),f=Math.min(c+l.nodeSize,n),p=r.addToSet(d);for(let g=0;g<d.length;g++)d[g].isInSet(p)||(o&&o.to==h&&o.mark.eq(d[g])?o.to=f:s.push(o=new Pr(h,f,d[g])));a&&a.to==h?a.to=f:i.push(a=new Ls(h,f,r))}}),s.forEach(l=>t.step(l)),i.forEach(l=>t.step(l))}function DD(t,e,n,r){let s=[],i=0;t.doc.nodesBetween(e,n,(o,a)=>{if(!o.isInline)return;i++;let l=null;if(r instanceof Mh){let c=o.marks,u;for(;u=r.isInSet(c);)(l||(l=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(o.marks)&&(l=[r]):l=o.marks;if(l&&l.length){let c=Math.min(a+o.nodeSize,n);for(let u=0;u<l.length;u++){let d=l[u],h;for(let f=0;f<s.length;f++){let p=s[f];p.step==i-1&&d.eq(s[f].style)&&(h=p)}h?(h.to=c,h.step=i):s.push({style:d,from:Math.max(a,e),to:c,step:i})}}}),s.forEach(o=>t.step(new Pr(o.from,o.to,o.style)))}function H0(t,e,n,r=n.contentMatch,s=!0){let i=t.doc.nodeAt(e),o=[],a=e+1;for(let l=0;l<i.childCount;l++){let c=i.child(l),u=a+c.nodeSize,d=r.matchType(c.type);if(!d)o.push(new At(a,u,ce.empty));else{r=d;for(let h=0;h<c.marks.length;h++)n.allowsMarkType(c.marks[h].type)||t.step(new Pr(a,u,c.marks[h]));if(s&&c.isText&&n.whitespace!="pre"){let h,f=/\r?\n|\r/g,p;for(;h=f.exec(c.text);)p||(p=new ce(ee.from(n.schema.text(" ",n.allowedMarks(c.marks))),0,0)),o.push(new At(a+h.index,a+h.index+h[0].length,p))}}a=u}if(!r.validEnd){let l=r.fillBefore(ee.empty,!0);t.replace(a,a,new ce(l,0,0))}for(let l=o.length-1;l>=0;l--)t.step(o[l])}function jD(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function ka(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let r=t.depth,s=0,i=0;;--r){let o=t.$from.node(r),a=t.$from.index(r)+s,l=t.$to.indexAfter(r)-i;if(r<t.depth&&o.canReplace(a,l,n))return r;if(r==0||o.type.spec.isolating||!jD(o,a,l))break;a&&(s=1),l<o.childCount&&(i=1)}return null}function LD(t,e,n){let{$from:r,$to:s,depth:i}=e,o=r.before(i+1),a=s.after(i+1),l=o,c=a,u=ee.empty,d=0;for(let p=i,g=!1;p>n;p--)g||r.index(p)>0?(g=!0,u=ee.from(r.node(p).copy(u)),d++):l--;let h=ee.empty,f=0;for(let p=i,g=!1;p>n;p--)g||s.after(p+1)<s.end(p)?(g=!0,h=ee.from(s.node(p).copy(h)),f++):c++;t.step(new Nt(l,c,o,a,new ce(u.append(h),d,f),u.size-d,!0))}function W0(t,e,n=null,r=t){let s=$D(t,e),i=s&&FD(r,e);return i?s.map(tw).concat({type:e,attrs:n}).concat(i.map(tw)):null}function tw(t){return{type:t,attrs:null}}function $D(t,e){let{parent:n,startIndex:r,endIndex:s}=t,i=n.contentMatchAt(r).findWrapping(e);if(!i)return null;let o=i.length?i[0]:e;return n.canReplaceWith(r,s,o)?i:null}function FD(t,e){let{parent:n,startIndex:r,endIndex:s}=t,i=n.child(r),o=e.contentMatch.findWrapping(i.type);if(!o)return null;let l=(o.length?o[o.length-1]:e).contentMatch;for(let c=r;l&&c<s;c++)l=l.matchType(n.child(c).type);return!l||!l.validEnd?null:o}function BD(t,e,n){let r=ee.empty;for(let o=n.length-1;o>=0;o--){if(r.size){let a=n[o].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=ee.from(n[o].type.create(n[o].attrs,r))}let s=e.start,i=e.end;t.step(new Nt(s,i,s,i,new ce(r,0,0),n.length,!0))}function UD(t,e,n,r,s){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=t.steps.length;t.doc.nodesBetween(e,n,(o,a)=>{let l=typeof s=="function"?s(o):s;if(o.isTextblock&&!o.hasMarkup(r,l)&&zD(t.doc,t.mapping.slice(i).map(a),r)){let c=null;if(r.schema.linebreakReplacement){let f=r.whitespace=="pre",p=!!r.contentMatch.matchType(r.schema.linebreakReplacement);f&&!p?c=!1:!f&&p&&(c=!0)}c===!1&&OC(t,o,a,i),H0(t,t.mapping.slice(i).map(a,1),r,void 0,c===null);let u=t.mapping.slice(i),d=u.map(a,1),h=u.map(a+o.nodeSize,1);return t.step(new Nt(d,h,d+1,h-1,new ce(ee.from(r.create(l,null,o.marks)),0,0),1,!0)),c===!0&&AC(t,o,a,i),!1}})}function AC(t,e,n,r){e.forEach((s,i)=>{if(s.isText){let o,a=/\r?\n|\r/g;for(;o=a.exec(s.text);){let l=t.mapping.slice(r).map(n+1+i+o.index);t.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function OC(t,e,n,r){e.forEach((s,i)=>{if(s.type==s.type.schema.linebreakReplacement){let o=t.mapping.slice(r).map(n+1+i);t.replaceWith(o,o+1,e.type.schema.text(`
`))}})}function zD(t,e,n){let r=t.resolve(e),s=r.index();return r.parent.canReplaceWith(s,s+1,n)}function VD(t,e,n,r,s){let i=t.doc.nodeAt(e);if(!i)throw new RangeError("No node at given position");n||(n=i.type);let o=n.create(r,null,s||i.marks);if(i.isLeaf)return t.replaceWith(e,e+i.nodeSize,o);if(!n.validContent(i.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new Nt(e,e+i.nodeSize,e+1,e+i.nodeSize-1,new ce(ee.from(o),0,0),1,!0))}function Qo(t,e,n=1,r){let s=t.resolve(e),i=s.depth-n,o=r&&r[r.length-1]||s.parent;if(i<0||s.parent.type.spec.isolating||!s.parent.canReplace(s.index(),s.parent.childCount)||!o.type.validContent(s.parent.content.cutByIndex(s.index(),s.parent.childCount)))return!1;for(let c=s.depth-1,u=n-2;c>i;c--,u--){let d=s.node(c),h=s.index(c);if(d.type.spec.isolating)return!1;let f=d.content.cutByIndex(h,d.childCount),p=r&&r[u+1];p&&(f=f.replaceChild(0,p.type.create(p.attrs)));let g=r&&r[u]||d;if(!d.canReplace(h+1,d.childCount)||!g.type.validContent(f))return!1}let a=s.indexAfter(i),l=r&&r[0];return s.node(i).canReplaceWith(a,a,l?l.type:s.node(i+1).type)}function HD(t,e,n=1,r){let s=t.doc.resolve(e),i=ee.empty,o=ee.empty;for(let a=s.depth,l=s.depth-n,c=n-1;a>l;a--,c--){i=ee.from(s.node(a).copy(i));let u=r&&r[c];o=ee.from(u?u.type.create(u.attrs,o):s.node(a).copy(o))}t.step(new At(e,e,new ce(i.append(o),n,n),!0))}function ci(t,e){let n=t.resolve(e),r=n.index();return RC(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function WD(t,e){e.content.size||t.type.compatibleContent(e.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:r}=t.type.schema;for(let s=0;s<e.childCount;s++){let i=e.child(s),o=i.type==r?t.type.schema.nodes.text:i.type;if(n=n.matchType(o),!n||!t.type.allowsMarks(i.marks))return!1}return n.validEnd}function RC(t,e){return!!(t&&e&&!t.isLeaf&&WD(t,e))}function Dh(t,e,n=-1){let r=t.resolve(e);for(let s=r.depth;;s--){let i,o,a=r.index(s);if(s==r.depth?(i=r.nodeBefore,o=r.nodeAfter):n>0?(i=r.node(s+1),a++,o=r.node(s).maybeChild(a)):(i=r.node(s).maybeChild(a-1),o=r.node(s+1)),i&&!i.isTextblock&&RC(i,o)&&r.node(s).canReplace(a,a+1))return e;if(s==0)break;e=n<0?r.before(s):r.after(s)}}function KD(t,e,n){let r=null,{linebreakReplacement:s}=t.doc.type.schema,i=t.doc.resolve(e-n),o=i.node().type;if(s&&o.inlineContent){let u=o.whitespace=="pre",d=!!o.contentMatch.matchType(s);u&&!d?r=!1:!u&&d&&(r=!0)}let a=t.steps.length;if(r===!1){let u=t.doc.resolve(e+n);OC(t,u.node(),u.before(),a)}o.inlineContent&&H0(t,e+n-1,o,i.node().contentMatchAt(i.index()),r==null);let l=t.mapping.slice(a),c=l.map(e-n);if(t.step(new At(c,l.map(e+n,-1),ce.empty,!0)),r===!0){let u=t.doc.resolve(c);AC(t,u.node(),u.before(),t.steps.length)}return t}function qD(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(r.parentOffset==0)for(let s=r.depth-1;s>=0;s--){let i=r.index(s);if(r.node(s).canReplaceWith(i,i,n))return r.before(s+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(let s=r.depth-1;s>=0;s--){let i=r.indexAfter(s);if(r.node(s).canReplaceWith(i,i,n))return r.after(s+1);if(i<r.node(s).childCount)return null}return null}function NC(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let s=n.content;for(let i=0;i<n.openStart;i++)s=s.firstChild.content;for(let i=1;i<=(n.openStart==0&&n.size?2:1);i++)for(let o=r.depth;o>=0;o--){let a=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,l=r.index(o)+(a>0?1:0),c=r.node(o),u=!1;if(i==1)u=c.canReplace(l,l,s);else{let d=c.contentMatchAt(l).findWrapping(s.firstChild.type);u=d&&c.canReplaceWith(l,l,d[0])}if(u)return a==0?r.pos:a<0?r.before(o+1):r.after(o+1)}return null}function jh(t,e,n=e,r=ce.empty){if(e==n&&!r.size)return null;let s=t.resolve(e),i=t.resolve(n);return IC(s,i,r)?new At(e,n,r):new GD(s,i,r).fit()}function IC(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class GD{constructor(e,n,r){this.$from=e,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=ee.empty;for(let s=0;s<=e.depth;s++){let i=e.node(s);this.frontier.push({type:i.type,match:i.contentMatchAt(e.indexAfter(s))})}for(let s=e.depth;s>0;s--)this.placed=ee.from(e.node(s).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,s=this.close(e<0?this.$to:r.doc.resolve(e));if(!s)return null;let i=this.placed,o=r.depth,a=s.depth;for(;o&&a&&i.childCount==1;)i=i.firstChild.content,o--,a--;let l=new ce(i,o,a);return e>-1?new Nt(r.pos,e,this.$to.pos,this.$to.end(),l,n):l.size||r.pos!=this.$to.pos?new At(r.pos,s.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,r=0,s=this.unplaced.openEnd;r<e;r++){let i=n.firstChild;if(n.childCount>1&&(s=0),i.type.spec.isolating&&s<=r){e=r;break}n=i.content}for(let n=1;n<=2;n++)for(let r=n==1?e:this.unplaced.openStart;r>=0;r--){let s,i=null;r?(i=Bf(this.unplaced.content,r-1).firstChild,s=i.content):s=this.unplaced.content;let o=s.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],u,d=null;if(n==1&&(o?c.matchType(o.type)||(d=c.fillBefore(ee.from(o),!1)):i&&l.compatibleContent(i.type)))return{sliceDepth:r,frontierDepth:a,parent:i,inject:d};if(n==2&&o&&(u=c.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:a,parent:i,wrap:u};if(i&&c.matchType(i.type))break}}}openMore(){let{content:e,openStart:n,openEnd:r}=this.unplaced,s=Bf(e,n);return!s.childCount||s.firstChild.isLeaf?!1:(this.unplaced=new ce(e,n+1,Math.max(r,s.size+n>=e.size-r?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:r}=this.unplaced,s=Bf(e,n);if(s.childCount<=1&&n>0){let i=e.size-n<=n+s.size;this.unplaced=new ce(Wa(e,n-1,1),n-1,i?n-1:r)}else this.unplaced=new ce(Wa(e,n,1),n,r)}placeNodes({sliceDepth:e,frontierDepth:n,parent:r,inject:s,wrap:i}){for(;this.depth>n;)this.closeFrontierNode();if(i)for(let g=0;g<i.length;g++)this.openFrontierNode(i[g]);let o=this.unplaced,a=r?r.content:o.content,l=o.openStart-e,c=0,u=[],{match:d,type:h}=this.frontier[n];if(s){for(let g=0;g<s.childCount;g++)u.push(s.child(g));d=d.matchFragment(s)}let f=a.size+e-(o.content.size-o.openEnd);for(;c<a.childCount;){let g=a.child(c),y=d.matchType(g.type);if(!y)break;c++,(c>1||l==0||g.content.size)&&(d=y,u.push(PC(g.mark(h.allowedMarks(g.marks)),c==1?l:0,c==a.childCount?f:-1)))}let p=c==a.childCount;p||(f=-1),this.placed=Ka(this.placed,n,ee.from(u)),this.frontier[n].match=d,p&&f<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let g=0,y=a;g<f;g++){let m=y.lastChild;this.frontier.push({type:m.type,match:m.contentMatchAt(m.childCount)}),y=m.content}this.unplaced=p?e==0?ce.empty:new ce(Wa(o.content,e-1,1),e-1,f<0?o.openEnd:e-1):new ce(Wa(o.content,e,c),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!Uf(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:r}=this.$to,s=this.$to.after(r);for(;r>1&&s==this.$to.end(--r);)++s;return s}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:r,type:s}=this.frontier[n],i=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),o=Uf(e,n,s,r,i);if(o){for(let a=n-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=Uf(e,a,c,l,!0);if(!u||u.childCount)continue e}return{depth:n,fit:o,move:i?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=Ka(this.placed,n.depth,n.fit)),e=n.move;for(let r=n.depth+1;r<=e.depth;r++){let s=e.node(r),i=s.type.contentMatch.fillBefore(s.content,!0,e.index(r));this.openFrontierNode(s.type,s.attrs,i)}return e}openFrontierNode(e,n=null,r){let s=this.frontier[this.depth];s.match=s.match.matchType(e),this.placed=Ka(this.placed,this.depth,ee.from(e.create(n,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(ee.empty,!0);n.childCount&&(this.placed=Ka(this.placed,this.frontier.length,n))}}function Wa(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(Wa(t.firstChild.content,e-1,n)))}function Ka(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(Ka(t.lastChild.content,e-1,n)))}function Bf(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function PC(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,PC(r.firstChild,e-1,r.childCount==1?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(ee.empty,!0)))),t.copy(r)}function Uf(t,e,n,r,s){let i=t.node(e),o=s?t.indexAfter(e):t.index(e);if(o==i.childCount&&!n.compatibleContent(i.type))return null;let a=r.fillBefore(i.content,!0,o);return a&&!JD(n,i.content,o)?a:null}function JD(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}function YD(t){return t.spec.defining||t.spec.definingForContent}function QD(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let s=t.doc.resolve(e),i=t.doc.resolve(n);if(IC(s,i,r))return t.step(new At(e,n,r));let o=DC(s,i);o[o.length-1]==0&&o.pop();let a=-(s.depth+1);o.unshift(a);for(let h=s.depth,f=s.pos-1;h>0;h--,f--){let p=s.node(h).type.spec;if(p.defining||p.definingAsContext||p.isolating)break;o.indexOf(h)>-1?a=h:s.before(h)==f&&o.splice(1,0,-h)}let l=o.indexOf(a),c=[],u=r.openStart;for(let h=r.content,f=0;;f++){let p=h.firstChild;if(c.push(p),f==r.openStart)break;h=p.content}for(let h=u-1;h>=0;h--){let f=c[h],p=YD(f.type);if(p&&!f.sameMarkup(s.node(Math.abs(a)-1)))u=h;else if(p||!f.type.isTextblock)break}for(let h=r.openStart;h>=0;h--){let f=(h+u+1)%(r.openStart+1),p=c[f];if(p)for(let g=0;g<o.length;g++){let y=o[(g+l)%o.length],m=!0;y<0&&(m=!1,y=-y);let v=s.node(y-1),w=s.index(y-1);if(v.canReplaceWith(w,w,p.type,p.marks))return t.replace(s.before(y),m?i.after(y):n,new ce(MC(r.content,0,r.openStart,f),f,r.openEnd))}}let d=t.steps.length;for(let h=o.length-1;h>=0&&(t.replace(e,n,r),!(t.steps.length>d));h--){let f=o[h];f<0||(e=s.before(f),n=i.after(f))}}function MC(t,e,n,r,s){if(e<n){let i=t.firstChild;t=t.replaceChild(0,i.copy(MC(i.content,e+1,n,r,i)))}if(e>r){let i=s.contentMatchAt(0),o=i.fillBefore(t).append(t);t=o.append(i.matchFragment(o).fillBefore(ee.empty,!0))}return t}function XD(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let s=qD(t.doc,e,r.type);s!=null&&(e=n=s)}t.replaceRange(e,n,new ce(ee.from(r),0,0))}function ZD(t,e,n){let r=t.doc.resolve(e),s=t.doc.resolve(n),i=DC(r,s);for(let o=0;o<i.length;o++){let a=i[o],l=o==i.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return t.delete(r.start(a),s.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),s.indexAfter(a-1))))return t.delete(r.before(a),s.after(a))}for(let o=1;o<=r.depth&&o<=s.depth;o++)if(e-r.start(o)==r.depth-o&&n>r.end(o)&&s.end(o)-n!=s.depth-o&&r.start(o-1)==s.start(o-1)&&r.node(o-1).canReplace(r.index(o-1),s.index(o-1)))return t.delete(r.before(o),n);t.delete(e,n)}function DC(t,e){let n=[],r=Math.min(t.depth,e.depth);for(let s=r;s>=0;s--){let i=t.start(s);if(i<t.pos-(t.depth-s)||e.end(s)>e.pos+(e.depth-s)||t.node(s).type.spec.isolating||e.node(s).type.spec.isolating)break;(i==e.start(s)||s==t.depth&&s==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&s&&e.start(s-1)==i-1)&&n.push(s)}return n}class Xo extends tn{constructor(e,n,r){super(),this.pos=e,this.attr=n,this.value=r}apply(e){let n=e.nodeAt(this.pos);if(!n)return vt.fail("No node at attribute step's position");let r=Object.create(null);for(let i in n.attrs)r[i]=n.attrs[i];r[this.attr]=this.value;let s=n.type.create(r,null,n.marks);return vt.fromReplace(e,this.pos,this.pos+1,new ce(ee.from(s),0,n.isLeaf?0:1))}getMap(){return Dn.empty}invert(e){return new Xo(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Xo(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Xo(n.pos,n.attr,n.value)}}tn.jsonID("attr",Xo);class Xl extends tn{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let s in e.attrs)n[s]=e.attrs[s];n[this.attr]=this.value;let r=e.type.create(n,e.content,e.marks);return vt.ok(r)}getMap(){return Dn.empty}invert(e){return new Xl(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Xl(n.attr,n.value)}}tn.jsonID("docAttr",Xl);let la=class extends Error{};la=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n};la.prototype=Object.create(Error.prototype);la.prototype.constructor=la;la.prototype.name="TransformError";class jC{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Ql}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new la(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,r=ce.empty){let s=jh(this.doc,e,n,r);return s&&this.step(s),this}replaceWith(e,n,r){return this.replace(e,n,new ce(ee.from(r),0,0))}delete(e,n){return this.replace(e,n,ce.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,r){return QD(this,e,n,r),this}replaceRangeWith(e,n,r){return XD(this,e,n,r),this}deleteRange(e,n){return ZD(this,e,n),this}lift(e,n){return LD(this,e,n),this}join(e,n=1){return KD(this,e,n),this}wrap(e,n){return BD(this,e,n),this}setBlockType(e,n=e,r,s=null){return UD(this,e,n,r,s),this}setNodeMarkup(e,n,r=null,s){return VD(this,e,n,r,s),this}setNodeAttribute(e,n,r){return this.step(new Xo(e,n,r)),this}setDocAttribute(e,n){return this.step(new Xl(e,n)),this}addNodeMark(e,n){return this.step(new $s(e,n)),this}removeNodeMark(e,n){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(n instanceof ze)n.isInSet(r.marks)&&this.step(new Qi(e,n));else{let s=r.marks,i,o=[];for(;i=n.isInSet(s);)o.push(new Qi(e,i)),s=i.removeFromSet(s);for(let a=o.length-1;a>=0;a--)this.step(o[a])}return this}split(e,n=1,r){return HD(this,e,n,r),this}addMark(e,n,r){return MD(this,e,n,r),this}removeMark(e,n,r){return DD(this,e,n,r),this}clearIncompatible(e,n,r){return H0(this,e,n,r),this}}const zf=Object.create(null);class Pe{constructor(e,n,r){this.$anchor=e,this.$head=n,this.ranges=r||[new ej(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=ce.empty){let r=n.content.lastChild,s=null;for(let a=0;a<n.openEnd;a++)s=r,r=r.lastChild;let i=e.steps.length,o=this.ranges;for(let a=0;a<o.length;a++){let{$from:l,$to:c}=o[a],u=e.mapping.slice(i);e.replaceRange(u.map(l.pos),u.map(c.pos),a?ce.empty:n),a==0&&sw(e,i,(r?r.isInline:s&&s.isTextblock)?-1:1)}}replaceWith(e,n){let r=e.steps.length,s=this.ranges;for(let i=0;i<s.length;i++){let{$from:o,$to:a}=s[i],l=e.mapping.slice(r),c=l.map(o.pos),u=l.map(a.pos);i?e.deleteRange(c,u):(e.replaceRangeWith(c,u,n),sw(e,r,n.isInline?-1:1))}}static findFrom(e,n,r=!1){let s=e.parent.inlineContent?new Ae(e):xo(e.node(0),e.parent,e.pos,e.index(),n,r);if(s)return s;for(let i=e.depth-1;i>=0;i--){let o=n<0?xo(e.node(0),e.node(i),e.before(i+1),e.index(i),n,r):xo(e.node(0),e.node(i),e.after(i+1),e.index(i)+1,n,r);if(o)return o}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new tr(e.node(0))}static atStart(e){return xo(e,e,0,0,1)||new tr(e)}static atEnd(e){return xo(e,e,e.content.size,e.childCount,-1)||new tr(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=zf[n.type];if(!r)throw new RangeError(`No selection type ${n.type} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in zf)throw new RangeError("Duplicate use of selection JSON ID "+e);return zf[e]=n,n.prototype.jsonID=e,n}getBookmark(){return Ae.between(this.$anchor,this.$head).getBookmark()}}Pe.prototype.visible=!0;class ej{constructor(e,n){this.$from=e,this.$to=n}}let nw=!1;function rw(t){!nw&&!t.parent.inlineContent&&(nw=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class Ae extends Pe{constructor(e,n=e){rw(e),rw(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let r=e.resolve(n.map(this.head));if(!r.parent.inlineContent)return Pe.near(r);let s=e.resolve(n.map(this.anchor));return new Ae(s.parent.inlineContent?s:r,r)}replace(e,n=ce.empty){if(super.replace(e,n),n==ce.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof Ae&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Lh(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new Ae(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){let s=e.resolve(n);return new this(s,r==n?s:e.resolve(r))}static between(e,n,r){let s=e.pos-n.pos;if((!r||s)&&(r=s>=0?1:-1),!n.parent.inlineContent){let i=Pe.findFrom(n,r,!0)||Pe.findFrom(n,-r,!0);if(i)n=i.$head;else return Pe.near(n,r)}return e.parent.inlineContent||(s==0?e=n:(e=(Pe.findFrom(e,-r,!0)||Pe.findFrom(e,r,!0)).$anchor,e.pos<n.pos!=s<0&&(e=n))),new Ae(e,n)}}Pe.jsonID("text",Ae);class Lh{constructor(e,n){this.anchor=e,this.head=n}map(e){return new Lh(e.map(this.anchor),e.map(this.head))}resolve(e){return Ae.between(e.resolve(this.anchor),e.resolve(this.head))}}class xe extends Pe{constructor(e){let n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);super(e,r),this.node=n}map(e,n){let{deleted:r,pos:s}=n.mapResult(this.anchor),i=e.resolve(s);return r?Pe.near(i):new xe(i)}content(){return new ce(ee.from(this.node),0,0)}eq(e){return e instanceof xe&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new K0(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new xe(e.resolve(n.anchor))}static create(e,n){return new xe(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}xe.prototype.visible=!1;Pe.jsonID("node",xe);class K0{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:r}=e.mapResult(this.anchor);return n?new Lh(r,r):new K0(r)}resolve(e){let n=e.resolve(this.anchor),r=n.nodeAfter;return r&&xe.isSelectable(r)?new xe(n):Pe.near(n)}}class tr extends Pe{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=ce.empty){if(n==ce.empty){e.delete(0,e.doc.content.size);let r=Pe.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new tr(e)}map(e){return new tr(e)}eq(e){return e instanceof tr}getBookmark(){return tj}}Pe.jsonID("all",tr);const tj={map(){return this},resolve(t){return new tr(t)}};function xo(t,e,n,r,s,i=!1){if(e.inlineContent)return Ae.create(t,n);for(let o=r-(s>0?0:1);s>0?o<e.childCount:o>=0;o+=s){let a=e.child(o);if(a.isAtom){if(!i&&xe.isSelectable(a))return xe.create(t,n-(s<0?a.nodeSize:0))}else{let l=xo(t,a,n+s,s<0?a.childCount:0,s,i);if(l)return l}n+=a.nodeSize*s}return null}function sw(t,e,n){let r=t.steps.length-1;if(r<e)return;let s=t.steps[r];if(!(s instanceof At||s instanceof Nt))return;let i=t.mapping.maps[r],o;i.forEach((a,l,c,u)=>{o==null&&(o=u)}),t.setSelection(Pe.near(t.doc.resolve(o),n))}const iw=1,Zc=2,ow=4;class nj extends jC{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|iw)&~Zc,this.storedMarks=null,this}get selectionSet(){return(this.updated&iw)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Zc,this}ensureMarks(e){return ze.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Zc)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&~Zc,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let r=this.selection;return n&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||ze.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,r){let s=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(s.text(e),!0):this.deleteSelection();{if(r==null&&(r=n),!e)return this.deleteRange(n,r);let i=this.storedMarks;if(!i){let o=this.doc.resolve(n);i=r==n?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(n,r,s.text(e,i)),!this.selection.empty&&this.selection.to==n+e.length&&this.setSelection(Pe.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=ow,this}get scrolledIntoView(){return(this.updated&ow)>0}}function aw(t,e){return!e||!t?t:t.bind(e)}class qa{constructor(e,n,r){this.name=e,this.init=aw(n.init,r),this.apply=aw(n.apply,r)}}const rj=[new qa("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new qa("selection",{init(t,e){return t.selection||Pe.atStart(e.doc)},apply(t){return t.selection}}),new qa("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new qa("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class Vf{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=rj.slice(),n&&n.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new qa(r.key,r.spec.state,r))})}}class Lo{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=n){let s=this.config.plugins[r];if(s.spec.filterTransaction&&!s.spec.filterTransaction.call(s,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],r=this.applyInner(e),s=null;for(;;){let i=!1;for(let o=0;o<this.config.plugins.length;o++){let a=this.config.plugins[o];if(a.spec.appendTransaction){let l=s?s[o].n:0,c=s?s[o].state:this,u=l<n.length&&a.spec.appendTransaction.call(a,l?n.slice(l):n,c,r);if(u&&r.filterTransaction(u,o)){if(u.setMeta("appendedTransaction",e),!s){s=[];for(let d=0;d<this.config.plugins.length;d++)s.push(d<o?{state:r,n:n.length}:{state:this,n:0})}n.push(u),r=r.applyInner(u),i=!0}s&&(s[o]={state:r,n:n.length})}}if(!i)return{state:r,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new Lo(this.config),r=this.config.fields;for(let s=0;s<r.length;s++){let i=r[s];n[i.name]=i.apply(e,this[i.name],this,n)}return n}get tr(){return new nj(this)}static create(e){let n=new Vf(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new Lo(n);for(let s=0;s<n.fields.length;s++)r[n.fields[s].name]=n.fields[s].init(e,r);return r}reconfigure(e){let n=new Vf(this.schema,e.plugins),r=n.fields,s=new Lo(n);for(let i=0;i<r.length;i++){let o=r[i].name;s[o]=this.hasOwnProperty(o)?this[o]:r[i].init(e,s)}return s}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let s=e[r],i=s.spec.state;i&&i.toJSON&&(n[r]=i.toJSON.call(s,this[s.key]))}return n}static fromJSON(e,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let s=new Vf(e.schema,e.plugins),i=new Lo(s);return s.fields.forEach(o=>{if(o.name=="doc")i.doc=Gs.fromJSON(e.schema,n.doc);else if(o.name=="selection")i.selection=Pe.fromJSON(i.doc,n.selection);else if(o.name=="storedMarks")n.storedMarks&&(i.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],c=l.spec.state;if(l.key==o.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(n,a)){i[o.name]=c.fromJSON.call(l,e,n[a],i);return}}i[o.name]=o.init(e,i)}}),i}}function LC(t,e,n){for(let r in t){let s=t[r];s instanceof Function?s=s.bind(e):r=="handleDOMEvents"&&(s=LC(s,e,{})),n[r]=s}return n}class Mt{constructor(e){this.spec=e,this.props={},e.props&&LC(e.props,this,this.props),this.key=e.key?e.key.key:$C("plugin")}getState(e){return e[this.key]}}const Hf=Object.create(null);function $C(t){return t in Hf?t+"$"+ ++Hf[t]:(Hf[t]=0,t+"$")}class En{constructor(e="key"){this.key=$C(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Bt=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},ca=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let Bm=null;const Qr=function(t,e,n){let r=Bm||(Bm=document.createRange());return r.setEnd(t,n??t.nodeValue.length),r.setStart(t,e||0),r},sj=function(){Bm=null},Xi=function(t,e,n,r){return n&&(lw(t,e,n,r,-1)||lw(t,e,n,r,1))},ij=/^(img|br|input|textarea|hr)$/i;function lw(t,e,n,r,s){for(var i;;){if(t==n&&e==r)return!0;if(e==(s<0?0:Qn(t))){let o=t.parentNode;if(!o||o.nodeType!=1||bc(t)||ij.test(t.nodeName)||t.contentEditable=="false")return!1;e=Bt(t)+(s<0?0:1),t=o}else if(t.nodeType==1){let o=t.childNodes[e+(s<0?-1:0)];if(o.nodeType==1&&o.contentEditable=="false")if(!((i=o.pmViewDesc)===null||i===void 0)&&i.ignoreForSelection)e+=s;else return!1;else t=o,e=s<0?Qn(t):0}else return!1}}function Qn(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function oj(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=Qn(t)}else if(t.parentNode&&!bc(t))e=Bt(t),t=t.parentNode;else return null}}function aj(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!bc(t))e=Bt(t)+1,t=t.parentNode;else return null}}function lj(t,e,n){for(let r=e==0,s=e==Qn(t);r||s;){if(t==n)return!0;let i=Bt(t);if(t=t.parentNode,!t)return!1;r=r&&i==0,s=s&&i==Qn(t)}}function bc(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const $h=function(t){return t.focusNode&&Xi(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function ki(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function cj(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function uj(t,e,n){if(t.caretPositionFromPoint)try{let r=t.caretPositionFromPoint(e,n);if(r)return{node:r.offsetNode,offset:Math.min(Qn(r.offsetNode),r.offset)}}catch{}if(t.caretRangeFromPoint){let r=t.caretRangeFromPoint(e,n);if(r)return{node:r.startContainer,offset:Math.min(Qn(r.startContainer),r.startOffset)}}}const $r=typeof navigator<"u"?navigator:null,cw=typeof document<"u"?document:null,ui=$r&&$r.userAgent||"",Um=/Edge\/(\d+)/.exec(ui),FC=/MSIE \d/.exec(ui),zm=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ui),Sn=!!(FC||zm||Um),Ys=FC?document.documentMode:zm?+zm[1]:Um?+Um[1]:0,nr=!Sn&&/gecko\/(\d+)/i.test(ui);nr&&+(/Firefox\/(\d+)/.exec(ui)||[0,0])[1];const Vm=!Sn&&/Chrome\/(\d+)/.exec(ui),Ot=!!Vm,BC=Vm?+Vm[1]:0,Xt=!Sn&&!!$r&&/Apple Computer/.test($r.vendor),ua=Xt&&(/Mobile\/\w+/.test(ui)||!!$r&&$r.maxTouchPoints>2),Gn=ua||($r?/Mac/.test($r.platform):!1),UC=$r?/Win/.test($r.platform):!1,ns=/Android \d/.test(ui),kc=!!cw&&"webkitFontSmoothing"in cw.documentElement.style,dj=kc?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function hj(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function Wr(t,e){return typeof t=="number"?t:t[e]}function fj(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function uw(t,e,n){let r=t.someProp("scrollThreshold")||0,s=t.someProp("scrollMargin")||5,i=t.dom.ownerDocument;for(let o=n||t.dom;o;){if(o.nodeType!=1){o=ca(o);continue}let a=o,l=a==i.body,c=l?hj(i):fj(a),u=0,d=0;if(e.top<c.top+Wr(r,"top")?d=-(c.top-e.top+Wr(s,"top")):e.bottom>c.bottom-Wr(r,"bottom")&&(d=e.bottom-e.top>c.bottom-c.top?e.top+Wr(s,"top")-c.top:e.bottom-c.bottom+Wr(s,"bottom")),e.left<c.left+Wr(r,"left")?u=-(c.left-e.left+Wr(s,"left")):e.right>c.right-Wr(r,"right")&&(u=e.right-c.right+Wr(s,"right")),u||d)if(l)i.defaultView.scrollBy(u,d);else{let f=a.scrollLeft,p=a.scrollTop;d&&(a.scrollTop+=d),u&&(a.scrollLeft+=u);let g=a.scrollLeft-f,y=a.scrollTop-p;e={left:e.left-g,top:e.top-y,right:e.right-g,bottom:e.bottom-y}}let h=l?"fixed":getComputedStyle(o).position;if(/^(fixed|sticky)$/.test(h))break;o=h=="absolute"?o.offsetParent:ca(o)}}function pj(t){let e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top),r,s;for(let i=(e.left+e.right)/2,o=n+1;o<Math.min(innerHeight,e.bottom);o+=5){let a=t.root.elementFromPoint(i,o);if(!a||a==t.dom||!t.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=n-20){r=a,s=l.top;break}}return{refDOM:r,refTop:s,stack:zC(t.dom)}}function zC(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=ca(r));return e}function mj({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;VC(n,r==0?0:r-e)}function VC(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:s,left:i}=t[n];r.scrollTop!=s+e&&(r.scrollTop=s+e),r.scrollLeft!=i&&(r.scrollLeft=i)}}let po=null;function gj(t){if(t.setActive)return t.setActive();if(po)return t.focus(po);let e=zC(t);t.focus(po==null?{get preventScroll(){return po={preventScroll:!0},!0}}:void 0),po||(po=!1,VC(e,0))}function HC(t,e){let n,r=2e8,s,i=0,o=e.top,a=e.top,l,c;for(let u=t.firstChild,d=0;u;u=u.nextSibling,d++){let h;if(u.nodeType==1)h=u.getClientRects();else if(u.nodeType==3)h=Qr(u).getClientRects();else continue;for(let f=0;f<h.length;f++){let p=h[f];if(p.top<=o&&p.bottom>=a){o=Math.max(p.bottom,o),a=Math.min(p.top,a);let g=p.left>e.left?p.left-e.left:p.right<e.left?e.left-p.right:0;if(g<r){n=u,r=g,s=g&&n.nodeType==3?{left:p.right<e.left?p.right:p.left,top:e.top}:e,u.nodeType==1&&g&&(i=d+(e.left>=(p.left+p.right)/2?1:0));continue}}else p.top>e.top&&!l&&p.left<=e.left&&p.right>=e.left&&(l=u,c={left:Math.max(p.left,Math.min(p.right,e.left)),top:p.top});!n&&(e.left>=p.right&&e.top>=p.top||e.left>=p.left&&e.top>=p.bottom)&&(i=d+1)}}return!n&&l&&(n=l,s=c,r=0),n&&n.nodeType==3?yj(n,s):!n||r&&n.nodeType==1?{node:t,offset:i}:HC(n,s)}function yj(t,e){let n=t.nodeValue.length,r=document.createRange(),s;for(let i=0;i<n;i++){r.setEnd(t,i+1),r.setStart(t,i);let o=bs(r,1);if(o.top!=o.bottom&&q0(e,o)){s={node:t,offset:i+(e.left>=(o.left+o.right)/2?1:0)};break}}return r.detach(),s||{node:t,offset:0}}function q0(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function vj(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function wj(t,e,n){let{node:r,offset:s}=HC(e,n),i=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();i=o.left!=o.right&&n.left>(o.left+o.right)/2?1:-1}return t.docView.posFromDOM(r,s,i)}function xj(t,e,n,r){let s=-1;for(let i=e,o=!1;i!=t.dom;){let a=t.docView.nearestDesc(i,!0),l;if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)&&((l=a.dom.getBoundingClientRect()).width||l.height)&&(a.node.isBlock&&a.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(a.dom.nodeName)&&(!o&&l.left>r.left||l.top>r.top?s=a.posBefore:(!o&&l.right<r.left||l.bottom<r.top)&&(s=a.posAfter),o=!0),!a.contentDOM&&s<0&&!a.node.isText))return(a.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?a.posBefore:a.posAfter;i=a.dom.parentNode}return s>-1?s:t.docView.posFromDOM(e,n,-1)}function WC(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let s=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),i=s;;){let o=t.childNodes[i];if(o.nodeType==1){let a=o.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(q0(e,c))return WC(o,e,c)}}if((i=(i+1)%r)==s)break}return t}function bj(t,e){let n=t.dom.ownerDocument,r,s=0,i=uj(n,e.left,e.top);i&&({node:r,offset:s}=i);let o=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top),a;if(!o||!t.dom.contains(o.nodeType!=1?o.parentNode:o)){let c=t.dom.getBoundingClientRect();if(!q0(e,c)||(o=WC(t.dom,e,c),!o))return null}if(Xt)for(let c=o;r&&c;c=ca(c))c.draggable&&(r=void 0);if(o=vj(o,e),r){if(nr&&r.nodeType==1&&(s=Math.min(s,r.childNodes.length),s<r.childNodes.length)){let u=r.childNodes[s],d;u.nodeName=="IMG"&&(d=u.getBoundingClientRect()).right<=e.left&&d.bottom>e.top&&s++}let c;kc&&s&&r.nodeType==1&&(c=r.childNodes[s-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&s--,r==t.dom&&s==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?a=t.state.doc.content.size:(s==0||r.nodeType!=1||r.childNodes[s-1].nodeName!="BR")&&(a=xj(t,r,s,e))}a==null&&(a=wj(t,o,e));let l=t.docView.nearestDesc(o,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function dw(t){return t.top<t.bottom||t.left<t.right}function bs(t,e){let n=t.getClientRects();if(n.length){let r=n[e<0?0:n.length-1];if(dw(r))return r}return Array.prototype.find.call(n,dw)||t.getBoundingClientRect()}const kj=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function KC(t,e,n){let{node:r,offset:s,atom:i}=t.docView.domFromPos(e,n<0?-1:1),o=kc||nr;if(r.nodeType==3)if(o&&(kj.test(r.nodeValue)||(n<0?!s:s==r.nodeValue.length))){let l=bs(Qr(r,s,s),n);if(nr&&s&&/\s/.test(r.nodeValue[s-1])&&s<r.nodeValue.length){let c=bs(Qr(r,s-1,s-1),-1);if(c.top==l.top){let u=bs(Qr(r,s,s+1),-1);if(u.top!=l.top)return ja(u,u.left<c.left)}}return l}else{let l=s,c=s,u=n<0?1:-1;return n<0&&!s?(c++,u=-1):n>=0&&s==r.nodeValue.length?(l--,u=1):n<0?l--:c++,ja(bs(Qr(r,l,c),u),u<0)}if(!t.state.doc.resolve(e-(i||0)).parent.inlineContent){if(i==null&&s&&(n<0||s==Qn(r))){let l=r.childNodes[s-1];if(l.nodeType==1)return Wf(l.getBoundingClientRect(),!1)}if(i==null&&s<Qn(r)){let l=r.childNodes[s];if(l.nodeType==1)return Wf(l.getBoundingClientRect(),!0)}return Wf(r.getBoundingClientRect(),n>=0)}if(i==null&&s&&(n<0||s==Qn(r))){let l=r.childNodes[s-1],c=l.nodeType==3?Qr(l,Qn(l)-(o?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return ja(bs(c,1),!1)}if(i==null&&s<Qn(r)){let l=r.childNodes[s];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?Qr(l,0,o?0:1):l.nodeType==1?l:null:null;if(c)return ja(bs(c,-1),!0)}return ja(bs(r.nodeType==3?Qr(r):r,-n),n>=0)}function ja(t,e){if(t.width==0)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function Wf(t,e){if(t.height==0)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function qC(t,e,n){let r=t.state,s=t.root.activeElement;r!=e&&t.updateState(e),s!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),s!=t.dom&&s&&s.focus()}}function Sj(t,e,n){let r=e.selection,s=n=="up"?r.$from:r.$to;return qC(t,e,()=>{let{node:i}=t.docView.domFromPos(s.pos,n=="up"?-1:1);for(;;){let a=t.docView.nearestDesc(i,!0);if(!a)break;if(a.node.isBlock){i=a.contentDOM||a.dom;break}i=a.dom.parentNode}let o=KC(t,s.pos,1);for(let a=i.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=Qr(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let u=l[c];if(u.bottom>u.top+1&&(n=="up"?o.top-u.top>(u.bottom-o.top)*2:u.bottom-o.bottom>(o.bottom-u.top)*2))return!1}}return!0})}const Ej=/[\u0590-\u08ac]/;function Cj(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let s=r.parentOffset,i=!s,o=s==r.parent.content.size,a=t.domSelection();return a?!Ej.test(r.parent.textContent)||!a.modify?n=="left"||n=="backward"?i:o:qC(t,e,()=>{let{focusNode:l,focusOffset:c,anchorNode:u,anchorOffset:d}=t.domSelectionRange(),h=a.caretBidiLevel;a.modify("move",n,"character");let f=r.depth?t.docView.domAfterPos(r.before()):t.dom,{focusNode:p,focusOffset:g}=t.domSelectionRange(),y=p&&!f.contains(p.nodeType==1?p:p.parentNode)||l==p&&c==g;try{a.collapse(u,d),l&&(l!=u||c!=d)&&a.extend&&a.extend(l,c)}catch{}return h!=null&&(a.caretBidiLevel=h),y}):r.pos==r.start()||r.pos==r.end()}let hw=null,fw=null,pw=!1;function Tj(t,e,n){return hw==e&&fw==n?pw:(hw=e,fw=n,pw=n=="up"||n=="down"?Sj(t,e,n):Cj(t,e,n))}const rr=0,mw=1,Oi=2,Fr=3;class Sc{constructor(e,n,r,s){this.parent=e,this.children=n,this.dom=r,this.contentDOM=s,this.dirty=rr,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,r=this.posAtStart;;n++){let s=this.children[n];if(s==e)return r;r+=s.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let i,o;if(e==this.contentDOM)i=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.previousSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.previousSibling;return i?this.posBeforeChild(o)+o.size:this.posAtStart}else{let i,o;if(e==this.contentDOM)i=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.nextSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.nextSibling;return i?this.posBeforeChild(o):this.posAtEnd}let s;if(e==this.dom&&this.contentDOM)s=n>Bt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))s=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let i=e;;i=i.parentNode){if(i==this.dom){s=!1;break}if(i.previousSibling)break}if(s==null&&n==e.childNodes.length)for(let i=e;;i=i.parentNode){if(i==this.dom){s=!0;break}if(i.nextSibling)break}}return s??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let r=!0,s=e;s;s=s.parentNode){let i=this.getDesc(s),o;if(i&&(!n||i.node))if(r&&(o=i.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))r=!1;else return i}}getDesc(e){let n=e.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(e,n,r){for(let s=e;s;s=s.parentNode){let i=this.getDesc(s);if(i)return i.localPosFromDOM(e,n,r)}return-1}descAt(e){for(let n=0,r=0;n<this.children.length;n++){let s=this.children[n],i=r+s.size;if(r==e&&i!=r){for(;!s.border&&s.children.length;)for(let o=0;o<s.children.length;o++){let a=s.children[o];if(a.size){s=a;break}}return s}if(e<i)return s.descAt(e-r-s.border);r=i}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,s=0;for(let i=0;r<this.children.length;r++){let o=this.children[r],a=i+o.size;if(a>e||o instanceof JC){s=e-i;break}i=a}if(s)return this.children[r].domFromPos(s-this.children[r].border,n);for(let i;r&&!(i=this.children[r-1]).size&&i instanceof GC&&i.side>=0;r--);if(n<=0){let i,o=!0;for(;i=r?this.children[r-1]:null,!(!i||i.dom.parentNode==this.contentDOM);r--,o=!1);return i&&n&&o&&!i.border&&!i.domAtom?i.domFromPos(i.size,n):{node:this.contentDOM,offset:i?Bt(i.dom)+1:0}}else{let i,o=!0;for(;i=r<this.children.length?this.children[r]:null,!(!i||i.dom.parentNode==this.contentDOM);r++,o=!1);return i&&o&&!i.border&&!i.domAtom?i.domFromPos(0,n):{node:this.contentDOM,offset:i?Bt(i.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let s=-1,i=-1;for(let o=r,a=0;;a++){let l=this.children[a],c=o+l.size;if(s==-1&&e<=c){let u=o+l.border;if(e>=u&&n<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,n,u);e=o;for(let d=a;d>0;d--){let h=this.children[d-1];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(1)){s=Bt(h.dom)+1;break}e-=h.size}s==-1&&(s=0)}if(s>-1&&(c>n||a==this.children.length-1)){n=c;for(let u=a+1;u<this.children.length;u++){let d=this.children[u];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){i=Bt(d.dom);break}n+=d.size}i==-1&&(i=this.contentDOM.childNodes.length);break}o=c}return{node:this.contentDOM,from:e,to:n,fromOffset:s,toOffset:i}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:r}=this.domFromPos(e,0);if(n.nodeType!=1||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}setSelection(e,n,r,s=!1){let i=Math.min(e,n),o=Math.max(e,n);for(let f=0,p=0;f<this.children.length;f++){let g=this.children[f],y=p+g.size;if(i>p&&o<y)return g.setSelection(e-p-g.border,n-p-g.border,r,s);p=y}let a=this.domFromPos(e,e?-1:1),l=n==e?a:this.domFromPos(n,n?-1:1),c=r.root.getSelection(),u=r.domSelectionRange(),d=!1;if((nr||Xt)&&e==n){let{node:f,offset:p}=a;if(f.nodeType==3){if(d=!!(p&&f.nodeValue[p-1]==`
`),d&&p==f.nodeValue.length)for(let g=f,y;g;g=g.parentNode){if(y=g.nextSibling){y.nodeName=="BR"&&(a=l={node:y.parentNode,offset:Bt(y)+1});break}let m=g.pmViewDesc;if(m&&m.node&&m.node.isBlock)break}}else{let g=f.childNodes[p-1];d=g&&(g.nodeName=="BR"||g.contentEditable=="false")}}if(nr&&u.focusNode&&u.focusNode!=l.node&&u.focusNode.nodeType==1){let f=u.focusNode.childNodes[u.focusOffset];f&&f.contentEditable=="false"&&(s=!0)}if(!(s||d&&Xt)&&Xi(a.node,a.offset,u.anchorNode,u.anchorOffset)&&Xi(l.node,l.offset,u.focusNode,u.focusOffset))return;let h=!1;if((c.extend||e==n)&&!(d&&nr)){c.collapse(a.node,a.offset);try{e!=n&&c.extend(l.node,l.offset),h=!0}catch{}}if(!h){if(e>n){let p=a;a=l,l=p}let f=document.createRange();f.setEnd(l.node,l.offset),f.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(f)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let r=0,s=0;s<this.children.length;s++){let i=this.children[s],o=r+i.size;if(r==o?e<=o&&n>=r:e<o&&n>r){let a=r+i.border,l=o-i.border;if(e>=a&&n<=l){this.dirty=e==r||n==o?Oi:mw,e==a&&n==l&&(i.contentLost||i.dom.parentNode!=this.contentDOM)?i.dirty=Fr:i.markDirty(e-a,n-a);return}else i.dirty=i.dom==i.contentDOM&&i.dom.parentNode==this.contentDOM&&!i.children.length?Oi:Fr}r=o}this.dirty=Oi}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let r=e==1?Oi:mw;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class GC extends Sc{constructor(e,n,r,s){let i,o=n.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!i)return s;if(i.parent)return i.parent.posBeforeChild(i)})),!n.type.spec.raw){if(o.nodeType!=1){let a=document.createElement("span");a.appendChild(o),o=a}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=n,this.widget=n,i=this}matchesWidget(e){return this.dirty==rr&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class _j extends Sc{constructor(e,n,r,s){super(e,[],n,null),this.textDOM=r,this.text=s}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class Zi extends Sc{constructor(e,n,r,s,i){super(e,[],r,s),this.mark=n,this.spec=i}static create(e,n,r,s){let i=s.nodeViews[n.type.name],o=i&&i(n,s,r);return(!o||!o.dom)&&(o=so.renderSpec(document,n.type.spec.toDOM(n,r),null,n.attrs)),new Zi(e,n,o.dom,o.contentDOM||o.dom,o)}parseRule(){return this.dirty&Fr||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Fr&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=rr){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=rr}}slice(e,n,r){let s=Zi.create(this.parent,this.mark,!0,r),i=this.children,o=this.size;n<o&&(i=Wm(i,n,o,r)),e>0&&(i=Wm(i,0,e,r));for(let a=0;a<i.length;a++)i[a].parent=s;return s.children=i,s}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Qs extends Sc{constructor(e,n,r,s,i,o,a,l,c){super(e,[],i,o),this.node=n,this.outerDeco=r,this.innerDeco=s,this.nodeDOM=a}static create(e,n,r,s,i,o){let a=i.nodeViews[n.type.name],l,c=a&&a(n,i,()=>{if(!l)return o;if(l.parent)return l.parent.posBeforeChild(l)},r,s),u=c&&c.dom,d=c&&c.contentDOM;if(n.isText){if(!u)u=document.createTextNode(n.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:d}=so.renderSpec(document,n.type.spec.toDOM(n),null,n.attrs));!d&&!n.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),n.type.spec.draggable&&(u.draggable=!0));let h=u;return u=XC(u,r,n),c?l=new Aj(e,n,r,s,u,d||null,h,c,i,o+1):n.isText?new Fh(e,n,r,s,u,h,i):new Qs(e,n,r,s,u,d||null,h,i,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>ee.empty)}return e}matchesNode(e,n,r){return this.dirty==rr&&e.eq(this.node)&&Sd(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let r=this.node.inlineContent,s=n,i=e.composing?this.localCompositionInfo(e,n):null,o=i&&i.pos>-1?i:null,a=i&&i.pos<0,l=new Rj(this,o&&o.node,e);Pj(this.node,this.innerDeco,(c,u,d)=>{c.spec.marks?l.syncToMarks(c.spec.marks,r,e):c.type.side>=0&&!d&&l.syncToMarks(u==this.node.childCount?ze.none:this.node.child(u).marks,r,e),l.placeWidget(c,e,s)},(c,u,d,h)=>{l.syncToMarks(c.marks,r,e);let f;l.findNodeMatch(c,u,d,h)||a&&e.state.selection.from>s&&e.state.selection.to<s+c.nodeSize&&(f=l.findIndexWithChild(i.node))>-1&&l.updateNodeAt(c,u,d,f,e)||l.updateNextNode(c,u,d,e,h,s)||l.addNode(c,u,d,e,s),s+=c.nodeSize}),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==Oi)&&(o&&this.protectLocalComposition(e,o),YC(this.contentDOM,this.children,e),ua&&Mj(this.dom))}localCompositionInfo(e,n){let{from:r,to:s}=e.state.selection;if(!(e.state.selection instanceof Ae)||r<n||s>n+this.node.content.size)return null;let i=e.input.compositionNode;if(!i||!this.dom.contains(i.parentNode))return null;if(this.node.inlineContent){let o=i.nodeValue,a=Dj(this.node.content,o,r-n,s-n);return a<0?null:{node:i,pos:a,text:o}}else return{node:i,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:r,text:s}){if(this.getDesc(n))return;let i=n;for(;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}let o=new _j(this,i,n,s);e.input.compositionNodes.push(o),this.children=Wm(this.children,r,r+s.length,e,o)}update(e,n,r,s){return this.dirty==Fr||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,r,s),!0)}updateInner(e,n,r,s){this.updateOuterDeco(n),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(s,this.posAtStart),this.dirty=rr}updateOuterDeco(e){if(Sd(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=QC(this.dom,this.nodeDOM,Hm(this.outerDeco,this.node,n),Hm(e,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function gw(t,e,n,r,s){XC(r,e,t);let i=new Qs(void 0,t,e,n,r,r,r,s,0);return i.contentDOM&&i.updateChildren(s,0),i}class Fh extends Qs{constructor(e,n,r,s,i,o,a){super(e,n,r,s,i,null,o,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,r,s){return this.dirty==Fr||this.dirty!=rr&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=rr||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,s.trackWrites==this.nodeDOM&&(s.trackWrites=null)),this.node=e,this.dirty=rr,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,r){let s=this.node.cut(e,n),i=document.createTextNode(s.text);return new Fh(this.parent,s,this.outerDeco,this.innerDeco,i,i,r)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=Fr)}get domAtom(){return!1}isText(e){return this.node.text==e}}class JC extends Sc{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==rr&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class Aj extends Qs{constructor(e,n,r,s,i,o,a,l,c,u){super(e,n,r,s,i,o,a,c,u),this.spec=l}update(e,n,r,s){if(this.dirty==Fr)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let i=this.spec.update(e,n,r);return i&&this.updateInner(e,n,r,s),i}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,r,s)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,r,s){this.spec.setSelection?this.spec.setSelection(e,n,r.root):super.setSelection(e,n,r,s)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function YC(t,e,n){let r=t.firstChild,s=!1;for(let i=0;i<e.length;i++){let o=e[i],a=o.dom;if(a.parentNode==t){for(;a!=r;)r=yw(r),s=!0;r=r.nextSibling}else s=!0,t.insertBefore(a,r);if(o instanceof Zi){let l=r?r.previousSibling:t.lastChild;YC(o.contentDOM,o.children,n),r=l?l.nextSibling:t.firstChild}}for(;r;)r=yw(r),s=!0;s&&n.trackWrites==t&&(n.trackWrites=null)}const cl=function(t){t&&(this.nodeName=t)};cl.prototype=Object.create(null);const Ri=[new cl];function Hm(t,e,n){if(t.length==0)return Ri;let r=n?Ri[0]:new cl,s=[r];for(let i=0;i<t.length;i++){let o=t[i].type.attrs;if(o){o.nodeName&&s.push(r=new cl(o.nodeName));for(let a in o){let l=o[a];l!=null&&(n&&s.length==1&&s.push(r=new cl(e.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return s}function QC(t,e,n,r){if(n==Ri&&r==Ri)return e;let s=e;for(let i=0;i<r.length;i++){let o=r[i],a=n[i];if(i){let l;a&&a.nodeName==o.nodeName&&s!=t&&(l=s.parentNode)&&l.nodeName.toLowerCase()==o.nodeName||(l=document.createElement(o.nodeName),l.pmIsDeco=!0,l.appendChild(s),a=Ri[0]),s=l}Oj(s,a||Ri[0],o)}return s}function Oj(t,e,n){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in n)&&t.removeAttribute(r);for(let r in n)r!="class"&&r!="style"&&r!="nodeName"&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],s=n.class?n.class.split(" ").filter(Boolean):[];for(let i=0;i<r.length;i++)s.indexOf(r[i])==-1&&t.classList.remove(r[i]);for(let i=0;i<s.length;i++)r.indexOf(s[i])==-1&&t.classList.add(s[i]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,s;for(;s=r.exec(e.style);)t.style.removeProperty(s[1])}n.style&&(t.style.cssText+=n.style)}}function XC(t,e,n){return QC(t,t,Ri,Hm(e,n,t.nodeType!=1))}function Sd(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function yw(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class Rj{constructor(e,n,r){this.lock=n,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=Nj(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let r=e;r<n;r++)this.top.children[r].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,r){let s=0,i=this.stack.length>>1,o=Math.min(i,e.length);for(;s<o&&(s==i-1?this.top:this.stack[s+1<<1]).matchesMark(e[s])&&e[s].type.spec.spanning!==!1;)s++;for(;s<i;)this.destroyRest(),this.top.dirty=rr,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let c=this.top.children[l];if(c.matchesMark(e[i])&&!this.isLocked(c.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=Zi.create(this.top,e[i],n,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,i++}}findNodeMatch(e,n,r,s){let i=-1,o;if(s>=this.preMatch.index&&(o=this.preMatch.matches[s-this.preMatch.index]).parent==this.top&&o.matchesNode(e,n,r))i=this.top.children.indexOf(o,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(e,n,r)&&!this.preMatch.matched.has(c)){i=a;break}}return i<0?!1:(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(e,n,r,s,i){let o=this.top.children[s];return o.dirty==Fr&&o.dom==o.contentDOM&&(o.dirty=Oi),o.update(e,n,r,i)?(this.destroyBetween(this.index,s),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let s=this.index;s<this.top.children.length;s++)if(this.top.children[s]==r)return s}return-1}e=n}}updateNextNode(e,n,r,s,i,o){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof Qs){let c=this.preMatch.matched.get(l);if(c!=null&&c!=i)return!1;let u=l.dom,d,h=this.isLocked(u)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=Fr&&Sd(n,l.outerDeco));if(!h&&l.update(e,n,r,s))return this.destroyBetween(this.index,a),l.dom!=u&&(this.changed=!0),this.index++,!0;if(!h&&(d=this.recreateWrapper(l,e,n,r,s,o)))return this.destroyBetween(this.index,a),this.top.children[this.index]=d,d.contentDOM&&(d.dirty=Oi,d.updateChildren(s,o+1),d.dirty=rr),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,n,r,s,i,o){if(e.dirty||n.isAtom||!e.children.length||!e.node.content.eq(n.content)||!Sd(r,e.outerDeco)||!s.eq(e.innerDeco))return null;let a=Qs.create(this.top,n,r,s,i,o);if(a.contentDOM){a.children=e.children,e.children=[];for(let l of a.children)l.parent=a}return e.destroy(),a}addNode(e,n,r,s,i){let o=Qs.create(this.top,e,n,r,s,i);o.contentDOM&&o.updateChildren(s,i+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,n,r){let s=this.index<this.top.children.length?this.top.children[this.index]:null;if(s&&s.matchesWidget(e)&&(e==s.widget||!s.widget.type.toDOM.parentNode))this.index++;else{let i=new GC(this.top,e,n,r);this.top.children.splice(this.index++,0,i),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof Zi;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof Fh)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Xt||Ot)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let s=new JC(this.top,[],r,null);n!=this.top?n.children.push(s):n.children.splice(this.index++,0,s),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function Nj(t,e){let n=e,r=n.children.length,s=t.childCount,i=new Map,o=[];e:for(;s>0;){let a;for(;;)if(r){let c=n.children[r-1];if(c instanceof Zi)n=c,r=c.children.length;else{a=c,r--;break}}else{if(n==e)break e;r=n.parent.children.indexOf(n),n=n.parent}let l=a.node;if(l){if(l!=t.child(s-1))break;--s,i.set(a,s),o.push(a)}}return{index:s,matched:i,matches:o.reverse()}}function Ij(t,e){return t.type.side-e.type.side}function Pj(t,e,n,r){let s=e.locals(t),i=0;if(s.length==0){for(let c=0;c<t.childCount;c++){let u=t.child(c);r(u,s,e.forChild(i,u),c),i+=u.nodeSize}return}let o=0,a=[],l=null;for(let c=0;;){let u,d;for(;o<s.length&&s[o].to==i;){let y=s[o++];y.widget&&(u?(d||(d=[u])).push(y):u=y)}if(u)if(d){d.sort(Ij);for(let y=0;y<d.length;y++)n(d[y],c,!!l)}else n(u,c,!!l);let h,f;if(l)f=-1,h=l,l=null;else if(c<t.childCount)f=c,h=t.child(c++);else break;for(let y=0;y<a.length;y++)a[y].to<=i&&a.splice(y--,1);for(;o<s.length&&s[o].from<=i&&s[o].to>i;)a.push(s[o++]);let p=i+h.nodeSize;if(h.isText){let y=p;o<s.length&&s[o].from<y&&(y=s[o].from);for(let m=0;m<a.length;m++)a[m].to<y&&(y=a[m].to);y<p&&(l=h.cut(y-i),h=h.cut(0,y-i),p=y,f=-1)}else for(;o<s.length&&s[o].to<p;)o++;let g=h.isInline&&!h.isLeaf?a.filter(y=>!y.inline):a.slice();r(h,g,e.forChild(i,h),f),i=p}}function Mj(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function Dj(t,e,n,r){for(let s=0,i=0;s<t.childCount&&i<=r;){let o=t.child(s++),a=i;if(i+=o.nodeSize,!o.isText)continue;let l=o.text;for(;s<t.childCount;){let c=t.child(s++);if(i+=c.nodeSize,!c.isText)break;l+=c.text}if(i>=n){if(i>=r&&l.slice(r-e.length-a,r-a)==e)return r-e.length;let c=a<r?l.lastIndexOf(e,r-a-1):-1;if(c>=0&&c+e.length+a>=n)return a+c;if(n==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}function Wm(t,e,n,r,s){let i=[];for(let o=0,a=0;o<t.length;o++){let l=t[o],c=a,u=a+=l.size;c>=n||u<=e?i.push(l):(c<e&&i.push(l.slice(0,e-c,r)),s&&(i.push(s),s=void 0),u>n&&i.push(l.slice(n-c,l.size,r)))}return i}function G0(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let s=t.docView.nearestDesc(n.focusNode),i=s&&s.size==0,o=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(o<0)return null;let a=r.resolve(o),l,c;if($h(n)){for(l=o;s&&!s.node;)s=s.parent;let d=s.node;if(s&&d.isAtom&&xe.isSelectable(d)&&s.parent&&!(d.isInline&&lj(n.focusNode,n.focusOffset,s.dom))){let h=s.posBefore;c=new xe(o==h?a:r.resolve(h))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let d=o,h=o;for(let f=0;f<n.rangeCount;f++){let p=n.getRangeAt(f);d=Math.min(d,t.docView.posFromDOM(p.startContainer,p.startOffset,1)),h=Math.max(h,t.docView.posFromDOM(p.endContainer,p.endOffset,-1))}if(d<0)return null;[l,o]=h==t.state.selection.anchor?[h,d]:[d,h],a=r.resolve(o)}else l=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(l<0)return null}let u=r.resolve(l);if(!c){let d=e=="pointer"||t.state.selection.head<a.pos&&!i?1:-1;c=J0(t,u,a,d)}return c}function ZC(t){return t.editable?t.hasFocus():tT(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function as(t,e=!1){let n=t.state.selection;if(eT(t,n),!!ZC(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&Ot){let r=t.domSelectionRange(),s=t.domObserver.currentSelection;if(r.anchorNode&&s.anchorNode&&Xi(r.anchorNode,r.anchorOffset,s.anchorNode,s.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)Lj(t);else{let{anchor:r,head:s}=n,i,o;vw&&!(n instanceof Ae)&&(n.$from.parent.inlineContent||(i=ww(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(o=ww(t,n.to))),t.docView.setSelection(r,s,t,e),vw&&(i&&xw(i),o&&xw(o)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&jj(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const vw=Xt||Ot&&BC<63;function ww(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),s=r<n.childNodes.length?n.childNodes[r]:null,i=r?n.childNodes[r-1]:null;if(Xt&&s&&s.contentEditable=="false")return Kf(s);if((!s||s.contentEditable=="false")&&(!i||i.contentEditable=="false")){if(s)return Kf(s);if(i)return Kf(i)}}function Kf(t){return t.contentEditable="true",Xt&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function xw(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function jj(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,s=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=s)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!ZC(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function Lj(t){let e=t.domSelection();if(!e)return;let n=t.cursorWrapper.dom,r=n.nodeName=="IMG";r?e.collapse(n.parentNode,Bt(n)+1):e.collapse(n,0),!r&&!t.state.selection.visible&&Sn&&Ys<=11&&(n.disabled=!0,n.disabled=!1)}function eT(t,e){if(e instanceof xe){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(bw(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else bw(t)}function bw(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function J0(t,e,n,r){return t.someProp("createSelectionBetween",s=>s(t,e,n))||Ae.between(e,n,r)}function kw(t){return t.editable&&!t.hasFocus()?!1:tT(t)}function tT(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function $j(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return Xi(e.node,e.offset,n.anchorNode,n.anchorOffset)}function Km(t,e){let{$anchor:n,$head:r}=t.selection,s=e>0?n.max(r):n.min(r),i=s.parent.inlineContent?s.depth?t.doc.resolve(e>0?s.after():s.before()):null:s;return i&&Pe.findFrom(i,e)}function Ts(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function Sw(t,e,n){let r=t.state.selection;if(r instanceof Ae)if(n.indexOf("s")>-1){let{$head:s}=r,i=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter;if(!i||i.isText||!i.isLeaf)return!1;let o=t.state.doc.resolve(s.pos+i.nodeSize*(e<0?-1:1));return Ts(t,new Ae(r.$anchor,o))}else if(r.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let s=Km(t.state,e);return s&&s instanceof xe?Ts(t,s):!1}else if(!(Gn&&n.indexOf("m")>-1)){let s=r.$head,i=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter,o;if(!i||i.isText)return!1;let a=e<0?s.pos-i.nodeSize:s.pos;return i.isAtom||(o=t.docView.descAt(a))&&!o.contentDOM?xe.isSelectable(i)?Ts(t,new xe(e<0?t.state.doc.resolve(s.pos-i.nodeSize):s)):kc?Ts(t,new Ae(t.state.doc.resolve(e<0?a:a+i.nodeSize))):!1:!1}}else return!1;else{if(r instanceof xe&&r.node.isInline)return Ts(t,new Ae(e>0?r.$to:r.$from));{let s=Km(t.state,e);return s?Ts(t,s):!1}}}function Ed(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function ul(t,e){let n=t.pmViewDesc;return n&&n.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function mo(t,e){return e<0?Fj(t):Bj(t)}function Fj(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let s,i,o=!1;for(nr&&n.nodeType==1&&r<Ed(n)&&ul(n.childNodes[r],-1)&&(o=!0);;)if(r>0){if(n.nodeType!=1)break;{let a=n.childNodes[r-1];if(ul(a,-1))s=n,i=--r;else if(a.nodeType==3)n=a,r=n.nodeValue.length;else break}}else{if(nT(n))break;{let a=n.previousSibling;for(;a&&ul(a,-1);)s=n.parentNode,i=Bt(a),a=a.previousSibling;if(a)n=a,r=Ed(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}o?qm(t,n,r):s&&qm(t,s,i)}function Bj(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let s=Ed(n),i,o;for(;;)if(r<s){if(n.nodeType!=1)break;let a=n.childNodes[r];if(ul(a,1))i=n,o=++r;else break}else{if(nT(n))break;{let a=n.nextSibling;for(;a&&ul(a,1);)i=a.parentNode,o=Bt(a)+1,a=a.nextSibling;if(a)n=a,r=0,s=Ed(n);else{if(n=n.parentNode,n==t.dom)break;r=s=0}}}i&&qm(t,i,o)}function nT(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function Uj(t,e){for(;t&&e==t.childNodes.length&&!bc(t);)e=Bt(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=0}}function zj(t,e){for(;t&&!e&&!bc(t);)e=Bt(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=t.childNodes.length}}function qm(t,e,n){if(e.nodeType!=3){let i,o;(o=Uj(e,n))?(e=o,n=0):(i=zj(e,n))&&(e=i,n=i.nodeValue.length)}let r=t.domSelection();if(!r)return;if($h(r)){let i=document.createRange();i.setEnd(e,n),i.setStart(e,n),r.removeAllRanges(),r.addRange(i)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:s}=t;setTimeout(()=>{t.state==s&&as(t)},50)}function Ew(t,e){let n=t.state.doc.resolve(e);if(!(Ot||UC)&&n.parent.inlineContent){let s=t.coordsAtPos(e);if(e>n.start()){let i=t.coordsAtPos(e-1),o=(i.top+i.bottom)/2;if(o>s.top&&o<s.bottom&&Math.abs(i.left-s.left)>1)return i.left<s.left?"ltr":"rtl"}if(e<n.end()){let i=t.coordsAtPos(e+1),o=(i.top+i.bottom)/2;if(o>s.top&&o<s.bottom&&Math.abs(i.left-s.left)>1)return i.left>s.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function Cw(t,e,n){let r=t.state.selection;if(r instanceof Ae&&!r.empty||n.indexOf("s")>-1||Gn&&n.indexOf("m")>-1)return!1;let{$from:s,$to:i}=r;if(!s.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let o=Km(t.state,e);if(o&&o instanceof xe)return Ts(t,o)}if(!s.parent.inlineContent){let o=e<0?s:i,a=r instanceof tr?Pe.near(o,e):Pe.findFrom(o,e);return a?Ts(t,a):!1}return!1}function Tw(t,e){if(!(t.state.selection instanceof Ae))return!0;let{$head:n,$anchor:r,empty:s}=t.state.selection;if(!n.sameParent(r))return!0;if(!s)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let i=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(i&&!i.isText){let o=t.state.tr;return e<0?o.delete(n.pos-i.nodeSize,n.pos):o.delete(n.pos,n.pos+i.nodeSize),t.dispatch(o),!0}return!1}function _w(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function Vj(t){if(!Xt||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;_w(t,r,"true"),setTimeout(()=>_w(t,r,"false"),20)}return!1}function Hj(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function Wj(t,e){let n=e.keyCode,r=Hj(e);if(n==8||Gn&&n==72&&r=="c")return Tw(t,-1)||mo(t,-1);if(n==46&&!e.shiftKey||Gn&&n==68&&r=="c")return Tw(t,1)||mo(t,1);if(n==13||n==27)return!0;if(n==37||Gn&&n==66&&r=="c"){let s=n==37?Ew(t,t.state.selection.from)=="ltr"?-1:1:-1;return Sw(t,s,r)||mo(t,s)}else if(n==39||Gn&&n==70&&r=="c"){let s=n==39?Ew(t,t.state.selection.from)=="ltr"?1:-1:1;return Sw(t,s,r)||mo(t,s)}else{if(n==38||Gn&&n==80&&r=="c")return Cw(t,-1,r)||mo(t,-1);if(n==40||Gn&&n==78&&r=="c")return Vj(t)||Cw(t,1,r)||mo(t,1);if(r==(Gn?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function Y0(t,e){t.someProp("transformCopied",f=>{e=f(e,t)});let n=[],{content:r,openStart:s,openEnd:i}=e;for(;s>1&&i>1&&r.childCount==1&&r.firstChild.childCount==1;){s--,i--;let f=r.firstChild;n.push(f.type.name,f.attrs!=f.type.defaultAttrs?f.attrs:null),r=f.content}let o=t.someProp("clipboardSerializer")||so.fromSchema(t.state.schema),a=lT(),l=a.createElement("div");l.appendChild(o.serializeFragment(r,{document:a}));let c=l.firstChild,u,d=0;for(;c&&c.nodeType==1&&(u=aT[c.nodeName.toLowerCase()]);){for(let f=u.length-1;f>=0;f--){let p=a.createElement(u[f]);for(;l.firstChild;)p.appendChild(l.firstChild);l.appendChild(p),d++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${s} ${i}${d?` -${d}`:""} ${JSON.stringify(n)}`);let h=t.someProp("clipboardTextSerializer",f=>f(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:h,slice:e}}function rT(t,e,n,r,s){let i=s.parent.type.spec.code,o,a;if(!n&&!e)return null;let l=!!e&&(r||i||!n);if(l){if(t.someProp("transformPastedText",h=>{e=h(e,i||r,t)}),i)return a=new ce(ee.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),t.someProp("transformPasted",h=>{a=h(a,t,!0)}),a;let d=t.someProp("clipboardTextParser",h=>h(e,s,r,t));if(d)a=d;else{let h=s.marks(),{schema:f}=t.state,p=so.fromSchema(f);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(g=>{let y=o.appendChild(document.createElement("p"));g&&y.appendChild(p.serializeNode(f.text(g,h)))})}}else t.someProp("transformPastedHTML",d=>{n=d(n,t)}),o=Jj(n),kc&&Yj(o);let c=o&&o.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let d=+u[3];d>0;d--){let h=o.firstChild;for(;h&&h.nodeType!=1;)h=h.nextSibling;if(!h)break;o=h}if(a||(a=(t.someProp("clipboardParser")||t.someProp("domParser")||Js.fromSchema(t.state.schema)).parseSlice(o,{preserveWhitespace:!!(l||u),context:s,ruleFromNode(h){return h.nodeName=="BR"&&!h.nextSibling&&h.parentNode&&!Kj.test(h.parentNode.nodeName)?{ignore:!0}:null}})),u)a=Qj(Aw(a,+u[1],+u[2]),u[4]);else if(a=ce.maxOpen(qj(a.content,s),!0),a.openStart||a.openEnd){let d=0,h=0;for(let f=a.content.firstChild;d<a.openStart&&!f.type.spec.isolating;d++,f=f.firstChild);for(let f=a.content.lastChild;h<a.openEnd&&!f.type.spec.isolating;h++,f=f.lastChild);a=Aw(a,d,h)}return t.someProp("transformPasted",d=>{a=d(a,t,l)}),a}const Kj=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function qj(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let s=e.node(n).contentMatchAt(e.index(n)),i,o=[];if(t.forEach(a=>{if(!o)return;let l=s.findWrapping(a.type),c;if(!l)return o=null;if(c=o.length&&i.length&&iT(l,i,a,o[o.length-1],0))o[o.length-1]=c;else{o.length&&(o[o.length-1]=oT(o[o.length-1],i.length));let u=sT(a,l);o.push(u),s=s.matchType(u.type),i=l}}),o)return ee.from(o)}return t}function sT(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,ee.from(t));return t}function iT(t,e,n,r,s){if(s<t.length&&s<e.length&&t[s]==e[s]){let i=iT(t,e,n,r.lastChild,s+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(s==t.length-1?n.type:t[s+1]))return r.copy(r.content.append(ee.from(sT(n,t,s+1))))}}function oT(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,oT(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(ee.empty,!0);return t.copy(n.append(r))}function Gm(t,e,n,r,s,i){let o=e<0?t.firstChild:t.lastChild,a=o.content;return t.childCount>1&&(i=0),s<r-1&&(a=Gm(a,e,n,r,s+1,i)),s>=n&&(a=e<0?o.contentMatchAt(0).fillBefore(a,i<=s).append(a):a.append(o.contentMatchAt(o.childCount).fillBefore(ee.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,o.copy(a))}function Aw(t,e,n){return e<t.openStart&&(t=new ce(Gm(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new ce(Gm(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const aT={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Ow=null;function lT(){return Ow||(Ow=document.implementation.createHTMLDocument("title"))}let qf=null;function Gj(t){let e=window.trustedTypes;return e?(qf||(qf=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:n=>n})),qf.createHTML(t)):t}function Jj(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=lT().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t),s;if((s=r&&aT[r[1].toLowerCase()])&&(t=s.map(i=>"<"+i+">").join("")+t+s.map(i=>"</"+i+">").reverse().join("")),n.innerHTML=Gj(t),s)for(let i=0;i<s.length;i++)n=n.querySelector(s[i])||n;return n}function Yj(t){let e=t.querySelectorAll(Ot?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}function Qj(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return t}let{content:s,openStart:i,openEnd:o}=t;for(let a=r.length-2;a>=0;a-=2){let l=n.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;s=ee.from(l.create(r[a+1],s)),i++,o++}return new ce(s,i,o)}const cn={},un={},Xj={touchstart:!0,touchmove:!0};class Zj{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function e5(t){for(let e in cn){let n=cn[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=r=>{n5(t,r)&&!Q0(t,r)&&(t.editable||!(r.type in un))&&n(t,r)},Xj[e]?{passive:!0}:void 0)}Xt&&t.dom.addEventListener("input",()=>null),Jm(t)}function Fs(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function t5(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function Jm(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=r=>Q0(t,r))})}function Q0(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return r?r(t,e)||e.defaultPrevented:!1})}function n5(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function r5(t,e){!Q0(t,e)&&cn[e.type]&&(t.editable||!(e.type in un))&&cn[e.type](t,e)}un.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!uT(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(ns&&Ot&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),ua&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",s=>s(t,ki(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",r=>r(t,n))||Wj(t,n)?n.preventDefault():Fs(t,"key")};un.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};un.keypress=(t,e)=>{let n=e;if(uT(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||Gn&&n.metaKey)return;if(t.someProp("handleKeyPress",s=>s(t,n))){n.preventDefault();return}let r=t.state.selection;if(!(r instanceof Ae)||!r.$from.sameParent(r.$to)){let s=String.fromCharCode(n.charCode),i=()=>t.state.tr.insertText(s).scrollIntoView();!/[\r\n]/.test(s)&&!t.someProp("handleTextInput",o=>o(t,r.$from.pos,r.$to.pos,s,i))&&t.dispatch(i()),n.preventDefault()}};function Bh(t){return{left:t.clientX,top:t.clientY}}function s5(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}function X0(t,e,n,r,s){if(r==-1)return!1;let i=t.state.doc.resolve(r);for(let o=i.depth+1;o>0;o--)if(t.someProp(e,a=>o>i.depth?a(t,n,i.nodeAfter,i.before(o),s,!0):a(t,n,i.node(o),i.before(o),s,!1)))return!0;return!1}function Zo(t,e,n){if(t.focused||t.focus(),t.state.selection.eq(e))return;let r=t.state.tr.setSelection(e);n=="pointer"&&r.setMeta("pointer",!0),t.dispatch(r)}function i5(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return r&&r.isAtom&&xe.isSelectable(r)?(Zo(t,new xe(n),"pointer"),!0):!1}function o5(t,e){if(e==-1)return!1;let n=t.state.selection,r,s;n instanceof xe&&(r=n.node);let i=t.state.doc.resolve(e);for(let o=i.depth+1;o>0;o--){let a=o>i.depth?i.nodeAfter:i.node(o);if(xe.isSelectable(a)){r&&n.$from.depth>0&&o>=n.$from.depth&&i.before(n.$from.depth+1)==n.$from.pos?s=i.before(n.$from.depth):s=i.before(o);break}}return s!=null?(Zo(t,xe.create(t.state.doc,s),"pointer"),!0):!1}function a5(t,e,n,r,s){return X0(t,"handleClickOn",e,n,r)||t.someProp("handleClick",i=>i(t,e,r))||(s?o5(t,n):i5(t,n))}function l5(t,e,n,r){return X0(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",s=>s(t,e,r))}function c5(t,e,n,r){return X0(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",s=>s(t,e,r))||u5(t,n,r)}function u5(t,e,n){if(n.button!=0)return!1;let r=t.state.doc;if(e==-1)return r.inlineContent?(Zo(t,Ae.create(r,0,r.content.size),"pointer"),!0):!1;let s=r.resolve(e);for(let i=s.depth+1;i>0;i--){let o=i>s.depth?s.nodeAfter:s.node(i),a=s.before(i);if(o.inlineContent)Zo(t,Ae.create(r,a+1,a+1+o.content.size),"pointer");else if(xe.isSelectable(o))Zo(t,xe.create(r,a),"pointer");else continue;return!0}}function Z0(t){return Cd(t)}const cT=Gn?"metaKey":"ctrlKey";cn.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=Z0(t),s=Date.now(),i="singleClick";s-t.input.lastClick.time<500&&s5(n,t.input.lastClick)&&!n[cT]&&t.input.lastClick.button==n.button&&(t.input.lastClick.type=="singleClick"?i="doubleClick":t.input.lastClick.type=="doubleClick"&&(i="tripleClick")),t.input.lastClick={time:s,x:n.clientX,y:n.clientY,type:i,button:n.button};let o=t.posAtCoords(Bh(n));o&&(i=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new d5(t,o,n,!!r)):(i=="doubleClick"?l5:c5)(t,o.pos,o.inside,n)?n.preventDefault():Fs(t,"pointer"))};class d5{constructor(e,n,r,s){this.view=e,this.pos=n,this.event=r,this.flushed=s,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[cT],this.allowDefault=r.shiftKey;let i,o;if(n.inside>-1)i=e.state.doc.nodeAt(n.inside),o=n.inside;else{let u=e.state.doc.resolve(n.pos);i=u.parent,o=u.depth?u.before():0}const a=s?null:r.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l&&l.nodeDOM.nodeType==1?l.nodeDOM:null;let{selection:c}=e.state;(r.button==0&&i.type.spec.draggable&&i.type.spec.selectable!==!1||c instanceof xe&&c.from<=o&&c.to>o)&&(this.mightDrag={node:i,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&nr&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Fs(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>as(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(Bh(e))),this.updateAllowDefault(e),this.allowDefault||!n?Fs(this.view,"pointer"):a5(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Xt&&this.mightDrag&&!this.mightDrag.node.isAtom||Ot&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(Zo(this.view,Pe.near(this.view.state.doc.resolve(n.pos)),"pointer"),e.preventDefault()):Fs(this.view,"pointer")}move(e){this.updateAllowDefault(e),Fs(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}cn.touchstart=t=>{t.input.lastTouch=Date.now(),Z0(t),Fs(t,"pointer")};cn.touchmove=t=>{t.input.lastTouch=Date.now(),Fs(t,"pointer")};cn.contextmenu=t=>Z0(t);function uT(t,e){return t.composing?!0:Xt&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const h5=ns?5e3:-1;un.compositionstart=un.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$to;if(e.selection instanceof Ae&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)||Ot&&UC&&f5(t)))t.markCursor=t.state.storedMarks||n.marks(),Cd(t,!0),t.markCursor=null;else if(Cd(t,!e.selection.empty),nr&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelectionRange();for(let s=r.focusNode,i=r.focusOffset;s&&s.nodeType==1&&i!=0;){let o=i<0?s.lastChild:s.childNodes[i-1];if(!o)break;if(o.nodeType==3){let a=t.domSelection();a&&a.collapse(o,o.nodeValue.length);break}else s=o,i=-1}}t.input.composing=!0}dT(t,h5)};function f5(t){let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(!e||e.nodeType!=1||n>=e.childNodes.length)return!1;let r=e.childNodes[n];return r.nodeType==1&&r.contentEditable=="false"}un.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,dT(t,20))};function dT(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>Cd(t),e))}function hT(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=m5());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function p5(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let n=oj(e.focusNode,e.focusOffset),r=aj(e.focusNode,e.focusOffset);if(n&&r&&n!=r){let s=r.pmViewDesc,i=t.domObserver.lastChangedTextNode;if(n==i||r==i)return i;if(!s||!s.isText(r.nodeValue))return r;if(t.input.compositionNode==r){let o=n.pmViewDesc;if(!(!o||!o.isText(n.nodeValue)))return r}}return n||r}function m5(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function Cd(t,e=!1){if(!(ns&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),hT(t),e||t.docView&&t.docView.dirty){let n=G0(t),r=t.state.selection;return n&&!n.eq(r)?t.dispatch(t.state.tr.setSelection(n)):(t.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function g5(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),s=document.createRange();s.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(s),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const Zl=Sn&&Ys<15||ua&&dj<604;cn.copy=un.cut=(t,e)=>{let n=e,r=t.state.selection,s=n.type=="cut";if(r.empty)return;let i=Zl?null:n.clipboardData,o=r.content(),{dom:a,text:l}=Y0(t,o);i?(n.preventDefault(),i.clearData(),i.setData("text/html",a.innerHTML),i.setData("text/plain",l)):g5(t,a),s&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function y5(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function v5(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let s=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?ec(t,r.value,null,s,e):ec(t,r.textContent,r.innerHTML,s,e)},50)}function ec(t,e,n,r,s){let i=rT(t,e,n,r,t.state.selection.$from);if(t.someProp("handlePaste",l=>l(t,s,i||ce.empty)))return!0;if(!i)return!1;let o=y5(i),a=o?t.state.tr.replaceSelectionWith(o,r):t.state.tr.replaceSelection(i);return t.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function fT(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}un.paste=(t,e)=>{let n=e;if(t.composing&&!ns)return;let r=Zl?null:n.clipboardData,s=t.input.shiftKey&&t.input.lastKeyCode!=45;r&&ec(t,fT(r),r.getData("text/html"),s,n)?n.preventDefault():v5(t,n)};class pT{constructor(e,n,r){this.slice=e,this.move=n,this.node=r}}const w5=Gn?"altKey":"ctrlKey";function mT(t,e){let n=t.someProp("dragCopies",r=>!r(e));return n??!e[w5]}cn.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let s=t.state.selection,i=s.empty?null:t.posAtCoords(Bh(n)),o;if(!(i&&i.pos>=s.from&&i.pos<=(s instanceof xe?s.to-1:s.to))){if(r&&r.mightDrag)o=xe.create(t.state.doc,r.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let d=t.docView.nearestDesc(n.target,!0);d&&d.node.type.spec.draggable&&d!=t.docView&&(o=xe.create(t.state.doc,d.posBefore))}}let a=(o||t.state.selection).content(),{dom:l,text:c,slice:u}=Y0(t,a);(!n.dataTransfer.files.length||!Ot||BC>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(Zl?"Text":"text/html",l.innerHTML),n.dataTransfer.effectAllowed="copyMove",Zl||n.dataTransfer.setData("text/plain",c),t.dragging=new pT(u,mT(t,n),o)};cn.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};un.dragover=un.dragenter=(t,e)=>e.preventDefault();un.drop=(t,e)=>{try{x5(t,e,t.dragging)}finally{t.dragging=null}};function x5(t,e,n){if(!e.dataTransfer)return;let r=t.posAtCoords(Bh(e));if(!r)return;let s=t.state.doc.resolve(r.pos),i=n&&n.slice;i?t.someProp("transformPasted",f=>{i=f(i,t,!1)}):i=rT(t,fT(e.dataTransfer),Zl?null:e.dataTransfer.getData("text/html"),!1,s);let o=!!(n&&mT(t,e));if(t.someProp("handleDrop",f=>f(t,e,i||ce.empty,o))){e.preventDefault();return}if(!i)return;e.preventDefault();let a=i?NC(t.state.doc,s.pos,i):s.pos;a==null&&(a=s.pos);let l=t.state.tr;if(o){let{node:f}=n;f?f.replace(l):l.deleteSelection()}let c=l.mapping.map(a),u=i.openStart==0&&i.openEnd==0&&i.content.childCount==1,d=l.doc;if(u?l.replaceRangeWith(c,c,i.content.firstChild):l.replaceRange(c,c,i),l.doc.eq(d))return;let h=l.doc.resolve(c);if(u&&xe.isSelectable(i.content.firstChild)&&h.nodeAfter&&h.nodeAfter.sameMarkup(i.content.firstChild))l.setSelection(new xe(h));else{let f=l.mapping.map(a);l.mapping.maps[l.mapping.maps.length-1].forEach((p,g,y,m)=>f=m),l.setSelection(J0(t,h,l.doc.resolve(f)))}t.focus(),t.dispatch(l.setMeta("uiEvent","drop"))}cn.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&as(t)},20))};cn.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};cn.beforeinput=(t,e)=>{if(Ot&&ns&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",i=>i(t,ki(8,"Backspace")))))return;let{$cursor:s}=t.state.selection;s&&s.pos>0&&t.dispatch(t.state.tr.delete(s.pos-1,s.pos).scrollIntoView())},50)}};for(let t in un)cn[t]=un[t];function tc(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class Td{constructor(e,n){this.toDOM=e,this.spec=n||Bi,this.side=this.spec.side||0}map(e,n,r,s){let{pos:i,deleted:o}=e.mapResult(n.from+s,this.side<0?-1:1);return o?null:new Ln(i-r,i-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Td&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&tc(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Xs{constructor(e,n){this.attrs=e,this.spec=n||Bi}map(e,n,r,s){let i=e.map(n.from+s,this.spec.inclusiveStart?-1:1)-r,o=e.map(n.to+s,this.spec.inclusiveEnd?1:-1)-r;return i>=o?null:new Ln(i,o,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof Xs&&tc(this.attrs,e.attrs)&&tc(this.spec,e.spec)}static is(e){return e.type instanceof Xs}destroy(){}}class ey{constructor(e,n){this.attrs=e,this.spec=n||Bi}map(e,n,r,s){let i=e.mapResult(n.from+s,1);if(i.deleted)return null;let o=e.mapResult(n.to+s,-1);return o.deleted||o.pos<=i.pos?null:new Ln(i.pos-r,o.pos-r,this)}valid(e,n){let{index:r,offset:s}=e.content.findIndex(n.from),i;return s==n.from&&!(i=e.child(r)).isText&&s+i.nodeSize==n.to}eq(e){return this==e||e instanceof ey&&tc(this.attrs,e.attrs)&&tc(this.spec,e.spec)}destroy(){}}class Ln{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new Ln(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new Ln(e,e,new Td(n,r))}static inline(e,n,r,s){return new Ln(e,n,new Xs(r,s))}static node(e,n,r,s){return new Ln(e,n,new ey(r,s))}get spec(){return this.type.spec}get inline(){return this.type instanceof Xs}get widget(){return this.type instanceof Td}}const bo=[],Bi={};class gt{constructor(e,n){this.local=e.length?e:bo,this.children=n.length?n:bo}static create(e,n){return n.length?_d(n,e,0,Bi):qt}find(e,n,r){let s=[];return this.findInner(e??0,n??1e9,s,0,r),s}findInner(e,n,r,s,i){for(let o=0;o<this.local.length;o++){let a=this.local[o];a.from<=n&&a.to>=e&&(!i||i(a.spec))&&r.push(a.copy(a.from+s,a.to+s))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<n&&this.children[o+1]>e){let a=this.children[o]+1;this.children[o+2].findInner(e-a,n-a,r,s+a,i)}}map(e,n,r){return this==qt||e.maps.length==0?this:this.mapInner(e,n,0,0,r||Bi)}mapInner(e,n,r,s,i){let o;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,r,s);l&&l.type.valid(n,l)?(o||(o=[])).push(l):i.onRemove&&i.onRemove(this.local[a].spec)}return this.children.length?b5(this.children,o||[],e,n,r,s,i):o?new gt(o.sort(Ui),bo):qt}add(e,n){return n.length?this==qt?gt.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let s,i=0;e.forEach((a,l)=>{let c=l+r,u;if(u=yT(n,a,c)){for(s||(s=this.children.slice());i<s.length&&s[i]<l;)i+=3;s[i]==l?s[i+2]=s[i+2].addInner(a,u,c+1):s.splice(i,0,l,l+a.nodeSize,_d(u,a,c+1,Bi)),i+=3}});let o=gT(i?vT(n):n,-r);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||o.splice(a--,1);return new gt(o.length?this.local.concat(o).sort(Ui):this.local,s||this.children)}remove(e){return e.length==0||this==qt?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,s=this.local;for(let i=0;i<r.length;i+=3){let o,a=r[i]+n,l=r[i+1]+n;for(let u=0,d;u<e.length;u++)(d=e[u])&&d.from>a&&d.to<l&&(e[u]=null,(o||(o=[])).push(d));if(!o)continue;r==this.children&&(r=this.children.slice());let c=r[i+2].removeInner(o,a+1);c!=qt?r[i+2]=c:(r.splice(i,3),i-=3)}if(s.length){for(let i=0,o;i<e.length;i++)if(o=e[i])for(let a=0;a<s.length;a++)s[a].eq(o,n)&&(s==this.local&&(s=this.local.slice()),s.splice(a--,1))}return r==this.children&&s==this.local?this:s.length||r.length?new gt(s,r):qt}forChild(e,n){if(this==qt)return this;if(n.isLeaf)return gt.empty;let r,s;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let i=e+1,o=i+n.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<o&&l.to>i&&l.type instanceof Xs){let c=Math.max(i,l.from)-i,u=Math.min(o,l.to)-i;c<u&&(s||(s=[])).push(l.copy(c,u))}}if(s){let a=new gt(s.sort(Ui),bo);return r?new Ps([a,r]):a}return r||qt}eq(e){if(this==e)return!0;if(!(e instanceof gt)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return ty(this.localsInner(e))}localsInner(e){if(this==qt)return bo;if(e.inlineContent||!this.local.some(Xs.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Xs||n.push(this.local[r]);return n}forEachSet(e){e(this)}}gt.empty=new gt([],[]);gt.removeOverlap=ty;const qt=gt.empty;class Ps{constructor(e){this.members=e}map(e,n){const r=this.members.map(s=>s.map(e,n,Bi));return Ps.from(r)}forChild(e,n){if(n.isLeaf)return gt.empty;let r=[];for(let s=0;s<this.members.length;s++){let i=this.members[s].forChild(e,n);i!=qt&&(i instanceof Ps?r=r.concat(i.members):r.push(i))}return Ps.from(r)}eq(e){if(!(e instanceof Ps)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let s=0;s<this.members.length;s++){let i=this.members[s].localsInner(e);if(i.length)if(!n)n=i;else{r&&(n=n.slice(),r=!1);for(let o=0;o<i.length;o++)n.push(i[o])}}return n?ty(r?n:n.sort(Ui)):bo}static from(e){switch(e.length){case 0:return qt;case 1:return e[0];default:return new Ps(e.every(n=>n instanceof gt)?e:e.reduce((n,r)=>n.concat(r instanceof gt?r:r.members),[]))}}forEachSet(e){for(let n=0;n<this.members.length;n++)this.members[n].forEachSet(e)}}function b5(t,e,n,r,s,i,o){let a=t.slice();for(let c=0,u=i;c<n.maps.length;c++){let d=0;n.maps[c].forEach((h,f,p,g)=>{let y=g-p-(f-h);for(let m=0;m<a.length;m+=3){let v=a[m+1];if(v<0||h>v+u-d)continue;let w=a[m]+u-d;f>=w?a[m+1]=h<=w?-2:-1:h>=u&&y&&(a[m]+=y,a[m+1]+=y)}d+=y}),u=n.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let u=n.map(t[c]+i),d=u-s;if(d<0||d>=r.content.size){l=!0;continue}let h=n.map(t[c+1]+i,-1),f=h-s,{index:p,offset:g}=r.content.findIndex(d),y=r.maybeChild(p);if(y&&g==d&&g+y.nodeSize==f){let m=a[c+2].mapInner(n,y,u+1,t[c]+i+1,o);m!=qt?(a[c]=d,a[c+1]=f,a[c+2]=m):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=k5(a,t,e,n,s,i,o),u=_d(c,r,0,o);e=u.local;for(let d=0;d<a.length;d+=3)a[d+1]<0&&(a.splice(d,3),d-=3);for(let d=0,h=0;d<u.children.length;d+=3){let f=u.children[d];for(;h<a.length&&a[h]<f;)h+=3;a.splice(h,0,u.children[d],u.children[d+1],u.children[d+2])}}return new gt(e.sort(Ui),a)}function gT(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let s=t[r];n.push(new Ln(s.from+e,s.to+e,s.type))}return n}function k5(t,e,n,r,s,i,o){function a(l,c){for(let u=0;u<l.local.length;u++){let d=l.local[u].map(r,s,c);d?n.push(d):o.onRemove&&o.onRemove(l.local[u].spec)}for(let u=0;u<l.children.length;u+=3)a(l.children[u+2],l.children[u]+c+1)}for(let l=0;l<t.length;l+=3)t[l+1]==-1&&a(t[l+2],e[l]+i+1);return n}function yT(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,s=null;for(let i=0,o;i<t.length;i++)(o=t[i])&&o.from>n&&o.to<r&&((s||(s=[])).push(o),t[i]=null);return s}function vT(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function _d(t,e,n,r){let s=[],i=!1;e.forEach((a,l)=>{let c=yT(t,a,l+n);if(c){i=!0;let u=_d(c,a,n+l+1,r);u!=qt&&s.push(l,l+a.nodeSize,u)}});let o=gT(i?vT(t):t,-n).sort(Ui);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||(r.onRemove&&r.onRemove(o[a].spec),o.splice(a--,1));return o.length||s.length?new gt(o,s):qt}function Ui(t,e){return t.from-e.from||t.to-e.to}function ty(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let s=n+1;s<e.length;s++){let i=e[s];if(i.from==r.from){i.to!=r.to&&(e==t&&(e=t.slice()),e[s]=i.copy(i.from,r.to),Rw(e,s+1,i.copy(r.to,i.to)));continue}else{i.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,i.from),Rw(e,s,r.copy(i.from,r.to)));break}}}return e}function Rw(t,e,n){for(;e<t.length&&Ui(n,t[e])>0;)e++;t.splice(e,0,n)}function Gf(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=qt&&e.push(r)}),t.cursorWrapper&&e.push(gt.create(t.state.doc,[t.cursorWrapper.deco])),Ps.from(e)}const S5={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},E5=Sn&&Ys<=11;class C5{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class T5{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new C5,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let s=0;s<r.length;s++)this.queue.push(r[s]);Sn&&Ys<=11&&r.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),E5&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,S5)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(kw(this.view)){if(this.suppressingSelectionUpdates)return as(this.view);if(Sn&&Ys<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Xi(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,r;for(let i=e.focusNode;i;i=ca(i))n.add(i);for(let i=e.anchorNode;i;i=ca(i))if(n.has(i)){r=i;break}let s=r&&this.view.docView.nearestDesc(r);if(s&&s.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let r=e.domSelectionRange(),s=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&kw(e)&&!this.ignoreSelectionChange(r),i=-1,o=-1,a=!1,l=[];if(e.editable)for(let u=0;u<n.length;u++){let d=this.registerMutation(n[u],l);d&&(i=i<0?d.from:Math.min(d.from,i),o=o<0?d.to:Math.max(d.to,o),d.typeOver&&(a=!0))}if(nr&&l.length){let u=l.filter(d=>d.nodeName=="BR");if(u.length==2){let[d,h]=u;d.parentNode&&d.parentNode.parentNode==h.parentNode?h.remove():d.remove()}else{let{focusNode:d}=this.currentSelection;for(let h of u){let f=h.parentNode;f&&f.nodeName=="LI"&&(!d||O5(e,d)!=f)&&h.remove()}}}else if((Ot||Xt)&&l.some(u=>u.nodeName=="BR")&&(e.input.lastKeyCode==8||e.input.lastKeyCode==46)){for(let u of l)if(u.nodeName=="BR"&&u.parentNode){let d=u.nextSibling;d&&d.nodeType==1&&d.contentEditable=="false"&&u.parentNode.removeChild(u)}}let c=null;i<0&&s&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&$h(r)&&(c=G0(e))&&c.eq(Pe.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,as(e),this.currentSelection.set(r),e.scrollToSelection()):(i>-1||s)&&(i>-1&&(e.docView.markDirty(i,o),_5(e)),this.handleDOMChange(i,o,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||as(e),this.currentSelection.set(r))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let u=0;u<e.addedNodes.length;u++){let d=e.addedNodes[u];n.push(d),d.nodeType==3&&(this.lastChangedTextNode=d)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let s=e.previousSibling,i=e.nextSibling;if(Sn&&Ys<=11&&e.addedNodes.length)for(let u=0;u<e.addedNodes.length;u++){let{previousSibling:d,nextSibling:h}=e.addedNodes[u];(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(s=d),(!h||Array.prototype.indexOf.call(e.addedNodes,h)<0)&&(i=h)}let o=s&&s.parentNode==e.target?Bt(s)+1:0,a=r.localPosFromDOM(e.target,o,-1),l=i&&i.parentNode==e.target?Bt(i):e.target.childNodes.length,c=r.localPosFromDOM(e.target,l,1);return{from:a,to:c}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let Nw=new WeakMap,Iw=!1;function _5(t){if(!Nw.has(t)&&(Nw.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=nr,Iw)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Iw=!0}}function Pw(t,e){let n=e.startContainer,r=e.startOffset,s=e.endContainer,i=e.endOffset,o=t.domAtPos(t.state.selection.anchor);return Xi(o.node,o.offset,s,i)&&([n,r,s,i]=[s,i,n,r]),{anchorNode:n,anchorOffset:r,focusNode:s,focusOffset:i}}function A5(t,e){if(e.getComposedRanges){let s=e.getComposedRanges(t.root)[0];if(s)return Pw(t,s)}let n;function r(s){s.preventDefault(),s.stopImmediatePropagation(),n=s.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",r,!0),n?Pw(t,n):null}function O5(t,e){for(let n=e.parentNode;n&&n!=t.dom;n=n.parentNode){let r=t.docView.nearestDesc(n,!0);if(r&&r.node.isBlock)return n}return null}function R5(t,e,n){let{node:r,fromOffset:s,toOffset:i,from:o,to:a}=t.docView.parseRange(e,n),l=t.domSelectionRange(),c,u=l.anchorNode;if(u&&t.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:l.anchorOffset}],$h(l)||c.push({node:l.focusNode,offset:l.focusOffset})),Ot&&t.input.lastKeyCode===8)for(let y=i;y>s;y--){let m=r.childNodes[y-1],v=m.pmViewDesc;if(m.nodeName=="BR"&&!v){i=y;break}if(!v||v.size)break}let d=t.state.doc,h=t.someProp("domParser")||Js.fromSchema(t.state.schema),f=d.resolve(o),p=null,g=h.parse(r,{topNode:f.parent,topMatch:f.parent.contentMatchAt(f.index()),topOpen:!0,from:s,to:i,preserveWhitespace:f.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:N5,context:f});if(c&&c[0].pos!=null){let y=c[0].pos,m=c[1]&&c[1].pos;m==null&&(m=y),p={anchor:y+o,head:m+o}}return{doc:g,sel:p,from:o,to:a}}function N5(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(Xt&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(t.parentNode.lastChild==t||Xt&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const I5=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function P5(t,e,n,r,s){let i=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let O=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,b=G0(t,O);if(b&&!t.state.selection.eq(b)){if(Ot&&ns&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",N=>N(t,ki(13,"Enter"))))return;let k=t.state.tr.setSelection(b);O=="pointer"?k.setMeta("pointer",!0):O=="key"&&k.scrollIntoView(),i&&k.setMeta("composition",i),t.dispatch(k)}return}let o=t.state.doc.resolve(e),a=o.sharedDepth(n);e=o.before(a+1),n=t.state.doc.resolve(n).after(a+1);let l=t.state.selection,c=R5(t,e,n),u=t.state.doc,d=u.slice(c.from,c.to),h,f;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(h=t.state.selection.to,f="end"):(h=t.state.selection.from,f="start"),t.input.lastKeyCode=null;let p=j5(d.content,c.doc.content,c.from,h,f);if(p&&t.input.domChangeCount++,(ua&&t.input.lastIOSEnter>Date.now()-225||ns)&&s.some(O=>O.nodeType==1&&!I5.test(O.nodeName))&&(!p||p.endA>=p.endB)&&t.someProp("handleKeyDown",O=>O(t,ki(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!p)if(r&&l instanceof Ae&&!l.empty&&l.$head.sameParent(l.$anchor)&&!t.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))p={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let O=Mw(t,t.state.doc,c.sel);if(O&&!O.eq(t.state.selection)){let b=t.state.tr.setSelection(O);i&&b.setMeta("composition",i),t.dispatch(b)}}return}t.state.selection.from<t.state.selection.to&&p.start==p.endB&&t.state.selection instanceof Ae&&(p.start>t.state.selection.from&&p.start<=t.state.selection.from+2&&t.state.selection.from>=c.from?p.start=t.state.selection.from:p.endA<t.state.selection.to&&p.endA>=t.state.selection.to-2&&t.state.selection.to<=c.to&&(p.endB+=t.state.selection.to-p.endA,p.endA=t.state.selection.to)),Sn&&Ys<=11&&p.endB==p.start+1&&p.endA==p.start&&p.start>c.from&&c.doc.textBetween(p.start-c.from-1,p.start-c.from+1)==" "&&(p.start--,p.endA--,p.endB--);let g=c.doc.resolveNoCache(p.start-c.from),y=c.doc.resolveNoCache(p.endB-c.from),m=u.resolve(p.start),v=g.sameParent(y)&&g.parent.inlineContent&&m.end()>=p.endA;if((ua&&t.input.lastIOSEnter>Date.now()-225&&(!v||s.some(O=>O.nodeName=="DIV"||O.nodeName=="P"))||!v&&g.pos<c.doc.content.size&&(!g.sameParent(y)||!g.parent.inlineContent)&&g.pos<y.pos&&!/\S/.test(c.doc.textBetween(g.pos,y.pos,"","")))&&t.someProp("handleKeyDown",O=>O(t,ki(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>p.start&&D5(u,p.start,p.endA,g,y)&&t.someProp("handleKeyDown",O=>O(t,ki(8,"Backspace")))){ns&&Ot&&t.domObserver.suppressSelectionUpdates();return}Ot&&p.endB==p.start&&(t.input.lastChromeDelete=Date.now()),ns&&!v&&g.start()!=y.start()&&y.parentOffset==0&&g.depth==y.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==p.endA&&(p.endB-=2,y=c.doc.resolveNoCache(p.endB-c.from),setTimeout(()=>{t.someProp("handleKeyDown",function(O){return O(t,ki(13,"Enter"))})},20));let w=p.start,S=p.endA,T=O=>{let b=O||t.state.tr.replace(w,S,c.doc.slice(p.start-c.from,p.endB-c.from));if(c.sel){let k=Mw(t,b.doc,c.sel);k&&!(Ot&&t.composing&&k.empty&&(p.start!=p.endB||t.input.lastChromeDelete<Date.now()-100)&&(k.head==w||k.head==b.mapping.map(S)-1)||Sn&&k.empty&&k.head==w)&&b.setSelection(k)}return i&&b.setMeta("composition",i),b.scrollIntoView()},E;if(v)if(g.pos==y.pos){Sn&&Ys<=11&&g.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>as(t),20));let O=T(t.state.tr.delete(w,S)),b=u.resolve(p.start).marksAcross(u.resolve(p.endA));b&&O.ensureMarks(b),t.dispatch(O)}else if(p.endA==p.endB&&(E=M5(g.parent.content.cut(g.parentOffset,y.parentOffset),m.parent.content.cut(m.parentOffset,p.endA-m.start())))){let O=T(t.state.tr);E.type=="add"?O.addMark(w,S,E.mark):O.removeMark(w,S,E.mark),t.dispatch(O)}else if(g.parent.child(g.index()).isText&&g.index()==y.index()-(y.textOffset?0:1)){let O=g.parent.textBetween(g.parentOffset,y.parentOffset),b=()=>T(t.state.tr.insertText(O,w,S));t.someProp("handleTextInput",k=>k(t,w,S,O,b))||t.dispatch(b())}else t.dispatch(T());else t.dispatch(T())}function Mw(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:J0(t,e.resolve(n.anchor),e.resolve(n.head))}function M5(t,e){let n=t.firstChild.marks,r=e.firstChild.marks,s=n,i=r,o,a,l;for(let u=0;u<r.length;u++)s=r[u].removeFromSet(s);for(let u=0;u<n.length;u++)i=n[u].removeFromSet(i);if(s.length==1&&i.length==0)a=s[0],o="add",l=u=>u.mark(a.addToSet(u.marks));else if(s.length==0&&i.length==1)a=i[0],o="remove",l=u=>u.mark(a.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<e.childCount;u++)c.push(l(e.child(u)));if(ee.from(c).eq(t))return{mark:a,type:o}}function D5(t,e,n,r,s){if(n-e<=s.pos-r.pos||Jf(r,!0,!1)<s.pos)return!1;let i=t.resolve(e);if(!r.parent.isTextblock){let a=i.nodeAfter;return a!=null&&n==e+a.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let o=t.resolve(Jf(i,!0,!0));return!o.parent.isTextblock||o.pos>n||Jf(o,!0,!1)<n?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function Jf(t,e,n){let r=t.depth,s=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,s++,e=!1;if(n){let i=t.node(r).maybeChild(t.indexAfter(r));for(;i&&!i.isLeaf;)i=i.firstChild,s++}return s}function j5(t,e,n,r,s){let i=t.findDiffStart(e,n);if(i==null)return null;let{a:o,b:a}=t.findDiffEnd(e,n+t.size,n+e.size);if(s=="end"){let l=Math.max(0,i-Math.min(o,a));r-=o+l-i}if(o<i&&t.size<e.size){let l=r<=i&&r>=o?i-r:0;i-=l,i&&i<e.size&&Dw(e.textBetween(i-1,i+1))&&(i+=l?1:-1),a=i+(a-o),o=i}else if(a<i){let l=r<=i&&r>=a?i-r:0;i-=l,i&&i<t.size&&Dw(t.textBetween(i-1,i+1))&&(i+=l?1:-1),o=i+(o-a),a=i}return{start:i,endA:o,endB:a}}function Dw(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class wT{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new Zj,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(Bw),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=$w(this),Lw(this),this.nodeViews=Fw(this),this.docView=gw(this.state.doc,jw(this),Gf(this),this.dom,this),this.domObserver=new T5(this,(r,s,i,o)=>P5(this,r,s,i,o)),this.domObserver.start(),e5(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Jm(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(Bw),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in e)n[r]=e[r];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){var r;let s=this.state,i=!1,o=!1;e.storedMarks&&this.composing&&(hT(this),o=!0),this.state=e;let a=s.plugins!=e.plugins||this._props.plugins!=n.plugins;if(a||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let f=Fw(this);$5(f,this.nodeViews)&&(this.nodeViews=f,i=!0)}(a||n.handleDOMEvents!=this._props.handleDOMEvents)&&Jm(this),this.editable=$w(this),Lw(this);let l=Gf(this),c=jw(this),u=s.plugins!=e.plugins&&!s.doc.eq(e.doc)?"reset":e.scrollToSelection>s.scrollToSelection?"to selection":"preserve",d=i||!this.docView.matchesNode(e.doc,c,l);(d||!e.selection.eq(s.selection))&&(o=!0);let h=u=="preserve"&&o&&this.dom.style.overflowAnchor==null&&pj(this);if(o){this.domObserver.stop();let f=d&&(Sn||Ot)&&!this.composing&&!s.selection.empty&&!e.selection.empty&&L5(s.selection,e.selection);if(d){let p=Ot?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=p5(this)),(i||!this.docView.update(e.doc,c,l,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=gw(e.doc,c,l,this.dom,this)),p&&!this.trackWrites&&(f=!0)}f||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&$j(this))?as(this,f):(eT(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(s),!((r=this.dragging)===null||r===void 0)&&r.node&&!s.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,s),u=="reset"?this.dom.scrollTop=0:u=="to selection"?this.scrollToSelection():h&&mj(h)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof xe){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&uw(this,n.getBoundingClientRect(),e)}else uw(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,e)}}updateDraggedNode(e,n){let r=e.node,s=-1;if(this.state.doc.nodeAt(r.from)==r.node)s=r.from;else{let i=r.from+(this.state.doc.content.size-n.doc.content.size);(i>0&&this.state.doc.nodeAt(i))==r.node&&(s=i)}this.dragging=new pT(e.slice,e.move,s<0?void 0:xe.create(this.state.doc,s))}someProp(e,n){let r=this._props&&this._props[e],s;if(r!=null&&(s=n?n(r):r))return s;for(let o=0;o<this.directPlugins.length;o++){let a=this.directPlugins[o].props[e];if(a!=null&&(s=n?n(a):a))return s}let i=this.state.plugins;if(i)for(let o=0;o<i.length;o++){let a=i[o].props[e];if(a!=null&&(s=n?n(a):a))return s}}hasFocus(){if(Sn){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&gj(this.dom),as(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}updateRoot(){this._root=null}posAtCoords(e){return bj(this,e)}coordsAtPos(e,n=1){return KC(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,r=-1){let s=this.docView.posFromDOM(e,n,r);if(s==null)throw new RangeError("DOM position not inside the editor");return s}endOfTextblock(e,n){return Tj(this,n||this.state,e)}pasteHTML(e,n){return ec(this,"",e,!1,n||new ClipboardEvent("paste"))}pasteText(e,n){return ec(this,e,null,!0,n||new ClipboardEvent("paste"))}serializeForClipboard(e){return Y0(this,e)}destroy(){this.docView&&(t5(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Gf(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,sj())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return r5(this,e)}domSelectionRange(){let e=this.domSelection();return e?Xt&&this.root.nodeType===11&&cj(this.dom.ownerDocument)==this.dom&&A5(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}wT.prototype.dispatch=function(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};function jw(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(t.state)),n)for(let r in n)r=="class"?e.class+=" "+n[r]:r=="style"?e.style=(e.style?e.style+";":"")+n[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(n[r]))}),e.translate||(e.translate="no"),[Ln.node(0,t.state.doc.content.size,e)]}function Lw(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:Ln.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function $w(t){return!t.someProp("editable",e=>e(t.state)===!1)}function L5(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function Fw(t){let e=Object.create(null);function n(r){for(let s in r)Object.prototype.hasOwnProperty.call(e,s)||(e[s]=r[s])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function $5(t,e){let n=0,r=0;for(let s in t){if(t[s]!=e[s])return!0;n++}for(let s in e)r++;return n!=r}function Bw(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var ni={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Ad={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},F5=typeof navigator<"u"&&/Mac/.test(navigator.platform),B5=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Ut=0;Ut<10;Ut++)ni[48+Ut]=ni[96+Ut]=String(Ut);for(var Ut=1;Ut<=24;Ut++)ni[Ut+111]="F"+Ut;for(var Ut=65;Ut<=90;Ut++)ni[Ut]=String.fromCharCode(Ut+32),Ad[Ut]=String.fromCharCode(Ut);for(var Yf in ni)Ad.hasOwnProperty(Yf)||(Ad[Yf]=ni[Yf]);function U5(t){var e=F5&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||B5&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?Ad:ni)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const z5=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),V5=typeof navigator<"u"&&/Win/.test(navigator.platform);function H5(t){let e=t.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let r,s,i,o;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))z5?o=!0:s=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(n="Alt-"+n),s&&(n="Ctrl-"+n),o&&(n="Meta-"+n),i&&(n="Shift-"+n),n}function W5(t){let e=Object.create(null);for(let n in t)e[H5(n)]=t[n];return e}function Qf(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function K5(t){return new Mt({props:{handleKeyDown:xT(t)}})}function xT(t){let e=W5(t);return function(n,r){let s=U5(r),i,o=e[Qf(s,r)];if(o&&o(n.state,n.dispatch,n))return!0;if(s.length==1&&s!=" "){if(r.shiftKey){let a=e[Qf(s,r,!1)];if(a&&a(n.state,n.dispatch,n))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(V5&&r.ctrlKey&&r.altKey)&&(i=ni[r.keyCode])&&i!=s){let a=e[Qf(i,r)];if(a&&a(n.state,n.dispatch,n))return!0}}return!1}}const q5=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function bT(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const G5=(t,e,n)=>{let r=bT(t,n);if(!r)return!1;let s=ny(r);if(!s){let o=r.blockRange(),a=o&&ka(o);return a==null?!1:(e&&e(t.tr.lift(o,a).scrollIntoView()),!0)}let i=s.nodeBefore;if(CT(t,s,e,-1))return!0;if(r.parent.content.size==0&&(da(i,"end")||xe.isSelectable(i)))for(let o=r.depth;;o--){let a=jh(t.doc,r.before(o),r.after(o),ce.empty);if(a&&a.slice.size<a.to-a.from){if(e){let l=t.tr.step(a);l.setSelection(da(i,"end")?Pe.findFrom(l.doc.resolve(l.mapping.map(s.pos,-1)),-1):xe.create(l.doc,s.pos-i.nodeSize)),e(l.scrollIntoView())}return!0}if(o==1||r.node(o-1).childCount>1)break}return i.isAtom&&s.depth==r.depth-1?(e&&e(t.tr.delete(s.pos-i.nodeSize,s.pos).scrollIntoView()),!0):!1},J5=(t,e,n)=>{let r=bT(t,n);if(!r)return!1;let s=ny(r);return s?kT(t,s,e):!1},Y5=(t,e,n)=>{let r=ST(t,n);if(!r)return!1;let s=ry(r);return s?kT(t,s,e):!1};function kT(t,e,n){let r=e.nodeBefore,s=r,i=e.pos-1;for(;!s.isTextblock;i--){if(s.type.spec.isolating)return!1;let u=s.lastChild;if(!u)return!1;s=u}let o=e.nodeAfter,a=o,l=e.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let u=a.firstChild;if(!u)return!1;a=u}let c=jh(t.doc,i,l,ce.empty);if(!c||c.from!=i||c instanceof At&&c.slice.size>=l-i)return!1;if(n){let u=t.tr.step(c);u.setSelection(Ae.create(u.doc,i)),n(u.scrollIntoView())}return!0}function da(t,e,n=!1){for(let r=t;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&r.childCount!=1)return!1}return!1}const Q5=(t,e,n)=>{let{$head:r,empty:s}=t.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;i=ny(r)}let o=i&&i.nodeBefore;return!o||!xe.isSelectable(o)?!1:(e&&e(t.tr.setSelection(xe.create(t.doc,i.pos-o.nodeSize)).scrollIntoView()),!0)};function ny(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function ST(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const X5=(t,e,n)=>{let r=ST(t,n);if(!r)return!1;let s=ry(r);if(!s)return!1;let i=s.nodeAfter;if(CT(t,s,e,1))return!0;if(r.parent.content.size==0&&(da(i,"start")||xe.isSelectable(i))){let o=jh(t.doc,r.before(),r.after(),ce.empty);if(o&&o.slice.size<o.to-o.from){if(e){let a=t.tr.step(o);a.setSelection(da(i,"start")?Pe.findFrom(a.doc.resolve(a.mapping.map(s.pos)),1):xe.create(a.doc,a.mapping.map(s.pos))),e(a.scrollIntoView())}return!0}}return i.isAtom&&s.depth==r.depth-1?(e&&e(t.tr.delete(s.pos,s.pos+i.nodeSize).scrollIntoView()),!0):!1},Z5=(t,e,n)=>{let{$head:r,empty:s}=t.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;i=ry(r)}let o=i&&i.nodeAfter;return!o||!xe.isSelectable(o)?!1:(e&&e(t.tr.setSelection(xe.create(t.doc,i.pos)).scrollIntoView()),!0)};function ry(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const eL=(t,e)=>{let n=t.selection,r=n instanceof xe,s;if(r){if(n.node.isTextblock||!ci(t.doc,n.from))return!1;s=n.from}else if(s=Dh(t.doc,n.from,-1),s==null)return!1;if(e){let i=t.tr.join(s);r&&i.setSelection(xe.create(i.doc,s-t.doc.resolve(s).nodeBefore.nodeSize)),e(i.scrollIntoView())}return!0},tL=(t,e)=>{let n=t.selection,r;if(n instanceof xe){if(n.node.isTextblock||!ci(t.doc,n.to))return!1;r=n.to}else if(r=Dh(t.doc,n.to,1),r==null)return!1;return e&&e(t.tr.join(r).scrollIntoView()),!0},nL=(t,e)=>{let{$from:n,$to:r}=t.selection,s=n.blockRange(r),i=s&&ka(s);return i==null?!1:(e&&e(t.tr.lift(s,i).scrollIntoView()),!0)},rL=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!n.parent.type.spec.code||!n.sameParent(r)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function ET(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const sL=(t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let s=n.node(-1),i=n.indexAfter(-1),o=ET(s.contentMatchAt(i));if(!o||!s.canReplaceWith(i,i,o))return!1;if(e){let a=n.after(),l=t.tr.replaceWith(a,a,o.createAndFill());l.setSelection(Pe.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},iL=(t,e)=>{let n=t.selection,{$from:r,$to:s}=n;if(n instanceof tr||r.parent.inlineContent||s.parent.inlineContent)return!1;let i=ET(s.parent.contentMatchAt(s.indexAfter()));if(!i||!i.isTextblock)return!1;if(e){let o=(!r.parentOffset&&s.index()<s.parent.childCount?r:s).pos,a=t.tr.insert(o,i.createAndFill());a.setSelection(Ae.create(a.doc,o+1)),e(a.scrollIntoView())}return!0},oL=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let i=n.before();if(Qo(t.doc,i))return e&&e(t.tr.split(i).scrollIntoView()),!0}let r=n.blockRange(),s=r&&ka(r);return s==null?!1:(e&&e(t.tr.lift(r,s).scrollIntoView()),!0)},aL=(t,e)=>{let{$from:n,to:r}=t.selection,s,i=n.sharedDepth(r);return i==0?!1:(s=n.before(i),e&&e(t.tr.setSelection(xe.create(t.doc,s))),!0)};function lL(t,e,n){let r=e.nodeBefore,s=e.nodeAfter,i=e.index();return!r||!s||!r.type.compatibleContent(s.type)?!1:!r.content.size&&e.parent.canReplace(i-1,i)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(i,i+1)||!(s.isTextblock||ci(t.doc,e.pos))?!1:(n&&n(t.tr.join(e.pos).scrollIntoView()),!0)}function CT(t,e,n,r){let s=e.nodeBefore,i=e.nodeAfter,o,a,l=s.type.spec.isolating||i.type.spec.isolating;if(!l&&lL(t,e,n))return!0;let c=!l&&e.parent.canReplace(e.index(),e.index()+1);if(c&&(o=(a=s.contentMatchAt(s.childCount)).findWrapping(i.type))&&a.matchType(o[0]||i.type).validEnd){if(n){let f=e.pos+i.nodeSize,p=ee.empty;for(let m=o.length-1;m>=0;m--)p=ee.from(o[m].create(null,p));p=ee.from(s.copy(p));let g=t.tr.step(new Nt(e.pos-1,f,e.pos,f,new ce(p,1,0),o.length,!0)),y=g.doc.resolve(f+2*o.length);y.nodeAfter&&y.nodeAfter.type==s.type&&ci(g.doc,y.pos)&&g.join(y.pos),n(g.scrollIntoView())}return!0}let u=i.type.spec.isolating||r>0&&l?null:Pe.findFrom(e,1),d=u&&u.$from.blockRange(u.$to),h=d&&ka(d);if(h!=null&&h>=e.depth)return n&&n(t.tr.lift(d,h).scrollIntoView()),!0;if(c&&da(i,"start",!0)&&da(s,"end")){let f=s,p=[];for(;p.push(f),!f.isTextblock;)f=f.lastChild;let g=i,y=1;for(;!g.isTextblock;g=g.firstChild)y++;if(f.canReplace(f.childCount,f.childCount,g.content)){if(n){let m=ee.empty;for(let w=p.length-1;w>=0;w--)m=ee.from(p[w].copy(m));let v=t.tr.step(new Nt(e.pos-p.length,e.pos+i.nodeSize,e.pos+y,e.pos+i.nodeSize-y,new ce(m,p.length,0),0,!0));n(v.scrollIntoView())}return!0}}return!1}function TT(t){return function(e,n){let r=e.selection,s=t<0?r.$from:r.$to,i=s.depth;for(;s.node(i).isInline;){if(!i)return!1;i--}return s.node(i).isTextblock?(n&&n(e.tr.setSelection(Ae.create(e.doc,t<0?s.start(i):s.end(i)))),!0):!1}}const cL=TT(-1),uL=TT(1);function dL(t,e=null){return function(n,r){let{$from:s,$to:i}=n.selection,o=s.blockRange(i),a=o&&W0(o,t,e);return a?(r&&r(n.tr.wrap(o,a).scrollIntoView()),!0):!1}}function Uw(t,e=null){return function(n,r){let s=!1;for(let i=0;i<n.selection.ranges.length&&!s;i++){let{$from:{pos:o},$to:{pos:a}}=n.selection.ranges[i];n.doc.nodesBetween(o,a,(l,c)=>{if(s)return!1;if(!(!l.isTextblock||l.hasMarkup(t,e)))if(l.type==t)s=!0;else{let u=n.doc.resolve(c),d=u.index();s=u.parent.canReplaceWith(d,d+1,t)}})}if(!s)return!1;if(r){let i=n.tr;for(let o=0;o<n.selection.ranges.length;o++){let{$from:{pos:a},$to:{pos:l}}=n.selection.ranges[o];i.setBlockType(a,l,t,e)}r(i.scrollIntoView())}return!0}}typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function hL(t,e=null){return function(n,r){let{$from:s,$to:i}=n.selection,o=s.blockRange(i);if(!o)return!1;let a=r?n.tr:null;return fL(a,o,t,e)?(r&&r(a.scrollIntoView()),!0):!1}}function fL(t,e,n,r=null){let s=!1,i=e,o=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let l=o.resolve(e.start-2);i=new bd(l,l,e.depth),e.endIndex<e.parent.childCount&&(e=new bd(e.$from,o.resolve(e.$to.end(e.depth)),e.depth)),s=!0}let a=W0(i,n,r,e);return a?(t&&pL(t,e,a,s,n),!0):!1}function pL(t,e,n,r,s){let i=ee.empty;for(let u=n.length-1;u>=0;u--)i=ee.from(n[u].type.create(n[u].attrs,i));t.step(new Nt(e.start-(r?2:0),e.end,e.start,e.end,new ce(i,0,0),n.length,!0));let o=0;for(let u=0;u<n.length;u++)n[u].type==s&&(o=u+1);let a=n.length-o,l=e.start+n.length-(r?2:0),c=e.parent;for(let u=e.startIndex,d=e.endIndex,h=!0;u<d;u++,h=!1)!h&&Qo(t.doc,l,a)&&(t.split(l,a),l+=2*a),l+=c.child(u).nodeSize;return t}function mL(t){return function(e,n){let{$from:r,$to:s}=e.selection,i=r.blockRange(s,o=>o.childCount>0&&o.firstChild.type==t);return i?n?r.node(i.depth-1).type==t?gL(e,n,t,i):yL(e,n,i):!0:!1}}function gL(t,e,n,r){let s=t.tr,i=r.end,o=r.$to.end(r.depth);i<o&&(s.step(new Nt(i-1,o,i,o,new ce(ee.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new bd(s.doc.resolve(r.$from.pos),s.doc.resolve(o),r.depth));const a=ka(r);if(a==null)return!1;s.lift(r,a);let l=s.doc.resolve(s.mapping.map(i,-1)-1);return ci(s.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&s.join(l.pos),e(s.scrollIntoView()),!0}function yL(t,e,n){let r=t.tr,s=n.parent;for(let f=n.end,p=n.endIndex-1,g=n.startIndex;p>g;p--)f-=s.child(p).nodeSize,r.delete(f-1,f+1);let i=r.doc.resolve(n.start),o=i.nodeAfter;if(r.mapping.map(n.end)!=n.start+i.nodeAfter.nodeSize)return!1;let a=n.startIndex==0,l=n.endIndex==s.childCount,c=i.node(-1),u=i.index(-1);if(!c.canReplace(u+(a?0:1),u+1,o.content.append(l?ee.empty:ee.from(s))))return!1;let d=i.pos,h=d+o.nodeSize;return r.step(new Nt(d-(a?1:0),h+(l?1:0),d+1,h-1,new ce((a?ee.empty:ee.from(s.copy(ee.empty))).append(l?ee.empty:ee.from(s.copy(ee.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}function vL(t){return function(e,n){let{$from:r,$to:s}=e.selection,i=r.blockRange(s,c=>c.childCount>0&&c.firstChild.type==t);if(!i)return!1;let o=i.startIndex;if(o==0)return!1;let a=i.parent,l=a.child(o-1);if(l.type!=t)return!1;if(n){let c=l.lastChild&&l.lastChild.type==a.type,u=ee.from(c?t.create():null),d=new ce(ee.from(t.create(null,ee.from(a.type.create(null,u)))),c?3:1,0),h=i.start,f=i.end;n(e.tr.step(new Nt(h-(c?3:1),f,h,f,d,1,!0)).scrollIntoView())}return!0}}function Uh(t){const{state:e,transaction:n}=t;let{selection:r}=n,{doc:s}=n,{storedMarks:i}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return i},get selection(){return r},get doc(){return s},get tr(){return r=n.selection,s=n.doc,i=n.storedMarks,n}}}class zh{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:n,state:r}=this,{view:s}=n,{tr:i}=r,o=this.buildProps(i);return Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...u)=>{const d=l(...u)(o);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(i),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,n=!0){const{rawCommands:r,editor:s,state:i}=this,{view:o}=s,a=[],l=!!e,c=e||i.tr,u=()=>(!l&&n&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(c),a.every(h=>h===!0)),d={...Object.fromEntries(Object.entries(r).map(([h,f])=>[h,(...g)=>{const y=this.buildProps(c,n),m=f(...g)(y);return a.push(m),d}])),run:u};return d}createCan(e){const{rawCommands:n,state:r}=this,s=!1,i=e||r.tr,o=this.buildProps(i,s);return{...Object.fromEntries(Object.entries(n).map(([l,c])=>[l,(...u)=>c(...u)({...o,dispatch:void 0})])),chain:()=>this.createChain(i,s)}}buildProps(e,n=!0){const{rawCommands:r,editor:s,state:i}=this,{view:o}=s,a={tr:e,editor:s,view:o,state:Uh({state:i,transaction:e}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(e,n),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([l,c])=>[l,(...u)=>c(...u)(a)]))}};return a}}class wL{constructor(){this.callbacks={}}on(e,n){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(n),this}emit(e,...n){const r=this.callbacks[e];return r&&r.forEach(s=>s.apply(this,n)),this}off(e,n){const r=this.callbacks[e];return r&&(n?this.callbacks[e]=r.filter(s=>s!==n):delete this.callbacks[e]),this}once(e,n){const r=(...s)=>{this.off(e,r),n.apply(this,s)};return this.on(e,r)}removeAllListeners(){this.callbacks={}}}function pe(t,e,n){return t.config[e]===void 0&&t.parent?pe(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?pe(t.parent,e,n):null}):t.config[e]}function Vh(t){const e=t.filter(s=>s.type==="extension"),n=t.filter(s=>s.type==="node"),r=t.filter(s=>s.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:r}}function _T(t){const e=[],{nodeExtensions:n,markExtensions:r}=Vh(t),s=[...n,...r],i={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage,extensions:s},l=pe(o,"addGlobalAttributes",a);if(!l)return;l().forEach(u=>{u.types.forEach(d=>{Object.entries(u.attributes).forEach(([h,f])=>{e.push({type:d,name:h,attribute:{...i,...f}})})})})}),s.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage},l=pe(o,"addAttributes",a);if(!l)return;const c=l();Object.entries(c).forEach(([u,d])=>{const h={...i,...d};typeof(h==null?void 0:h.default)=="function"&&(h.default=h.default()),h!=null&&h.isRequired&&(h==null?void 0:h.default)===void 0&&delete h.default,e.push({type:o.name,name:u,attribute:h})})}),e}function Pt(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}function St(...t){return t.filter(e=>!!e).reduce((e,n)=>{const r={...e};return Object.entries(n).forEach(([s,i])=>{if(!r[s]){r[s]=i;return}if(s==="class"){const a=i?String(i).split(" "):[],l=r[s]?r[s].split(" "):[],c=a.filter(u=>!l.includes(u));r[s]=[...l,...c].join(" ")}else if(s==="style"){const a=i?i.split(";").map(u=>u.trim()).filter(Boolean):[],l=r[s]?r[s].split(";").map(u=>u.trim()).filter(Boolean):[],c=new Map;l.forEach(u=>{const[d,h]=u.split(":").map(f=>f.trim());c.set(d,h)}),a.forEach(u=>{const[d,h]=u.split(":").map(f=>f.trim());c.set(d,h)}),r[s]=Array.from(c.entries()).map(([u,d])=>`${u}: ${d}`).join("; ")}else r[s]=i}),r},{})}function Ym(t,e){return e.filter(n=>n.type===t.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,r)=>St(n,r),{})}function AT(t){return typeof t=="function"}function De(t,e=void 0,...n){return AT(t)?e?t.bind(e)(...n):t(...n):t}function xL(t={}){return Object.keys(t).length===0&&t.constructor===Object}function bL(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function zw(t,e){return"style"in t?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(r===!1)return!1;const s=e.reduce((i,o)=>{const a=o.attribute.parseHTML?o.attribute.parseHTML(n):bL(n.getAttribute(o.name));return a==null?i:{...i,[o.name]:a}},{});return{...r,...s}}}}function Vw(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&xL(n)?!1:n!=null))}function kL(t,e){var n;const r=_T(t),{nodeExtensions:s,markExtensions:i}=Vh(t),o=(n=s.find(c=>pe(c,"topNode")))===null||n===void 0?void 0:n.name,a=Object.fromEntries(s.map(c=>{const u=r.filter(m=>m.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},h=t.reduce((m,v)=>{const w=pe(v,"extendNodeSchema",d);return{...m,...w?w(c):{}}},{}),f=Vw({...h,content:De(pe(c,"content",d)),marks:De(pe(c,"marks",d)),group:De(pe(c,"group",d)),inline:De(pe(c,"inline",d)),atom:De(pe(c,"atom",d)),selectable:De(pe(c,"selectable",d)),draggable:De(pe(c,"draggable",d)),code:De(pe(c,"code",d)),whitespace:De(pe(c,"whitespace",d)),linebreakReplacement:De(pe(c,"linebreakReplacement",d)),defining:De(pe(c,"defining",d)),isolating:De(pe(c,"isolating",d)),attrs:Object.fromEntries(u.map(m=>{var v;return[m.name,{default:(v=m==null?void 0:m.attribute)===null||v===void 0?void 0:v.default}]}))}),p=De(pe(c,"parseHTML",d));p&&(f.parseDOM=p.map(m=>zw(m,u)));const g=pe(c,"renderHTML",d);g&&(f.toDOM=m=>g({node:m,HTMLAttributes:Ym(m,u)}));const y=pe(c,"renderText",d);return y&&(f.toText=y),[c.name,f]})),l=Object.fromEntries(i.map(c=>{const u=r.filter(y=>y.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},h=t.reduce((y,m)=>{const v=pe(m,"extendMarkSchema",d);return{...y,...v?v(c):{}}},{}),f=Vw({...h,inclusive:De(pe(c,"inclusive",d)),excludes:De(pe(c,"excludes",d)),group:De(pe(c,"group",d)),spanning:De(pe(c,"spanning",d)),code:De(pe(c,"code",d)),attrs:Object.fromEntries(u.map(y=>{var m;return[y.name,{default:(m=y==null?void 0:y.attribute)===null||m===void 0?void 0:m.default}]}))}),p=De(pe(c,"parseHTML",d));p&&(f.parseDOM=p.map(y=>zw(y,u)));const g=pe(c,"renderHTML",d);return g&&(f.toDOM=y=>g({mark:y,HTMLAttributes:Ym(y,u)})),[c.name,f]}));return new xC({topNode:o,nodes:a,marks:l})}function Xf(t,e){return e.nodes[t]||e.marks[t]||null}function Hw(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}function sy(t,e){const n=so.fromSchema(e).serializeFragment(t),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(n),s.innerHTML}const SL=(t,e=500)=>{let n="";const r=t.parentOffset;return t.parent.nodesBetween(Math.max(0,r-e),r,(s,i,o,a)=>{var l,c;const u=((c=(l=s.type.spec).toText)===null||c===void 0?void 0:c.call(l,{node:s,pos:i,parent:o,index:a}))||s.textContent||"%leaf%";n+=s.isAtom&&!s.isText?u:u.slice(0,Math.max(0,r-i))}),n};function iy(t){return Object.prototype.toString.call(t)==="[object RegExp]"}class Hh{constructor(e){this.find=e.find,this.handler=e.handler}}const EL=(t,e)=>{if(iy(e))return e.exec(t);const n=e(t);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function eu(t){var e;const{editor:n,from:r,to:s,text:i,rules:o,plugin:a}=t,{view:l}=n;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||!((e=c.nodeBefore||c.nodeAfter)===null||e===void 0)&&e.marks.find(h=>h.type.spec.code))return!1;let u=!1;const d=SL(c)+i;return o.forEach(h=>{if(u)return;const f=EL(d,h.find);if(!f)return;const p=l.state.tr,g=Uh({state:l.state,transaction:p}),y={from:r-(f[0].length-i.length),to:s},{commands:m,chain:v,can:w}=new zh({editor:n,state:g});h.handler({state:g,range:y,match:f,commands:m,chain:v,can:w})===null||!p.steps.length||(p.setMeta(a,{transform:p,from:r,to:s,text:i}),l.dispatch(p),u=!0)}),u}function CL(t){const{editor:e,rules:n}=t,r=new Mt({state:{init(){return null},apply(s,i,o){const a=s.getMeta(r);if(a)return a;const l=s.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:u}=l;typeof u=="string"?u=u:u=sy(ee.from(u),o.schema);const{from:d}=l,h=d+u.length;eu({editor:e,from:d,to:h,text:u,rules:n,plugin:r})}),s.selectionSet||s.docChanged?null:i}},props:{handleTextInput(s,i,o,a){return eu({editor:e,from:i,to:o,text:a,rules:n,plugin:r})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{const{$cursor:i}=s.state.selection;i&&eu({editor:e,from:i.pos,to:i.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(s,i){if(i.key!=="Enter")return!1;const{$cursor:o}=s.state.selection;return o?eu({editor:e,from:o.pos,to:o.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function TL(t){return Object.prototype.toString.call(t).slice(8,-1)}function tu(t){return TL(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function Wh(t,e){const n={...t};return tu(t)&&tu(e)&&Object.keys(e).forEach(r=>{tu(e[r])&&tu(t[r])?n[r]=Wh(t[r],e[r]):n[r]=e[r]}),n}class fs{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=De(pe(this,"addOptions",{name:this.name}))),this.storage=De(pe(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new fs(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>Wh(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new fs(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=De(pe(n,"addOptions",{name:n.name})),n.storage=De(pe(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:e,mark:n}){const{tr:r}=e.state,s=e.state.selection.$from;if(s.pos===s.end()){const o=s.marks();if(!!!o.find(c=>(c==null?void 0:c.type.name)===n.name))return!1;const l=o.find(c=>(c==null?void 0:c.type.name)===n.name);return l&&r.removeStoredMark(l),r.insertText(" ",s.pos),e.view.dispatch(r),!0}return!1}}function _L(t){return typeof t=="number"}class AL{constructor(e){this.find=e.find,this.handler=e.handler}}const OL=(t,e,n)=>{if(iy(e))return[...t.matchAll(e)];const r=e(t,n);return r?r.map(s=>{const i=[s.text];return i.index=s.index,i.input=t,i.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(s.replaceWith)),i}):[]};function RL(t){const{editor:e,state:n,from:r,to:s,rule:i,pasteEvent:o,dropEvent:a}=t,{commands:l,chain:c,can:u}=new zh({editor:e,state:n}),d=[];return n.doc.nodesBetween(r,s,(f,p)=>{if(!f.isTextblock||f.type.spec.code)return;const g=Math.max(r,p),y=Math.min(s,p+f.content.size),m=f.textBetween(g-p,y-p,void 0,"");OL(m,i.find,o).forEach(w=>{if(w.index===void 0)return;const S=g+w.index+1,T=S+w[0].length,E={from:n.tr.mapping.map(S),to:n.tr.mapping.map(T)},O=i.handler({state:n,range:E,match:w,commands:l,chain:c,can:u,pasteEvent:o,dropEvent:a});d.push(O)})}),d.every(f=>f!==null)}let nu=null;const NL=t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=n.clipboardData)===null||e===void 0||e.setData("text/html",t),n};function IL(t){const{editor:e,rules:n}=t;let r=null,s=!1,i=!1,o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}const l=({state:u,from:d,to:h,rule:f,pasteEvt:p})=>{const g=u.tr,y=Uh({state:u,transaction:g});if(!(!RL({editor:e,state:y,from:Math.max(d-1,0),to:h.b-1,rule:f,pasteEvent:p,dropEvent:a})||!g.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,g}};return n.map(u=>new Mt({view(d){const h=p=>{var g;r=!((g=d.dom.parentElement)===null||g===void 0)&&g.contains(p.target)?d.dom.parentElement:null,r&&(nu=e)},f=()=>{nu&&(nu=null)};return window.addEventListener("dragstart",h),window.addEventListener("dragend",f),{destroy(){window.removeEventListener("dragstart",h),window.removeEventListener("dragend",f)}}},props:{handleDOMEvents:{drop:(d,h)=>{if(i=r===d.dom.parentElement,a=h,!i){const f=nu;f!=null&&f.isEditable&&setTimeout(()=>{const p=f.state.selection;p&&f.commands.deleteRange({from:p.from,to:p.to})},10)}return!1},paste:(d,h)=>{var f;const p=(f=h.clipboardData)===null||f===void 0?void 0:f.getData("text/html");return o=h,s=!!(p!=null&&p.includes("data-pm-slice")),!1}}},appendTransaction:(d,h,f)=>{const p=d[0],g=p.getMeta("uiEvent")==="paste"&&!s,y=p.getMeta("uiEvent")==="drop"&&!i,m=p.getMeta("applyPasteRules"),v=!!m;if(!g&&!y&&!v)return;if(v){let{text:T}=m;typeof T=="string"?T=T:T=sy(ee.from(T),f.schema);const{from:E}=m,O=E+T.length,b=NL(T);return l({rule:u,state:f,from:E,to:{b:O},pasteEvt:b})}const w=h.doc.content.findDiffStart(f.doc.content),S=h.doc.content.findDiffEnd(f.doc.content);if(!(!_L(w)||!S||w===S.b))return l({rule:u,state:f,from:w,to:S,pasteEvt:o})}}))}function PL(t){const e=t.filter((n,r)=>t.indexOf(n)!==r);return Array.from(new Set(e))}class $o{constructor(e,n){this.splittableMarks=[],this.editor=n,this.extensions=$o.resolve(e),this.schema=kL(this.extensions,n),this.setupExtensions()}static resolve(e){const n=$o.sort($o.flatten(e)),r=PL(n.map(s=>s.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(s=>`'${s}'`).join(", ")}]. This can lead to issues.`),n}static flatten(e){return e.map(n=>{const r={name:n.name,options:n.options,storage:n.storage},s=pe(n,"addExtensions",r);return s?[n,...this.flatten(s())]:n}).flat(10)}static sort(e){return e.sort((r,s)=>{const i=pe(r,"priority")||100,o=pe(s,"priority")||100;return i>o?-1:i<o?1:0})}get commands(){return this.extensions.reduce((e,n)=>{const r={name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:Xf(n.name,this.schema)},s=pe(n,"addCommands",r);return s?{...e,...s()}:e},{})}get plugins(){const{editor:e}=this,n=$o.sort([...this.extensions].reverse()),r=[],s=[],i=n.map(o=>{const a={name:o.name,options:o.options,storage:o.storage,editor:e,type:Xf(o.name,this.schema)},l=[],c=pe(o,"addKeyboardShortcuts",a);let u={};if(o.type==="mark"&&pe(o,"exitable",a)&&(u.ArrowRight=()=>fs.handleExit({editor:e,mark:o})),c){const g=Object.fromEntries(Object.entries(c()).map(([y,m])=>[y,()=>m({editor:e})]));u={...u,...g}}const d=K5(u);l.push(d);const h=pe(o,"addInputRules",a);Hw(o,e.options.enableInputRules)&&h&&r.push(...h());const f=pe(o,"addPasteRules",a);Hw(o,e.options.enablePasteRules)&&f&&s.push(...f());const p=pe(o,"addProseMirrorPlugins",a);if(p){const g=p();l.push(...g)}return l}).flat();return[CL({editor:e,rules:r}),...IL({editor:e,rules:s}),...i]}get attributes(){return _T(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:n}=Vh(this.extensions);return Object.fromEntries(n.filter(r=>!!pe(r,"addNodeView")).map(r=>{const s=this.attributes.filter(l=>l.type===r.name),i={name:r.name,options:r.options,storage:r.storage,editor:e,type:Pt(r.name,this.schema)},o=pe(r,"addNodeView",i);if(!o)return[];const a=(l,c,u,d,h)=>{const f=Ym(l,s);return o()({node:l,view:c,getPos:u,decorations:d,innerDecorations:h,editor:e,extension:r,HTMLAttributes:f})};return[r.name,a]}))}setupExtensions(){this.extensions.forEach(e=>{var n;this.editor.extensionStorage[e.name]=e.storage;const r={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:Xf(e.name,this.schema)};e.type==="mark"&&(!((n=De(pe(e,"keepOnSplit",r)))!==null&&n!==void 0)||n)&&this.splittableMarks.push(e.name);const s=pe(e,"onBeforeCreate",r),i=pe(e,"onCreate",r),o=pe(e,"onUpdate",r),a=pe(e,"onSelectionUpdate",r),l=pe(e,"onTransaction",r),c=pe(e,"onFocus",r),u=pe(e,"onBlur",r),d=pe(e,"onDestroy",r);s&&this.editor.on("beforeCreate",s),i&&this.editor.on("create",i),o&&this.editor.on("update",o),a&&this.editor.on("selectionUpdate",a),l&&this.editor.on("transaction",l),c&&this.editor.on("focus",c),u&&this.editor.on("blur",u),d&&this.editor.on("destroy",d)})}}class Zt{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=De(pe(this,"addOptions",{name:this.name}))),this.storage=De(pe(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Zt(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>Wh(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new Zt({...this.config,...e});return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=De(pe(n,"addOptions",{name:n.name})),n.storage=De(pe(n,"addStorage",{name:n.name,options:n.options})),n}}function OT(t,e,n){const{from:r,to:s}=e,{blockSeparator:i=`

`,textSerializers:o={}}=n||{};let a="";return t.nodesBetween(r,s,(l,c,u,d)=>{var h;l.isBlock&&c>r&&(a+=i);const f=o==null?void 0:o[l.type.name];if(f)return u&&(a+=f({node:l,pos:c,parent:u,index:d,range:e})),!1;l.isText&&(a+=(h=l==null?void 0:l.text)===null||h===void 0?void 0:h.slice(Math.max(r,c)-c,s-c))}),a}function RT(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}const ML=Zt.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Mt({key:new En("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:r,selection:s}=e,{ranges:i}=s,o=Math.min(...i.map(u=>u.$from.pos)),a=Math.max(...i.map(u=>u.$to.pos)),l=RT(n);return OT(r,{from:o,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),DL=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window==null?void 0:window.getSelection())===null||n===void 0||n.removeAllRanges())}),!0),jL=(t=!1)=>({commands:e})=>e.setContent("",t),LL=()=>({state:t,tr:e,dispatch:n})=>{const{selection:r}=e,{ranges:s}=r;return n&&s.forEach(({$from:i,$to:o})=>{t.doc.nodesBetween(i.pos,o.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:u}=e,d=c.resolve(u.map(l)),h=c.resolve(u.map(l+a.nodeSize)),f=d.blockRange(h);if(!f)return;const p=ka(f);if(a.type.isTextblock){const{defaultType:g}=d.parent.contentMatchAt(d.index());e.setNodeMarkup(f.start,g)}(p||p===0)&&e.lift(f,p)})}),!0},$L=t=>e=>t(e),FL=()=>({state:t,dispatch:e})=>iL(t,e),BL=(t,e)=>({editor:n,tr:r})=>{const{state:s}=n,i=s.doc.slice(t.from,t.to);r.deleteRange(t.from,t.to);const o=r.mapping.map(e);return r.insert(o,i.content),r.setSelection(new Ae(r.doc.resolve(Math.max(o-1,0)))),!0},UL=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,r=n.$anchor.node();if(r.content.size>0)return!1;const s=t.selection.$anchor;for(let i=s.depth;i>0;i-=1)if(s.node(i).type===r.type){if(e){const a=s.before(i),l=s.after(i);t.delete(a,l).scrollIntoView()}return!0}return!1},zL=t=>({tr:e,state:n,dispatch:r})=>{const s=Pt(t,n.schema),i=e.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===s){if(r){const l=i.before(o),c=i.after(o);e.delete(l,c).scrollIntoView()}return!0}return!1},VL=t=>({tr:e,dispatch:n})=>{const{from:r,to:s}=t;return n&&e.delete(r,s),!0},HL=()=>({state:t,dispatch:e})=>q5(t,e),WL=()=>({commands:t})=>t.keyboardShortcut("Enter"),KL=()=>({state:t,dispatch:e})=>sL(t,e);function Od(t,e,n={strict:!0}){const r=Object.keys(e);return r.length?r.every(s=>n.strict?e[s]===t[s]:iy(e[s])?e[s].test(t[s]):e[s]===t[s]):!0}function NT(t,e,n={}){return t.find(r=>r.type===e&&Od(Object.fromEntries(Object.keys(n).map(s=>[s,r.attrs[s]])),n))}function Ww(t,e,n={}){return!!NT(t,e,n)}function oy(t,e,n){var r;if(!t||!e)return;let s=t.parent.childAfter(t.parentOffset);if((!s.node||!s.node.marks.some(u=>u.type===e))&&(s=t.parent.childBefore(t.parentOffset)),!s.node||!s.node.marks.some(u=>u.type===e)||(n=n||((r=s.node.marks[0])===null||r===void 0?void 0:r.attrs),!NT([...s.node.marks],e,n)))return;let o=s.index,a=t.start()+s.offset,l=o+1,c=a+s.node.nodeSize;for(;o>0&&Ww([...t.parent.child(o-1).marks],e,n);)o-=1,a-=t.parent.child(o).nodeSize;for(;l<t.parent.childCount&&Ww([...t.parent.child(l).marks],e,n);)c+=t.parent.child(l).nodeSize,l+=1;return{from:a,to:c}}function di(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}const qL=(t,e={})=>({tr:n,state:r,dispatch:s})=>{const i=di(t,r.schema),{doc:o,selection:a}=n,{$from:l,from:c,to:u}=a;if(s){const d=oy(l,i,e);if(d&&d.from<=c&&d.to>=u){const h=Ae.create(o,d.from,d.to);n.setSelection(h)}}return!0},GL=t=>e=>{const n=typeof t=="function"?t(e):t;for(let r=0;r<n.length;r+=1)if(n[r](e))return!0;return!1};function IT(t){return t instanceof Ae}function Ni(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function PT(t,e=null){if(!e)return null;const n=Pe.atStart(t),r=Pe.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return r;const s=n.from,i=r.to;return e==="all"?Ae.create(t,Ni(0,s,i),Ni(t.content.size,s,i)):Ae.create(t,Ni(e,s,i),Ni(e,s,i))}function JL(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function ay(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const YL=(t=null,e={})=>({editor:n,view:r,tr:s,dispatch:i})=>{e={scrollIntoView:!0,...e};const o=()=>{(ay()||JL())&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&n.commands.scrollIntoView())})};if(r.hasFocus()&&t===null||t===!1)return!0;if(i&&t===null&&!IT(n.state.selection))return o(),!0;const a=PT(s.doc,t)||n.state.selection,l=n.state.selection.eq(a);return i&&(l||s.setSelection(a),l&&s.storedMarks&&s.setStoredMarks(s.storedMarks),o()),!0},QL=(t,e)=>n=>t.every((r,s)=>e(r,{...n,index:s})),XL=(t,e)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),MT=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const r=e[n];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?t.removeChild(r):r.nodeType===1&&MT(r)}return t};function ru(t){const e=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(e,"text/html").body;return MT(n)}function nc(t,e,n){if(t instanceof Gs||t instanceof ee)return t;n={slice:!0,parseOptions:{},...n};const r=typeof t=="object"&&t!==null,s=typeof t=="string";if(r)try{if(Array.isArray(t)&&t.length>0)return ee.fromArray(t.map(a=>e.nodeFromJSON(a)));const o=e.nodeFromJSON(t);return n.errorOnInvalidContent&&o.check(),o}catch(i){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:i});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",i),nc("",e,n)}if(s){if(n.errorOnInvalidContent){let o=!1,a="";const l=new xC({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(o=!0,a=typeof c=="string"?c:c.outerHTML,null)}]}})});if(n.slice?Js.fromSchema(l).parseSlice(ru(t),n.parseOptions):Js.fromSchema(l).parse(ru(t),n.parseOptions),n.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const i=Js.fromSchema(e);return n.slice?i.parseSlice(ru(t),n.parseOptions).content:i.parse(ru(t),n.parseOptions)}return nc("",e,n)}function ZL(t,e,n){const r=t.steps.length-1;if(r<e)return;const s=t.steps[r];if(!(s instanceof At||s instanceof Nt))return;const i=t.mapping.maps[r];let o=0;i.forEach((a,l,c,u)=>{o===0&&(o=u)}),t.setSelection(Pe.near(t.doc.resolve(o),n))}const e3=t=>!("type"in t),t3=(t,e,n)=>({tr:r,dispatch:s,editor:i})=>{var o;if(s){n={parseOptions:i.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let a;const l=y=>{i.emit("contentError",{editor:i,error:y,disableCollaboration:()=>{i.storage.collaboration&&(i.storage.collaboration.isDisabled=!0)}})},c={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!i.options.enableContentCheck&&i.options.emitContentError)try{nc(e,i.schema,{parseOptions:c,errorOnInvalidContent:!0})}catch(y){l(y)}try{a=nc(e,i.schema,{parseOptions:c,errorOnInvalidContent:(o=n.errorOnInvalidContent)!==null&&o!==void 0?o:i.options.enableContentCheck})}catch(y){return l(y),!1}let{from:u,to:d}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},h=!0,f=!0;if((e3(a)?a:[a]).forEach(y=>{y.check(),h=h?y.isText&&y.marks.length===0:!1,f=f?y.isBlock:!1}),u===d&&f){const{parent:y}=r.doc.resolve(u);y.isTextblock&&!y.type.spec.code&&!y.childCount&&(u-=1,d+=1)}let g;if(h){if(Array.isArray(e))g=e.map(y=>y.text||"").join("");else if(e instanceof ee){let y="";e.forEach(m=>{m.text&&(y+=m.text)}),g=y}else typeof e=="object"&&e&&e.text?g=e.text:g=e;r.insertText(g,u,d)}else g=a,r.replaceWith(u,d,g);n.updateSelection&&ZL(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:u,text:g}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:u,text:g})}return!0},n3=()=>({state:t,dispatch:e})=>eL(t,e),r3=()=>({state:t,dispatch:e})=>tL(t,e),s3=()=>({state:t,dispatch:e})=>G5(t,e),i3=()=>({state:t,dispatch:e})=>X5(t,e),o3=()=>({state:t,dispatch:e,tr:n})=>{try{const r=Dh(t.doc,t.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},a3=()=>({state:t,dispatch:e,tr:n})=>{try{const r=Dh(t.doc,t.selection.$from.pos,1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},l3=()=>({state:t,dispatch:e})=>J5(t,e),c3=()=>({state:t,dispatch:e})=>Y5(t,e);function DT(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function u3(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let r,s,i,o;for(let a=0;a<e.length-1;a+=1){const l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))ay()||DT()?o=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(n=`Alt-${n}`),s&&(n=`Ctrl-${n}`),o&&(n=`Meta-${n}`),i&&(n=`Shift-${n}`),n}const d3=t=>({editor:e,view:n,tr:r,dispatch:s})=>{const i=u3(t).split(/-(?!$)/),o=i.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{n.someProp("handleKeyDown",c=>c(n,a))});return l==null||l.steps.forEach(c=>{const u=c.map(r.mapping);u&&s&&r.maybeStep(u)}),!0};function rc(t,e,n={}){const{from:r,to:s,empty:i}=t.selection,o=e?Pt(e,t.schema):null,a=[];t.doc.nodesBetween(r,s,(d,h)=>{if(d.isText)return;const f=Math.max(r,h),p=Math.min(s,h+d.nodeSize);a.push({node:d,from:f,to:p})});const l=s-r,c=a.filter(d=>o?o.name===d.node.type.name:!0).filter(d=>Od(d.node.attrs,n,{strict:!1}));return i?!!c.length:c.reduce((d,h)=>d+h.to-h.from,0)>=l}const h3=(t,e={})=>({state:n,dispatch:r})=>{const s=Pt(t,n.schema);return rc(n,s,e)?nL(n,r):!1},f3=()=>({state:t,dispatch:e})=>oL(t,e),p3=t=>({state:e,dispatch:n})=>{const r=Pt(t,e.schema);return mL(r)(e,n)},m3=()=>({state:t,dispatch:e})=>rL(t,e);function Kh(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function Kw(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((r,s)=>(n.includes(s)||(r[s]=t[s]),r),{})}const g3=(t,e)=>({tr:n,state:r,dispatch:s})=>{let i=null,o=null;const a=Kh(typeof t=="string"?t:t.name,r.schema);return a?(a==="node"&&(i=Pt(t,r.schema)),a==="mark"&&(o=di(t,r.schema)),s&&n.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,u)=>{i&&i===c.type&&n.setNodeMarkup(u,void 0,Kw(c.attrs,e)),o&&c.marks.length&&c.marks.forEach(d=>{o===d.type&&n.addMark(u,u+c.nodeSize,o.create(Kw(d.attrs,e)))})})}),!0):!1},y3=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),v3=()=>({tr:t,dispatch:e})=>{if(e){const n=new tr(t.doc);t.setSelection(n)}return!0},w3=()=>({state:t,dispatch:e})=>Q5(t,e),x3=()=>({state:t,dispatch:e})=>Z5(t,e),b3=()=>({state:t,dispatch:e})=>aL(t,e),k3=()=>({state:t,dispatch:e})=>uL(t,e),S3=()=>({state:t,dispatch:e})=>cL(t,e);function Qm(t,e,n={},r={}){return nc(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}const E3=(t,e=!1,n={},r={})=>({editor:s,tr:i,dispatch:o,commands:a})=>{var l,c;const{doc:u}=i;if(n.preserveWhitespace!=="full"){const d=Qm(t,s.schema,n,{errorOnInvalidContent:(l=r.errorOnInvalidContent)!==null&&l!==void 0?l:s.options.enableContentCheck});return o&&i.replaceWith(0,u.content.size,d).setMeta("preventUpdate",!e),!0}return o&&i.setMeta("preventUpdate",!e),a.insertContentAt({from:0,to:u.content.size},t,{parseOptions:n,errorOnInvalidContent:(c=r.errorOnInvalidContent)!==null&&c!==void 0?c:s.options.enableContentCheck})};function jT(t,e){const n=di(e,t.schema),{from:r,to:s,empty:i}=t.selection,o=[];i?(t.storedMarks&&o.push(...t.storedMarks),o.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,s,l=>{o.push(...l.marks)});const a=o.find(l=>l.type.name===n.name);return a?{...a.attrs}:{}}function C3(t,e){const n=new jC(t);return e.forEach(r=>{r.steps.forEach(s=>{n.step(s)})}),n}function T3(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function _3(t,e,n){const r=[];return t.nodesBetween(e.from,e.to,(s,i)=>{n(s)&&r.push({node:s,pos:i})}),r}function A3(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}function ly(t){return e=>A3(e.$from,t)}function O3(t,e){const n={from:0,to:t.content.size};return OT(t,n,e)}function R3(t,e){const n=Pt(e,t.schema),{from:r,to:s}=t.selection,i=[];t.doc.nodesBetween(r,s,a=>{i.push(a)});const o=i.reverse().find(a=>a.type.name===n.name);return o?{...o.attrs}:{}}function LT(t,e){const n=Kh(typeof e=="string"?e:e.name,t.schema);return n==="node"?R3(t,e):n==="mark"?jT(t,e):{}}function N3(t,e=JSON.stringify){const n={};return t.filter(r=>{const s=e(r);return Object.prototype.hasOwnProperty.call(n,s)?!1:n[s]=!0})}function I3(t){const e=N3(t);return e.length===1?e:e.filter((n,r)=>!e.filter((i,o)=>o!==r).some(i=>n.oldRange.from>=i.oldRange.from&&n.oldRange.to<=i.oldRange.to&&n.newRange.from>=i.newRange.from&&n.newRange.to<=i.newRange.to))}function P3(t){const{mapping:e,steps:n}=t,r=[];return e.maps.forEach((s,i)=>{const o=[];if(s.ranges.length)s.forEach((a,l)=>{o.push({from:a,to:l})});else{const{from:a,to:l}=n[i];if(a===void 0||l===void 0)return;o.push({from:a,to:l})}o.forEach(({from:a,to:l})=>{const c=e.slice(i).map(a,-1),u=e.slice(i).map(l),d=e.invert().map(c,-1),h=e.invert().map(u);r.push({oldRange:{from:d,to:h},newRange:{from:c,to:u}})})}),I3(r)}function cy(t,e,n){const r=[];return t===e?n.resolve(t).marks().forEach(s=>{const i=n.resolve(t),o=oy(i,s.type);o&&r.push({mark:s,...o})}):n.nodesBetween(t,e,(s,i)=>{!s||(s==null?void 0:s.nodeSize)===void 0||r.push(...s.marks.map(o=>({from:i,to:i+s.nodeSize,mark:o})))}),r}function Ru(t,e,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const s=t.find(i=>i.type===e&&i.name===r);return s?s.attribute.keepOnSplit:!1}))}function Xm(t,e,n={}){const{empty:r,ranges:s}=t.selection,i=e?di(e,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(d=>i?i.name===d.type.name:!0).find(d=>Od(d.attrs,n,{strict:!1}));let o=0;const a=[];if(s.forEach(({$from:d,$to:h})=>{const f=d.pos,p=h.pos;t.doc.nodesBetween(f,p,(g,y)=>{if(!g.isText&&!g.marks.length)return;const m=Math.max(f,y),v=Math.min(p,y+g.nodeSize),w=v-m;o+=w,a.push(...g.marks.map(S=>({mark:S,from:m,to:v})))})}),o===0)return!1;const l=a.filter(d=>i?i.name===d.mark.type.name:!0).filter(d=>Od(d.mark.attrs,n,{strict:!1})).reduce((d,h)=>d+h.to-h.from,0),c=a.filter(d=>i?d.mark.type!==i&&d.mark.type.excludes(i):!0).reduce((d,h)=>d+h.to-h.from,0);return(l>0?l+c:l)>=o}function M3(t,e,n={}){if(!e)return rc(t,null,n)||Xm(t,null,n);const r=Kh(e,t.schema);return r==="node"?rc(t,e,n):r==="mark"?Xm(t,e,n):!1}function qw(t,e){const{nodeExtensions:n}=Vh(e),r=n.find(o=>o.name===t);if(!r)return!1;const s={name:r.name,options:r.options,storage:r.storage},i=De(pe(r,"group",s));return typeof i!="string"?!1:i.split(" ").includes("list")}function uy(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((r=t.text)!==null&&r!==void 0?r:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let s=!0;return t.content.forEach(i=>{s!==!1&&(uy(i,{ignoreWhitespace:n,checkChildren:e})||(s=!1))}),s}return!1}function D3(t){return t instanceof xe}function j3(t,e,n){var r;const{selection:s}=e;let i=null;if(IT(s)&&(i=s.$cursor),i){const a=(r=t.storedMarks)!==null&&r!==void 0?r:i.marks();return!!n.isInSet(a)||!a.some(l=>l.type.excludes(n))}const{ranges:o}=s;return o.some(({$from:a,$to:l})=>{let c=a.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(a.pos,l.pos,(u,d,h)=>{if(c)return!1;if(u.isInline){const f=!h||h.type.allowsMarkType(n),p=!!n.isInSet(u.marks)||!u.marks.some(g=>g.type.excludes(n));c=f&&p}return!c}),c})}const L3=(t,e={})=>({tr:n,state:r,dispatch:s})=>{const{selection:i}=n,{empty:o,ranges:a}=i,l=di(t,r.schema);if(s)if(o){const c=jT(r,l);n.addStoredMark(l.create({...c,...e}))}else a.forEach(c=>{const u=c.$from.pos,d=c.$to.pos;r.doc.nodesBetween(u,d,(h,f)=>{const p=Math.max(f,u),g=Math.min(f+h.nodeSize,d);h.marks.find(m=>m.type===l)?h.marks.forEach(m=>{l===m.type&&n.addMark(p,g,l.create({...m.attrs,...e}))}):n.addMark(p,g,l.create(e))})});return j3(r,n,l)},$3=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),F3=(t,e={})=>({state:n,dispatch:r,chain:s})=>{const i=Pt(t,n.schema);let o;return n.selection.$anchor.sameParent(n.selection.$head)&&(o=n.selection.$anchor.parent.attrs),i.isTextblock?s().command(({commands:a})=>Uw(i,{...o,...e})(n)?!0:a.clearNodes()).command(({state:a})=>Uw(i,{...o,...e})(a,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},B3=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,s=Ni(t,0,r.content.size),i=xe.create(r,s);e.setSelection(i)}return!0},U3=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,{from:s,to:i}=typeof t=="number"?{from:t,to:t}:t,o=Ae.atStart(r).from,a=Ae.atEnd(r).to,l=Ni(s,o,a),c=Ni(i,o,a),u=Ae.create(r,l,c);e.setSelection(u)}return!0},z3=t=>({state:e,dispatch:n})=>{const r=Pt(t,e.schema);return vL(r)(e,n)};function Gw(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter(s=>e==null?void 0:e.includes(s.type.name));t.tr.ensureMarks(r)}}const V3=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:s})=>{const{selection:i,doc:o}=e,{$from:a,$to:l}=i,c=s.extensionManager.attributes,u=Ru(c,a.node().type.name,a.node().attrs);if(i instanceof xe&&i.node.isBlock)return!a.parentOffset||!Qo(o,a.pos)?!1:(r&&(t&&Gw(n,s.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const d=l.parentOffset===l.parent.content.size,h=a.depth===0?void 0:T3(a.node(-1).contentMatchAt(a.indexAfter(-1)));let f=d&&h?[{type:h,attrs:u}]:void 0,p=Qo(e.doc,e.mapping.map(a.pos),1,f);if(!f&&!p&&Qo(e.doc,e.mapping.map(a.pos),1,h?[{type:h}]:void 0)&&(p=!0,f=h?[{type:h,attrs:u}]:void 0),r){if(p&&(i instanceof Ae&&e.deleteSelection(),e.split(e.mapping.map(a.pos),1,f),h&&!d&&!a.parentOffset&&a.parent.type!==h)){const g=e.mapping.map(a.before()),y=e.doc.resolve(g);a.node(-1).canReplaceWith(y.index(),y.index()+1,h)&&e.setNodeMarkup(e.mapping.map(a.before()),h)}t&&Gw(n,s.extensionManager.splittableMarks),e.scrollIntoView()}return p},H3=(t,e={})=>({tr:n,state:r,dispatch:s,editor:i})=>{var o;const a=Pt(t,r.schema),{$from:l,$to:c}=r.selection,u=r.selection.node;if(u&&u.isBlock||l.depth<2||!l.sameParent(c))return!1;const d=l.node(-1);if(d.type!==a)return!1;const h=i.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(s){let m=ee.empty;const v=l.index(-1)?1:l.index(-2)?2:3;for(let b=l.depth-v;b>=l.depth-3;b-=1)m=ee.from(l.node(b).copy(m));const w=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,S={...Ru(h,l.node().type.name,l.node().attrs),...e},T=((o=a.contentMatch.defaultType)===null||o===void 0?void 0:o.createAndFill(S))||void 0;m=m.append(ee.from(a.createAndFill(null,T)||void 0));const E=l.before(l.depth-(v-1));n.replace(E,l.after(-w),new ce(m,4-v,0));let O=-1;n.doc.nodesBetween(E,n.doc.content.size,(b,k)=>{if(O>-1)return!1;b.isTextblock&&b.content.size===0&&(O=k+1)}),O>-1&&n.setSelection(Ae.near(n.doc.resolve(O))),n.scrollIntoView()}return!0}const f=c.pos===l.end()?d.contentMatchAt(0).defaultType:null,p={...Ru(h,d.type.name,d.attrs),...e},g={...Ru(h,l.node().type.name,l.node().attrs),...e};n.delete(l.pos,c.pos);const y=f?[{type:a,attrs:p},{type:f,attrs:g}]:[{type:a,attrs:p}];if(!Qo(n.doc,l.pos,2))return!1;if(s){const{selection:m,storedMarks:v}=r,{splittableMarks:w}=i.extensionManager,S=v||m.$to.parentOffset&&m.$from.marks();if(n.split(l.pos,2,y).scrollIntoView(),!S||!s)return!0;const T=S.filter(E=>w.includes(E.type.name));n.ensureMarks(T)}return!0},Zf=(t,e)=>{const n=ly(o=>o.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const s=t.doc.nodeAt(r);return n.node.type===(s==null?void 0:s.type)&&ci(t.doc,n.pos)&&t.join(n.pos),!0},ep=(t,e)=>{const n=ly(o=>o.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const s=t.doc.nodeAt(r);return n.node.type===(s==null?void 0:s.type)&&ci(t.doc,r)&&t.join(r),!0},W3=(t,e,n,r={})=>({editor:s,tr:i,state:o,dispatch:a,chain:l,commands:c,can:u})=>{const{extensions:d,splittableMarks:h}=s.extensionManager,f=Pt(t,o.schema),p=Pt(e,o.schema),{selection:g,storedMarks:y}=o,{$from:m,$to:v}=g,w=m.blockRange(v),S=y||g.$to.parentOffset&&g.$from.marks();if(!w)return!1;const T=ly(E=>qw(E.type.name,d))(g);if(w.depth>=1&&T&&w.depth-T.depth<=1){if(T.node.type===f)return c.liftListItem(p);if(qw(T.node.type.name,d)&&f.validContent(T.node.content)&&a)return l().command(()=>(i.setNodeMarkup(T.pos,f),!0)).command(()=>Zf(i,f)).command(()=>ep(i,f)).run()}return!n||!S||!a?l().command(()=>u().wrapInList(f,r)?!0:c.clearNodes()).wrapInList(f,r).command(()=>Zf(i,f)).command(()=>ep(i,f)).run():l().command(()=>{const E=u().wrapInList(f,r),O=S.filter(b=>h.includes(b.type.name));return i.ensureMarks(O),E?!0:c.clearNodes()}).wrapInList(f,r).command(()=>Zf(i,f)).command(()=>ep(i,f)).run()},K3=(t,e={},n={})=>({state:r,commands:s})=>{const{extendEmptyMarkRange:i=!1}=n,o=di(t,r.schema);return Xm(r,o,e)?s.unsetMark(o,{extendEmptyMarkRange:i}):s.setMark(o,e)},q3=(t,e,n={})=>({state:r,commands:s})=>{const i=Pt(t,r.schema),o=Pt(e,r.schema),a=rc(r,i,n);let l;return r.selection.$anchor.sameParent(r.selection.$head)&&(l=r.selection.$anchor.parent.attrs),a?s.setNode(o,l):s.setNode(i,{...l,...n})},G3=(t,e={})=>({state:n,commands:r})=>{const s=Pt(t,n.schema);return rc(n,s,e)?r.lift(s):r.wrapIn(s,e)},J3=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let r=0;r<n.length;r+=1){const s=n[r];let i;if(s.spec.isInputRules&&(i=s.getState(t))){if(e){const o=t.tr,a=i.transform;for(let l=a.steps.length-1;l>=0;l-=1)o.step(a.steps[l].invert(a.docs[l]));if(i.text){const l=o.doc.resolve(i.from).marks();o.replaceWith(i.from,i.to,t.schema.text(i.text,l))}else o.delete(i.from,i.to)}return!0}}return!1},Y3=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:r,ranges:s}=n;return r||e&&s.forEach(i=>{t.removeMark(i.$from.pos,i.$to.pos)}),!0},Q3=(t,e={})=>({tr:n,state:r,dispatch:s})=>{var i;const{extendEmptyMarkRange:o=!1}=e,{selection:a}=n,l=di(t,r.schema),{$from:c,empty:u,ranges:d}=a;if(!s)return!0;if(u&&o){let{from:h,to:f}=a;const p=(i=c.marks().find(y=>y.type===l))===null||i===void 0?void 0:i.attrs,g=oy(c,l,p);g&&(h=g.from,f=g.to),n.removeMark(h,f,l)}else d.forEach(h=>{n.removeMark(h.$from.pos,h.$to.pos,l)});return n.removeStoredMark(l),!0},X3=(t,e={})=>({tr:n,state:r,dispatch:s})=>{let i=null,o=null;const a=Kh(typeof t=="string"?t:t.name,r.schema);return a?(a==="node"&&(i=Pt(t,r.schema)),a==="mark"&&(o=di(t,r.schema)),s&&n.selection.ranges.forEach(l=>{const c=l.$from.pos,u=l.$to.pos;let d,h,f,p;n.selection.empty?r.doc.nodesBetween(c,u,(g,y)=>{i&&i===g.type&&(f=Math.max(y,c),p=Math.min(y+g.nodeSize,u),d=y,h=g)}):r.doc.nodesBetween(c,u,(g,y)=>{y<c&&i&&i===g.type&&(f=Math.max(y,c),p=Math.min(y+g.nodeSize,u),d=y,h=g),y>=c&&y<=u&&(i&&i===g.type&&n.setNodeMarkup(y,void 0,{...g.attrs,...e}),o&&g.marks.length&&g.marks.forEach(m=>{if(o===m.type){const v=Math.max(y,c),w=Math.min(y+g.nodeSize,u);n.addMark(v,w,o.create({...m.attrs,...e}))}}))}),h&&(d!==void 0&&n.setNodeMarkup(d,void 0,{...h.attrs,...e}),o&&h.marks.length&&h.marks.forEach(g=>{o===g.type&&n.addMark(f,p,o.create({...g.attrs,...e}))}))}),!0):!1},Z3=(t,e={})=>({state:n,dispatch:r})=>{const s=Pt(t,n.schema);return dL(s,e)(n,r)},e4=(t,e={})=>({state:n,dispatch:r})=>{const s=Pt(t,n.schema);return hL(s,e)(n,r)};var t4=Object.freeze({__proto__:null,blur:DL,clearContent:jL,clearNodes:LL,command:$L,createParagraphNear:FL,cut:BL,deleteCurrentNode:UL,deleteNode:zL,deleteRange:VL,deleteSelection:HL,enter:WL,exitCode:KL,extendMarkRange:qL,first:GL,focus:YL,forEach:QL,insertContent:XL,insertContentAt:t3,joinBackward:s3,joinDown:r3,joinForward:i3,joinItemBackward:o3,joinItemForward:a3,joinTextblockBackward:l3,joinTextblockForward:c3,joinUp:n3,keyboardShortcut:d3,lift:h3,liftEmptyBlock:f3,liftListItem:p3,newlineInCode:m3,resetAttributes:g3,scrollIntoView:y3,selectAll:v3,selectNodeBackward:w3,selectNodeForward:x3,selectParentNode:b3,selectTextblockEnd:k3,selectTextblockStart:S3,setContent:E3,setMark:L3,setMeta:$3,setNode:F3,setNodeSelection:B3,setTextSelection:U3,sinkListItem:z3,splitBlock:V3,splitListItem:H3,toggleList:W3,toggleMark:K3,toggleNode:q3,toggleWrap:G3,undoInputRule:J3,unsetAllMarks:Y3,unsetMark:Q3,updateAttributes:X3,wrapIn:Z3,wrapInList:e4});const n4=Zt.create({name:"commands",addCommands(){return{...t4}}}),r4=Zt.create({name:"drop",addProseMirrorPlugins(){return[new Mt({key:new En("tiptapDrop"),props:{handleDrop:(t,e,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:r})}}})]}}),s4=Zt.create({name:"editable",addProseMirrorPlugins(){return[new Mt({key:new En("editable"),props:{editable:()=>this.editor.options.editable}})]}}),i4=new En("focusEvents"),o4=Zt.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new Mt({key:i4,props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),a4=Zt.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:u,$anchor:d}=l,{pos:h,parent:f}=d,p=d.parent.isTextblock&&h>0?a.doc.resolve(h-1):d,g=p.parent.type.spec.isolating,y=d.pos-d.parentOffset,m=g&&p.parent.childCount===1?y===d.pos:Pe.atStart(c).from===h;return!u||!f.type.isTextblock||f.textContent.length||!m||m&&d.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},s={...r},i={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return ay()||DT()?i:s},addProseMirrorPlugins(){return[new Mt({key:new En("clearDocument"),appendTransaction:(t,e,n)=>{if(t.some(g=>g.getMeta("composition")))return;const r=t.some(g=>g.docChanged)&&!e.doc.eq(n.doc),s=t.some(g=>g.getMeta("preventClearDocument"));if(!r||s)return;const{empty:i,from:o,to:a}=e.selection,l=Pe.atStart(e.doc).from,c=Pe.atEnd(e.doc).to;if(i||!(o===l&&a===c)||!uy(n.doc))return;const h=n.tr,f=Uh({state:n,transaction:h}),{commands:p}=new zh({editor:this.editor,state:f});if(p.clearNodes(),!!h.steps.length)return h}})]}}),l4=Zt.create({name:"paste",addProseMirrorPlugins(){return[new Mt({key:new En("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),c4=Zt.create({name:"tabindex",addProseMirrorPlugins(){return[new Mt({key:new En("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class Si{get name(){return this.node.type.name}constructor(e,n,r=!1,s=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=n,this.currentNode=s}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let n=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:n,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new Si(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Si(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Si(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,r)=>{const s=n.isBlock&&!n.isTextblock,i=n.isAtom&&!n.isText,o=this.pos+r+(i?0:1);if(o<0||o>this.resolvedPos.doc.nodeSize-2)return;const a=this.resolvedPos.doc.resolve(o);if(!s&&a.depth<=this.depth)return;const l=new Si(a,this.editor,s,s?n:null);s&&(l.actualDepth=this.depth+1),e.push(new Si(a,this.editor,s,s?n:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,n={}){let r=null,s=this.parent;for(;s&&!r;){if(s.node.type.name===e)if(Object.keys(n).length>0){const i=s.node.attrs,o=Object.keys(n);for(let a=0;a<o.length;a+=1){const l=o[a];if(i[l]!==n[l])break}}else r=s;s=s.parent}return r}querySelector(e,n={}){return this.querySelectorAll(e,n,!0)[0]||null}querySelectorAll(e,n={},r=!1){let s=[];if(!this.children||this.children.length===0)return s;const i=Object.keys(n);return this.children.forEach(o=>{r&&s.length>0||(o.node.type.name===e&&i.every(l=>n[l]===o.node.attrs[l])&&s.push(o),!(r&&s.length>0)&&(s=s.concat(o.querySelectorAll(e,n,r))))}),s}setAttribute(e){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(n)}}const u4=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function d4(t,e,n){const r=document.querySelector(`style[data-tiptap-style${n?`-${n}`:""}]`);if(r!==null)return r;const s=document.createElement("style");return e&&s.setAttribute("nonce",e),s.setAttribute(`data-tiptap-style${n?`-${n}`:""}`,""),s.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(s),s}let h4=class extends wL{constructor(e={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:r,moved:s})=>this.options.onDrop(n,r,s)),this.on("paste",({event:n,slice:r})=>this.options.onPaste(n,r)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=d4(u4,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,n=!0){this.setOptions({editable:e}),n&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,n){const r=AT(n)?n(e,[...this.state.plugins]):[...this.state.plugins,e],s=this.state.reconfigure({plugins:r});return this.view.updateState(s),s}unregisterPlugin(e){if(this.isDestroyed)return;const n=this.state.plugins;let r=n;if([].concat(e).forEach(i=>{const o=typeof i=="string"?`${i}$`:i.key;r=r.filter(a=>!a.key.startsWith(o))}),n.length===r.length)return;const s=this.state.reconfigure({plugins:r});return this.view.updateState(s),s}createExtensionManager(){var e,n;const s=[...this.options.enableCoreExtensions?[s4,ML.configure({blockSeparator:(n=(e=this.options.coreExtensionOptions)===null||e===void 0?void 0:e.clipboardTextSerializer)===null||n===void 0?void 0:n.blockSeparator}),n4,o4,a4,c4,r4,l4].filter(i=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[i.name]!==!1:!0):[],...this.options.extensions].filter(i=>["extension","node","mark"].includes(i==null?void 0:i.type));this.extensionManager=new $o(s,this)}createCommandManager(){this.commandManager=new zh({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let n;try{n=Qm(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(o){if(!(o instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(o.message))throw o;this.emit("contentError",{editor:this,error:o,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(a=>a.name!=="collaboration"),this.createExtensionManager()}}),n=Qm(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const r=PT(n,this.options.autofocus);this.view=new wT(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)===null||e===void 0?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:Lo.create({doc:n,selection:r||void 0})});const s=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(s),this.createNodeViews(),this.prependClass();const i=this.view.dom;i.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(o=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(o)});return}const n=this.state.apply(e),r=!this.state.selection.eq(n.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:n}),this.view.updateState(n),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const s=e.getMeta("focus"),i=e.getMeta("blur");s&&this.emit("focus",{editor:this,event:s.event,transaction:e}),i&&this.emit("blur",{editor:this,event:i.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return LT(this.state,e)}isActive(e,n){const r=typeof e=="string"?e:null,s=typeof e=="string"?n:e;return M3(this.state,r,s)}getJSON(){return this.state.doc.toJSON()}getHTML(){return sy(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:n=`

`,textSerializers:r={}}=e||{};return O3(this.state.doc,{blockSeparator:n,textSerializers:{...RT(this.schema),...r}})}get isEmpty(){return uy(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(e,n))||null}$nodes(e,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(e,n))||null}$pos(e){const n=this.state.doc.resolve(e);return new Si(n,this)}get $doc(){return this.$pos(0)}};function ha(t){return new Hh({find:t.find,handler:({state:e,range:n,match:r})=>{const s=De(t.getAttributes,void 0,r);if(s===!1||s===null)return null;const{tr:i}=e,o=r[r.length-1],a=r[0];if(o){const l=a.search(/\S/),c=n.from+a.indexOf(o),u=c+o.length;if(cy(n.from,n.to,e.doc).filter(f=>f.mark.type.excluded.find(g=>g===t.type&&g!==f.mark.type)).filter(f=>f.to>c).length)return null;u<n.to&&i.delete(u,n.to),c>n.from&&i.delete(n.from+l,c);const h=n.from+l+o.length;i.addMark(n.from+l,h,t.type.create(s||{})),i.removeStoredMark(t.type)}}})}function f4(t){return new Hh({find:t.find,handler:({state:e,range:n,match:r})=>{const s=De(t.getAttributes,void 0,r)||{},{tr:i}=e,o=n.from;let a=n.to;const l=t.type.create(s);if(r[1]){const c=r[0].lastIndexOf(r[1]);let u=o+c;u>a?u=a:a=u+r[1].length;const d=r[0][r[0].length-1];i.insertText(d,o+r[0].length-1),i.replaceWith(u,a,l)}else if(r[0]){const c=t.type.isInline?o:o-1;i.insert(c,t.type.create(s)).delete(i.mapping.map(o),i.mapping.map(a))}i.scrollIntoView()}})}function Zm(t){return new Hh({find:t.find,handler:({state:e,range:n,match:r})=>{const s=e.doc.resolve(n.from),i=De(t.getAttributes,void 0,r)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,i)}})}function fa(t){return new Hh({find:t.find,handler:({state:e,range:n,match:r,chain:s})=>{const i=De(t.getAttributes,void 0,r)||{},o=e.tr.delete(n.from,n.to),l=o.doc.resolve(n.from).blockRange(),c=l&&W0(l,t.type,i);if(!c)return null;if(o.wrap(l,c),t.keepMarks&&t.editor){const{selection:d,storedMarks:h}=e,{splittableMarks:f}=t.editor.extensionManager,p=h||d.$to.parentOffset&&d.$from.marks();if(p){const g=p.filter(y=>f.includes(y.type.name));o.ensureMarks(g)}}if(t.keepAttributes){const d=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(d,i).run()}const u=o.doc.resolve(n.from-1).nodeBefore;u&&u.type===t.type&&ci(o.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(r,u))&&o.join(n.from-1)}})}class en{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=De(pe(this,"addOptions",{name:this.name}))),this.storage=De(pe(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new en(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>Wh(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new en(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=De(pe(n,"addOptions",{name:n.name})),n.storage=De(pe(n,"addStorage",{name:n.name,options:n.options})),n}}function eo(t){return new AL({find:t.find,handler:({state:e,range:n,match:r,pasteEvent:s})=>{const i=De(t.getAttributes,void 0,r,s);if(i===!1||i===null)return null;const{tr:o}=e,a=r[r.length-1],l=r[0];let c=n.to;if(a){const u=l.search(/\S/),d=n.from+l.indexOf(a),h=d+a.length;if(cy(n.from,n.to,e.doc).filter(p=>p.mark.type.excluded.find(y=>y===t.type&&y!==p.mark.type)).filter(p=>p.to>d).length)return null;h<n.to&&o.delete(h,n.to),d>n.from&&o.delete(n.from+u,d),c=n.from+u+a.length,o.addMark(n.from+u,c,t.type.create(i||{})),o.removeStoredMark(t.type)}}})}function p4(t,e){const{selection:n}=t,{$from:r}=n;if(n instanceof xe){const i=r.index();return r.parent.canReplaceWith(i,i+1,e)}let s=r.depth;for(;s>=0;){const i=r.index(s);if(r.node(s).contentMatchAt(i).matchType(e))return!0;s-=1}return!1}const m4=(...t)=>e=>{t.forEach(n=>{typeof n=="function"?n(e):n&&(n.current=e)})},g4=({renderers:t})=>on.createElement(on.Fragment,null,Object.entries(t).map(([e,n])=>aR.createPortal(n.reactElement,n.element,e)));class y4 extends on.Component{constructor(e){super(e),this.editorContentRef=on.createRef(),this.initialized=!1,this.state={renderers:{}}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const{editor:e}=this.props;if(e&&e.options.element){if(e.contentComponent)return;const n=this.editorContentRef.current;n.append(...e.options.element.childNodes),e.setOptions({element:n}),e.contentComponent=this,e.createNodeViews(),this.initialized=!0}}maybeFlushSync(e){this.initialized?E0.flushSync(e):e()}setRenderer(e,n){this.maybeFlushSync(()=>{this.setState(({renderers:r})=>({renderers:{...r,[e]:n}}))})}removeRenderer(e){this.maybeFlushSync(()=>{this.setState(({renderers:n})=>{const r={...n};return delete r[e],{renderers:r}})})}componentWillUnmount(){const{editor:e}=this.props;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),e.contentComponent=null,!e.options.element.firstChild))return;const n=document.createElement("div");n.append(...e.options.element.childNodes),e.setOptions({element:n})}render(){const{editor:e,innerRef:n,...r}=this.props;return on.createElement(on.Fragment,null,on.createElement("div",{ref:m4(n,this.editorContentRef),...r}),on.createElement(g4,{renderers:this.state.renderers}))}}const v4=A.forwardRef((t,e)=>{const n=on.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return on.createElement(y4,{key:n,innerRef:e,...t})}),w4=on.memo(v4);class x4 extends h4{constructor(){super(...arguments),this.contentComponent=null}}const b4=(t={},e=[])=>{const n=A.useRef(null),[,r]=A.useState({}),{onBeforeCreate:s,onBlur:i,onCreate:o,onDestroy:a,onFocus:l,onSelectionUpdate:c,onTransaction:u,onUpdate:d}=t,h=A.useRef(s),f=A.useRef(i),p=A.useRef(o),g=A.useRef(a),y=A.useRef(l),m=A.useRef(c),v=A.useRef(u),w=A.useRef(d);return A.useEffect(()=>{n.current&&(s&&(n.current.off("beforeCreate",h.current),n.current.on("beforeCreate",s),h.current=s),i&&(n.current.off("blur",f.current),n.current.on("blur",i),f.current=i),o&&(n.current.off("create",p.current),n.current.on("create",o),p.current=o),a&&(n.current.off("destroy",g.current),n.current.on("destroy",a),g.current=a),l&&(n.current.off("focus",y.current),n.current.on("focus",l),y.current=l),c&&(n.current.off("selectionUpdate",m.current),n.current.on("selectionUpdate",c),m.current=c),u&&(n.current.off("transaction",v.current),n.current.on("transaction",u),v.current=u),d&&(n.current.off("update",w.current),n.current.on("update",d),w.current=d))},[s,i,o,a,l,c,u,d,n.current]),A.useEffect(()=>{let S=!0;return n.current=new x4(t),n.current.on("transaction",()=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{S&&r({})})})}),()=>{S=!1}},e),A.useEffect(()=>()=>{var S;return(S=n.current)===null||S===void 0?void 0:S.destroy()},[]),n.current},k4=A.createContext({editor:null});k4.Consumer;const S4=A.createContext({onDragStart:void 0}),E4=()=>A.useContext(S4);on.forwardRef((t,e)=>{const{onDragStart:n}=E4(),r=t.as||"div";return on.createElement(r,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...t.style}})});const C4=/^\s*>\s$/,T4=en.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return["blockquote",St(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[fa({find:C4,type:this.type})]}}),_4=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,A4=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,O4=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,R4=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,N4=fs.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return["strong",St(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[ha({find:_4,type:this.type}),ha({find:O4,type:this.type})]},addPasteRules(){return[eo({find:A4,type:this.type}),eo({find:R4,type:this.type})]}}),I4="listItem",Jw="textStyle",Yw=/^\s*([-+*])\s$/,P4=en.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",St(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(I4,this.editor.getAttributes(Jw)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=fa({find:Yw,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=fa({find:Yw,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Jw),editor:this.editor})),[t]}}),M4=/(^|[^`])`([^`]+)`(?!`)/,D4=/(^|[^`])`([^`]+)`(?!`)/g,j4=fs.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",St(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[ha({find:M4,type:this.type})]},addPasteRules(){return[eo({find:D4,type:this.type})]}}),L4=/^```([a-z]+)?[\s\n]$/,$4=/^~~~([a-z]+)?[\s\n]$/,F4=en.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options,i=[...((e=t.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(o=>o.startsWith(n)).map(o=>o.replace(n,""))[0];return i||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",St(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!t||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:r,empty:s}=n;if(!s||r.parent.type!==this.type)return!1;const i=r.parentOffset===r.parent.nodeSize-2,o=r.parent.textContent.endsWith(`

`);return!i||!o?!1:t.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:r}=e,{$from:s,empty:i}=n;if(!i||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;const a=s.after();return a===void 0?!1:r.nodeAt(a)?t.commands.command(({tr:c})=>(c.setSelection(Pe.near(r.resolve(a))),!0)):t.commands.exitCode()}}},addInputRules(){return[Zm({find:L4,type:this.type,getAttributes:t=>({language:t[1]})}),Zm({find:$4,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new Mt({key:new En("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),s=r?JSON.parse(r):void 0,i=s==null?void 0:s.mode;if(!n||!i)return!1;const{tr:o,schema:a}=t.state,l=a.text(n.replace(/\r\n?/g,`
`));return o.replaceSelectionWith(this.type.create({language:i},l)),o.selection.$from.parent.type!==this.type&&o.setSelection(Ae.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),t.dispatch(o),!0}}})]}}),B4=en.create({name:"doc",topNode:!0,content:"block+"});function U4(t={}){return new Mt({view(e){return new z4(e,t)}})}class z4{constructor(e,n){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=n.width)!==null&&r!==void 0?r:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(s=>{let i=o=>{this[s](o)};return e.dom.addEventListener(s,i),{name:s,handler:i}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,r,s=this.editorView.dom,i=s.getBoundingClientRect(),o=i.width/s.offsetWidth,a=i.height/s.offsetHeight;if(n){let d=e.nodeBefore,h=e.nodeAfter;if(d||h){let f=this.editorView.nodeDOM(this.cursorPos-(d?d.nodeSize:0));if(f){let p=f.getBoundingClientRect(),g=d?p.bottom:p.top;d&&h&&(g=(g+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let y=this.width/2*a;r={left:p.left,right:p.right,top:g-y,bottom:g+y}}}}if(!r){let d=this.editorView.coordsAtPos(this.cursorPos),h=this.width/2*o;r={left:d.left-h,right:d.left+h,top:d.top,bottom:d.bottom}}let l=this.editorView.dom.offsetParent;this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let c,u;if(!l||l==document.body&&getComputedStyle(l).position=="static")c=-pageXOffset,u=-pageYOffset;else{let d=l.getBoundingClientRect(),h=d.width/l.offsetWidth,f=d.height/l.offsetHeight;c=d.left-l.scrollLeft*h,u=d.top-l.scrollTop*f}this.element.style.left=(r.left-c)/o+"px",this.element.style.top=(r.top-u)/a+"px",this.element.style.width=(r.right-r.left)/o+"px",this.element.style.height=(r.bottom-r.top)/a+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),s=r&&r.type.spec.disableDropCursor,i=typeof s=="function"?s(this.editorView,n,e):s;if(n&&!i){let o=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=NC(this.editorView.state.doc,o,this.editorView.dragging.slice);a!=null&&(o=a)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}const V4=Zt.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[U4(this.options)]}});class ht extends Pe{constructor(e){super(e,e)}map(e,n){let r=e.resolve(n.map(this.head));return ht.valid(r)?new ht(r):Pe.near(r)}content(){return ce.empty}eq(e){return e instanceof ht&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new ht(e.resolve(n.pos))}getBookmark(){return new dy(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!H4(e)||!W4(e))return!1;let r=n.type.spec.allowGapCursor;if(r!=null)return r;let s=n.contentMatchAt(e.index()).defaultType;return s&&s.isTextblock}static findGapCursorFrom(e,n,r=!1){e:for(;;){if(!r&&ht.valid(e))return e;let s=e.pos,i=null;for(let o=e.depth;;o--){let a=e.node(o);if(n>0?e.indexAfter(o)<a.childCount:e.index(o)>0){i=a.child(n>0?e.indexAfter(o):e.index(o)-1);break}else if(o==0)return null;s+=n;let l=e.doc.resolve(s);if(ht.valid(l))return l}for(;;){let o=n>0?i.firstChild:i.lastChild;if(!o){if(i.isAtom&&!i.isText&&!xe.isSelectable(i)){e=e.doc.resolve(s+i.nodeSize*n),r=!1;continue e}break}i=o,s+=n;let a=e.doc.resolve(s);if(ht.valid(a))return a}return null}}}ht.prototype.visible=!1;ht.findFrom=ht.findGapCursorFrom;Pe.jsonID("gapcursor",ht);class dy{constructor(e){this.pos=e}map(e){return new dy(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return ht.valid(n)?new ht(n):Pe.near(n)}}function $T(t){return t.isAtom||t.spec.isolating||t.spec.createGapCursor}function H4(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),r=t.node(e);if(n==0){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(n-1);;s=s.lastChild){if(s.childCount==0&&!s.inlineContent||$T(s.type))return!0;if(s.inlineContent)return!1}}return!0}function W4(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),r=t.node(e);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(n);;s=s.firstChild){if(s.childCount==0&&!s.inlineContent||$T(s.type))return!0;if(s.inlineContent)return!1}}return!0}function K4(){return new Mt({props:{decorations:Y4,createSelectionBetween(t,e,n){return e.pos==n.pos&&ht.valid(n)?new ht(n):null},handleClick:G4,handleKeyDown:q4,handleDOMEvents:{beforeinput:J4}}})}const q4=xT({ArrowLeft:su("horiz",-1),ArrowRight:su("horiz",1),ArrowUp:su("vert",-1),ArrowDown:su("vert",1)});function su(t,e){const n=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,s,i){let o=r.selection,a=e>0?o.$to:o.$from,l=o.empty;if(o instanceof Ae){if(!i.endOfTextblock(n)||a.depth==0)return!1;l=!1,a=r.doc.resolve(e>0?a.after():a.before())}let c=ht.findGapCursorFrom(a,e,l);return c?(s&&s(r.tr.setSelection(new ht(c))),!0):!1}}function G4(t,e,n){if(!t||!t.editable)return!1;let r=t.state.doc.resolve(e);if(!ht.valid(r))return!1;let s=t.posAtCoords({left:n.clientX,top:n.clientY});return s&&s.inside>-1&&xe.isSelectable(t.state.doc.nodeAt(s.inside))?!1:(t.dispatch(t.state.tr.setSelection(new ht(r))),!0)}function J4(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof ht))return!1;let{$from:n}=t.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;let s=ee.empty;for(let o=r.length-1;o>=0;o--)s=ee.from(r[o].createAndFill(null,s));let i=t.state.tr.replace(n.pos,n.pos,new ce(s,0,0));return i.setSelection(Ae.near(i.doc.resolve(n.pos+1))),t.dispatch(i),!1}function Y4(t){if(!(t.selection instanceof ht))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",gt.create(t.doc,[Ln.widget(t.selection.head,e,{key:"gapcursor"})])}const Q4=Zt.create({name:"gapCursor",addProseMirrorPlugins(){return[K4()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=De(pe(t,"allowGapCursor",n)))!==null&&e!==void 0?e:null}}}),X4=en.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",St(this.options.HTMLAttributes,t)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:r})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:s,storedMarks:i}=n;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:a}=r.extensionManager,l=i||s.$to.parentOffset&&s.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&l&&o){const d=l.filter(h=>a.includes(h.type.name));c.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Z4=en.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,St(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>Zm({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}});var Rd=200,It=function(){};It.prototype.append=function(e){return e.length?(e=It.from(e),!this.length&&e||e.length<Rd&&this.leafAppend(e)||this.length<Rd&&e.leafPrepend(this)||this.appendInner(e)):this};It.prototype.prepend=function(e){return e.length?It.from(e).append(this):this};It.prototype.appendInner=function(e){return new e$(this,e)};It.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?It.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};It.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};It.prototype.forEach=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length),n<=r?this.forEachInner(e,n,r,0):this.forEachInvertedInner(e,n,r,0)};It.prototype.map=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length);var s=[];return this.forEach(function(i,o){return s.push(e(i,o))},n,r),s};It.from=function(e){return e instanceof It?e:e&&e.length?new FT(e):It.empty};var FT=function(t){function e(r){t.call(this),this.values=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(s,i){return s==0&&i==this.length?this:new e(this.values.slice(s,i))},e.prototype.getInner=function(s){return this.values[s]},e.prototype.forEachInner=function(s,i,o,a){for(var l=i;l<o;l++)if(s(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(s,i,o,a){for(var l=i-1;l>=o;l--)if(s(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(s){if(this.length+s.length<=Rd)return new e(this.values.concat(s.flatten()))},e.prototype.leafPrepend=function(s){if(this.length+s.length<=Rd)return new e(s.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(It);It.empty=new FT([]);var e$=function(t){function e(n,r){t.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,s,i,o){var a=this.left.length;if(s<a&&this.left.forEachInner(r,s,Math.min(i,a),o)===!1||i>a&&this.right.forEachInner(r,Math.max(s-a,0),Math.min(this.length,i)-a,o+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,s,i,o){var a=this.left.length;if(s>a&&this.right.forEachInvertedInner(r,s-a,Math.max(i,a)-a,o+a)===!1||i<a&&this.left.forEachInvertedInner(r,Math.min(s,a),i,o)===!1)return!1},e.prototype.sliceInner=function(r,s){if(r==0&&s==this.length)return this;var i=this.left.length;return s<=i?this.left.slice(r,s):r>=i?this.right.slice(r-i,s-i):this.left.slice(r,i).append(this.right.slice(0,s-i))},e.prototype.leafAppend=function(r){var s=this.right.leafAppend(r);if(s)return new e(this.left,s)},e.prototype.leafPrepend=function(r){var s=this.left.leafPrepend(r);if(s)return new e(s,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(It);const t$=500;class br{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let s,i;n&&(s=this.remapping(r,this.items.length),i=s.maps.length);let o=e.tr,a,l,c=[],u=[];return this.items.forEach((d,h)=>{if(!d.step){s||(s=this.remapping(r,h+1),i=s.maps.length),i--,u.push(d);return}if(s){u.push(new Ar(d.map));let f=d.step.map(s.slice(i)),p;f&&o.maybeStep(f).doc&&(p=o.mapping.maps[o.mapping.maps.length-1],c.push(new Ar(p,void 0,void 0,c.length+u.length))),i--,p&&s.appendMap(p,i)}else o.maybeStep(d.step);if(d.selection)return a=s?d.selection.map(s.slice(i)):d.selection,l=new br(this.items.slice(0,r).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:o,selection:a}}addTransform(e,n,r,s){let i=[],o=this.eventCount,a=this.items,l=!s&&a.length?a.get(a.length-1):null;for(let u=0;u<e.steps.length;u++){let d=e.steps[u].invert(e.docs[u]),h=new Ar(e.mapping.maps[u],d,n),f;(f=l&&l.merge(h))&&(h=f,u?i.pop():a=a.slice(0,a.length-1)),i.push(h),n&&(o++,n=void 0),s||(l=h)}let c=o-r.depth;return c>r$&&(a=n$(a,c),o-=c),new br(a.append(i),o)}remapping(e,n){let r=new Ql;return this.items.forEach((s,i)=>{let o=s.mirrorOffset!=null&&i-s.mirrorOffset>=e?r.maps.length-s.mirrorOffset:void 0;r.appendMap(s.map,o)},e,n),r}addMaps(e){return this.eventCount==0?this:new br(this.items.append(e.map(n=>new Ar(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let r=[],s=Math.max(0,this.items.length-n),i=e.mapping,o=e.steps.length,a=this.eventCount;this.items.forEach(h=>{h.selection&&a--},s);let l=n;this.items.forEach(h=>{let f=i.getMirror(--l);if(f==null)return;o=Math.min(o,f);let p=i.maps[f];if(h.step){let g=e.steps[f].invert(e.docs[f]),y=h.selection&&h.selection.map(i.slice(l+1,f));y&&a++,r.push(new Ar(p,g,y))}else r.push(new Ar(p))},s);let c=[];for(let h=n;h<o;h++)c.push(new Ar(i.maps[h]));let u=this.items.slice(0,s).append(c).append(r),d=new br(u,a);return d.emptyItemCount()>t$&&(d=d.compress(this.items.length-r.length)),d}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),r=n.maps.length,s=[],i=0;return this.items.forEach((o,a)=>{if(a>=e)s.push(o),o.selection&&i++;else if(o.step){let l=o.step.map(n.slice(r)),c=l&&l.getMap();if(r--,c&&n.appendMap(c,r),l){let u=o.selection&&o.selection.map(n.slice(r));u&&i++;let d=new Ar(c.invert(),l,u),h,f=s.length-1;(h=s.length&&s[f].merge(d))?s[f]=h:s.push(d)}}else o.map&&r--},this.items.length,0),new br(It.from(s.reverse()),i)}}br.empty=new br(It.empty,0);function n$(t,e){let n;return t.forEach((r,s)=>{if(r.selection&&e--==0)return n=s,!1}),t.slice(n)}class Ar{constructor(e,n,r,s){this.map=e,this.step=n,this.selection=r,this.mirrorOffset=s}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new Ar(n.getMap().invert(),n,this.selection)}}}class _s{constructor(e,n,r,s,i){this.done=e,this.undone=n,this.prevRanges=r,this.prevTime=s,this.prevComposition=i}}const r$=20;function s$(t,e,n,r){let s=n.getMeta(zi),i;if(s)return s.historyState;n.getMeta(a$)&&(t=new _s(t.done,t.undone,null,0,-1));let o=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(o&&o.getMeta(zi))return o.getMeta(zi).redo?new _s(t.done.addTransform(n,void 0,r,Nu(e)),t.undone,Qw(n.mapping.maps),t.prevTime,t.prevComposition):new _s(t.done,t.undone.addTransform(n,void 0,r,Nu(e)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let a=n.getMeta("composition"),l=t.prevTime==0||!o&&t.prevComposition!=a&&(t.prevTime<(n.time||0)-r.newGroupDelay||!i$(n,t.prevRanges)),c=o?tp(t.prevRanges,n.mapping):Qw(n.mapping.maps);return new _s(t.done.addTransform(n,l?e.selection.getBookmark():void 0,r,Nu(e)),br.empty,c,n.time,a??t.prevComposition)}else return(i=n.getMeta("rebased"))?new _s(t.done.rebased(n,i),t.undone.rebased(n,i),tp(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new _s(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),tp(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function i$(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((r,s)=>{for(let i=0;i<e.length;i+=2)r<=e[i+1]&&s>=e[i]&&(n=!0)}),n}function Qw(t){let e=[];for(let n=t.length-1;n>=0&&e.length==0;n--)t[n].forEach((r,s,i,o)=>e.push(i,o));return e}function tp(t,e){if(!t)return null;let n=[];for(let r=0;r<t.length;r+=2){let s=e.map(t[r],1),i=e.map(t[r+1],-1);s<=i&&n.push(s,i)}return n}function o$(t,e,n){let r=Nu(e),s=zi.get(e).spec.config,i=(n?t.undone:t.done).popEvent(e,r);if(!i)return null;let o=i.selection.resolve(i.transform.doc),a=(n?t.done:t.undone).addTransform(i.transform,e.selection.getBookmark(),s,r),l=new _s(n?a:i.remaining,n?i.remaining:a,null,0,-1);return i.transform.setSelection(o).setMeta(zi,{redo:n,historyState:l})}let np=!1,Xw=null;function Nu(t){let e=t.plugins;if(Xw!=e){np=!1,Xw=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){np=!0;break}}return np}const zi=new En("history"),a$=new En("closeHistory");function l$(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new Mt({key:zi,state:{init(){return new _s(br.empty,br.empty,null,0,-1)},apply(e,n,r){return s$(n,r,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let r=n.inputType,s=r=="historyUndo"?UT:r=="historyRedo"?zT:null;return!s||!e.editable?!1:(n.preventDefault(),s(e.state,e.dispatch))}}}})}function BT(t,e){return(n,r)=>{let s=zi.getState(n);if(!s||(t?s.undone:s.done).eventCount==0)return!1;if(r){let i=o$(s,n,t);i&&r(e?i.scrollIntoView():i)}return!0}}const UT=BT(!1,!0),zT=BT(!0,!0),c$=Zt.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>UT(t,e),redo:()=>({state:t,dispatch:e})=>zT(t,e)}},addProseMirrorPlugins(){return[l$(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),u$=en.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",St(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{if(!p4(e,e.schema.nodes[this.name]))return!1;const{selection:n}=e,{$from:r,$to:s}=n,i=t();return r.parentOffset===0?i.insertContentAt({from:Math.max(r.pos-1,0),to:s.pos},{type:this.name}):D3(n)?i.insertContentAt(s.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({tr:o,dispatch:a})=>{var l;if(a){const{$to:c}=o.selection,u=c.end();if(c.nodeAfter)c.nodeAfter.isTextblock?o.setSelection(Ae.create(o.doc,c.pos+1)):c.nodeAfter.isBlock?o.setSelection(xe.create(o.doc,c.pos)):o.setSelection(Ae.create(o.doc,c.pos));else{const d=(l=c.parent.type.contentMatch.defaultType)===null||l===void 0?void 0:l.create();d&&(o.insert(u,d),o.setSelection(Ae.create(o.doc,u+1)))}o.scrollIntoView()}return!0}).run()}}},addInputRules(){return[f4({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),d$=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,h$=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,f$=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,p$=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,m$=fs.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",St(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[ha({find:d$,type:this.type}),ha({find:f$,type:this.type})]},addPasteRules(){return[eo({find:h$,type:this.type}),eo({find:p$,type:this.type})]}}),g$=en.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",St(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),y$="listItem",Zw="textStyle",ex=/^(\d+)\.\s$/,v$=en.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return e===1?["ol",St(this.options.HTMLAttributes,n),0]:["ol",St(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(y$,this.editor.getAttributes(Zw)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=fa({find:ex,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=fa({find:ex,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(Zw)}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1],editor:this.editor})),[t]}}),w$=en.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",St(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),x$=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,b$=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,k$=fs.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",St(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[ha({find:x$,type:this.type})]},addPasteRules(){return[eo({find:b$,type:this.type})]}}),S$=en.create({name:"text",group:"inline"}),E$=Zt.create({name:"starterKit",addExtensions(){var t,e,n,r,s,i,o,a,l,c,u,d,h,f,p,g,y,m;const v=[];return this.options.blockquote!==!1&&v.push(T4.configure((t=this.options)===null||t===void 0?void 0:t.blockquote)),this.options.bold!==!1&&v.push(N4.configure((e=this.options)===null||e===void 0?void 0:e.bold)),this.options.bulletList!==!1&&v.push(P4.configure((n=this.options)===null||n===void 0?void 0:n.bulletList)),this.options.code!==!1&&v.push(j4.configure((r=this.options)===null||r===void 0?void 0:r.code)),this.options.codeBlock!==!1&&v.push(F4.configure((s=this.options)===null||s===void 0?void 0:s.codeBlock)),this.options.document!==!1&&v.push(B4.configure((i=this.options)===null||i===void 0?void 0:i.document)),this.options.dropcursor!==!1&&v.push(V4.configure((o=this.options)===null||o===void 0?void 0:o.dropcursor)),this.options.gapcursor!==!1&&v.push(Q4.configure((a=this.options)===null||a===void 0?void 0:a.gapcursor)),this.options.hardBreak!==!1&&v.push(X4.configure((l=this.options)===null||l===void 0?void 0:l.hardBreak)),this.options.heading!==!1&&v.push(Z4.configure((c=this.options)===null||c===void 0?void 0:c.heading)),this.options.history!==!1&&v.push(c$.configure((u=this.options)===null||u===void 0?void 0:u.history)),this.options.horizontalRule!==!1&&v.push(u$.configure((d=this.options)===null||d===void 0?void 0:d.horizontalRule)),this.options.italic!==!1&&v.push(m$.configure((h=this.options)===null||h===void 0?void 0:h.italic)),this.options.listItem!==!1&&v.push(g$.configure((f=this.options)===null||f===void 0?void 0:f.listItem)),this.options.orderedList!==!1&&v.push(v$.configure((p=this.options)===null||p===void 0?void 0:p.orderedList)),this.options.paragraph!==!1&&v.push(w$.configure((g=this.options)===null||g===void 0?void 0:g.paragraph)),this.options.strike!==!1&&v.push(k$.configure((y=this.options)===null||y===void 0?void 0:y.strike)),this.options.text!==!1&&v.push(S$.configure((m=this.options)===null||m===void 0?void 0:m.text)),v}}),C$="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",T$="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",eg="numeric",tg="ascii",ng="alpha",dl="asciinumeric",Ga="alphanumeric",rg="domain",VT="emoji",_$="scheme",A$="slashscheme",rp="whitespace";function O$(t,e){return t in e||(e[t]=[]),e[t]}function Ii(t,e,n){e[eg]&&(e[dl]=!0,e[Ga]=!0),e[tg]&&(e[dl]=!0,e[ng]=!0),e[dl]&&(e[Ga]=!0),e[ng]&&(e[Ga]=!0),e[Ga]&&(e[rg]=!0),e[VT]&&(e[rg]=!0);for(const r in e){const s=O$(r,n);s.indexOf(t)<0&&s.push(t)}}function R$(t,e){const n={};for(const r in e)e[r].indexOf(t)>=0&&(n[r]=!0);return n}function gn(t=null){this.j={},this.jr=[],this.jd=null,this.t=t}gn.groups={};gn.prototype={accepts(){return!!this.t},go(t){const e=this,n=e.j[t];if(n)return n;for(let r=0;r<e.jr.length;r++){const s=e.jr[r][0],i=e.jr[r][1];if(i&&s.test(t))return i}return e.jd},has(t,e=!1){return e?t in this.j:!!this.go(t)},ta(t,e,n,r){for(let s=0;s<t.length;s++)this.tt(t[s],e,n,r)},tr(t,e,n,r){r=r||gn.groups;let s;return e&&e.j?s=e:(s=new gn(e),n&&r&&Ii(e,n,r)),this.jr.push([t,s]),s},ts(t,e,n,r){let s=this;const i=t.length;if(!i)return s;for(let o=0;o<i-1;o++)s=s.tt(t[o]);return s.tt(t[i-1],e,n,r)},tt(t,e,n,r){r=r||gn.groups;const s=this;if(e&&e.j)return s.j[t]=e,e;const i=e;let o,a=s.go(t);if(a?(o=new gn,Object.assign(o.j,a.j),o.jr.push.apply(o.jr,a.jr),o.jd=a.jd,o.t=a.t):o=new gn,i){if(r)if(o.t&&typeof o.t=="string"){const l=Object.assign(R$(o.t,r),n);Ii(i,l,r)}else n&&Ii(i,n,r);o.t=i}return s.j[t]=o,o}};const Ie=(t,e,n,r,s)=>t.ta(e,n,r,s),lt=(t,e,n,r,s)=>t.tr(e,n,r,s),tx=(t,e,n,r,s)=>t.ts(e,n,r,s),te=(t,e,n,r,s)=>t.tt(e,n,r,s),Gr="WORD",sg="UWORD",HT="ASCIINUMERICAL",WT="ALPHANUMERICAL",sc="LOCALHOST",ig="TLD",og="UTLD",Iu="SCHEME",ko="SLASH_SCHEME",hy="NUM",ag="WS",fy="NL",hl="OPENBRACE",fl="CLOSEBRACE",Nd="OPENBRACKET",Id="CLOSEBRACKET",Pd="OPENPAREN",Md="CLOSEPAREN",Dd="OPENANGLEBRACKET",jd="CLOSEANGLEBRACKET",Ld="FULLWIDTHLEFTPAREN",$d="FULLWIDTHRIGHTPAREN",Fd="LEFTCORNERBRACKET",Bd="RIGHTCORNERBRACKET",Ud="LEFTWHITECORNERBRACKET",zd="RIGHTWHITECORNERBRACKET",Vd="FULLWIDTHLESSTHAN",Hd="FULLWIDTHGREATERTHAN",Wd="AMPERSAND",Kd="APOSTROPHE",qd="ASTERISK",As="AT",Gd="BACKSLASH",Jd="BACKTICK",Yd="CARET",Ms="COLON",py="COMMA",Qd="DOLLAR",Or="DOT",Xd="EQUALS",my="EXCLAMATION",Kn="HYPHEN",pl="PERCENT",Zd="PIPE",eh="PLUS",th="POUND",ml="QUERY",gy="QUOTE",KT="FULLWIDTHMIDDLEDOT",yy="SEMI",Rr="SLASH",gl="TILDE",nh="UNDERSCORE",qT="EMOJI",rh="SYM";var GT=Object.freeze({__proto__:null,ALPHANUMERICAL:WT,AMPERSAND:Wd,APOSTROPHE:Kd,ASCIINUMERICAL:HT,ASTERISK:qd,AT:As,BACKSLASH:Gd,BACKTICK:Jd,CARET:Yd,CLOSEANGLEBRACKET:jd,CLOSEBRACE:fl,CLOSEBRACKET:Id,CLOSEPAREN:Md,COLON:Ms,COMMA:py,DOLLAR:Qd,DOT:Or,EMOJI:qT,EQUALS:Xd,EXCLAMATION:my,FULLWIDTHGREATERTHAN:Hd,FULLWIDTHLEFTPAREN:Ld,FULLWIDTHLESSTHAN:Vd,FULLWIDTHMIDDLEDOT:KT,FULLWIDTHRIGHTPAREN:$d,HYPHEN:Kn,LEFTCORNERBRACKET:Fd,LEFTWHITECORNERBRACKET:Ud,LOCALHOST:sc,NL:fy,NUM:hy,OPENANGLEBRACKET:Dd,OPENBRACE:hl,OPENBRACKET:Nd,OPENPAREN:Pd,PERCENT:pl,PIPE:Zd,PLUS:eh,POUND:th,QUERY:ml,QUOTE:gy,RIGHTCORNERBRACKET:Bd,RIGHTWHITECORNERBRACKET:zd,SCHEME:Iu,SEMI:yy,SLASH:Rr,SLASH_SCHEME:ko,SYM:rh,TILDE:gl,TLD:ig,UNDERSCORE:nh,UTLD:og,UWORD:sg,WORD:Gr,WS:ag});const Kr=/[a-z]/,La=/\p{L}/u,sp=/\p{Emoji}/u,qr=/\d/,ip=/\s/,nx="\r",op=`
`,N$="",I$="",ap="";let iu=null,ou=null;function P$(t=[]){const e={};gn.groups=e;const n=new gn;iu==null&&(iu=rx(C$)),ou==null&&(ou=rx(T$)),te(n,"'",Kd),te(n,"{",hl),te(n,"}",fl),te(n,"[",Nd),te(n,"]",Id),te(n,"(",Pd),te(n,")",Md),te(n,"<",Dd),te(n,">",jd),te(n,"",Ld),te(n,"",$d),te(n,"",Fd),te(n,"",Bd),te(n,"",Ud),te(n,"",zd),te(n,"",Vd),te(n,"",Hd),te(n,"&",Wd),te(n,"*",qd),te(n,"@",As),te(n,"`",Jd),te(n,"^",Yd),te(n,":",Ms),te(n,",",py),te(n,"$",Qd),te(n,".",Or),te(n,"=",Xd),te(n,"!",my),te(n,"-",Kn),te(n,"%",pl),te(n,"|",Zd),te(n,"+",eh),te(n,"#",th),te(n,"?",ml),te(n,'"',gy),te(n,"/",Rr),te(n,";",yy),te(n,"~",gl),te(n,"_",nh),te(n,"\\",Gd),te(n,"",KT);const r=lt(n,qr,hy,{[eg]:!0});lt(r,qr,r);const s=lt(r,Kr,HT,{[dl]:!0}),i=lt(r,La,WT,{[Ga]:!0}),o=lt(n,Kr,Gr,{[tg]:!0});lt(o,qr,s),lt(o,Kr,o),lt(s,qr,s),lt(s,Kr,s);const a=lt(n,La,sg,{[ng]:!0});lt(a,Kr),lt(a,qr,i),lt(a,La,a),lt(i,qr,i),lt(i,Kr),lt(i,La,i);const l=te(n,op,fy,{[rp]:!0}),c=te(n,nx,ag,{[rp]:!0}),u=lt(n,ip,ag,{[rp]:!0});te(n,ap,u),te(c,op,l),te(c,ap,u),lt(c,ip,u),te(u,nx),te(u,op),lt(u,ip,u),te(u,ap,u);const d=lt(n,sp,qT,{[VT]:!0});te(d,"#"),lt(d,sp,d),te(d,N$,d);const h=te(d,I$);te(h,"#"),lt(h,sp,d);const f=[[Kr,o],[qr,s]],p=[[Kr,null],[La,a],[qr,i]];for(let g=0;g<iu.length;g++)xs(n,iu[g],ig,Gr,f);for(let g=0;g<ou.length;g++)xs(n,ou[g],og,sg,p);Ii(ig,{tld:!0,ascii:!0},e),Ii(og,{utld:!0,alpha:!0},e),xs(n,"file",Iu,Gr,f),xs(n,"mailto",Iu,Gr,f),xs(n,"http",ko,Gr,f),xs(n,"https",ko,Gr,f),xs(n,"ftp",ko,Gr,f),xs(n,"ftps",ko,Gr,f),Ii(Iu,{scheme:!0,ascii:!0},e),Ii(ko,{slashscheme:!0,ascii:!0},e),t=t.sort((g,y)=>g[0]>y[0]?1:-1);for(let g=0;g<t.length;g++){const y=t[g][0],v=t[g][1]?{[_$]:!0}:{[A$]:!0};y.indexOf("-")>=0?v[rg]=!0:Kr.test(y)?qr.test(y)?v[dl]=!0:v[tg]=!0:v[eg]=!0,tx(n,y,y,v)}return tx(n,"localhost",sc,{ascii:!0}),n.jd=new gn(rh),{start:n,tokens:Object.assign({groups:e},GT)}}function JT(t,e){const n=M$(e.replace(/[A-Z]/g,a=>a.toLowerCase())),r=n.length,s=[];let i=0,o=0;for(;o<r;){let a=t,l=null,c=0,u=null,d=-1,h=-1;for(;o<r&&(l=a.go(n[o]));)a=l,a.accepts()?(d=0,h=0,u=a):d>=0&&(d+=n[o].length,h++),c+=n[o].length,i+=n[o].length,o++;i-=d,o-=h,c-=d,s.push({t:u.t,v:e.slice(i-c,i),s:i-c,e:i})}return s}function M$(t){const e=[],n=t.length;let r=0;for(;r<n;){let s=t.charCodeAt(r),i,o=s<55296||s>56319||r+1===n||(i=t.charCodeAt(r+1))<56320||i>57343?t[r]:t.slice(r,r+2);e.push(o),r+=o.length}return e}function xs(t,e,n,r,s){let i;const o=e.length;for(let a=0;a<o-1;a++){const l=e[a];t.j[l]?i=t.j[l]:(i=new gn(r),i.jr=s.slice(),t.j[l]=i),t=i}return i=new gn(n),i.jr=s.slice(),t.j[e[o-1]]=i,i}function rx(t){const e=[],n=[];let r=0,s="0123456789";for(;r<t.length;){let i=0;for(;s.indexOf(t[r+i])>=0;)i++;if(i>0){e.push(n.join(""));for(let o=parseInt(t.substring(r,r+i),10);o>0;o--)n.pop();r+=i}else n.push(t[r]),r++}return e}const ic={defaultProtocol:"http",events:null,format:sx,formatHref:sx,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function vy(t,e=null){let n=Object.assign({},ic);t&&(n=Object.assign(n,t instanceof vy?t.o:t));const r=n.ignoreTags,s=[];for(let i=0;i<r.length;i++)s.push(r[i].toUpperCase());this.o=n,e&&(this.defaultRender=e),this.ignoreTags=s}vy.prototype={o:ic,ignoreTags:[],defaultRender(t){return t},check(t){return this.get("validate",t.toString(),t)},get(t,e,n){const r=e!=null;let s=this.o[t];return s&&(typeof s=="object"?(s=n.t in s?s[n.t]:ic[t],typeof s=="function"&&r&&(s=s(e,n))):typeof s=="function"&&r&&(s=s(e,n.t,n)),s)},getObj(t,e,n){let r=this.o[t];return typeof r=="function"&&e!=null&&(r=r(e,n.t,n)),r},render(t){const e=t.render(this);return(this.get("render",null,t)||this.defaultRender)(e,t.t,t)}};function sx(t){return t}function YT(t,e){this.t="token",this.v=t,this.tk=e}YT.prototype={isLink:!1,toString(){return this.v},toHref(t){return this.toString()},toFormattedString(t){const e=this.toString(),n=t.get("truncate",e,this),r=t.get("format",e,this);return n&&r.length>n?r.substring(0,n)+"":r},toFormattedHref(t){return t.get("formatHref",this.toHref(t.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(t=ic.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(t),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(t){return{type:this.t,value:this.toFormattedString(t),isLink:this.isLink,href:this.toFormattedHref(t),start:this.startIndex(),end:this.endIndex()}},validate(t){return t.get("validate",this.toString(),this)},render(t){const e=this,n=this.toHref(t.get("defaultProtocol")),r=t.get("formatHref",n,this),s=t.get("tagName",n,e),i=this.toFormattedString(t),o={},a=t.get("className",n,e),l=t.get("target",n,e),c=t.get("rel",n,e),u=t.getObj("attributes",n,e),d=t.getObj("events",n,e);return o.href=r,a&&(o.class=a),l&&(o.target=l),c&&(o.rel=c),u&&Object.assign(o,u),{tagName:s,attributes:o,content:i,eventListeners:d}}};function qh(t,e){class n extends YT{constructor(s,i){super(s,i),this.t=t}}for(const r in e)n.prototype[r]=e[r];return n.t=t,n}const ix=qh("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),ox=qh("text"),D$=qh("nl"),au=qh("url",{isLink:!0,toHref(t=ic.defaultProtocol){return this.hasProtocol()?this.v:`${t}://${this.v}`},hasProtocol(){const t=this.tk;return t.length>=2&&t[0].t!==sc&&t[1].t===Ms}}),Wn=t=>new gn(t);function j$({groups:t}){const e=t.domain.concat([Wd,qd,As,Gd,Jd,Yd,Qd,Xd,Kn,hy,pl,Zd,eh,th,Rr,rh,gl,nh]),n=[Kd,Ms,py,Or,my,pl,ml,gy,yy,Dd,jd,hl,fl,Id,Nd,Pd,Md,Ld,$d,Fd,Bd,Ud,zd,Vd,Hd],r=[Wd,Kd,qd,Gd,Jd,Yd,Qd,Xd,Kn,hl,fl,pl,Zd,eh,th,ml,Rr,rh,gl,nh],s=Wn(),i=te(s,gl);Ie(i,r,i),Ie(i,t.domain,i);const o=Wn(),a=Wn(),l=Wn();Ie(s,t.domain,o),Ie(s,t.scheme,a),Ie(s,t.slashscheme,l),Ie(o,r,i),Ie(o,t.domain,o);const c=te(o,As);te(i,As,c),te(a,As,c),te(l,As,c);const u=te(i,Or);Ie(u,r,i),Ie(u,t.domain,i);const d=Wn();Ie(c,t.domain,d),Ie(d,t.domain,d);const h=te(d,Or);Ie(h,t.domain,d);const f=Wn(ix);Ie(h,t.tld,f),Ie(h,t.utld,f),te(c,sc,f);const p=te(d,Kn);te(p,Kn,p),Ie(p,t.domain,d),Ie(f,t.domain,d),te(f,Or,h),te(f,Kn,p);const g=te(f,Ms);Ie(g,t.numeric,ix);const y=te(o,Kn),m=te(o,Or);te(y,Kn,y),Ie(y,t.domain,o),Ie(m,r,i),Ie(m,t.domain,o);const v=Wn(au);Ie(m,t.tld,v),Ie(m,t.utld,v),Ie(v,t.domain,o),Ie(v,r,i),te(v,Or,m),te(v,Kn,y),te(v,As,c);const w=te(v,Ms),S=Wn(au);Ie(w,t.numeric,S);const T=Wn(au),E=Wn();Ie(T,e,T),Ie(T,n,E),Ie(E,e,T),Ie(E,n,E),te(v,Rr,T),te(S,Rr,T);const O=te(a,Ms),b=te(l,Ms),k=te(b,Rr),N=te(k,Rr);Ie(a,t.domain,o),te(a,Or,m),te(a,Kn,y),Ie(l,t.domain,o),te(l,Or,m),te(l,Kn,y),Ie(O,t.domain,T),te(O,Rr,T),te(O,ml,T),Ie(N,t.domain,T),Ie(N,e,T),te(N,Rr,T);const M=[[hl,fl],[Nd,Id],[Pd,Md],[Dd,jd],[Ld,$d],[Fd,Bd],[Ud,zd],[Vd,Hd]];for(let L=0;L<M.length;L++){const[$,P]=M[L],U=te(T,$);te(E,$,U),te(U,P,T);const R=Wn(au);Ie(U,e,R);const C=Wn();Ie(U,n),Ie(R,e,R),Ie(R,n,C),Ie(C,e,R),Ie(C,n,C),te(R,P,T),te(C,P,T)}return te(s,sc,v),te(s,fy,D$),{start:s,tokens:GT}}function L$(t,e,n){let r=n.length,s=0,i=[],o=[];for(;s<r;){let a=t,l=null,c=null,u=0,d=null,h=-1;for(;s<r&&!(l=a.go(n[s].t));)o.push(n[s++]);for(;s<r&&(c=l||a.go(n[s].t));)l=null,a=c,a.accepts()?(h=0,d=a):h>=0&&h++,s++,u++;if(h<0)s-=u,s<r&&(o.push(n[s]),s++);else{o.length>0&&(i.push(lp(ox,e,o)),o=[]),s-=h,u-=h;const f=d.t,p=n.slice(s-u,s);i.push(lp(f,e,p))}}return o.length>0&&i.push(lp(ox,e,o)),i}function lp(t,e,n){const r=n[0].s,s=n[n.length-1].e,i=e.slice(r,s);return new t(i,n)}const $$=typeof console<"u"&&console&&console.warn||(()=>{}),F$="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",Ge={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function B$(){return gn.groups={},Ge.scanner=null,Ge.parser=null,Ge.tokenQueue=[],Ge.pluginQueue=[],Ge.customSchemes=[],Ge.initialized=!1,Ge}function ax(t,e=!1){if(Ge.initialized&&$$(`linkifyjs: already initialized - will not register custom scheme "${t}" ${F$}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(t))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);Ge.customSchemes.push([t,e])}function U$(){Ge.scanner=P$(Ge.customSchemes);for(let t=0;t<Ge.tokenQueue.length;t++)Ge.tokenQueue[t][1]({scanner:Ge.scanner});Ge.parser=j$(Ge.scanner.tokens);for(let t=0;t<Ge.pluginQueue.length;t++)Ge.pluginQueue[t][1]({scanner:Ge.scanner,parser:Ge.parser});return Ge.initialized=!0,Ge}function QT(t){return Ge.initialized||U$(),L$(Ge.parser.start,t,JT(Ge.scanner.start,t))}QT.scan=JT;function wy(t,e=null,n=null){if(e&&typeof e=="object"){if(n)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);n=e,e=null}const r=new vy(n),s=QT(t),i=[];for(let o=0;o<s.length;o++){const a=s[o];a.isLink&&(!e||a.t===e)&&r.check(a)&&i.push(a.toFormattedObject(r))}return i}function z$(t){return new Mt({key:new En("autolink"),appendTransaction:(e,n,r)=>{const s=e.some(c=>c.docChanged)&&!n.doc.eq(r.doc),i=e.some(c=>c.getMeta("preventAutolink"));if(!s||i)return;const{tr:o}=r,a=C3(n.doc,[...e]);if(P3(a).forEach(({newRange:c})=>{const u=_3(r.doc,c,f=>f.isTextblock);let d,h;if(u.length>1?(d=u[0],h=r.doc.textBetween(d.pos,d.pos+d.node.nodeSize,void 0," ")):u.length&&r.doc.textBetween(c.from,c.to," "," ").endsWith(" ")&&(d=u[0],h=r.doc.textBetween(d.pos,c.to,void 0," ")),d&&h){const f=h.split(" ").filter(y=>y!=="");if(f.length<=0)return!1;const p=f[f.length-1],g=d.pos+h.lastIndexOf(p);if(!p)return!1;wy(p).filter(y=>y.isLink).map(y=>({...y,from:g+y.start+1,to:g+y.end+1})).filter(y=>r.schema.marks.code?!r.doc.rangeHasMark(y.from,y.to,r.schema.marks.code):!0).filter(y=>t.validate?t.validate(y.value):!0).forEach(y=>{cy(y.from,y.to,r.doc).some(m=>m.mark.type===t.type)||o.addMark(y.from,y.to,t.type.create({href:y.href}))})}}),!!o.steps.length)return o}})}function V$(t){return new Mt({key:new En("handleClickLink"),props:{handleClick:(e,n,r)=>{var s,i;if(r.button!==0)return!1;let o=r.target;const a=[];for(;o.nodeName!=="DIV";)a.push(o),o=o.parentNode;if(!a.find(h=>h.nodeName==="A"))return!1;const l=LT(e.state,t.type.name),c=r.target,u=(s=c==null?void 0:c.href)!==null&&s!==void 0?s:l.href,d=(i=c==null?void 0:c.target)!==null&&i!==void 0?i:l.target;return c&&u?(window.open(u,d),!0):!1}}})}function H$(t){return new Mt({key:new En("handlePasteLink"),props:{handlePaste:(e,n,r)=>{const{state:s}=e,{selection:i}=s,{empty:o}=i;if(o)return!1;let a="";r.content.forEach(c=>{a+=c.textContent});const l=wy(a).find(c=>c.isLink&&c.value===a);return!a||!l?!1:(t.editor.commands.setMark(t.type,{href:l.href}),!0)}}})}const W$=fs.create({name:"link",priority:1e3,keepOnSplit:!1,onCreate(){this.options.protocols.forEach(t=>{if(typeof t=="string"){ax(t);return}ax(t.scheme,t.optionalSlashes)})},onDestroy(){B$()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},validate:void 0}},addAttributes(){return{href:{default:null},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:'a[href]:not([href *= "javascript:" i])'}]},renderHTML({HTMLAttributes:t}){var e;return!((e=t.href)===null||e===void 0)&&e.startsWith("javascript:")?["a",St(this.options.HTMLAttributes,{...t,href:""}),0]:["a",St(this.options.HTMLAttributes,t),0]},addCommands(){return{setLink:t=>({chain:e})=>e().setMark(this.name,t).setMeta("preventAutolink",!0).run(),toggleLink:t=>({chain:e})=>e().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run(),unsetLink:()=>({chain:t})=>t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[eo({find:t=>{const e=[];if(t){const n=wy(t).filter(r=>r.isLink);n.length&&n.forEach(r=>e.push({text:r.value,data:{href:r.href},index:r.start}))}return e},type:this.type,getAttributes:t=>{var e;return{href:(e=t.data)===null||e===void 0?void 0:e.href}}})]},addProseMirrorPlugins(){const t=[];return this.options.autolink&&t.push(z$({type:this.type,validate:this.options.validate})),this.options.openOnClick&&t.push(V$({type:this.type})),this.options.linkOnPaste&&t.push(H$({editor:this.editor,type:this.type})),t}}),K$=Zt.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,considerAnyAsEmpty:!1,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new Mt({key:new En("placeholder"),props:{decorations:({doc:t,selection:e})=>{var n;const r=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:s}=e,i=[];if(!r)return null;const{firstChild:o}=t.content,a=o&&o.type.isLeaf,l=o&&o.isAtom,c=this.options.considerAnyAsEmpty?!0:o&&o.type.name===((n=t.type.contentMatch.defaultType)===null||n===void 0?void 0:n.name),u=t.content.childCount<=1&&o&&c&&o.nodeSize<=2&&(!a||!l);return t.descendants((d,h)=>{const f=s>=h&&s<=h+d.nodeSize,p=!d.isLeaf&&!d.childCount;if((f||!this.options.showOnlyCurrent)&&p){const g=[this.options.emptyNodeClass];u&&g.push(this.options.emptyEditorClass);const y=Ln.node(h,h+d.nodeSize,{class:g.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:d,pos:h,hasAnchor:f}):this.options.placeholder});i.push(y)}return this.options.includeChildren}),gt.create(t,i)}}})]}}),q$=en.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:t}){return["ul",St(this.options.HTMLAttributes,t,{"data-type":this.name}),0]},addCommands(){return{toggleTaskList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}}),G$=/^\s*(\[([( |x])?\])\s$/,J$=en.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList"}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:t=>t.getAttribute("data-checked")==="true",renderHTML:t=>({"data-checked":t.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:t,HTMLAttributes:e}){return["li",St(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:t.attrs.checked?"checked":null}],["span"]],["div",0]]},addKeyboardShortcuts(){const t={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...t,Tab:()=>this.editor.commands.sinkListItem(this.name)}:t},addNodeView(){return({node:t,HTMLAttributes:e,getPos:n,editor:r})=>{const s=document.createElement("li"),i=document.createElement("label"),o=document.createElement("span"),a=document.createElement("input"),l=document.createElement("div");return i.contentEditable="false",a.type="checkbox",a.addEventListener("change",c=>{if(!r.isEditable&&!this.options.onReadOnlyChecked){a.checked=!a.checked;return}const{checked:u}=c.target;r.isEditable&&typeof n=="function"&&r.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:d})=>{const h=n(),f=d.doc.nodeAt(h);return d.setNodeMarkup(h,void 0,{...f==null?void 0:f.attrs,checked:u}),!0}).run(),!r.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(t,u)||(a.checked=!a.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([c,u])=>{s.setAttribute(c,u)}),s.dataset.checked=t.attrs.checked,t.attrs.checked&&a.setAttribute("checked","checked"),i.append(a,o),s.append(i,l),Object.entries(e).forEach(([c,u])=>{s.setAttribute(c,u)}),{dom:s,contentDOM:l,update:c=>c.type!==this.type?!1:(s.dataset.checked=c.attrs.checked,c.attrs.checked?a.setAttribute("checked","checked"):a.removeAttribute("checked"),!0)}}},addInputRules(){return[fa({find:G$,type:this.type,getAttributes:t=>({checked:t[t.length-1]==="x"})})]}}),Y$=({initialContent:t,onChange:e,editable:n=!0,className:r="",placeholder:s="...",textSizeClass:i="text-base",descFontClass:o="font-normal",autoFocus:a=!1})=>{const l=b4({extensions:[E$,W$.configure({openOnClick:!1,autolink:!0}),K$.configure({placeholder:s,emptyEditorClass:"is-editor-empty before:content-[attr(data-placeholder)] before:text-slate-300 before:float-left before:pointer-events-none before:h-0"}),q$,J$.configure({nested:!0})],content:t,editable:n,editorProps:{attributes:{class:`prose prose-sm max-w-none focus:outline-none min-h-[5cm] max-h-[5cm] overflow-y-auto text-slate-500 ${i} ${o} leading-relaxed custom-scrollbar`}},onUpdate:({editor:c})=>{const u=c.getHTML();c.isEmpty?e(""):e(u)}});return A.useEffect(()=>{if(l&&t!==void 0){const c=l.getHTML();if(c!==t){const u=d=>d==="<p></p>"||d==="";if(u(c)&&u(t))return;l.commands.setContent(t)}}},[t,l]),A.useEffect(()=>{l&&a&&l.commands.focus("end")},[l,a]),l?x.jsx("div",{className:`note-editor-wrapper ${r} relative`,children:x.jsx(w4,{editor:l})}):null};var lx;(function(t){t.STRING="string",t.NUMBER="number",t.INTEGER="integer",t.BOOLEAN="boolean",t.ARRAY="array",t.OBJECT="object"})(lx||(lx={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var cx;(function(t){t.LANGUAGE_UNSPECIFIED="language_unspecified",t.PYTHON="python"})(cx||(cx={}));var ux;(function(t){t.OUTCOME_UNSPECIFIED="outcome_unspecified",t.OUTCOME_OK="outcome_ok",t.OUTCOME_FAILED="outcome_failed",t.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(ux||(ux={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dx=["user","model","function","system"];var hx;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(hx||(hx={}));var fx;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(fx||(fx={}));var px;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(px||(px={}));var mx;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER"})(mx||(mx={}));var yl;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.OTHER="OTHER"})(yl||(yl={}));var gx;(function(t){t.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",t.RETRIEVAL_QUERY="RETRIEVAL_QUERY",t.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",t.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",t.CLASSIFICATION="CLASSIFICATION",t.CLUSTERING="CLUSTERING"})(gx||(gx={}));var yx;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE"})(yx||(yx={}));var vx;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(vx||(vx={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt extends Error{constructor(e){super(`[GoogleGenerativeAI Error]: ${e}`)}}class go extends Jt{constructor(e,n){super(e),this.response=n}}class XT extends Jt{constructor(e,n,r,s){super(e),this.status=n,this.statusText=r,this.errorDetails=s}}class Zs extends Jt{}class ZT extends Jt{}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q$="https://generativelanguage.googleapis.com",X$="v1beta",Z$="0.24.1",eF="genai-js";var to;(function(t){t.GENERATE_CONTENT="generateContent",t.STREAM_GENERATE_CONTENT="streamGenerateContent",t.COUNT_TOKENS="countTokens",t.EMBED_CONTENT="embedContent",t.BATCH_EMBED_CONTENTS="batchEmbedContents"})(to||(to={}));class tF{constructor(e,n,r,s,i){this.model=e,this.task=n,this.apiKey=r,this.stream=s,this.requestOptions=i}toString(){var e,n;const r=((e=this.requestOptions)===null||e===void 0?void 0:e.apiVersion)||X$;let i=`${((n=this.requestOptions)===null||n===void 0?void 0:n.baseUrl)||Q$}/${r}/${this.model}:${this.task}`;return this.stream&&(i+="?alt=sse"),i}}function nF(t){const e=[];return t!=null&&t.apiClient&&e.push(t.apiClient),e.push(`${eF}/${Z$}`),e.join(" ")}async function rF(t){var e;const n=new Headers;n.append("Content-Type","application/json"),n.append("x-goog-api-client",nF(t.requestOptions)),n.append("x-goog-api-key",t.apiKey);let r=(e=t.requestOptions)===null||e===void 0?void 0:e.customHeaders;if(r){if(!(r instanceof Headers))try{r=new Headers(r)}catch(s){throw new Zs(`unable to convert customHeaders value ${JSON.stringify(r)} to Headers: ${s.message}`)}for(const[s,i]of r.entries()){if(s==="x-goog-api-key")throw new Zs(`Cannot set reserved header name ${s}`);if(s==="x-goog-api-client")throw new Zs(`Header name ${s} can only be set using the apiClient field`);n.append(s,i)}}return n}async function sF(t,e,n,r,s,i){const o=new tF(t,e,n,r,i);return{url:o.toString(),fetchOptions:Object.assign(Object.assign({},lF(i)),{method:"POST",headers:await rF(o),body:s})}}async function Ec(t,e,n,r,s,i={},o=fetch){const{url:a,fetchOptions:l}=await sF(t,e,n,r,s,i);return iF(a,l,o)}async function iF(t,e,n=fetch){let r;try{r=await n(t,e)}catch(s){oF(s,t)}return r.ok||await aF(r,t),r}function oF(t,e){let n=t;throw n.name==="AbortError"?(n=new ZT(`Request aborted when fetching ${e.toString()}: ${t.message}`),n.stack=t.stack):t instanceof XT||t instanceof Zs||(n=new Jt(`Error fetching from ${e.toString()}: ${t.message}`),n.stack=t.stack),n}async function aF(t,e){let n="",r;try{const s=await t.json();n=s.error.message,s.error.details&&(n+=` ${JSON.stringify(s.error.details)}`,r=s.error.details)}catch{}throw new XT(`Error fetching from ${e.toString()}: [${t.status} ${t.statusText}] ${n}`,t.status,t.statusText,r)}function lF(t){const e={};if((t==null?void 0:t.signal)!==void 0||(t==null?void 0:t.timeout)>=0){const n=new AbortController;(t==null?void 0:t.timeout)>=0&&setTimeout(()=>n.abort(),t.timeout),t!=null&&t.signal&&t.signal.addEventListener("abort",()=>{n.abort()}),e.signal=n.signal}return e}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xy(t){return t.text=()=>{if(t.candidates&&t.candidates.length>0){if(t.candidates.length>1&&console.warn(`This response had ${t.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),Pu(t.candidates[0]))throw new go(`${Os(t)}`,t);return cF(t)}else if(t.promptFeedback)throw new go(`Text not available. ${Os(t)}`,t);return""},t.functionCall=()=>{if(t.candidates&&t.candidates.length>0){if(t.candidates.length>1&&console.warn(`This response had ${t.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),Pu(t.candidates[0]))throw new go(`${Os(t)}`,t);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),wx(t)[0]}else if(t.promptFeedback)throw new go(`Function call not available. ${Os(t)}`,t)},t.functionCalls=()=>{if(t.candidates&&t.candidates.length>0){if(t.candidates.length>1&&console.warn(`This response had ${t.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),Pu(t.candidates[0]))throw new go(`${Os(t)}`,t);return wx(t)}else if(t.promptFeedback)throw new go(`Function call not available. ${Os(t)}`,t)},t}function cF(t){var e,n,r,s;const i=[];if(!((n=(e=t.candidates)===null||e===void 0?void 0:e[0].content)===null||n===void 0)&&n.parts)for(const o of(s=(r=t.candidates)===null||r===void 0?void 0:r[0].content)===null||s===void 0?void 0:s.parts)o.text&&i.push(o.text),o.executableCode&&i.push("\n```"+o.executableCode.language+`
`+o.executableCode.code+"\n```\n"),o.codeExecutionResult&&i.push("\n```\n"+o.codeExecutionResult.output+"\n```\n");return i.length>0?i.join(""):""}function wx(t){var e,n,r,s;const i=[];if(!((n=(e=t.candidates)===null||e===void 0?void 0:e[0].content)===null||n===void 0)&&n.parts)for(const o of(s=(r=t.candidates)===null||r===void 0?void 0:r[0].content)===null||s===void 0?void 0:s.parts)o.functionCall&&i.push(o.functionCall);if(i.length>0)return i}const uF=[yl.RECITATION,yl.SAFETY,yl.LANGUAGE];function Pu(t){return!!t.finishReason&&uF.includes(t.finishReason)}function Os(t){var e,n,r;let s="";if((!t.candidates||t.candidates.length===0)&&t.promptFeedback)s+="Response was blocked",!((e=t.promptFeedback)===null||e===void 0)&&e.blockReason&&(s+=` due to ${t.promptFeedback.blockReason}`),!((n=t.promptFeedback)===null||n===void 0)&&n.blockReasonMessage&&(s+=`: ${t.promptFeedback.blockReasonMessage}`);else if(!((r=t.candidates)===null||r===void 0)&&r[0]){const i=t.candidates[0];Pu(i)&&(s+=`Candidate was blocked due to ${i.finishReason}`,i.finishMessage&&(s+=`: ${i.finishMessage}`))}return s}function oc(t){return this instanceof oc?(this.v=t,this):new oc(t)}function dF(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(h){r[h]&&(s[h]=function(f){return new Promise(function(p,g){i.push([h,f,p,g])>1||a(h,f)})})}function a(h,f){try{l(r[h](f))}catch(p){d(i[0][3],p)}}function l(h){h.value instanceof oc?Promise.resolve(h.value.v).then(c,u):d(i[0][2],h)}function c(h){a("next",h)}function u(h){a("throw",h)}function d(h,f){h(f),i.shift(),i.length&&a(i[0][0],i[0][1])}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xx=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function hF(t){const e=t.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),n=mF(e),[r,s]=n.tee();return{stream:pF(r),response:fF(s)}}async function fF(t){const e=[],n=t.getReader();for(;;){const{done:r,value:s}=await n.read();if(r)return xy(gF(e));e.push(s)}}function pF(t){return dF(this,arguments,function*(){const n=t.getReader();for(;;){const{value:r,done:s}=yield oc(n.read());if(s)break;yield yield oc(xy(r))}})}function mF(t){const e=t.getReader();return new ReadableStream({start(r){let s="";return i();function i(){return e.read().then(({value:o,done:a})=>{if(a){if(s.trim()){r.error(new Jt("Failed to parse stream"));return}r.close();return}s+=o;let l=s.match(xx),c;for(;l;){try{c=JSON.parse(l[1])}catch{r.error(new Jt(`Error parsing JSON response: "${l[1]}"`));return}r.enqueue(c),s=s.substring(l[0].length),l=s.match(xx)}return i()}).catch(o=>{let a=o;throw a.stack=o.stack,a.name==="AbortError"?a=new ZT("Request aborted when reading from the stream"):a=new Jt("Error reading from the stream"),a})}}})}function gF(t){const e=t[t.length-1],n={promptFeedback:e==null?void 0:e.promptFeedback};for(const r of t){if(r.candidates){let s=0;for(const i of r.candidates)if(n.candidates||(n.candidates=[]),n.candidates[s]||(n.candidates[s]={index:s}),n.candidates[s].citationMetadata=i.citationMetadata,n.candidates[s].groundingMetadata=i.groundingMetadata,n.candidates[s].finishReason=i.finishReason,n.candidates[s].finishMessage=i.finishMessage,n.candidates[s].safetyRatings=i.safetyRatings,i.content&&i.content.parts){n.candidates[s].content||(n.candidates[s].content={role:i.content.role||"user",parts:[]});const o={};for(const a of i.content.parts)a.text&&(o.text=a.text),a.functionCall&&(o.functionCall=a.functionCall),a.executableCode&&(o.executableCode=a.executableCode),a.codeExecutionResult&&(o.codeExecutionResult=a.codeExecutionResult),Object.keys(o).length===0&&(o.text=""),n.candidates[s].content.parts.push(o)}s++}r.usageMetadata&&(n.usageMetadata=r.usageMetadata)}return n}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e2(t,e,n,r){const s=await Ec(e,to.STREAM_GENERATE_CONTENT,t,!0,JSON.stringify(n),r);return hF(s)}async function t2(t,e,n,r){const i=await(await Ec(e,to.GENERATE_CONTENT,t,!1,JSON.stringify(n),r)).json();return{response:xy(i)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n2(t){if(t!=null){if(typeof t=="string")return{role:"system",parts:[{text:t}]};if(t.text)return{role:"system",parts:[t]};if(t.parts)return t.role?t:{role:"system",parts:t.parts}}}function ac(t){let e=[];if(typeof t=="string")e=[{text:t}];else for(const n of t)typeof n=="string"?e.push({text:n}):e.push(n);return yF(e)}function yF(t){const e={role:"user",parts:[]},n={role:"function",parts:[]};let r=!1,s=!1;for(const i of t)"functionResponse"in i?(n.parts.push(i),s=!0):(e.parts.push(i),r=!0);if(r&&s)throw new Jt("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!r&&!s)throw new Jt("No content is provided for sending chat message.");return r?e:n}function vF(t,e){var n;let r={model:e==null?void 0:e.model,generationConfig:e==null?void 0:e.generationConfig,safetySettings:e==null?void 0:e.safetySettings,tools:e==null?void 0:e.tools,toolConfig:e==null?void 0:e.toolConfig,systemInstruction:e==null?void 0:e.systemInstruction,cachedContent:(n=e==null?void 0:e.cachedContent)===null||n===void 0?void 0:n.name,contents:[]};const s=t.generateContentRequest!=null;if(t.contents){if(s)throw new Zs("CountTokensRequest must have one of contents or generateContentRequest, not both.");r.contents=t.contents}else if(s)r=Object.assign(Object.assign({},r),t.generateContentRequest);else{const i=ac(t);r.contents=[i]}return{generateContentRequest:r}}function bx(t){let e;return t.contents?e=t:e={contents:[ac(t)]},t.systemInstruction&&(e.systemInstruction=n2(t.systemInstruction)),e}function wF(t){return typeof t=="string"||Array.isArray(t)?{content:ac(t)}:t}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kx=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],xF={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function bF(t){let e=!1;for(const n of t){const{role:r,parts:s}=n;if(!e&&r!=="user")throw new Jt(`First content should be with role 'user', got ${r}`);if(!dx.includes(r))throw new Jt(`Each item should include role field. Got ${r} but valid roles are: ${JSON.stringify(dx)}`);if(!Array.isArray(s))throw new Jt("Content should have 'parts' property with an array of Parts");if(s.length===0)throw new Jt("Each Content should have at least one part");const i={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const a of s)for(const l of kx)l in a&&(i[l]+=1);const o=xF[r];for(const a of kx)if(!o.includes(a)&&i[a]>0)throw new Jt(`Content with role '${r}' can't contain '${a}' part`);e=!0}}function Sx(t){var e;if(t.candidates===void 0||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;if(n===void 0||n.parts===void 0||n.parts.length===0)return!1;for(const r of n.parts)if(r===void 0||Object.keys(r).length===0||r.text!==void 0&&r.text==="")return!1;return!0}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ex="SILENT_ERROR";class kF{constructor(e,n,r,s={}){this.model=n,this.params=r,this._requestOptions=s,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=e,r!=null&&r.history&&(bF(r.history),this._history=r.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e,n={}){var r,s,i,o,a,l;await this._sendPromise;const c=ac(e),u={safetySettings:(r=this.params)===null||r===void 0?void 0:r.safetySettings,generationConfig:(s=this.params)===null||s===void 0?void 0:s.generationConfig,tools:(i=this.params)===null||i===void 0?void 0:i.tools,toolConfig:(o=this.params)===null||o===void 0?void 0:o.toolConfig,systemInstruction:(a=this.params)===null||a===void 0?void 0:a.systemInstruction,cachedContent:(l=this.params)===null||l===void 0?void 0:l.cachedContent,contents:[...this._history,c]},d=Object.assign(Object.assign({},this._requestOptions),n);let h;return this._sendPromise=this._sendPromise.then(()=>t2(this._apiKey,this.model,u,d)).then(f=>{var p;if(Sx(f.response)){this._history.push(c);const g=Object.assign({parts:[],role:"model"},(p=f.response.candidates)===null||p===void 0?void 0:p[0].content);this._history.push(g)}else{const g=Os(f.response);g&&console.warn(`sendMessage() was unsuccessful. ${g}. Inspect response object for details.`)}h=f}).catch(f=>{throw this._sendPromise=Promise.resolve(),f}),await this._sendPromise,h}async sendMessageStream(e,n={}){var r,s,i,o,a,l;await this._sendPromise;const c=ac(e),u={safetySettings:(r=this.params)===null||r===void 0?void 0:r.safetySettings,generationConfig:(s=this.params)===null||s===void 0?void 0:s.generationConfig,tools:(i=this.params)===null||i===void 0?void 0:i.tools,toolConfig:(o=this.params)===null||o===void 0?void 0:o.toolConfig,systemInstruction:(a=this.params)===null||a===void 0?void 0:a.systemInstruction,cachedContent:(l=this.params)===null||l===void 0?void 0:l.cachedContent,contents:[...this._history,c]},d=Object.assign(Object.assign({},this._requestOptions),n),h=e2(this._apiKey,this.model,u,d);return this._sendPromise=this._sendPromise.then(()=>h).catch(f=>{throw new Error(Ex)}).then(f=>f.response).then(f=>{if(Sx(f)){this._history.push(c);const p=Object.assign({},f.candidates[0].content);p.role||(p.role="model"),this._history.push(p)}else{const p=Os(f);p&&console.warn(`sendMessageStream() was unsuccessful. ${p}. Inspect response object for details.`)}}).catch(f=>{f.message!==Ex&&console.error(f)}),h}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SF(t,e,n,r){return(await Ec(e,to.COUNT_TOKENS,t,!1,JSON.stringify(n),r)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EF(t,e,n,r){return(await Ec(e,to.EMBED_CONTENT,t,!1,JSON.stringify(n),r)).json()}async function CF(t,e,n,r){const s=n.requests.map(o=>Object.assign(Object.assign({},o),{model:e}));return(await Ec(e,to.BATCH_EMBED_CONTENTS,t,!1,JSON.stringify({requests:s}),r)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cx{constructor(e,n,r={}){this.apiKey=e,this._requestOptions=r,n.model.includes("/")?this.model=n.model:this.model=`models/${n.model}`,this.generationConfig=n.generationConfig||{},this.safetySettings=n.safetySettings||[],this.tools=n.tools,this.toolConfig=n.toolConfig,this.systemInstruction=n2(n.systemInstruction),this.cachedContent=n.cachedContent}async generateContent(e,n={}){var r;const s=bx(e),i=Object.assign(Object.assign({},this._requestOptions),n);return t2(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(r=this.cachedContent)===null||r===void 0?void 0:r.name},s),i)}async generateContentStream(e,n={}){var r;const s=bx(e),i=Object.assign(Object.assign({},this._requestOptions),n);return e2(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(r=this.cachedContent)===null||r===void 0?void 0:r.name},s),i)}startChat(e){var n;return new kF(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(n=this.cachedContent)===null||n===void 0?void 0:n.name},e),this._requestOptions)}async countTokens(e,n={}){const r=vF(e,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),s=Object.assign(Object.assign({},this._requestOptions),n);return SF(this.apiKey,this.model,r,s)}async embedContent(e,n={}){const r=wF(e),s=Object.assign(Object.assign({},this._requestOptions),n);return EF(this.apiKey,this.model,r,s)}async batchEmbedContents(e,n={}){const r=Object.assign(Object.assign({},this._requestOptions),n);return CF(this.apiKey,this.model,e,r)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TF{constructor(e){this.apiKey=e}getGenerativeModel(e,n){if(!e.model)throw new Jt("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new Cx(this.apiKey,e,n)}getGenerativeModelFromCachedContent(e,n,r){if(!e.name)throw new Zs("Cached content must contain a `name` field.");if(!e.model)throw new Zs("Cached content must contain a `model` field.");const s=["model","systemInstruction"];for(const o of s)if(n!=null&&n[o]&&e[o]&&(n==null?void 0:n[o])!==e[o]){if(o==="model"){const a=n.model.startsWith("models/")?n.model.replace("models/",""):n.model,l=e.model.startsWith("models/")?e.model.replace("models/",""):e.model;if(a===l)continue}throw new Zs(`Different value for "${o}" specified in modelParams (${n[o]}) and cachedContent (${e[o]})`)}const i=Object.assign(Object.assign({},n),{model:e.model,tools:e.tools,toolConfig:e.toolConfig,systemInstruction:e.systemInstruction,cachedContent:e});return new Cx(this.apiKey,i,r)}}const _F="AIzaSyBbGFzQkwhEmNQduYxaZnnxxHR-DlQjj98",by=()=>({provider:localStorage.getItem("ai_provider")||"gemini",googleKey:localStorage.getItem("google_ai_key")||_F,openaiKey:localStorage.getItem("openai_api_key")||"",baseUrl:localStorage.getItem("ai_base_url")||"https://api.openai.com/v1",modelName:localStorage.getItem("ai_model")||"gpt-3.5-turbo"}),AF=()=>{const{googleKey:t}=by();if(!t)throw new Error("Google API Key is missing. Please set it in Settings.");return new TF(t)},OF=async t=>{const e=AF(),n=["gemini-2.0-flash-001","gemini-2.0-flash-lite-preview-02-05","gemini-flash-latest","gemini-pro-latest"];let r;for(const s of n)try{console.log(`Attempting to use AI model: ${s}`);const l=(await(await e.getGenerativeModel({model:s,generationConfig:{temperature:.7,topK:40,topP:.95,maxOutputTokens:2048}}).generateContent(t)).response).text();console.log("AI Raw Response:",l);const c=l.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(c)}catch(i){console.warn(`Model ${s} failed:`,i.message),r=i;continue}throw r},RF=async t=>{var o,a;const{openaiKey:e,baseUrl:n,modelName:r}=by();if(!e)throw new Error("API Key is missing. Please set it in Settings.");let s=n.trim();s.endsWith("/")&&(s=s.slice(0,-1)),s.endsWith("/v1");const i=`${s}/chat/completions`;console.log(`Using OpenAI-compatible provider: ${s}, model: ${r}`);try{const l=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({model:r,messages:[{role:"system",content:"You are a helpful assistant. Output valid JSON only."},{role:"user",content:t}],temperature:.7})});if(!l.ok){const h=await l.text();throw new Error(`API Error: ${l.status} ${l.statusText} - ${h}`)}const u=((a=(o=(await l.json()).choices[0])==null?void 0:o.message)==null?void 0:a.content)||"";console.log("AI Raw Response:",u);const d=u.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(d)}catch(l){throw console.error("OpenAI Provider Error:",l),l}},r2=async t=>{const{provider:e}=by();return e==="openai"?await RF(t):await OF(t)},NF=async(t,e)=>{const n=`
    You are a professional editor with a gentle, helpful personality (similar to Things 3's design language). 
    Please review the following text (which is a journal entry or task description) and the current title.
    
    Current Title: "${e}"
    Content:
    "${t}"
    
    Tasks:
    1. Improve the title to be more concise and professional in Traditional Chinese ().
    2. Improve the content for grammar, clarity, and tone in Traditional Chinese ().
    3. Provide a brief, gentle summary of what you changed in Traditional Chinese (). The summary should be one short sentence, like "" or "".
    
    Output JSON format ONLY:
    {
      "newTitle": "Improved Title (Traditional Chinese)",
      "newContent": "Improved Content (Traditional Chinese)",
      "summary": "Gentle summary of changes (Traditional Chinese)"
    }
    
    If the content is HTML, preserve the HTML structure/tags in "newContent" but improve the text inside.
    If the content is plain text, keep it plain text.
    ENSURE ALL OUTPUT IS IN TRADITIONAL CHINESE ().
  `;try{if(!t.trim())throw new Error("Content is empty");return await r2(n)}catch(r){throw console.error("AI Service Error Details:",r),r}},IF=async(t,e)=>{const n=`
    Role: You are an experienced supervisor at a Children's Placement Agency in Taiwan ().
    Task: Analyze the following task/journal entry from a management perspective.
    
    Current Title: "${e}"
    Content:
    "${t}"
    
    Analysis Requirements:
    1. **Strengths ()**: Identify what is being done well in the content, praising the effort or strategy.
    2. **Potential Blind Spots ()**: Point out potential risks, overlooked aspects, or problems with this way of thinking.
    3. **Cross-unit Collaboration ()**: Suggest how to collaborate with other units/departments (e.g., social workers, psychologists, administration) to handle this better.
    4. **Next Steps ()**: Provide concrete, actionable next steps.
    
    Output JSON format ONLY:
    {
      "strengths": "Analysis of strengths (Traditional Chinese)",
      "blindSpots": "Analysis of blind spots (Traditional Chinese)",
      "collaboration": "Suggestions for collaboration (Traditional Chinese)",
      "nextSteps": "Actionable next steps (Traditional Chinese)"
    }
    
    Tone: Professional, empathetic, constructive, and experienced. Use Traditional Chinese ().
    Format: The output text should be formatted as clean paragraphs or bullet points within the JSON strings.
  `;try{if(!t.trim())throw new Error("Content is empty");return await r2(n)}catch(r){throw console.error("AI Expert Analysis Error:",r),r}},sh=({initialData:t,onClose:e,isQuickAdd:n=!1})=>{const{addTask:r,updateTask:s,tags:i,tasks:o,addTag:a,deleteTag:l,setFocusedTaskId:c,themeSettings:u,toggleExpansion:d,setSelectedTaskIds:h,deleteTask:f,visibleTasks:p,user:g,view:y,setToast:m}=A.useContext(Vn),[v,w]=A.useState((t==null?void 0:t.title)||""),[S,T]=A.useState((t==null?void 0:t.description)||""),[E,O]=A.useState((t==null?void 0:t.due_date)||null),[b,k]=A.useState((t==null?void 0:t.start_date)||null),[N,M]=A.useState((t==null?void 0:t.tags)||[]),[L,$]=A.useState((t==null?void 0:t.images)||[]),[P,U]=A.useState((t==null?void 0:t.parent_id)||null),[R,C]=A.useState([]),[D,j]=A.useState((t==null?void 0:t.is_project)||!1),[F,Y]=A.useState((t==null?void 0:t.color)||"blue"),[Q,W]=A.useState(!1),[G,H]=A.useState(null),se=A.useRef(null),be=A.useRef(null),[X,re]=A.useState(!1),[ge,we]=A.useState(!1),[ue,J]=A.useState({isOpen:!1,title:"",content:"",history:[],historyIndex:-1}),[fe,de]=A.useState(null),[ie,oe]=A.useState(!1),Oe=_=>{J(I=>{const z={title:I.title,content:_},q=[...I.history.slice(0,I.historyIndex+1),z];return{...I,content:_,history:q,historyIndex:q.length-1}})},We=_=>{J(I=>{const z={title:_,content:I.content},q=[...I.history.slice(0,I.historyIndex+1),z];return{...I,title:_,history:q,historyIndex:q.length-1}})},Be=()=>{J(_=>{if(_.historyIndex<=0)return _;const I=_.historyIndex-1,z=_.history[I];return{..._,title:z.title,content:z.content,historyIndex:I}})},Re=()=>{J(_=>{if(_.historyIndex>=_.history.length-1)return _;const I=_.historyIndex+1,z=_.history[I];return{..._,title:z.title,content:z.content,historyIndex:I}})},Ke=t?!!t.completed_at:!1,me=A.useRef(null),Me=A.useRef(null),Le=A.useRef(null),it=A.useRef(null),[lr,ot]=A.useState([]),[at,Ze]=A.useState(!1),[Et,Ct]=A.useState(-1);A.useEffect(()=>{t||y==="today"&&!b&&k(new Date().toISOString())},[y,t]),A.useEffect(()=>{Me.current},[S]);const Cn=async()=>{if(!S||!S.trim()){alert("Please enter some content first.");return}re(!0);try{const _=await NF(S,v);J({isOpen:!0,title:_.newTitle,content:_.newContent,history:[{title:_.newTitle,content:_.newContent}],historyIndex:0})}catch(_){console.error(_),alert("AI Service Error. Please check your connection or key.")}finally{re(!1)}},fn=async()=>{if(!S||!S.trim()){alert("Please enter some content first.");return}if(ie&&fe){oe(!1);return}we(!0),oe(!0);try{const _=await IF(S,v);de(_)}catch(_){console.error(_),alert("AI Service Error. Please check your connection or key."),oe(!1)}finally{we(!1)}},cr=_=>{if(!_)return F;let I=o.find(q=>q.id===_);const z=new Set;for(;I&&I.parent_id&&!z.has(I.id);){z.add(I.id);const q=o.find(ae=>ae.id===I.parent_id);if(q)I=q;else break}return(I==null?void 0:I.color)||"blue"},Tn=A.useMemo(()=>cr(P),[P,o,F]),_n=vn[Tn]||vn.blue;Gl(se,()=>{if(t&&e)if(v.trim())vs();else{const _=p.findIndex(z=>z.data.id===t.id),I=p[_-1];f(t.id),e(I?I.data.id:null)}});const Ur=A.useMemo(()=>t!=null&&t.id?o.filter(_=>_.id!==t.id&&!L0(t.id,_.id,o)&&_.status!=="deleted"):o.filter(_=>_.status!=="deleted"),[o,t]);A.useEffect(()=>{if(t!=null&&t.id){const _=o.filter(I=>I.parent_id===t.id).map(I=>I.id);C(_)}},[t,o]),A.useEffect(()=>{const _=!t||!t.title;if(v.length>=2&&_){const I=o.filter(z=>z.title.toLowerCase().includes(v.toLowerCase())&&z.id!==(t==null?void 0:t.id));ot(I.slice(0,5)),Ze(I.length>0),Ct(-1)}else Ze(!1)},[v,o,t]),A.useEffect(()=>{!t&&me.current&&me.current.focus()},[t]);const vs=async()=>{if(!v.trim())return;const _={title:v,description:S,due_date:E,start_date:b,parent_id:P,is_project:D||R.length>0,tags:N,status:(t==null?void 0:t.status)||"inbox",color:Tn,images:L};if(e?(e(),t!=null&&t.id&&c(t.id)):zr(),t)await s(t.id,_,R);else{const I=await r(_,R);c(I),h([I])}},zr=()=>{w(""),T(""),O(null),k(null),M([]),$([]),U(null),C([]),j(!1)},Ta=async _=>{if(!_.target.files||_.target.files.length===0||!le)return;W(!0);const I=Array.from(_.target.files),z=[];try{for(const q of I){console.log(`Processing ${q.name}, original size: ${(q.size/1024).toFixed(2)} KB`);const ae={maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0};let ve=q;try{const Ue=await Kt(q,ae);console.log(`Compressed ${q.name}, new size: ${(Ue.size/1024).toFixed(2)} KB`),ve=Ue}catch(Ue){console.warn("Compression failed, using original file:",Ue)}const Ne=q.name.split(".").pop(),_e=`${Date.now()}-${Math.random().toString(36).substring(7)}.${Ne}`,Z=`${g.id}/${_e}`;console.log("Uploading file:",Z);const{error:ke}=await le.storage.from("attachments").upload(Z,ve);if(ke){console.error("Upload error:",ke);continue}const{data:Tt}=le.storage.from("attachments").getPublicUrl(Z);console.log("Got public URL:",Tt),Tt&&z.push(Tt.publicUrl)}$(q=>(console.log("Updating images state:",[...q,...z]),[...q,...z]))}catch(q){console.error("Error uploading images:",q)}finally{W(!1),be.current&&(be.current.value="")}},Hn=_=>{$(I=>I.filter(z=>z!==_))},nn=_=>{var ae,ve,Ne,_e,Z,ke,Tt,Ue,rn,An,On,Rn,Cr,Hr;_.preventDefault();const I=document.activeElement,z=_.shiftKey,q=(ae=se.current)==null?void 0:ae.querySelector(".ProseMirror");z?I===me.current?(Ue=it.current)==null||Ue.focus():I!=null&&I.classList.contains("ProseMirror")?(rn=me.current)==null||rn.focus():it.current&&(I===it.current||(An=it.current.parentElement)!=null&&An.contains(I))?(On=Le.current)==null||On.focus():Le.current&&(I===Le.current||(Rn=Le.current.parentElement)!=null&&Rn.contains(I))?q?q.focus():(Cr=me.current)==null||Cr.focus():(Hr=it.current)==null||Hr.focus():I===me.current?q&&q.focus():I!=null&&I.classList.contains("ProseMirror")?(ve=Le.current)==null||ve.focus():I===Le.current||Le.current&&((Ne=Le.current.parentElement)!=null&&Ne.contains(I))?(_e=it.current)==null||_e.focus():it.current&&(I===it.current||(Z=it.current.parentElement)!=null&&Z.contains(I))?(ke=me.current)==null||ke.focus():(Tt=me.current)==null||Tt.focus()},ur=()=>{t&&s(t.id,{completed_at:Ke?null:new Date().toISOString()})},Vr=_=>{var I,z;if(_.shiftKey){if(_.key==="S"||_.key==="s"){_.preventDefault(),(I=Le.current)==null||I.focus();return}if(_.key==="T"||_.key==="t"){_.preventDefault(),(z=it.current)==null||z.focus();return}}if(_.ctrlKey&&_.key==="."){_.preventDefault(),_.stopPropagation(),ur();return}if(_.key==="Tab"){nn(_);return}if(at){if(_.key==="ArrowDown"){_.preventDefault(),Ct(q=>q===-1?0:(q+1)%lr.length);return}if(_.key==="ArrowUp"){_.preventDefault(),Ct(q=>q<=0?lr.length-1:q-1);return}if((_.ctrlKey||_.metaKey)&&_.key==="Enter"&&Et>=0){_.preventDefault(),w(lr[Et].title),Ze(!1);return}if(_.key==="Escape"){_.preventDefault(),Ze(!1);return}}if(_.key==="Enter"&&!_.shiftKey&&(_.preventDefault(),_.stopPropagation(),vs()),_.key==="Escape"&&e)if(_.preventDefault(),t&&!v.trim()){const q=p.findIndex(ve=>ve.data.id===t.id),ae=p[q-1];f(t.id),e(ae?ae.data.id:null)}else vs()},io=t?"":"pl-3",V=u.fontWeight==="thin"?"font-extralight":"font-medium",B=u.fontWeight==="thin"?"font-extralight":"font-normal",K={small:"text-sm",normal:"text-base",large:"text-lg"}[u.fontSize]||"text-base";return x.jsxs("div",{ref:se,className:`group transition-all ${n?"bg-transparent":"mb-3 bg-white rounded-xl border border-gray-100/50 shadow-[0_4px_8px_rgba(0,0,0,0.08)]"}`,onKeyDown:Vr,children:[x.jsxs("div",{className:`flex gap-3 ${io} py-3`,children:[t?x.jsxs("div",{className:"mt-1.5 ml-1",children:[" ",x.jsx(qE,{checked:Ke,onChange:_=>{_.stopPropagation(),ur()},size:18,color:Tn,isRoot:!P})," "]}):x.jsx("button",{type:"button",tabIndex:-1,onClick:()=>j(!D),className:`mt-1 h-5 w-5 flex items-center justify-center transition-all ${D?_n.accent:"text-gray-300 hover:text-gray-400"}`,children:D?x.jsx(zE,{size:16}):x.jsx(BE,{size:16})}),x.jsxs("div",{className:"flex-1 space-y-3 relative pr-2",children:[x.jsx("div",{className:"flex items-start justify-between",children:x.jsxs("div",{className:"flex-1 relative space-y-2",children:[x.jsx("input",{ref:me,autoFocus:!0,type:"text",value:v,onChange:_=>w(_.target.value),placeholder:"...",className:`w-full ${K} ${V} placeholder:font-light placeholder-gray-300 border-none bg-transparent focus:ring-0 outline-none p-0 leading-tight ${Ke?"text-gray-300 line-through":"text-slate-800"}`}),at&&x.jsx("div",{className:"w-full mt-1 mb-2",children:x.jsx("div",{className:"bg-gray-50/50 rounded-lg overflow-hidden border border-gray-100",children:lr.map((_,I)=>x.jsxs("div",{className:`px-3 py-1.5 text-xs cursor-pointer transition-colors flex justify-between items-center ${I===Et?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-500 hover:bg-gray-100"}`,onClick:()=>{w(_.title),Ze(!1)},children:[x.jsx("span",{children:_.title}),I===Et&&x.jsx("span",{className:"text-[9px] text-indigo-400 font-normal",children:"Ctrl+Enter"})]},_.id))})}),x.jsxs("div",{className:"flex justify-end mb-1 gap-2",children:[x.jsxs("button",{type:"button",onClick:fn,disabled:ge||X,className:`flex items-center gap-1.5 text-xs transition-colors disabled:opacity-50 px-2 py-0.5 rounded-full ${ie?"bg-teal-50 text-teal-600":"text-teal-500 hover:text-teal-700 hover:bg-teal-50"}`,title:"AI Expert Analysis",children:[ge?x.jsx(Ha,{size:12,className:"animate-spin"}):x.jsx(LM,{size:12}),x.jsx("span",{className:"font-medium",children:"AI "})]}),x.jsxs("button",{type:"button",onClick:Cn,disabled:X||ge,className:"flex items-center gap-1.5 text-xs text-indigo-500 hover:text-indigo-700 transition-colors disabled:opacity-50 px-2 py-0.5 rounded-full hover:bg-indigo-50",title:"AI Polish Content & Title",children:[X?x.jsx(Ha,{size:12,className:"animate-spin"}):x.jsx(B1,{size:12}),x.jsx("span",{className:"font-medium",children:"AI "})]})]}),x.jsxs("div",{className:`flex gap-4 transition-all duration-300 ${ie?"min-h-[300px]":""}`,children:[x.jsx("div",{className:"flex-1 transition-all duration-300",children:x.jsx(Y$,{initialContent:S,onChange:T,textSizeClass:K,descFontClass:B})}),ie&&x.jsx("div",{className:"w-[300px] shrink-0 animate-in slide-in-from-right-4 fade-in duration-300 border-l border-gray-100 pl-4 flex flex-col gap-3 h-full overflow-y-auto max-h-[500px] custom-scrollbar",children:fe?x.jsxs(x.Fragment,{children:[x.jsxs("div",{className:"bg-teal-50/50 rounded-lg p-3 border border-teal-100/50",children:[x.jsxs("h4",{className:"flex items-center gap-2 text-xs font-bold text-teal-700 mb-2 uppercase tracking-wider",children:[x.jsx(YM,{size:12})," "]}),x.jsx("div",{className:"text-xs text-teal-900 leading-relaxed whitespace-pre-line",children:fe.strengths})]}),x.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-3 border border-amber-100/50",children:[x.jsxs("h4",{className:"flex items-center gap-2 text-xs font-bold text-amber-700 mb-2 uppercase tracking-wider",children:[x.jsx(AM,{size:12})," "]}),x.jsx("div",{className:"text-xs text-amber-900 leading-relaxed whitespace-pre-line",children:fe.blindSpots})]}),x.jsxs("div",{className:"bg-indigo-50/50 rounded-lg p-3 border border-indigo-100/50",children:[x.jsxs("h4",{className:"flex items-center gap-2 text-xs font-bold text-indigo-700 mb-2 uppercase tracking-wider",children:[x.jsx(ZM,{size:12})," "]}),x.jsx("div",{className:"text-xs text-indigo-900 leading-relaxed whitespace-pre-line",children:fe.collaboration})]}),x.jsxs("div",{className:"bg-slate-50 rounded-lg p-3 border border-slate-200",children:[x.jsxs("h4",{className:"flex items-center gap-2 text-xs font-bold text-slate-700 mb-2 uppercase tracking-wider",children:[x.jsx($E,{size:12})," "]}),x.jsx("div",{className:"text-xs text-slate-700 leading-relaxed whitespace-pre-line",children:fe.nextSteps})]})]}):x.jsxs("div",{className:"flex flex-col items-center justify-center h-40 text-gray-400 gap-2",children:[x.jsx(Ha,{size:24,className:"animate-spin text-teal-500"}),x.jsx("span",{className:"text-xs",children:"..."})]})})]}),L.length>0&&x.jsx("div",{className:"grid grid-cols-4 gap-2 mt-2",children:L.map((_,I)=>x.jsxs("div",{className:"relative group aspect-square rounded-lg overflow-hidden border border-gray-100 shadow-sm cursor-pointer",onClick:()=>H(_),children:[x.jsx("img",{src:_,alt:"attachment",className:"w-full h-full object-cover transition-transform group-hover:scale-105"}),x.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors"}),x.jsx("button",{type:"button",onClick:z=>{z.stopPropagation(),Hn(_)},className:"absolute top-1 right-1 p-1 bg-black/50 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-500",children:x.jsx(is,{size:12})})]},I))})]})}),x.jsxs("div",{className:"flex items-center justify-between pt-1 flex-col items-start gap-2",children:[N.length>0&&x.jsx("div",{className:"flex flex-wrap gap-1 px-1 w-full",children:N.length>3?x.jsx(x.Fragment,{children:x.jsxs("div",{className:"flex gap-1",children:[N.slice(0,3).map(_=>{const I=i.find(z=>z.id===_);return I?x.jsx(Pm,{tag:I,onRemove:()=>M(z=>z.filter(q=>q!==_))},_):null}),x.jsxs("div",{className:"group relative",children:[x.jsx("button",{type:"button",className:"h-5 px-1.5 rounded-full border border-gray-200 text-gray-400 bg-gray-50 flex items-center justify-center hover:bg-gray-100 transition-colors",title:`${N.length-3} more tags`,children:x.jsx(KM,{size:12})}),x.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 hidden group-hover:flex flex-col gap-1 bg-white p-2 rounded-lg shadow-xl border border-gray-100 z-50 min-w-[120px]",children:N.slice(3).map(_=>{const I=i.find(z=>z.id===_);return I?x.jsxs("div",{className:"flex items-center justify-between gap-2 text-xs text-gray-600 px-1",children:[x.jsx("span",{children:I.name}),x.jsx("button",{onClick:()=>M(z=>z.filter(q=>q!==_)),className:"hover:text-red-500",children:x.jsx(is,{size:10})})]},_):null})})]})]})}):N.map(_=>{const I=i.find(z=>z.id===_);return I?x.jsx(Pm,{tag:I,onRemove:()=>M(z=>z.filter(q=>q!==_))},_):null})}),x.jsxs("div",{className:"flex items-center justify-between w-full",children:[x.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[x.jsx(fd,{innerRef:Le,label:"",value:b,onChange:k,theme:_n,tasks:o}),x.jsx(fd,{tabIndex:-1,label:"",value:E,onChange:O,colorClass:"text-red-500",tasks:o,theme:_n}),x.jsx(Tu,{innerRef:it,icon:B0,label:"",items:i,selectedIds:N,placeholder:"...",allowAdd:!0,onDeleteItem:l,multiSelect:!0,theme:_n,onSelect:async(_,I)=>{if(_)M(z=>z.includes(_)?z.filter(q=>q!==_):[...z,_]);else if(I){const z=await a(I);z&&M(q=>[...q,z])}}}),!t&&x.jsx(Tu,{tabIndex:-1,icon:F0,label:"",items:Ur,selectedIds:R,placeholder:"...",theme:_n,onSelect:_=>C(I=>I.includes(_)?I.filter(z=>z!==_):[...I,_])}),x.jsx("input",{type:"file",ref:be,className:"hidden",multiple:!0,accept:"image/*",onChange:Ta}),x.jsxs("button",{type:"button",tabIndex:-1,onClick:()=>{var _;return(_=be.current)==null?void 0:_.click()},className:`flex items-center gap-1.5 px-2.5 py-1.5 rounded-md transition-all border border-transparent hover:bg-gray-100 text-gray-400 focus:outline-none focus:bg-white focus:ring-1 ${(_n==null?void 0:_n.buttonRing)||"focus:ring-indigo-300"} ${K} ${u.fontWeight==="thin"?"font-light":"font-medium"}`,children:[Q?x.jsx(Ha,{size:13,className:"animate-spin"}):x.jsx(Im,{size:13}),x.jsx("span",{children:""})]}),x.jsx("div",{className:"w-px h-3 bg-gray-200 mx-1"}),x.jsx("div",{className:"flex items-center",children:x.jsx(Tu,{tabIndex:-1,icon:NM,label:"",items:Ur,allowAdd:!0,selectedIds:P?[P]:[],placeholder:"...",theme:_n,onSelect:async(_,I)=>{let z=_;if(!z&&I&&(z=await r({title:I,is_project:!0,status:"inbox"})),!z&&!_)return;const q=z===P?null:z;U(q),t&&(q&&d(q,!0),await s(t.id,{parent_id:q}))}})})]}),x.jsx("div",{className:"flex items-center gap-2",children:!P&&x.jsx("div",{className:"flex gap-0.5 p-0.5 bg-gray-50 rounded-full border border-gray-100",children:Object.keys(vn).map(_=>x.jsx("button",{tabIndex:-1,type:"button",onClick:()=>Y(_),className:`w-2.5 h-2.5 rounded-full ${vn[_].dot} ${F===_?"ring-1 ring-gray-400 ring-offset-1":"hover:scale-110"} transition-all`},_))})})]})]})]})]}),G&&x.jsx("div",{className:"fixed inset-0 z-[100] bg-black/90 flex items-center justify-center p-4",onClick:()=>H(null),children:x.jsxs("div",{className:"relative max-w-full max-h-full",onClick:_=>_.stopPropagation(),children:[x.jsx("img",{src:G,alt:"Preview",className:"max-w-full max-h-[90vh] rounded-lg shadow-2xl"}),x.jsxs("div",{className:"absolute top-4 right-4 flex gap-2",children:[x.jsx("a",{href:G,download:`attachment-${Date.now()}`,target:"_blank",rel:"noopener noreferrer",onClick:_=>_.stopPropagation(),className:"p-2 bg-black/50 hover:bg-black/70 text-white rounded-full backdrop-blur-sm transition-colors",title:"Download",children:x.jsx(UE,{size:20})}),x.jsx("button",{onClick:()=>H(null),className:"p-2 bg-black/50 hover:bg-black/70 text-white rounded-full backdrop-blur-sm transition-colors",children:x.jsx(is,{size:20})})]})]})}),ue.isOpen&&x.jsx("div",{className:"fixed inset-0 z-[150] flex items-center justify-center p-4 bg-black/20 backdrop-blur-sm",onClick:()=>J({...ue,isOpen:!1}),children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-6 max-w-lg w-full animate-in zoom-in duration-200",onClick:_=>_.stopPropagation(),children:[x.jsxs("div",{className:"flex items-center justify-between mb-4",children:[x.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2",children:[x.jsx(B1,{size:18,className:"text-indigo-500"}),x.jsx("span",{children:"AI "})]}),x.jsxs("div",{className:"flex gap-1",children:[x.jsx("button",{onClick:Be,disabled:ue.historyIndex<=0,className:"p-1.5 text-gray-500 hover:text-indigo-600 hover:bg-indigo-50 rounded transition-colors disabled:opacity-30 disabled:hover:bg-transparent disabled:hover:text-gray-500",title:"",children:x.jsx(KE,{size:16})}),x.jsx("button",{onClick:Re,disabled:ue.historyIndex>=ue.history.length-1,className:"p-1.5 text-gray-500 hover:text-indigo-600 hover:bg-indigo-50 rounded transition-colors disabled:opacity-30 disabled:hover:bg-transparent disabled:hover:text-gray-500",title:"",children:x.jsx(WE,{size:16})})]})]}),x.jsxs("div",{className:"mb-4",children:[x.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-wider mb-2",children:" ()"}),x.jsx("input",{className:"w-full p-2 mb-3 bg-white border border-gray-200 rounded-lg text-sm text-gray-700 focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 outline-none shadow-sm transition-all font-medium",value:ue.title,onChange:_=>We(_.target.value),onKeyDown:_=>{(_.ctrlKey||_.metaKey)&&_.key==="z"?(_.preventDefault(),_.stopPropagation(),_.shiftKey?Re():Be()):(_.ctrlKey||_.metaKey)&&_.key==="y"&&(_.preventDefault(),_.stopPropagation(),Re())}}),x.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-wider mb-2",children:" ()"}),x.jsx("textarea",{className:"w-full h-40 p-3 bg-white border border-gray-200 rounded-lg text-sm text-gray-700 focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 outline-none resize-none leading-relaxed shadow-sm transition-all",value:ue.content,onChange:_=>Oe(_.target.value),onKeyDown:_=>{(_.ctrlKey||_.metaKey)&&_.key==="z"?(_.preventDefault(),_.stopPropagation(),_.shiftKey?Re():Be()):(_.ctrlKey||_.metaKey)&&_.key==="y"&&(_.preventDefault(),_.stopPropagation(),Re())}})]}),x.jsxs("div",{className:"flex gap-3 justify-end",children:[x.jsx("button",{onClick:()=>J({...ue,isOpen:!1}),className:"px-4 py-1.5 text-gray-600 hover:bg-gray-100 rounded text-sm font-medium transition-colors",children:""}),x.jsxs("button",{onClick:()=>{w(ue.title),T(ue.content),J({isOpen:!1,title:"",content:"",history:[],historyIndex:-1}),m({msg:" AI ",type:"info"})},className:"px-4 py-1.5 bg-[#2563EB] hover:bg-[#1d4ed8] text-white rounded text-sm font-medium shadow-sm transition-colors flex items-center gap-1.5",children:[x.jsx(Ih,{size:14,strokeWidth:3}),""]})]})]})})]})},s2=A.createContext({});function PF(t){const e=A.useRef(null);return e.current===null&&(e.current=t()),e.current}const ky=typeof window<"u",MF=ky?A.useLayoutEffect:A.useEffect,Sy=A.createContext(null);function Ey(t,e){t.indexOf(e)===-1&&t.push(e)}function Cy(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const ps=(t,e,n)=>n>e?e:n<t?t:n;let Ty=()=>{};const ms={},i2=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function o2(t){return typeof t=="object"&&t!==null}const a2=t=>/^0[^.\s]+$/u.test(t);function _y(t){let e;return()=>(e===void 0&&(e=t()),e)}const sr=t=>t,DF=(t,e)=>n=>e(t(n)),Cc=(...t)=>t.reduce(DF),lc=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r};class Ay{constructor(){this.subscriptions=[]}add(e){return Ey(this.subscriptions,e),()=>Cy(this.subscriptions,e)}notify(e,n,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,n,r);else for(let i=0;i<s;i++){const o=this.subscriptions[i];o&&o(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const jr=t=>t*1e3,Zn=t=>t/1e3;function l2(t,e){return e?t*(1e3/e):0}const c2=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,jF=1e-7,LF=12;function $F(t,e,n,r,s){let i,o,a=0;do o=e+(n-e)/2,i=c2(o,r,s)-t,i>0?n=o:e=o;while(Math.abs(i)>jF&&++a<LF);return o}function Tc(t,e,n,r){if(t===e&&n===r)return sr;const s=i=>$F(i,0,1,t,n);return i=>i===0||i===1?i:c2(s(i),e,r)}const u2=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,d2=t=>e=>1-t(1-e),h2=Tc(.33,1.53,.69,.99),Oy=d2(h2),f2=u2(Oy),p2=t=>(t*=2)<1?.5*Oy(t):.5*(2-Math.pow(2,-10*(t-1))),Ry=t=>1-Math.sin(Math.acos(t)),m2=d2(Ry),g2=u2(Ry),FF=Tc(.42,0,1,1),BF=Tc(0,0,.58,1),y2=Tc(.42,0,.58,1),UF=t=>Array.isArray(t)&&typeof t[0]!="number",v2=t=>Array.isArray(t)&&typeof t[0]=="number",zF={linear:sr,easeIn:FF,easeInOut:y2,easeOut:BF,circIn:Ry,circInOut:g2,circOut:m2,backIn:Oy,backInOut:f2,backOut:h2,anticipate:p2},VF=t=>typeof t=="string",Tx=t=>{if(v2(t)){Ty(t.length===4);const[e,n,r,s]=t;return Tc(e,n,r,s)}else if(VF(t))return zF[t];return t},lu=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],_x={value:null,addProjectionMetrics:null};function HF(t,e){let n=new Set,r=new Set,s=!1,i=!1;const o=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1},l=0;function c(d){o.has(d)&&(u.schedule(d),t()),l++,d(a)}const u={schedule:(d,h=!1,f=!1)=>{const g=f&&s?n:r;return h&&o.add(d),g.has(d)||g.add(d),d},cancel:d=>{r.delete(d),o.delete(d)},process:d=>{if(a=d,s){i=!0;return}s=!0,[n,r]=[r,n],n.forEach(c),e&&_x.value&&_x.value.frameloop[e].push(l),l=0,n.clear(),s=!1,i&&(i=!1,u.process(d))}};return u}const WF=40;function w2(t,e){let n=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,o=lu.reduce((w,S)=>(w[S]=HF(i,e?S:void 0),w),{}),{setup:a,read:l,resolveKeyframes:c,preUpdate:u,update:d,preRender:h,render:f,postRender:p}=o,g=()=>{const w=ms.useManualTiming?s.timestamp:performance.now();n=!1,ms.useManualTiming||(s.delta=r?1e3/60:Math.max(Math.min(w-s.timestamp,WF),1)),s.timestamp=w,s.isProcessing=!0,a.process(s),l.process(s),c.process(s),u.process(s),d.process(s),h.process(s),f.process(s),p.process(s),s.isProcessing=!1,n&&e&&(r=!1,t(g))},y=()=>{n=!0,r=!0,s.isProcessing||t(g)};return{schedule:lu.reduce((w,S)=>{const T=o[S];return w[S]=(E,O=!1,b=!1)=>(n||y(),T.schedule(E,O,b)),w},{}),cancel:w=>{for(let S=0;S<lu.length;S++)o[lu[S]].cancel(w)},state:s,steps:o}}const{schedule:Qe,cancel:ri,state:Ft,steps:cp}=w2(typeof requestAnimationFrame<"u"?requestAnimationFrame:sr,!0);let Mu;function KF(){Mu=void 0}const wn={now:()=>(Mu===void 0&&wn.set(Ft.isProcessing||ms.useManualTiming?Ft.timestamp:performance.now()),Mu),set:t=>{Mu=t,queueMicrotask(KF)}},x2=t=>e=>typeof e=="string"&&e.startsWith(t),b2=x2("--"),qF=x2("var(--"),Ny=t=>qF(t)?GF.test(t.split("/*")[0].trim()):!1,GF=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Sa={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},cc={...Sa,transform:t=>ps(0,1,t)},cu={...Sa,default:1},vl=t=>Math.round(t*1e5)/1e5,Iy=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function JF(t){return t==null}const YF=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Py=(t,e)=>n=>!!(typeof n=="string"&&YF.test(n)&&n.startsWith(t)||e&&!JF(n)&&Object.prototype.hasOwnProperty.call(n,e)),k2=(t,e,n)=>r=>{if(typeof r!="string")return r;const[s,i,o,a]=r.match(Iy);return{[t]:parseFloat(s),[e]:parseFloat(i),[n]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},QF=t=>ps(0,255,t),up={...Sa,transform:t=>Math.round(QF(t))},Pi={test:Py("rgb","red"),parse:k2("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+up.transform(t)+", "+up.transform(e)+", "+up.transform(n)+", "+vl(cc.transform(r))+")"};function XF(t){let e="",n="",r="",s="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),s=t.substring(4,5),e+=e,n+=n,r+=r,s+=s),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const lg={test:Py("#"),parse:XF,transform:Pi.transform},_c=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),ks=_c("deg"),Lr=_c("%"),Ce=_c("px"),ZF=_c("vh"),eB=_c("vw"),Ax=(()=>({...Lr,parse:t=>Lr.parse(t)/100,transform:t=>Lr.transform(t*100)}))(),Fo={test:Py("hsl","hue"),parse:k2("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+Lr.transform(vl(e))+", "+Lr.transform(vl(n))+", "+vl(cc.transform(r))+")"},mt={test:t=>Pi.test(t)||lg.test(t)||Fo.test(t),parse:t=>Pi.test(t)?Pi.parse(t):Fo.test(t)?Fo.parse(t):lg.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Pi.transform(t):Fo.transform(t),getAnimatableNone:t=>{const e=mt.parse(t);return e.alpha=0,mt.transform(e)}},tB=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function nB(t){var e,n;return isNaN(t)&&typeof t=="string"&&(((e=t.match(Iy))==null?void 0:e.length)||0)+(((n=t.match(tB))==null?void 0:n.length)||0)>0}const S2="number",E2="color",rB="var",sB="var(",Ox="${}",iB=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function uc(t){const e=t.toString(),n=[],r={color:[],number:[],var:[]},s=[];let i=0;const a=e.replace(iB,l=>(mt.test(l)?(r.color.push(i),s.push(E2),n.push(mt.parse(l))):l.startsWith(sB)?(r.var.push(i),s.push(rB),n.push(l)):(r.number.push(i),s.push(S2),n.push(parseFloat(l))),++i,Ox)).split(Ox);return{values:n,split:a,indexes:r,types:s}}function C2(t){return uc(t).values}function T2(t){const{split:e,types:n}=uc(t),r=e.length;return s=>{let i="";for(let o=0;o<r;o++)if(i+=e[o],s[o]!==void 0){const a=n[o];a===S2?i+=vl(s[o]):a===E2?i+=mt.transform(s[o]):i+=s[o]}return i}}const oB=t=>typeof t=="number"?0:mt.test(t)?mt.getAnimatableNone(t):t;function aB(t){const e=C2(t);return T2(t)(e.map(oB))}const si={test:nB,parse:C2,createTransformer:T2,getAnimatableNone:aB};function dp(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function lB({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let s=0,i=0,o=0;if(!e)s=i=o=n;else{const a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;s=dp(l,a,t+1/3),i=dp(l,a,t),o=dp(l,a,t-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:r}}function ih(t,e){return n=>n>0?e:t}const nt=(t,e,n)=>t+(e-t)*n,hp=(t,e,n)=>{const r=t*t,s=n*(e*e-r)+r;return s<0?0:Math.sqrt(s)},cB=[lg,Pi,Fo],uB=t=>cB.find(e=>e.test(t));function Rx(t){const e=uB(t);if(!e)return!1;let n=e.parse(t);return e===Fo&&(n=lB(n)),n}const Nx=(t,e)=>{const n=Rx(t),r=Rx(e);if(!n||!r)return ih(t,e);const s={...n};return i=>(s.red=hp(n.red,r.red,i),s.green=hp(n.green,r.green,i),s.blue=hp(n.blue,r.blue,i),s.alpha=nt(n.alpha,r.alpha,i),Pi.transform(s))},cg=new Set(["none","hidden"]);function dB(t,e){return cg.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function hB(t,e){return n=>nt(t,e,n)}function My(t){return typeof t=="number"?hB:typeof t=="string"?Ny(t)?ih:mt.test(t)?Nx:mB:Array.isArray(t)?_2:typeof t=="object"?mt.test(t)?Nx:fB:ih}function _2(t,e){const n=[...t],r=n.length,s=t.map((i,o)=>My(i)(i,e[o]));return i=>{for(let o=0;o<r;o++)n[o]=s[o](i);return n}}function fB(t,e){const n={...t,...e},r={};for(const s in n)t[s]!==void 0&&e[s]!==void 0&&(r[s]=My(t[s])(t[s],e[s]));return s=>{for(const i in r)n[i]=r[i](s);return n}}function pB(t,e){const n=[],r={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const i=e.types[s],o=t.indexes[i][r[i]],a=t.values[o]??0;n[s]=a,r[i]++}return n}const mB=(t,e)=>{const n=si.createTransformer(e),r=uc(t),s=uc(e);return r.indexes.var.length===s.indexes.var.length&&r.indexes.color.length===s.indexes.color.length&&r.indexes.number.length>=s.indexes.number.length?cg.has(t)&&!s.values.length||cg.has(e)&&!r.values.length?dB(t,e):Cc(_2(pB(r,s),s.values),n):ih(t,e)};function A2(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?nt(t,e,n):My(t)(t,e)}const gB=t=>{const e=({timestamp:n})=>t(n);return{start:(n=!0)=>Qe.update(e,n),stop:()=>ri(e),now:()=>Ft.isProcessing?Ft.timestamp:wn.now()}},O2=(t,e,n=10)=>{let r="";const s=Math.max(Math.round(e/n),2);for(let i=0;i<s;i++)r+=Math.round(t(i/(s-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},oh=2e4;function Dy(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<oh;)e+=n,r=t.next(e);return e>=oh?1/0:e}function yB(t,e=100,n){const r=n({...t,keyframes:[0,e]}),s=Math.min(Dy(r),oh);return{type:"keyframes",ease:i=>r.next(s*i).value/e,duration:Zn(s)}}const vB=5;function R2(t,e,n){const r=Math.max(e-vB,0);return l2(n-t(r),e-r)}const ut={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},fp=.001;function wB({duration:t=ut.duration,bounce:e=ut.bounce,velocity:n=ut.velocity,mass:r=ut.mass}){let s,i,o=1-e;o=ps(ut.minDamping,ut.maxDamping,o),t=ps(ut.minDuration,ut.maxDuration,Zn(t)),o<1?(s=c=>{const u=c*o,d=u*t,h=u-n,f=ug(c,o),p=Math.exp(-d);return fp-h/f*p},i=c=>{const d=c*o*t,h=d*n+n,f=Math.pow(o,2)*Math.pow(c,2)*t,p=Math.exp(-d),g=ug(Math.pow(c,2),o);return(-s(c)+fp>0?-1:1)*((h-f)*p)/g}):(s=c=>{const u=Math.exp(-c*t),d=(c-n)*t+1;return-fp+u*d},i=c=>{const u=Math.exp(-c*t),d=(n-c)*(t*t);return u*d});const a=5/t,l=bB(s,i,a);if(t=jr(t),isNaN(l))return{stiffness:ut.stiffness,damping:ut.damping,duration:t};{const c=Math.pow(l,2)*r;return{stiffness:c,damping:o*2*Math.sqrt(r*c),duration:t}}}const xB=12;function bB(t,e,n){let r=n;for(let s=1;s<xB;s++)r=r-t(r)/e(r);return r}function ug(t,e){return t*Math.sqrt(1-e*e)}const kB=["duration","bounce"],SB=["stiffness","damping","mass"];function Ix(t,e){return e.some(n=>t[n]!==void 0)}function EB(t){let e={velocity:ut.velocity,stiffness:ut.stiffness,damping:ut.damping,mass:ut.mass,isResolvedFromDuration:!1,...t};if(!Ix(t,SB)&&Ix(t,kB))if(t.visualDuration){const n=t.visualDuration,r=2*Math.PI/(n*1.2),s=r*r,i=2*ps(.05,1,1-(t.bounce||0))*Math.sqrt(s);e={...e,mass:ut.mass,stiffness:s,damping:i}}else{const n=wB(t);e={...e,...n,mass:ut.mass},e.isResolvedFromDuration=!0}return e}function ah(t=ut.visualDuration,e=ut.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:r,restDelta:s}=n;const i=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],a={done:!1,value:i},{stiffness:l,damping:c,mass:u,duration:d,velocity:h,isResolvedFromDuration:f}=EB({...n,velocity:-Zn(n.velocity||0)}),p=h||0,g=c/(2*Math.sqrt(l*u)),y=o-i,m=Zn(Math.sqrt(l/u)),v=Math.abs(y)<5;r||(r=v?ut.restSpeed.granular:ut.restSpeed.default),s||(s=v?ut.restDelta.granular:ut.restDelta.default);let w;if(g<1){const T=ug(m,g);w=E=>{const O=Math.exp(-g*m*E);return o-O*((p+g*m*y)/T*Math.sin(T*E)+y*Math.cos(T*E))}}else if(g===1)w=T=>o-Math.exp(-m*T)*(y+(p+m*y)*T);else{const T=m*Math.sqrt(g*g-1);w=E=>{const O=Math.exp(-g*m*E),b=Math.min(T*E,300);return o-O*((p+g*m*y)*Math.sinh(b)+T*y*Math.cosh(b))/T}}const S={calculatedDuration:f&&d||null,next:T=>{const E=w(T);if(f)a.done=T>=d;else{let O=T===0?p:0;g<1&&(O=T===0?jr(p):R2(w,T,E));const b=Math.abs(O)<=r,k=Math.abs(o-E)<=s;a.done=b&&k}return a.value=a.done?o:E,a},toString:()=>{const T=Math.min(Dy(S),oh),E=O2(O=>S.next(T*O).value,T,30);return T+"ms "+E},toTransition:()=>{}};return S}ah.applyToOptions=t=>{const e=yB(t,100,ah);return t.ease=e.ease,t.duration=jr(e.duration),t.type="keyframes",t};function dg({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:o,min:a,max:l,restDelta:c=.5,restSpeed:u}){const d=t[0],h={done:!1,value:d},f=b=>a!==void 0&&b<a||l!==void 0&&b>l,p=b=>a===void 0?l:l===void 0||Math.abs(a-b)<Math.abs(l-b)?a:l;let g=n*e;const y=d+g,m=o===void 0?y:o(y);m!==y&&(g=m-d);const v=b=>-g*Math.exp(-b/r),w=b=>m+v(b),S=b=>{const k=v(b),N=w(b);h.done=Math.abs(k)<=c,h.value=h.done?m:N};let T,E;const O=b=>{f(h.value)&&(T=b,E=ah({keyframes:[h.value,p(h.value)],velocity:R2(w,b,h.value),damping:s,stiffness:i,restDelta:c,restSpeed:u}))};return O(0),{calculatedDuration:null,next:b=>{let k=!1;return!E&&T===void 0&&(k=!0,S(b),O(b)),T!==void 0&&b>=T?E.next(b-T):(!k&&S(b),h)}}}function CB(t,e,n){const r=[],s=n||ms.mix||A2,i=t.length-1;for(let o=0;o<i;o++){let a=s(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||sr:e;a=Cc(l,a)}r.push(a)}return r}function TB(t,e,{clamp:n=!0,ease:r,mixer:s}={}){const i=t.length;if(Ty(i===e.length),i===1)return()=>e[0];if(i===2&&e[0]===e[1])return()=>e[1];const o=t[0]===t[1];t[0]>t[i-1]&&(t=[...t].reverse(),e=[...e].reverse());const a=CB(e,r,s),l=a.length,c=u=>{if(o&&u<t[0])return e[0];let d=0;if(l>1)for(;d<t.length-2&&!(u<t[d+1]);d++);const h=lc(t[d],t[d+1],u);return a[d](h)};return n?u=>c(ps(t[0],t[i-1],u)):c}function _B(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const s=lc(0,e,r);t.push(nt(n,1,s))}}function AB(t){const e=[0];return _B(e,t.length-1),e}function OB(t,e){return t.map(n=>n*e)}function RB(t,e){return t.map(()=>e||y2).splice(0,t.length-1)}function wl({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const s=UF(r)?r.map(Tx):Tx(r),i={done:!1,value:e[0]},o=OB(n&&n.length===e.length?n:AB(e),t),a=TB(o,e,{ease:Array.isArray(s)?s:RB(e,s)});return{calculatedDuration:t,next:l=>(i.value=a(l),i.done=l>=t,i)}}const NB=t=>t!==null;function jy(t,{repeat:e,repeatType:n="loop"},r,s=1){const i=t.filter(NB),a=s<0||e&&n!=="loop"&&e%2===1?0:i.length-1;return!a||r===void 0?i[a]:r}const IB={decay:dg,inertia:dg,tween:wl,keyframes:wl,spring:ah};function N2(t){typeof t.type=="string"&&(t.type=IB[t.type])}class Ly{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,n){return this.finished.then(e,n)}}const PB=t=>t/100;class $y extends Ly{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var r,s;const{motionValue:n}=this.options;n&&n.updatedAt!==wn.now()&&this.tick(wn.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(s=(r=this.options).onStop)==null||s.call(r))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;N2(e);const{type:n=wl,repeat:r=0,repeatDelay:s=0,repeatType:i,velocity:o=0}=e;let{keyframes:a}=e;const l=n||wl;l!==wl&&typeof a[0]!="number"&&(this.mixKeyframes=Cc(PB,A2(a[0],a[1])),a=[0,100]);const c=l({...e,keyframes:a});i==="mirror"&&(this.mirroredGenerator=l({...e,keyframes:[...a].reverse(),velocity:-o})),c.calculatedDuration===null&&(c.calculatedDuration=Dy(c));const{calculatedDuration:u}=c;this.calculatedDuration=u,this.resolvedDuration=u+s,this.totalDuration=this.resolvedDuration*(r+1)-s,this.generator=c}updateTime(e){const n=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(e,n=!1){const{generator:r,totalDuration:s,mixKeyframes:i,mirroredGenerator:o,resolvedDuration:a,calculatedDuration:l}=this;if(this.startTime===null)return r.next(0);const{delay:c=0,keyframes:u,repeat:d,repeatType:h,repeatDelay:f,type:p,onUpdate:g,finalKeyframe:y}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-s/this.speed,this.startTime)),n?this.currentTime=e:this.updateTime(e);const m=this.currentTime-c*(this.playbackSpeed>=0?1:-1),v=this.playbackSpeed>=0?m<0:m>s;this.currentTime=Math.max(m,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let w=this.currentTime,S=r;if(d){const b=Math.min(this.currentTime,s)/a;let k=Math.floor(b),N=b%1;!N&&b>=1&&(N=1),N===1&&k--,k=Math.min(k,d+1),!!(k%2)&&(h==="reverse"?(N=1-N,f&&(N-=f/a)):h==="mirror"&&(S=o)),w=ps(0,1,N)*a}const T=v?{done:!1,value:u[0]}:S.next(w);i&&(T.value=i(T.value));let{done:E}=T;!v&&l!==null&&(E=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const O=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&E);return O&&p!==dg&&(T.value=jy(u,this.options,y,this.speed)),g&&g(T.value),O&&this.finish(),T}then(e,n){return this.finished.then(e,n)}get duration(){return Zn(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Zn(e)}get time(){return Zn(this.currentTime)}set time(e){var n;e=jr(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(n=this.driver)==null||n.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(wn.now());const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=Zn(this.currentTime))}play(){var s,i;if(this.isStopped)return;const{driver:e=gB,startTime:n}=this.options;this.driver||(this.driver=e(o=>this.tick(o))),(i=(s=this.options).onPlay)==null||i.call(s);const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=n??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(wn.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,n;this.notifyFinished(),this.teardown(),this.state="finished",(n=(e=this.options).onComplete)==null||n.call(e)}cancel(){var e,n;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(n=(e=this.options).onCancel)==null||n.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var n;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(n=this.driver)==null||n.stop(),e.observe(this)}}function MB(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const Mi=t=>t*180/Math.PI,hg=t=>{const e=Mi(Math.atan2(t[1],t[0]));return fg(e)},DB={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:hg,rotateZ:hg,skewX:t=>Mi(Math.atan(t[1])),skewY:t=>Mi(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},fg=t=>(t=t%360,t<0&&(t+=360),t),Px=hg,Mx=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),Dx=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),jB={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Mx,scaleY:Dx,scale:t=>(Mx(t)+Dx(t))/2,rotateX:t=>fg(Mi(Math.atan2(t[6],t[5]))),rotateY:t=>fg(Mi(Math.atan2(-t[2],t[0]))),rotateZ:Px,rotate:Px,skewX:t=>Mi(Math.atan(t[4])),skewY:t=>Mi(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function pg(t){return t.includes("scale")?1:0}function mg(t,e){if(!t||t==="none")return pg(e);const n=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,s;if(n)r=jB,s=n;else{const a=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=DB,s=a}if(!s)return pg(e);const i=r[e],o=s[1].split(",").map($B);return typeof i=="function"?i(o):o[i]}const LB=(t,e)=>{const{transform:n="none"}=getComputedStyle(t);return mg(n,e)};function $B(t){return parseFloat(t.trim())}const Ea=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Ca=(()=>new Set(Ea))(),jx=t=>t===Sa||t===Ce,FB=new Set(["x","y","z"]),BB=Ea.filter(t=>!FB.has(t));function UB(t){const e=[];return BB.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e}const Vi={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>mg(e,"x"),y:(t,{transform:e})=>mg(e,"y")};Vi.translateX=Vi.x;Vi.translateY=Vi.y;const Hi=new Set;let gg=!1,yg=!1,vg=!1;function I2(){if(yg){const t=Array.from(Hi).filter(r=>r.needsMeasurement),e=new Set(t.map(r=>r.element)),n=new Map;e.forEach(r=>{const s=UB(r);s.length&&(n.set(r,s),r.render())}),t.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const s=n.get(r);s&&s.forEach(([i,o])=>{var a;(a=r.getValue(i))==null||a.set(o)})}),t.forEach(r=>r.measureEndState()),t.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}yg=!1,gg=!1,Hi.forEach(t=>t.complete(vg)),Hi.clear()}function P2(){Hi.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(yg=!0)})}function zB(){vg=!0,P2(),I2(),vg=!1}class Fy{constructor(e,n,r,s,i,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=r,this.motionValue=s,this.element=i,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(Hi.add(this),gg||(gg=!0,Qe.read(P2),Qe.resolveKeyframes(I2))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:r,motionValue:s}=this;if(e[0]===null){const i=s==null?void 0:s.get(),o=e[e.length-1];if(i!==void 0)e[0]=i;else if(r&&n){const a=r.readValue(n,o);a!=null&&(e[0]=a)}e[0]===void 0&&(e[0]=o),s&&i===void 0&&s.set(e[0])}MB(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),Hi.delete(this)}cancel(){this.state==="scheduled"&&(Hi.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const VB=t=>t.startsWith("--");function HB(t,e,n){VB(e)?t.style.setProperty(e,n):t.style[e]=n}const WB=_y(()=>window.ScrollTimeline!==void 0),KB={};function qB(t,e){const n=_y(t);return()=>KB[e]??n()}const M2=qB(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Ja=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,Lx={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Ja([0,.65,.55,1]),circOut:Ja([.55,0,1,.45]),backIn:Ja([.31,.01,.66,-.59]),backOut:Ja([.33,1.53,.69,.99])};function D2(t,e){if(t)return typeof t=="function"?M2()?O2(t,e):"ease-out":v2(t)?Ja(t):Array.isArray(t)?t.map(n=>D2(n,e)||Lx.easeOut):Lx[t]}function GB(t,e,n,{delay:r=0,duration:s=300,repeat:i=0,repeatType:o="loop",ease:a="easeOut",times:l}={},c=void 0){const u={[e]:n};l&&(u.offset=l);const d=D2(a,s);Array.isArray(d)&&(u.easing=d);const h={delay:r,duration:s,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"};return c&&(h.pseudoElement=c),t.animate(u,h)}function j2(t){return typeof t=="function"&&"applyToOptions"in t}function JB({type:t,...e}){return j2(t)&&M2()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class YB extends Ly{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:n,name:r,keyframes:s,pseudoElement:i,allowFlatten:o=!1,finalKeyframe:a,onComplete:l}=e;this.isPseudoElement=!!i,this.allowFlatten=o,this.options=e,Ty(typeof e.type!="string");const c=JB(e);this.animation=GB(n,r,s,c,i),c.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const u=jy(s,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(u):HB(n,r,u),this.animation.cancel()}l==null||l(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,n;(n=(e=this.animation).finish)==null||n.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,n;this.isPseudoElement||(n=(e=this.animation).commitStyles)==null||n.call(e)}get duration(){var n,r;const e=((r=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:r.call(n).duration)||0;return Zn(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Zn(e)}get time(){return Zn(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=jr(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:n}){var r;return this.allowFlatten&&((r=this.animation.effect)==null||r.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&WB()?(this.animation.timeline=e,sr):n(this)}}const L2={anticipate:p2,backInOut:f2,circInOut:g2};function QB(t){return t in L2}function XB(t){typeof t.ease=="string"&&QB(t.ease)&&(t.ease=L2[t.ease])}const $x=10;class ZB extends YB{constructor(e){XB(e),N2(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:n,onUpdate:r,onComplete:s,element:i,...o}=this.options;if(!n)return;if(e!==void 0){n.set(e);return}const a=new $y({...o,autoplay:!1}),l=jr(this.finishedTime??this.time);n.setWithVelocity(a.sample(l-$x).value,a.sample(l).value,$x),a.stop()}}const Fx=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(si.test(t)||t==="0")&&!t.startsWith("url("));function eU(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function tU(t,e,n,r){const s=t[0];if(s===null)return!1;if(e==="display"||e==="visibility")return!0;const i=t[t.length-1],o=Fx(s,e),a=Fx(i,e);return!o||!a?!1:eU(t)||(n==="spring"||j2(n))&&r}function wg(t){t.duration=0,t.type="keyframes"}const nU=new Set(["opacity","clipPath","filter","transform"]),rU=_y(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function sU(t){var u;const{motionValue:e,name:n,repeatDelay:r,repeatType:s,damping:i,type:o}=t;if(!(((u=e==null?void 0:e.owner)==null?void 0:u.current)instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=e.owner.getProps();return rU()&&n&&nU.has(n)&&(n!=="transform"||!c)&&!l&&!r&&s!=="mirror"&&i!==0&&o!=="inertia"}const iU=40;class oU extends Ly{constructor({autoplay:e=!0,delay:n=0,type:r="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:o="loop",keyframes:a,name:l,motionValue:c,element:u,...d}){var p;super(),this.stop=()=>{var g,y;this._animation&&(this._animation.stop(),(g=this.stopTimeline)==null||g.call(this)),(y=this.keyframeResolver)==null||y.cancel()},this.createdAt=wn.now();const h={autoplay:e,delay:n,type:r,repeat:s,repeatDelay:i,repeatType:o,name:l,motionValue:c,element:u,...d},f=(u==null?void 0:u.KeyframeResolver)||Fy;this.keyframeResolver=new f(a,(g,y,m)=>this.onKeyframesResolved(g,y,h,!m),l,c,u),(p=this.keyframeResolver)==null||p.scheduleResolve()}onKeyframesResolved(e,n,r,s){this.keyframeResolver=void 0;const{name:i,type:o,velocity:a,delay:l,isHandoff:c,onUpdate:u}=r;this.resolvedAt=wn.now(),tU(e,i,o,a)||((ms.instantAnimations||!l)&&(u==null||u(jy(e,r,n))),e[0]=e[e.length-1],wg(r),r.repeat=0);const h={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>iU?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...r,keyframes:e},f=!c&&sU(h)?new ZB({...h,element:h.motionValue.owner.current}):new $y(h);f.finished.then(()=>this.notifyFinished()).catch(sr),this.pendingTimeline&&(this.stopTimeline=f.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=f}get finished(){return this._animation?this.animation.finished:this._finished}then(e,n){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),zB()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const aU=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function lU(t){const e=aU.exec(t);if(!e)return[,];const[,n,r,s]=e;return[`--${n??r}`,s]}function $2(t,e,n=1){const[r,s]=lU(t);if(!r)return;const i=window.getComputedStyle(e).getPropertyValue(r);if(i){const o=i.trim();return i2(o)?parseFloat(o):o}return Ny(s)?$2(s,e,n+1):s}function By(t,e){return(t==null?void 0:t[e])??(t==null?void 0:t.default)??t}const F2=new Set(["width","height","top","left","right","bottom",...Ea]),cU={test:t=>t==="auto",parse:t=>t},B2=t=>e=>e.test(t),U2=[Sa,Ce,Lr,ks,eB,ZF,cU],Bx=t=>U2.find(B2(t));function uU(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||a2(t):!0}const dU=new Set(["brightness","contrast","saturate","opacity"]);function hU(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(Iy)||[];if(!r)return t;const s=n.replace(r,"");let i=dU.has(e)?1:0;return r!==n&&(i*=100),e+"("+i+s+")"}const fU=/\b([a-z-]*)\(.*?\)/gu,xg={...si,getAnimatableNone:t=>{const e=t.match(fU);return e?e.map(hU).join(" "):t}},Ux={...Sa,transform:Math.round},pU={rotate:ks,rotateX:ks,rotateY:ks,rotateZ:ks,scale:cu,scaleX:cu,scaleY:cu,scaleZ:cu,skew:ks,skewX:ks,skewY:ks,distance:Ce,translateX:Ce,translateY:Ce,translateZ:Ce,x:Ce,y:Ce,z:Ce,perspective:Ce,transformPerspective:Ce,opacity:cc,originX:Ax,originY:Ax,originZ:Ce},Uy={borderWidth:Ce,borderTopWidth:Ce,borderRightWidth:Ce,borderBottomWidth:Ce,borderLeftWidth:Ce,borderRadius:Ce,radius:Ce,borderTopLeftRadius:Ce,borderTopRightRadius:Ce,borderBottomRightRadius:Ce,borderBottomLeftRadius:Ce,width:Ce,maxWidth:Ce,height:Ce,maxHeight:Ce,top:Ce,right:Ce,bottom:Ce,left:Ce,padding:Ce,paddingTop:Ce,paddingRight:Ce,paddingBottom:Ce,paddingLeft:Ce,margin:Ce,marginTop:Ce,marginRight:Ce,marginBottom:Ce,marginLeft:Ce,backgroundPositionX:Ce,backgroundPositionY:Ce,...pU,zIndex:Ux,fillOpacity:cc,strokeOpacity:cc,numOctaves:Ux},mU={...Uy,color:mt,backgroundColor:mt,outlineColor:mt,fill:mt,stroke:mt,borderColor:mt,borderTopColor:mt,borderRightColor:mt,borderBottomColor:mt,borderLeftColor:mt,filter:xg,WebkitFilter:xg},z2=t=>mU[t];function V2(t,e){let n=z2(t);return n!==xg&&(n=si),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const gU=new Set(["auto","none","0"]);function yU(t,e,n){let r=0,s;for(;r<t.length&&!s;){const i=t[r];typeof i=="string"&&!gU.has(i)&&uc(i).values.length&&(s=t[r]),r++}if(s&&n)for(const i of e)t[i]=V2(n,s)}class vU extends Fy{constructor(e,n,r,s,i){super(e,n,r,s,i,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),Ny(c))){const u=$2(c,n.current);u!==void 0&&(e[l]=u),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!F2.has(r)||e.length!==2)return;const[s,i]=e,o=Bx(s),a=Bx(i);if(o!==a)if(jx(o)&&jx(a))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else Vi[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,r=[];for(let s=0;s<e.length;s++)(e[s]===null||uU(e[s]))&&r.push(s);r.length&&yU(e,r,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Vi[r](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const s=n[n.length-1];s!==void 0&&e.getValue(r,s).jump(s,!1)}measureEndState(){var a;const{element:e,name:n,unresolvedKeyframes:r}=this;if(!e||!e.current)return;const s=e.getValue(n);s&&s.jump(this.measuredOrigin,!1);const i=r.length-1,o=r[i];r[i]=Vi[n](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),(a=this.removedTransforms)!=null&&a.length&&this.removedTransforms.forEach(([l,c])=>{e.getValue(l).set(c)}),this.resolveNoneKeyframes()}}function wU(t,e,n){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let r=document;e&&(r=e.current);const s=(n==null?void 0:n[t])??r.querySelectorAll(t);return s?Array.from(s):[]}return Array.from(t)}const H2=(t,e)=>e&&typeof t=="number"?e.transform(t):t;function xU(t){return o2(t)&&"offsetHeight"in t}const zx=30,bU=t=>!isNaN(parseFloat(t));class kU{constructor(e,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{var i;const s=wn.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&((i=this.events.change)==null||i.notify(this.current),this.dependents))for(const o of this.dependents)o.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=wn.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=bU(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new Ay);const r=this.events[e].add(n);return e==="change"?()=>{r(),Qe.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=wn.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>zx)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,zx);return l2(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,n;(e=this.dependents)==null||e.clear(),(n=this.events.destroy)==null||n.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function pa(t,e){return new kU(t,e)}const{schedule:zy,cancel:SV}=w2(queueMicrotask,!1),mr={x:!1,y:!1};function W2(){return mr.x||mr.y}function SU(t){return t==="x"||t==="y"?mr[t]?null:(mr[t]=!0,()=>{mr[t]=!1}):mr.x||mr.y?null:(mr.x=mr.y=!0,()=>{mr.x=mr.y=!1})}function K2(t,e){const n=wU(t),r=new AbortController,s={passive:!0,...e,signal:r.signal};return[n,s,()=>r.abort()]}function Vx(t){return!(t.pointerType==="touch"||W2())}function EU(t,e,n={}){const[r,s,i]=K2(t,n),o=a=>{if(!Vx(a))return;const{target:l}=a,c=e(l,a);if(typeof c!="function"||!l)return;const u=d=>{Vx(d)&&(c(d),l.removeEventListener("pointerleave",u))};l.addEventListener("pointerleave",u,s)};return r.forEach(a=>{a.addEventListener("pointerenter",o,s)}),i}const q2=(t,e)=>e?t===e?!0:q2(t,e.parentElement):!1,Vy=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,CU=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function TU(t){return CU.has(t.tagName)||t.tabIndex!==-1}const Du=new WeakSet;function Hx(t){return e=>{e.key==="Enter"&&t(e)}}function pp(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const _U=(t,e)=>{const n=t.currentTarget;if(!n)return;const r=Hx(()=>{if(Du.has(n))return;pp(n,"down");const s=Hx(()=>{pp(n,"up")}),i=()=>pp(n,"cancel");n.addEventListener("keyup",s,e),n.addEventListener("blur",i,e)});n.addEventListener("keydown",r,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),e)};function Wx(t){return Vy(t)&&!W2()}function AU(t,e,n={}){const[r,s,i]=K2(t,n),o=a=>{const l=a.currentTarget;if(!Wx(a))return;Du.add(l);const c=e(l,a),u=(f,p)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",h),Du.has(l)&&Du.delete(l),Wx(f)&&typeof c=="function"&&c(f,{success:p})},d=f=>{u(f,l===window||l===document||n.useGlobalTarget||q2(l,f.target))},h=f=>{u(f,!1)};window.addEventListener("pointerup",d,s),window.addEventListener("pointercancel",h,s)};return r.forEach(a=>{(n.useGlobalTarget?window:a).addEventListener("pointerdown",o,s),xU(a)&&(a.addEventListener("focus",c=>_U(c,s)),!TU(a)&&!a.hasAttribute("tabindex")&&(a.tabIndex=0))}),i}function G2(t){return o2(t)&&"ownerSVGElement"in t}function OU(t){return G2(t)&&t.tagName==="svg"}const Yt=t=>!!(t&&t.getVelocity),RU=[...U2,mt,si],NU=t=>RU.find(B2(t)),J2=A.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function IU(t=!0){const e=A.useContext(Sy);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:s}=e,i=A.useId();A.useEffect(()=>{if(t)return s(i)},[t]);const o=A.useCallback(()=>t&&r&&r(i),[i,r,t]);return!n&&r?[!1,o]:[!0]}const Y2=A.createContext({strict:!1}),Kx={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},ma={};for(const t in Kx)ma[t]={isEnabled:e=>Kx[t].some(n=>!!e[n])};function PU(t){for(const e in t)ma[e]={...ma[e],...t[e]}}const MU=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function lh(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||MU.has(t)}let Q2=t=>!lh(t);function DU(t){typeof t=="function"&&(Q2=e=>e.startsWith("on")?!lh(e):t(e))}try{DU(require("@emotion/is-prop-valid").default)}catch{}function jU(t,e,n){const r={};for(const s in t)s==="values"&&typeof t.values=="object"||(Q2(s)||n===!0&&lh(s)||!e&&!lh(s)||t.draggable&&s.startsWith("onDrag"))&&(r[s]=t[s]);return r}const Gh=A.createContext({});function Jh(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function dc(t){return typeof t=="string"||Array.isArray(t)}const Hy=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Wy=["initial",...Hy];function Yh(t){return Jh(t.animate)||Wy.some(e=>dc(t[e]))}function X2(t){return!!(Yh(t)||t.variants)}function LU(t,e){if(Yh(t)){const{initial:n,animate:r}=t;return{initial:n===!1||dc(n)?n:void 0,animate:dc(r)?r:void 0}}return t.inherit!==!1?e:{}}function $U(t){const{initial:e,animate:n}=LU(t,A.useContext(Gh));return A.useMemo(()=>({initial:e,animate:n}),[qx(e),qx(n)])}function qx(t){return Array.isArray(t)?t.join(" "):t}function Gx(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const $a={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Ce.test(t))t=parseFloat(t);else return t;const n=Gx(t,e.target.x),r=Gx(t,e.target.y);return`${n}% ${r}%`}},FU={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,s=si.parse(t);if(s.length>5)return r;const i=si.createTransformer(t),o=typeof s[0]!="number"?1:0,a=n.x.scale*e.x,l=n.y.scale*e.y;s[0+o]/=a,s[1+o]/=l;const c=nt(a,l,.5);return typeof s[2+o]=="number"&&(s[2+o]/=c),typeof s[3+o]=="number"&&(s[3+o]/=c),i(s)}},bg={borderRadius:{...$a,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:$a,borderTopRightRadius:$a,borderBottomLeftRadius:$a,borderBottomRightRadius:$a,boxShadow:FU};function Z2(t,{layout:e,layoutId:n}){return Ca.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!bg[t]||t==="opacity")}const BU={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},UU=Ea.length;function zU(t,e,n){let r="",s=!0;for(let i=0;i<UU;i++){const o=Ea[i],a=t[o];if(a===void 0)continue;let l=!0;if(typeof a=="number"?l=a===(o.startsWith("scale")?1:0):l=parseFloat(a)===0,!l||n){const c=H2(a,Uy[o]);if(!l){s=!1;const u=BU[o]||o;r+=`${u}(${c}) `}n&&(e[o]=c)}}return r=r.trim(),n?r=n(e,s?"":r):s&&(r="none"),r}function Ky(t,e,n){const{style:r,vars:s,transformOrigin:i}=t;let o=!1,a=!1;for(const l in e){const c=e[l];if(Ca.has(l)){o=!0;continue}else if(b2(l)){s[l]=c;continue}else{const u=H2(c,Uy[l]);l.startsWith("origin")?(a=!0,i[l]=u):r[l]=u}}if(e.transform||(o||n?r.transform=zU(e,t.transform,n):r.transform&&(r.transform="none")),a){const{originX:l="50%",originY:c="50%",originZ:u=0}=i;r.transformOrigin=`${l} ${c} ${u}`}}const qy=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function e_(t,e,n){for(const r in e)!Yt(e[r])&&!Z2(r,n)&&(t[r]=e[r])}function VU({transformTemplate:t},e){return A.useMemo(()=>{const n=qy();return Ky(n,e,t),Object.assign({},n.vars,n.style)},[e])}function HU(t,e){const n=t.style||{},r={};return e_(r,n,t),Object.assign(r,VU(t,e)),r}function WU(t,e){const n={},r=HU(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=r,n}const KU={offset:"stroke-dashoffset",array:"stroke-dasharray"},qU={offset:"strokeDashoffset",array:"strokeDasharray"};function GU(t,e,n=1,r=0,s=!0){t.pathLength=1;const i=s?KU:qU;t[i.offset]=Ce.transform(-r);const o=Ce.transform(e),a=Ce.transform(n);t[i.array]=`${o} ${a}`}function t_(t,{attrX:e,attrY:n,attrScale:r,pathLength:s,pathSpacing:i=1,pathOffset:o=0,...a},l,c,u){if(Ky(t,a,c),l){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:d,style:h}=t;d.transform&&(h.transform=d.transform,delete d.transform),(h.transform||d.transformOrigin)&&(h.transformOrigin=d.transformOrigin??"50% 50%",delete d.transformOrigin),h.transform&&(h.transformBox=(u==null?void 0:u.transformBox)??"fill-box",delete d.transformBox),e!==void 0&&(d.x=e),n!==void 0&&(d.y=n),r!==void 0&&(d.scale=r),s!==void 0&&GU(d,s,i,o,!1)}const n_=()=>({...qy(),attrs:{}}),r_=t=>typeof t=="string"&&t.toLowerCase()==="svg";function JU(t,e,n,r){const s=A.useMemo(()=>{const i=n_();return t_(i,e,r_(r),t.transformTemplate,t.style),{...i.attrs,style:{...i.style}}},[e]);if(t.style){const i={};e_(i,t.style,t),s.style={...i,...s.style}}return s}const YU=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Gy(t){return typeof t!="string"||t.includes("-")?!1:!!(YU.indexOf(t)>-1||/[A-Z]/u.test(t))}function QU(t,e,n,{latestValues:r},s,i=!1){const a=(Gy(t)?JU:WU)(e,r,s,t),l=jU(e,typeof t=="string",i),c=t!==A.Fragment?{...l,...a,ref:n}:{},{children:u}=e,d=A.useMemo(()=>Yt(u)?u.get():u,[u]);return A.createElement(t,{...c,children:d})}function Jx(t){const e=[{},{}];return t==null||t.values.forEach((n,r)=>{e[0][r]=n.get(),e[1][r]=n.getVelocity()}),e}function Jy(t,e,n,r){if(typeof e=="function"){const[s,i]=Jx(r);e=e(n!==void 0?n:t.custom,s,i)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[s,i]=Jx(r);e=e(n!==void 0?n:t.custom,s,i)}return e}function ju(t){return Yt(t)?t.get():t}function XU({scrapeMotionValuesFromProps:t,createRenderState:e},n,r,s){return{latestValues:ZU(n,r,s,t),renderState:e()}}function ZU(t,e,n,r){const s={},i=r(t,{});for(const h in i)s[h]=ju(i[h]);let{initial:o,animate:a}=t;const l=Yh(t),c=X2(t);e&&c&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let u=n?n.initial===!1:!1;u=u||o===!1;const d=u?a:o;if(d&&typeof d!="boolean"&&!Jh(d)){const h=Array.isArray(d)?d:[d];for(let f=0;f<h.length;f++){const p=Jy(t,h[f]);if(p){const{transitionEnd:g,transition:y,...m}=p;for(const v in m){let w=m[v];if(Array.isArray(w)){const S=u?w.length-1:0;w=w[S]}w!==null&&(s[v]=w)}for(const v in g)s[v]=g[v]}}}return s}const s_=t=>(e,n)=>{const r=A.useContext(Gh),s=A.useContext(Sy),i=()=>XU(t,e,r,s);return n?i():PF(i)};function Yy(t,e,n){var i;const{style:r}=t,s={};for(const o in r)(Yt(r[o])||e.style&&Yt(e.style[o])||Z2(o,t)||((i=n==null?void 0:n.getValue(o))==null?void 0:i.liveStyle)!==void 0)&&(s[o]=r[o]);return s}const e6=s_({scrapeMotionValuesFromProps:Yy,createRenderState:qy});function i_(t,e,n){const r=Yy(t,e,n);for(const s in t)if(Yt(t[s])||Yt(e[s])){const i=Ea.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;r[i]=t[s]}return r}const t6=s_({scrapeMotionValuesFromProps:i_,createRenderState:n_}),n6=Symbol.for("motionComponentSymbol");function Bo(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function r6(t,e,n){return A.useCallback(r=>{r&&t.onMount&&t.onMount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):Bo(n)&&(n.current=r))},[e])}const Qy=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),s6="framerAppearId",o_="data-"+Qy(s6),a_=A.createContext({});function i6(t,e,n,r,s){var g,y;const{visualElement:i}=A.useContext(Gh),o=A.useContext(Y2),a=A.useContext(Sy),l=A.useContext(J2).reducedMotion,c=A.useRef(null);r=r||o.renderer,!c.current&&r&&(c.current=r(t,{visualState:e,parent:i,props:n,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:l}));const u=c.current,d=A.useContext(a_);u&&!u.projection&&s&&(u.type==="html"||u.type==="svg")&&o6(c.current,n,s,d);const h=A.useRef(!1);A.useInsertionEffect(()=>{u&&h.current&&u.update(n,a)});const f=n[o_],p=A.useRef(!!f&&!((g=window.MotionHandoffIsComplete)!=null&&g.call(window,f))&&((y=window.MotionHasOptimisedAnimation)==null?void 0:y.call(window,f)));return MF(()=>{u&&(h.current=!0,window.MotionIsMounted=!0,u.updateFeatures(),u.scheduleRenderMicrotask(),p.current&&u.animationState&&u.animationState.animateChanges())}),A.useEffect(()=>{u&&(!p.current&&u.animationState&&u.animationState.animateChanges(),p.current&&(queueMicrotask(()=>{var m;(m=window.MotionHandoffMarkAsComplete)==null||m.call(window,f)}),p.current=!1),u.enteringChildren=void 0)}),u}function o6(t,e,n,r){const{layoutId:s,layout:i,drag:o,dragConstraints:a,layoutScroll:l,layoutRoot:c,layoutCrossfade:u}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:l_(t.parent)),t.projection.setOptions({layoutId:s,layout:i,alwaysMeasureLayout:!!o||a&&Bo(a),visualElement:t,animationType:typeof i=="string"?i:"both",initialPromotionConfig:r,crossfade:u,layoutScroll:l,layoutRoot:c})}function l_(t){if(t)return t.options.allowProjection!==!1?t.projection:l_(t.parent)}function mp(t,{forwardMotionProps:e=!1}={},n,r){n&&PU(n);const s=Gy(t)?t6:e6;function i(a,l){let c;const u={...A.useContext(J2),...a,layoutId:a6(a)},{isStatic:d}=u,h=$U(a),f=s(a,d);if(!d&&ky){l6();const p=c6(u);c=p.MeasureLayout,h.visualElement=i6(t,f,u,r,p.ProjectionNode)}return x.jsxs(Gh.Provider,{value:h,children:[c&&h.visualElement?x.jsx(c,{visualElement:h.visualElement,...u}):null,QU(t,a,r6(f,h.visualElement,l),f,d,e)]})}i.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const o=A.forwardRef(i);return o[n6]=t,o}function a6({layoutId:t}){const e=A.useContext(s2).id;return e&&t!==void 0?e+"-"+t:t}function l6(t,e){A.useContext(Y2).strict}function c6(t){const{drag:e,layout:n}=ma;if(!e&&!n)return{};const r={...e,...n};return{MeasureLayout:e!=null&&e.isEnabled(t)||n!=null&&n.isEnabled(t)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function u6(t,e){if(typeof Proxy>"u")return mp;const n=new Map,r=(i,o)=>mp(i,o,t,e),s=(i,o)=>r(i,o);return new Proxy(s,{get:(i,o)=>o==="create"?r:(n.has(o)||n.set(o,mp(o,void 0,t,e)),n.get(o))})}function c_({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function d6({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function h6(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function gp(t){return t===void 0||t===1}function kg({scale:t,scaleX:e,scaleY:n}){return!gp(t)||!gp(e)||!gp(n)}function wi(t){return kg(t)||u_(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function u_(t){return Yx(t.x)||Yx(t.y)}function Yx(t){return t&&t!=="0%"}function ch(t,e,n){const r=t-n,s=e*r;return n+s}function Qx(t,e,n,r,s){return s!==void 0&&(t=ch(t,s,r)),ch(t,n,r)+e}function Sg(t,e=0,n=1,r,s){t.min=Qx(t.min,e,n,r,s),t.max=Qx(t.max,e,n,r,s)}function d_(t,{x:e,y:n}){Sg(t.x,e.translate,e.scale,e.originPoint),Sg(t.y,n.translate,n.scale,n.originPoint)}const Xx=.999999999999,Zx=1.0000000000001;function f6(t,e,n,r=!1){const s=n.length;if(!s)return;e.x=e.y=1;let i,o;for(let a=0;a<s;a++){i=n[a],o=i.projectionDelta;const{visualElement:l}=i.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&zo(t,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,d_(t,o)),r&&wi(i.latestValues)&&zo(t,i.latestValues))}e.x<Zx&&e.x>Xx&&(e.x=1),e.y<Zx&&e.y>Xx&&(e.y=1)}function Uo(t,e){t.min=t.min+e,t.max=t.max+e}function eb(t,e,n,r,s=.5){const i=nt(t.min,t.max,s);Sg(t,e,n,i,r)}function zo(t,e){eb(t.x,e.x,e.scaleX,e.scale,e.originX),eb(t.y,e.y,e.scaleY,e.scale,e.originY)}function h_(t,e){return c_(h6(t.getBoundingClientRect(),e))}function p6(t,e,n){const r=h_(t,n),{scroll:s}=e;return s&&(Uo(r.x,s.offset.x),Uo(r.y,s.offset.y)),r}const tb=()=>({translate:0,scale:1,origin:0,originPoint:0}),Vo=()=>({x:tb(),y:tb()}),nb=()=>({min:0,max:0}),xt=()=>({x:nb(),y:nb()}),Eg={current:null},f_={current:!1};function m6(){if(f_.current=!0,!!ky)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>Eg.current=t.matches;t.addEventListener("change",e),e()}else Eg.current=!1}const g6=new WeakMap;function y6(t,e,n){for(const r in e){const s=e[r],i=n[r];if(Yt(s))t.addValue(r,s);else if(Yt(i))t.addValue(r,pa(s,{owner:t}));else if(i!==s)if(t.hasValue(r)){const o=t.getValue(r);o.liveStyle===!0?o.jump(s):o.hasAnimated||o.set(s)}else{const o=t.getStaticValue(r);t.addValue(r,pa(o!==void 0?o:s,{owner:t}))}}for(const r in n)e[r]===void 0&&t.removeValue(r);return e}const rb=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class v6{scrapeMotionValuesFromProps(e,n,r){return{}}constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:s,blockInitialAnimation:i,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Fy,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=wn.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,Qe.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=o;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=a,this.blockInitialAnimation=!!i,this.isControllingVariants=Yh(n),this.isVariantNode=X2(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(n,{},this);for(const h in d){const f=d[h];l[h]!==void 0&&Yt(f)&&f.set(l[h])}}mount(e){var n;this.current=e,g6.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,s)=>this.bindToMotionValue(s,r)),f_.current||m6(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Eg.current,(n=this.parent)==null||n.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),ri(this.notifyUpdate),ri(this.render),this.valueSubscriptions.forEach(n=>n()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(e=this.parent)==null||e.removeChild(this);for(const n in this.events)this.events[n].clear();for(const n in this.features){const r=this.features[n];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=Ca.has(e);r&&this.onBindTransform&&this.onBindTransform();const s=n.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&Qe.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let i;window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{s(),i&&i(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in ma){const n=ma[e];if(!n)continue;const{isEnabled:r,Feature:s}=n;if(!this.features[e]&&s&&r(this.props)&&(this.features[e]=new s(this)),this.features[e]){const i=this.features[e];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):xt()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<rb.length;r++){const s=rb[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i="on"+s,o=e[i];o&&(this.propEventSubscriptions[s]=this.on(s,o))}this.prevMotionValues=y6(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const r=this.values.get(e);n!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=pa(n===null?void 0:n,{owner:this}),this.addValue(e,r)),r}readValue(e,n){let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(i2(r)||a2(r))?r=parseFloat(r):!NU(r)&&si.test(n)&&(r=V2(e,n)),this.setBaseTarget(e,Yt(r)?r.get():r)),Yt(r)?r.get():r}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var i;const{initial:n}=this.props;let r;if(typeof n=="string"||typeof n=="object"){const o=Jy(this.props,n,(i=this.presenceContext)==null?void 0:i.custom);o&&(r=o[e])}if(n&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!Yt(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new Ay),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}scheduleRenderMicrotask(){zy.render(this.render)}}class p_ extends v6{constructor(){super(...arguments),this.KeyframeResolver=vU}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Yt(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function m_(t,{style:e,vars:n},r,s){const i=t.style;let o;for(o in e)i[o]=e[o];s==null||s.applyProjectionStyles(i,r);for(o in n)i.setProperty(o,n[o])}function w6(t){return window.getComputedStyle(t)}class x6 extends p_{constructor(){super(...arguments),this.type="html",this.renderInstance=m_}readValueFromInstance(e,n){var r;if(Ca.has(n))return(r=this.projection)!=null&&r.isProjecting?pg(n):LB(e,n);{const s=w6(e),i=(b2(n)?s.getPropertyValue(n):s[n])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:n}){return h_(e,n)}build(e,n,r){Ky(e,n,r.transformTemplate)}scrapeMotionValuesFromProps(e,n,r){return Yy(e,n,r)}}const g_=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function b6(t,e,n,r){m_(t,e,void 0,r);for(const s in e.attrs)t.setAttribute(g_.has(s)?s:Qy(s),e.attrs[s])}class k6 extends p_{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=xt}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(Ca.has(n)){const r=z2(n);return r&&r.default||0}return n=g_.has(n)?n:Qy(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,r){return i_(e,n,r)}build(e,n,r){t_(e,n,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,n,r,s){b6(e,n,r,s)}mount(e){this.isSVGTag=r_(e.tagName),super.mount(e)}}const S6=(t,e)=>Gy(t)?new k6(e):new x6(e,{allowProjection:t!==A.Fragment});function ea(t,e,n){const r=t.getProps();return Jy(r,e,n!==void 0?n:r.custom,t)}const Cg=t=>Array.isArray(t);function E6(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,pa(n))}function C6(t){return Cg(t)?t[t.length-1]||0:t}function T6(t,e){const n=ea(t,e);let{transitionEnd:r={},transition:s={},...i}=n||{};i={...i,...r};for(const o in i){const a=C6(i[o]);E6(t,o,a)}}function _6(t){return!!(Yt(t)&&t.add)}function Tg(t,e){const n=t.getValue("willChange");if(_6(n))return n.add(e);if(!n&&ms.WillChange){const r=new ms.WillChange("auto");t.addValue("willChange",r),r.add(e)}}function y_(t){return t.props[o_]}const A6=t=>t!==null;function O6(t,{repeat:e,repeatType:n="loop"},r){const s=t.filter(A6),i=e&&n!=="loop"&&e%2===1?0:s.length-1;return!i||r===void 0?s[i]:r}const R6={type:"spring",stiffness:500,damping:25,restSpeed:10},N6=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),I6={type:"keyframes",duration:.8},P6={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},M6=(t,{keyframes:e})=>e.length>2?I6:Ca.has(t)?t.startsWith("scale")?N6(e[1]):R6:P6;function D6({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:s,repeat:i,repeatType:o,repeatDelay:a,from:l,elapsed:c,...u}){return!!Object.keys(u).length}const Xy=(t,e,n,r={},s,i)=>o=>{const a=By(r,t)||{},l=a.delay||r.delay||0;let{elapsed:c=0}=r;c=c-jr(l);const u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-c,onUpdate:h=>{e.set(h),a.onUpdate&&a.onUpdate(h)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:t,motionValue:e,element:i?void 0:s};D6(a)||Object.assign(u,M6(t,u)),u.duration&&(u.duration=jr(u.duration)),u.repeatDelay&&(u.repeatDelay=jr(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let d=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(wg(u),u.delay===0&&(d=!0)),(ms.instantAnimations||ms.skipAnimations)&&(d=!0,wg(u),u.delay=0),u.allowFlatten=!a.type&&!a.ease,d&&!i&&e.get()!==void 0){const h=O6(u.keyframes,a);if(h!==void 0){Qe.update(()=>{u.onUpdate(h),u.onComplete()});return}}return a.isSync?new $y(u):new oU(u)};function j6({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function v_(t,e,{delay:n=0,transitionOverride:r,type:s}={}){let{transition:i=t.getDefaultTransition(),transitionEnd:o,...a}=e;r&&(i=r);const l=[],c=s&&t.animationState&&t.animationState.getState()[s];for(const u in a){const d=t.getValue(u,t.latestValues[u]??null),h=a[u];if(h===void 0||c&&j6(c,u))continue;const f={delay:n,...By(i||{},u)},p=d.get();if(p!==void 0&&!d.isAnimating&&!Array.isArray(h)&&h===p&&!f.velocity)continue;let g=!1;if(window.MotionHandoffAnimation){const m=y_(t);if(m){const v=window.MotionHandoffAnimation(m,u,Qe);v!==null&&(f.startTime=v,g=!0)}}Tg(t,u),d.start(Xy(u,d,h,t.shouldReduceMotion&&F2.has(u)?{type:!1}:f,t,g));const y=d.animation;y&&l.push(y)}return o&&Promise.all(l).then(()=>{Qe.update(()=>{o&&T6(t,o)})}),l}function w_(t,e,n,r=0,s=1){const i=Array.from(t).sort((c,u)=>c.sortNodePosition(u)).indexOf(e),o=t.size,a=(o-1)*r;return typeof n=="function"?n(i,o):s===1?i*r:a-i*r}function _g(t,e,n={}){var l;const r=ea(t,e,n.type==="exit"?(l=t.presenceContext)==null?void 0:l.custom:void 0);let{transition:s=t.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(s=n.transitionOverride);const i=r?()=>Promise.all(v_(t,r,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:h}=s;return L6(t,e,c,u,d,h,n)}:()=>Promise.resolve(),{when:a}=s;if(a){const[c,u]=a==="beforeChildren"?[i,o]:[o,i];return c().then(()=>u())}else return Promise.all([i(),o(n.delay)])}function L6(t,e,n=0,r=0,s=0,i=1,o){const a=[];for(const l of t.variantChildren)l.notify("AnimationStart",e),a.push(_g(l,e,{...o,delay:n+(typeof r=="function"?0:r)+w_(t.variantChildren,l,r,s,i)}).then(()=>l.notify("AnimationComplete",e)));return Promise.all(a)}function $6(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const s=e.map(i=>_g(t,i,n));r=Promise.all(s)}else if(typeof e=="string")r=_g(t,e,n);else{const s=typeof e=="function"?ea(t,e,n.custom):e;r=Promise.all(v_(t,s,n))}return r.then(()=>{t.notify("AnimationComplete",e)})}function x_(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}const F6=Wy.length;function b_(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?b_(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<F6;n++){const r=Wy[n],s=t.props[r];(dc(s)||s===!1)&&(e[r]=s)}return e}const B6=[...Hy].reverse(),U6=Hy.length;function z6(t){return e=>Promise.all(e.map(({animation:n,options:r})=>$6(t,n,r)))}function V6(t){let e=z6(t),n=sb(),r=!0;const s=l=>(c,u)=>{var h;const d=ea(t,u,l==="exit"?(h=t.presenceContext)==null?void 0:h.custom:void 0);if(d){const{transition:f,transitionEnd:p,...g}=d;c={...c,...g,...p}}return c};function i(l){e=l(t)}function o(l){const{props:c}=t,u=b_(t.parent)||{},d=[],h=new Set;let f={},p=1/0;for(let y=0;y<U6;y++){const m=B6[y],v=n[m],w=c[m]!==void 0?c[m]:u[m],S=dc(w),T=m===l?v.isActive:null;T===!1&&(p=y);let E=w===u[m]&&w!==c[m]&&S;if(E&&r&&t.manuallyAnimateOnMount&&(E=!1),v.protectedKeys={...f},!v.isActive&&T===null||!w&&!v.prevProp||Jh(w)||typeof w=="boolean")continue;const O=H6(v.prevProp,w);let b=O||m===l&&v.isActive&&!E&&S||y>p&&S,k=!1;const N=Array.isArray(w)?w:[w];let M=N.reduce(s(m),{});T===!1&&(M={});const{prevResolvedValues:L={}}=v,$={...L,...M},P=C=>{b=!0,h.has(C)&&(k=!0,h.delete(C)),v.needsAnimating[C]=!0;const D=t.getValue(C);D&&(D.liveStyle=!1)};for(const C in $){const D=M[C],j=L[C];if(f.hasOwnProperty(C))continue;let F=!1;Cg(D)&&Cg(j)?F=!x_(D,j):F=D!==j,F?D!=null?P(C):h.add(C):D!==void 0&&h.has(C)?P(C):v.protectedKeys[C]=!0}v.prevProp=w,v.prevResolvedValues=M,v.isActive&&(f={...f,...M}),r&&t.blockInitialAnimation&&(b=!1);const U=E&&O;b&&(!U||k)&&d.push(...N.map(C=>{const D={type:m};if(typeof C=="string"&&r&&!U&&t.manuallyAnimateOnMount&&t.parent){const{parent:j}=t,F=ea(j,C);if(j.enteringChildren&&F){const{delayChildren:Y}=F.transition||{};D.delay=w_(j.enteringChildren,t,Y)}}return{animation:C,options:D}}))}if(h.size){const y={};if(typeof c.initial!="boolean"){const m=ea(t,Array.isArray(c.initial)?c.initial[0]:c.initial);m&&m.transition&&(y.transition=m.transition)}h.forEach(m=>{const v=t.getBaseTarget(m),w=t.getValue(m);w&&(w.liveStyle=!0),y[m]=v??null}),d.push({animation:y})}let g=!!d.length;return r&&(c.initial===!1||c.initial===c.animate)&&!t.manuallyAnimateOnMount&&(g=!1),r=!1,g?e(d):Promise.resolve()}function a(l,c){var d;if(n[l].isActive===c)return Promise.resolve();(d=t.variantChildren)==null||d.forEach(h=>{var f;return(f=h.animationState)==null?void 0:f.setActive(l,c)}),n[l].isActive=c;const u=o(l);for(const h in n)n[h].protectedKeys={};return u}return{animateChanges:o,setActive:a,setAnimateFunction:i,getState:()=>n,reset:()=>{n=sb()}}}function H6(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!x_(e,t):!1}function mi(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function sb(){return{animate:mi(!0),whileInView:mi(),whileHover:mi(),whileTap:mi(),whileDrag:mi(),whileFocus:mi(),exit:mi()}}class hi{constructor(e){this.isMounted=!1,this.node=e}update(){}}class W6 extends hi{constructor(e){super(e),e.animationState||(e.animationState=V6(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Jh(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let K6=0;class q6 extends hi{constructor(){super(...arguments),this.id=K6++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const s=this.node.animationState.setActive("exit",!e);n&&!e&&s.then(()=>{n(this.id)})}mount(){const{register:e,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const G6={animation:{Feature:W6},exit:{Feature:q6}};function hc(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}function Ac(t){return{point:{x:t.pageX,y:t.pageY}}}const J6=t=>e=>Vy(e)&&t(e,Ac(e));function xl(t,e,n,r){return hc(t,e,J6(n),r)}const k_=1e-4,Y6=1-k_,Q6=1+k_,S_=.01,X6=0-S_,Z6=0+S_;function an(t){return t.max-t.min}function ez(t,e,n){return Math.abs(t-e)<=n}function ib(t,e,n,r=.5){t.origin=r,t.originPoint=nt(e.min,e.max,t.origin),t.scale=an(n)/an(e),t.translate=nt(n.min,n.max,t.origin)-t.originPoint,(t.scale>=Y6&&t.scale<=Q6||isNaN(t.scale))&&(t.scale=1),(t.translate>=X6&&t.translate<=Z6||isNaN(t.translate))&&(t.translate=0)}function bl(t,e,n,r){ib(t.x,e.x,n.x,r?r.originX:void 0),ib(t.y,e.y,n.y,r?r.originY:void 0)}function ob(t,e,n){t.min=n.min+e.min,t.max=t.min+an(e)}function tz(t,e,n){ob(t.x,e.x,n.x),ob(t.y,e.y,n.y)}function ab(t,e,n){t.min=e.min-n.min,t.max=t.min+an(e)}function uh(t,e,n){ab(t.x,e.x,n.x),ab(t.y,e.y,n.y)}function qn(t){return[t("x"),t("y")]}const E_=({current:t})=>t?t.ownerDocument.defaultView:null,lb=(t,e)=>Math.abs(t-e);function nz(t,e){const n=lb(t.x,e.x),r=lb(t.y,e.y);return Math.sqrt(n**2+r**2)}class C_{constructor(e,n,{transformPagePoint:r,contextWindow:s=window,dragSnapToOrigin:i=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=vp(this.lastMoveEventInfo,this.history),f=this.startEvent!==null,p=nz(h.offset,{x:0,y:0})>=this.distanceThreshold;if(!f&&!p)return;const{point:g}=h,{timestamp:y}=Ft;this.history.push({...g,timestamp:y});const{onStart:m,onMove:v}=this.handlers;f||(m&&m(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),v&&v(this.lastMoveEvent,h)},this.handlePointerMove=(h,f)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=yp(f,this.transformPagePoint),Qe.update(this.updatePoint,!0)},this.handlePointerUp=(h,f)=>{this.end();const{onEnd:p,onSessionEnd:g,resumeAnimation:y}=this.handlers;if(this.dragSnapToOrigin&&y&&y(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=vp(h.type==="pointercancel"?this.lastMoveEventInfo:yp(f,this.transformPagePoint),this.history);this.startEvent&&p&&p(h,m),g&&g(h,m)},!Vy(e))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=r,this.distanceThreshold=o,this.contextWindow=s||window;const a=Ac(e),l=yp(a,this.transformPagePoint),{point:c}=l,{timestamp:u}=Ft;this.history=[{...c,timestamp:u}];const{onSessionStart:d}=n;d&&d(e,vp(l,this.history)),this.removeListeners=Cc(xl(this.contextWindow,"pointermove",this.handlePointerMove),xl(this.contextWindow,"pointerup",this.handlePointerUp),xl(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),ri(this.updatePoint)}}function yp(t,e){return e?{point:e(t.point)}:t}function cb(t,e){return{x:t.x-e.x,y:t.y-e.y}}function vp({point:t},e){return{point:t,delta:cb(t,T_(e)),offset:cb(t,rz(e)),velocity:sz(e,.1)}}function rz(t){return t[0]}function T_(t){return t[t.length-1]}function sz(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const s=T_(t);for(;n>=0&&(r=t[n],!(s.timestamp-r.timestamp>jr(e)));)n--;if(!r)return{x:0,y:0};const i=Zn(s.timestamp-r.timestamp);if(i===0)return{x:0,y:0};const o={x:(s.x-r.x)/i,y:(s.y-r.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function iz(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?nt(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?nt(n,t,r.max):Math.min(t,n)),t}function ub(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function oz(t,{top:e,left:n,bottom:r,right:s}){return{x:ub(t.x,n,s),y:ub(t.y,e,r)}}function db(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function az(t,e){return{x:db(t.x,e.x),y:db(t.y,e.y)}}function lz(t,e){let n=.5;const r=an(t),s=an(e);return s>r?n=lc(e.min,e.max-r,t.min):r>s&&(n=lc(t.min,t.max-s,e.min)),ps(0,1,n)}function cz(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const Ag=.35;function uz(t=Ag){return t===!1?t=0:t===!0&&(t=Ag),{x:hb(t,"left","right"),y:hb(t,"top","bottom")}}function hb(t,e,n){return{min:fb(t,e),max:fb(t,n)}}function fb(t,e){return typeof t=="number"?t:t[e]||0}const dz=new WeakMap;class hz{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=xt(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:n=!1,distanceThreshold:r}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const i=d=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Ac(d).point)},o=(d,h)=>{const{drag:f,dragPropagation:p,onDragStart:g}=this.getProps();if(f&&!p&&(this.openDragLock&&this.openDragLock(),this.openDragLock=SU(f),!this.openDragLock))return;this.latestPointerEvent=d,this.latestPanInfo=h,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),qn(m=>{let v=this.getAxisMotionValue(m).get()||0;if(Lr.test(v)){const{projection:w}=this.visualElement;if(w&&w.layout){const S=w.layout.layoutBox[m];S&&(v=an(S)*(parseFloat(v)/100))}}this.originPoint[m]=v}),g&&Qe.postRender(()=>g(d,h)),Tg(this.visualElement,"transform");const{animationState:y}=this.visualElement;y&&y.setActive("whileDrag",!0)},a=(d,h)=>{this.latestPointerEvent=d,this.latestPanInfo=h;const{dragPropagation:f,dragDirectionLock:p,onDirectionLock:g,onDrag:y}=this.getProps();if(!f&&!this.openDragLock)return;const{offset:m}=h;if(p&&this.currentDirection===null){this.currentDirection=fz(m),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",h.point,m),this.updateAxis("y",h.point,m),this.visualElement.render(),y&&y(d,h)},l=(d,h)=>{this.latestPointerEvent=d,this.latestPanInfo=h,this.stop(d,h),this.latestPointerEvent=null,this.latestPanInfo=null},c=()=>qn(d=>{var h;return this.getAnimationState(d)==="paused"&&((h=this.getAxisMotionValue(d).animation)==null?void 0:h.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new C_(e,{onSessionStart:i,onStart:o,onMove:a,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,distanceThreshold:r,contextWindow:E_(this.visualElement)})}stop(e,n){const r=e||this.latestPointerEvent,s=n||this.latestPanInfo,i=this.isDragging;if(this.cancel(),!i||!s||!r)return;const{velocity:o}=s;this.startAnimation(o);const{onDragEnd:a}=this.getProps();a&&Qe.postRender(()=>a(r,s))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,r){const{drag:s}=this.getProps();if(!r||!uu(e,s,this.currentDirection))return;const i=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=iz(o,this.constraints[e],this.elastic[e])),i.set(o)}resolveConstraints(){var i;const{dragConstraints:e,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)==null?void 0:i.layout,s=this.constraints;e&&Bo(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=oz(r.layoutBox,e):this.constraints=!1,this.elastic=uz(n),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&qn(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=cz(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!Bo(e))return!1;const r=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=p6(r,s.root,this.visualElement.getTransformPagePoint());let o=az(s.layout.layoutBox,i);if(n){const a=n(d6(o));this.hasMutatedConstraints=!!a,a&&(o=c_(a))}return o}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:s,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=qn(u=>{if(!uu(u,n,this.currentDirection))return;let d=l&&l[u]||{};o&&(d={min:0,max:0});const h=s?200:1e6,f=s?40:1e7,p={type:"inertia",velocity:r?e[u]:0,bounceStiffness:h,bounceDamping:f,timeConstant:750,restDelta:1,restSpeed:10,...i,...d};return this.startAxisValueAnimation(u,p)});return Promise.all(c).then(a)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return Tg(this.visualElement,e),r.start(Xy(e,r,0,n,this.visualElement,!1))}stopAnimation(){qn(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){qn(e=>{var n;return(n=this.getAxisMotionValue(e).animation)==null?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)==null?void 0:n.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),s=r[n];return s||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){qn(n=>{const{drag:r}=this.getProps();if(!uu(n,r,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(n);if(s&&s.layout){const{min:o,max:a}=s.layout.layoutBox[n];i.set(e[n]-nt(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!Bo(n)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};qn(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const l=a.get();s[o]=lz({min:l,max:l},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),qn(o=>{if(!uu(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:c}=this.constraints[o];a.set(nt(l,c,s[o]))})}addListeners(){if(!this.visualElement.current)return;dz.set(this.visualElement,this);const e=this.visualElement.current,n=xl(e,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();Bo(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),Qe.read(r);const o=hc(window,"resize",()=>this.scalePositionWithinConstraints()),a=s.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(qn(u=>{const d=this.getAxisMotionValue(u);d&&(this.originPoint[u]+=l[u].translate,d.set(d.get()+l[u].translate))}),this.visualElement.render())});return()=>{o(),n(),i(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:o=Ag,dragMomentum:a=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:s,dragConstraints:i,dragElastic:o,dragMomentum:a}}}function uu(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function fz(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class pz extends hi{constructor(e){super(e),this.removeGroupControls=sr,this.removeListeners=sr,this.controls=new hz(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||sr}unmount(){this.removeGroupControls(),this.removeListeners()}}const pb=t=>(e,n)=>{t&&Qe.postRender(()=>t(e,n))};class mz extends hi{constructor(){super(...arguments),this.removePointerDownListener=sr}onPointerDown(e){this.session=new C_(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:E_(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:pb(e),onStart:pb(n),onMove:r,onEnd:(i,o)=>{delete this.session,s&&Qe.postRender(()=>s(i,o))}}}mount(){this.removePointerDownListener=xl(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Lu={hasAnimatedSinceResize:!0,hasEverUpdated:!1};let wp=!1;class gz extends A.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:s}=this.props,{projection:i}=e;i&&(n.group&&n.group.add(i),r&&r.register&&s&&r.register(i),wp&&i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),Lu.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:s,isPresent:i}=this.props,{projection:o}=r;return o&&(o.isPresent=i,wp=!0,s||e.layoutDependency!==n||n===void 0||e.isPresent!==i?o.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?o.promote():o.relegate()||Qe.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),zy.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:s}=e;wp=!0,s&&(s.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function __(t){const[e,n]=IU(),r=A.useContext(s2);return x.jsx(gz,{...t,layoutGroup:r,switchLayoutGroup:A.useContext(a_),isPresent:e,safeToRemove:n})}function yz(t,e,n){const r=Yt(t)?t:pa(t);return r.start(Xy("",r,e,n)),r.animation}const vz=(t,e)=>t.depth-e.depth;class wz{constructor(){this.children=[],this.isDirty=!1}add(e){Ey(this.children,e),this.isDirty=!0}remove(e){Cy(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(vz),this.isDirty=!1,this.children.forEach(e)}}function xz(t,e){const n=wn.now(),r=({timestamp:s})=>{const i=s-n;i>=e&&(ri(r),t(i-e))};return Qe.setup(r,!0),()=>ri(r)}const A_=["TopLeft","TopRight","BottomLeft","BottomRight"],bz=A_.length,mb=t=>typeof t=="string"?parseFloat(t):t,gb=t=>typeof t=="number"||Ce.test(t);function kz(t,e,n,r,s,i){s?(t.opacity=nt(0,n.opacity??1,Sz(r)),t.opacityExit=nt(e.opacity??1,0,Ez(r))):i&&(t.opacity=nt(e.opacity??1,n.opacity??1,r));for(let o=0;o<bz;o++){const a=`border${A_[o]}Radius`;let l=yb(e,a),c=yb(n,a);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||gb(l)===gb(c)?(t[a]=Math.max(nt(mb(l),mb(c),r),0),(Lr.test(c)||Lr.test(l))&&(t[a]+="%")):t[a]=c}(e.rotate||n.rotate)&&(t.rotate=nt(e.rotate||0,n.rotate||0,r))}function yb(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const Sz=O_(0,.5,m2),Ez=O_(.5,.95,sr);function O_(t,e,n){return r=>r<t?0:r>e?1:n(lc(t,e,r))}function vb(t,e){t.min=e.min,t.max=e.max}function hr(t,e){vb(t.x,e.x),vb(t.y,e.y)}function wb(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function xb(t,e,n,r,s){return t-=e,t=ch(t,1/n,r),s!==void 0&&(t=ch(t,1/s,r)),t}function Cz(t,e=0,n=1,r=.5,s,i=t,o=t){if(Lr.test(e)&&(e=parseFloat(e),e=nt(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=nt(i.min,i.max,r);t===i&&(a-=e),t.min=xb(t.min,e,n,a,s),t.max=xb(t.max,e,n,a,s)}function bb(t,e,[n,r,s],i,o){Cz(t,e[n],e[r],e[s],e.scale,i,o)}const Tz=["x","scaleX","originX"],_z=["y","scaleY","originY"];function kb(t,e,n,r){bb(t.x,e,Tz,n?n.x:void 0,r?r.x:void 0),bb(t.y,e,_z,n?n.y:void 0,r?r.y:void 0)}function Sb(t){return t.translate===0&&t.scale===1}function R_(t){return Sb(t.x)&&Sb(t.y)}function Eb(t,e){return t.min===e.min&&t.max===e.max}function Az(t,e){return Eb(t.x,e.x)&&Eb(t.y,e.y)}function Cb(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function N_(t,e){return Cb(t.x,e.x)&&Cb(t.y,e.y)}function Tb(t){return an(t.x)/an(t.y)}function _b(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class Oz{constructor(){this.members=[]}add(e){Ey(this.members,e),e.scheduleRender()}remove(e){if(Cy(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(s=>e===s);if(n===0)return!1;let r;for(let s=n;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){r=i;break}}return r?(this.promote(r),!0):!1}promote(e,n){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,n&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:r}=e;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Rz(t,e,n){let r="";const s=t.x.translate/e.x,i=t.y.translate/e.y,o=(n==null?void 0:n.z)||0;if((s||i||o)&&(r=`translate3d(${s}px, ${i}px, ${o}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:c,rotate:u,rotateX:d,rotateY:h,skewX:f,skewY:p}=n;c&&(r=`perspective(${c}px) ${r}`),u&&(r+=`rotate(${u}deg) `),d&&(r+=`rotateX(${d}deg) `),h&&(r+=`rotateY(${h}deg) `),f&&(r+=`skewX(${f}deg) `),p&&(r+=`skewY(${p}deg) `)}const a=t.x.scale*e.x,l=t.y.scale*e.y;return(a!==1||l!==1)&&(r+=`scale(${a}, ${l})`),r||"none"}const xp=["","X","Y","Z"],Nz=1e3;let Iz=0;function bp(t,e,n,r){const{latestValues:s}=e;s[t]&&(n[t]=s[t],e.setStaticValue(t,0),r&&(r[t]=0))}function I_(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=y_(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:s,layoutId:i}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",Qe,!(s||i))}const{parent:r}=t;r&&!r.hasCheckedOptimisedAppear&&I_(r)}function P_({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(o={},a=e==null?void 0:e()){this.id=Iz++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(Dz),this.nodes.forEach(Fz),this.nodes.forEach(Bz),this.nodes.forEach(jz)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new wz)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new Ay),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=G2(o)&&!OU(o),this.instance=o;const{layoutId:a,layout:l,visualElement:c}=this.options;if(c&&!c.current&&c.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||a)&&(this.isLayoutDirty=!0),t){let u,d=0;const h=()=>this.root.updateBlockedByResize=!1;Qe.read(()=>{d=window.innerWidth}),t(o,()=>{const f=window.innerWidth;f!==d&&(d=f,this.root.updateBlockedByResize=!0,u&&u(),u=xz(h,250),Lu.hasAnimatedSinceResize&&(Lu.hasAnimatedSinceResize=!1,this.nodes.forEach(Rb)))})}a&&this.root.registerSharedNode(a,this),this.options.animate!==!1&&c&&(a||l)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:d,hasRelativeLayoutChanged:h,layout:f})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const p=this.options.transition||c.getDefaultTransition()||Wz,{onLayoutAnimationStart:g,onLayoutAnimationComplete:y}=c.getProps(),m=!this.targetLayout||!N_(this.targetLayout,f),v=!d&&h;if(this.options.layoutRoot||this.resumeFrom||v||d&&(m||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const w={...By(p,"layout"),onPlay:g,onComplete:y};(c.shouldReduceMotion||this.options.layoutRoot)&&(w.delay=0,w.type=!1),this.startAnimation(w),this.setAnimationOrigin(u,v)}else d||Rb(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=f})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),ri(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Uz),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&I_(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const d=this.path[u];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Ab);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(Ob);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach($z),this.nodes.forEach(Pz),this.nodes.forEach(Mz)):this.nodes.forEach(Ob),this.clearAllSnapshots();const a=wn.now();Ft.delta=ps(0,1e3/60,a-Ft.timestamp),Ft.timestamp=a,Ft.isProcessing=!0,cp.update.process(Ft),cp.preRender.process(Ft),cp.render.process(Ft),Ft.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,zy.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Lz),this.sharedNodes.forEach(zz)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Qe.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Qe.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!an(this.snapshot.measuredBox.x)&&!an(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=xt(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a&&this.instance){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!s)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!R_(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;o&&this.instance&&(a||wi(this.latestValues)||u)&&(s(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),Kz(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var c;const{visualElement:o}=this.options;if(!o)return xt();const a=o.measureViewportBox();if(!(((c=this.scroll)==null?void 0:c.wasRoot)||this.path.some(qz))){const{scroll:u}=this.root;u&&(Uo(a.x,u.offset.x),Uo(a.y,u.offset.y))}return a}removeElementScroll(o){var l;const a=xt();if(hr(a,o),(l=this.scroll)!=null&&l.wasRoot)return a;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:h}=u;u!==this.root&&d&&h.layoutScroll&&(d.wasRoot&&hr(a,o),Uo(a.x,d.offset.x),Uo(a.y,d.offset.y))}return a}applyTransform(o,a=!1){const l=xt();hr(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];!a&&u.options.layoutScroll&&u.scroll&&u!==u.root&&zo(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),wi(u.latestValues)&&zo(l,u.latestValues)}return wi(this.latestValues)&&zo(l,this.latestValues),l}removeTransform(o){const a=xt();hr(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!wi(c.latestValues))continue;kg(c.latestValues)&&c.updateSnapshot();const u=xt(),d=c.measurePageBox();hr(u,d),kb(a,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return wi(this.latestValues)&&kb(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Ft.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var f;const a=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==a;if(!(o||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(f=this.parent)!=null&&f.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:d}=this.options;if(!this.layout||!(u||d))return;this.resolvedRelativeTargetAt=Ft.timestamp;const h=this.getClosestProjectingParent();h&&this.linkedParentVersion!==h.layoutVersion&&!h.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(h&&h.layout?this.createRelativeTarget(h,this.layout.layoutBox,h.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=xt(),this.targetWithTransforms=xt()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),tz(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):hr(this.target,this.layout.layoutBox),d_(this.target,this.targetDelta)):hr(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,h&&!!h.resumingFrom==!!this.resumingFrom&&!h.options.layoutScroll&&h.target&&this.animationProgress!==1?this.createRelativeTarget(h,this.target,h.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||kg(this.parent.latestValues)||u_(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(o,a,l){this.relativeParent=o,this.linkedParentVersion=o.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=xt(),this.relativeTargetOrigin=xt(),uh(this.relativeTargetOrigin,a,l),hr(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){var p;const o=this.getLead(),a=!!this.resumingFrom||this!==o;let l=!0;if((this.isProjectionDirty||(p=this.parent)!=null&&p.isProjectionDirty)&&(l=!1),a&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===Ft.timestamp&&(l=!1),l)return;const{layout:c,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||u))return;hr(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,h=this.treeScale.y;f6(this.layoutCorrected,this.treeScale,this.path,a),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=xt());const{target:f}=o;if(!f){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(wb(this.prevProjectionDelta.x,this.projectionDelta.x),wb(this.prevProjectionDelta.y,this.projectionDelta.y)),bl(this.projectionDelta,this.layoutCorrected,f,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==h||!_b(this.projectionDelta.x,this.prevProjectionDelta.x)||!_b(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",f))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)==null||a.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Vo(),this.projectionDelta=Vo(),this.projectionDeltaWithTransform=Vo()}setAnimationOrigin(o,a=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},d=Vo();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const h=xt(),f=l?l.source:void 0,p=this.layout?this.layout.source:void 0,g=f!==p,y=this.getStack(),m=!y||y.members.length<=1,v=!!(g&&!m&&this.options.crossfade===!0&&!this.path.some(Hz));this.animationProgress=0;let w;this.mixTargetDelta=S=>{const T=S/1e3;Nb(d.x,o.x,T),Nb(d.y,o.y,T),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(uh(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Vz(this.relativeTarget,this.relativeTargetOrigin,h,T),w&&Az(this.relativeTarget,w)&&(this.isProjectionDirty=!1),w||(w=xt()),hr(w,this.relativeTarget)),g&&(this.animationValues=u,kz(u,c,this.latestValues,T,v,m)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=T},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){var a,l,c;this.notifyListeners("animationStart"),(a=this.currentAnimation)==null||a.stop(),(c=(l=this.resumingFrom)==null?void 0:l.currentAnimation)==null||c.stop(),this.pendingAnimation&&(ri(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Qe.update(()=>{Lu.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=pa(0)),this.currentAnimation=yz(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:u=>{this.mixTargetDelta(u),o.onUpdate&&o.onUpdate(u)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Nz),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:c,latestValues:u}=o;if(!(!a||!l||!c)){if(this!==o&&this.layout&&c&&M_(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||xt();const d=an(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+d;const h=an(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+h}hr(a,l),zo(a,u),bl(this.projectionDeltaWithTransform,this.layoutCorrected,a,u)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new Oz),this.sharedNodes.get(o).add(a);const c=a.options.initialPromotionConfig;a.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())==null?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())==null?void 0:a.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const c={};l.z&&bp("z",o,c,this.animationValues);for(let u=0;u<xp.length;u++)bp(`rotate${xp[u]}`,o,c,this.animationValues),bp(`skew${xp[u]}`,o,c,this.animationValues);o.render();for(const u in c)o.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);o.scheduleRender()}applyProjectionStyles(o,a){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const l=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=ju(a==null?void 0:a.pointerEvents)||"",o.transform=l?l(this.latestValues,""):"none";return}const c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=ju(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!wi(this.latestValues)&&(o.transform=l?l({},""):"none",this.hasProjected=!1);return}o.visibility="";const u=c.animationValues||c.latestValues;this.applyTransformsToTarget();let d=Rz(this.projectionDeltaWithTransform,this.treeScale,u);l&&(d=l(u,d)),o.transform=d;const{x:h,y:f}=this.projectionDelta;o.transformOrigin=`${h.origin*100}% ${f.origin*100}% 0`,c.animationValues?o.opacity=c===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:o.opacity=c===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const p in bg){if(u[p]===void 0)continue;const{correct:g,applyTo:y,isCSSVariable:m}=bg[p],v=d==="none"?u[p]:g(u[p],c);if(y){const w=y.length;for(let S=0;S<w;S++)o[y[S]]=v}else m?this.options.visualElement.renderState.vars[p]=v:o[p]=v}this.options.layoutId&&(o.pointerEvents=c===this?ju(a==null?void 0:a.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)==null?void 0:a.stop()}),this.root.nodes.forEach(Ab),this.root.sharedNodes.clear()}}}function Pz(t){t.updateLayout()}function Mz(t){var n;const e=((n=t.resumeFrom)==null?void 0:n.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:s}=t.layout,{animationType:i}=t.options,o=e.source!==t.layout.source;i==="size"?qn(d=>{const h=o?e.measuredBox[d]:e.layoutBox[d],f=an(h);h.min=r[d].min,h.max=h.min+f}):M_(i,e.layoutBox,r)&&qn(d=>{const h=o?e.measuredBox[d]:e.layoutBox[d],f=an(r[d]);h.max=h.min+f,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[d].max=t.relativeTarget[d].min+f)});const a=Vo();bl(a,r,e.layoutBox);const l=Vo();o?bl(l,t.applyTransform(s,!0),e.measuredBox):bl(l,r,e.layoutBox);const c=!R_(a);let u=!1;if(!t.resumeFrom){const d=t.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:h,layout:f}=d;if(h&&f){const p=xt();uh(p,e.layoutBox,h.layoutBox);const g=xt();uh(g,r,f.layoutBox),N_(p,g)||(u=!0),d.options.layoutRoot&&(t.relativeTarget=g,t.relativeTargetOrigin=p,t.relativeParent=d)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:e,delta:l,layoutDelta:a,hasLayoutChanged:c,hasRelativeLayoutChanged:u})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function Dz(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function jz(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function Lz(t){t.clearSnapshot()}function Ab(t){t.clearMeasurements()}function Ob(t){t.isLayoutDirty=!1}function $z(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function Rb(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function Fz(t){t.resolveTargetDelta()}function Bz(t){t.calcProjection()}function Uz(t){t.resetSkewAndRotation()}function zz(t){t.removeLeadSnapshot()}function Nb(t,e,n){t.translate=nt(e.translate,0,n),t.scale=nt(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function Ib(t,e,n,r){t.min=nt(e.min,n.min,r),t.max=nt(e.max,n.max,r)}function Vz(t,e,n,r){Ib(t.x,e.x,n.x,r),Ib(t.y,e.y,n.y,r)}function Hz(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const Wz={duration:.45,ease:[.4,0,.1,1]},Pb=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),Mb=Pb("applewebkit/")&&!Pb("chrome/")?Math.round:sr;function Db(t){t.min=Mb(t.min),t.max=Mb(t.max)}function Kz(t){Db(t.x),Db(t.y)}function M_(t,e,n){return t==="position"||t==="preserve-aspect"&&!ez(Tb(e),Tb(n),.2)}function qz(t){var e;return t!==t.root&&((e=t.scroll)==null?void 0:e.wasRoot)}const Gz=P_({attachResizeListener:(t,e)=>hc(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),kp={current:void 0},D_=P_({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!kp.current){const t=new Gz({});t.mount(window),t.setOptions({layoutScroll:!0}),kp.current=t}return kp.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),Jz={pan:{Feature:mz},drag:{Feature:pz,ProjectionNode:D_,MeasureLayout:__}};function jb(t,e,n){const{props:r}=t;t.animationState&&r.whileHover&&t.animationState.setActive("whileHover",n==="Start");const s="onHover"+n,i=r[s];i&&Qe.postRender(()=>i(e,Ac(e)))}class Yz extends hi{mount(){const{current:e}=this.node;e&&(this.unmount=EU(e,(n,r)=>(jb(this.node,r,"Start"),s=>jb(this.node,s,"End"))))}unmount(){}}class Qz extends hi{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Cc(hc(this.node.current,"focus",()=>this.onFocus()),hc(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Lb(t,e,n){const{props:r}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&r.whileTap&&t.animationState.setActive("whileTap",n==="Start");const s="onTap"+(n==="End"?"":n),i=r[s];i&&Qe.postRender(()=>i(e,Ac(e)))}class Xz extends hi{mount(){const{current:e}=this.node;e&&(this.unmount=AU(e,(n,r)=>(Lb(this.node,r,"Start"),(s,{success:i})=>Lb(this.node,s,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Og=new WeakMap,Sp=new WeakMap,Zz=t=>{const e=Og.get(t.target);e&&e(t)},eV=t=>{t.forEach(Zz)};function tV({root:t,...e}){const n=t||document;Sp.has(n)||Sp.set(n,{});const r=Sp.get(n),s=JSON.stringify(e);return r[s]||(r[s]=new IntersectionObserver(eV,{root:t,...e})),r[s]}function nV(t,e,n){const r=tV(e);return Og.set(t,n),r.observe(t),()=>{Og.delete(t),r.unobserve(t)}}const rV={some:0,all:1};class sV extends hi{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:s="some",once:i}=e,o={root:n?n.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:rV[s]},a=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,i&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:d}=this.node.getProps(),h=c?u:d;h&&h(l)};return nV(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(iV(e,n))&&this.startObserver()}unmount(){}}function iV({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const oV={inView:{Feature:sV},tap:{Feature:Xz},focus:{Feature:Qz},hover:{Feature:Yz}},aV={layout:{ProjectionNode:D_,MeasureLayout:__}},lV={...G6,...oV,...Jz,...aV},cV=u6(lV,S6),uV=({flatTask:t,isFocused:e,onEdit:n})=>{const{updateTask:r,deleteTask:s,setFocusedTaskId:i,setEditingTaskId:o,addTask:a,toggleExpansion:l,startDrag:c,keyboardMove:u,tasks:d,tags:h,dragState:f,navigateToTask:p,navigateBack:g,view:y,canNavigateBack:m,smartReschedule:v,selectedTaskIds:w,handleSelection:S,themeSettings:T,setPendingFocusTaskId:E,setSelectedTaskIds:O,visibleTasks:b}=A.useContext(Vn),k=t.data,N=A.useRef(null),M=t.isExpanded,L=t.hasChildren,$=!!k.completed_at,P=w.includes(k.id),U=X=>{let re=X;const ge=new Set;for(;re.parent_id&&!ge.has(re.id);){ge.add(re.id);const we=d.find(ue=>ue.id===re.parent_id);if(!we)break;re=we}return re.color||"blue"};A.useEffect(()=>{e&&N.current&&N.current.focus({preventScroll:!0})},[e]);const R=()=>{r(k.id,{completed_at:$?null:new Date().toISOString()})},C=X=>{if(X.altKey&&!X.ctrlKey&&!X.metaKey){if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(X.key)&&(X.preventDefault(),X.stopPropagation()),X.key==="ArrowUp"){u(k.id,"up");return}if(X.key==="ArrowDown"){u(k.id,"down");return}if(X.key==="ArrowRight"){u(k.id,"right");return}if(X.key==="ArrowLeft"){m&&y==="all"?g():u(k.id,"left");return}}if(X.key==="Tab"){X.preventDefault(),X.stopPropagation(),X.shiftKey?m&&y==="all"?g():u(k.id,"left"):u(k.id,"right");return}if(X.key==="Delete"||X.key==="Backspace"&&!X.target.matches("input, textarea")){X.preventDefault(),X.stopPropagation();const re=w.includes(k.id)?w:[k.id],ge=b.findIndex(ue=>ue.data.id===k.id);let we=null;for(let ue=ge+1;ue<b.length;ue++)if(!re.includes(b[ue].data.id)){we=b[ue];break}if(!we){for(let ue=ge-1;ue>=0;ue--)if(!re.includes(b[ue].data.id)){we=b[ue];break}}re.forEach(ue=>s(ue)),we&&(i(we.data.id),O([we.data.id]));return}if(X.ctrlKey&&X.key==="."){X.preventDefault(),X.stopPropagation(),R();return}if(X.key==="Enter"&&(X.preventDefault(),X.stopPropagation(),n()),X.key===" "&&(y==="inbox"||y==="all")){X.preventDefault(),X.stopPropagation();const re=d.filter(ue=>ue.parent_id===k.parent_id).sort((ue,J)=>(ue.order_index||0)-(J.order_index||0)),ge=re.findIndex(ue=>ue.id===k.id);let we=k.order_index+1e4;ge<re.length-1&&(we=(k.order_index+re[ge+1].order_index)/2),a({title:"",status:"inbox",parent_id:k.parent_id,order_index:we},[],void 0).then(ue=>{ue&&(E(ue),o(ue),O([]))})}if(X.ctrlKey){if(X.key==="t"&&(X.preventDefault(),X.stopPropagation(),r(k.id,{start_date:new Date().toISOString()})),X.key==="]"){X.preventDefault(),X.stopPropagation();const re=k.start_date?new Date(k.start_date):new Date;re.setDate(re.getDate()+1),r(k.id,{start_date:re.toISOString()})}if(X.key==="["){X.preventDefault(),X.stopPropagation();const re=k.start_date?new Date(k.start_date):new Date;re.setDate(re.getDate()-1),r(k.id,{start_date:re.toISOString()})}}X.altKey&&(X.metaKey||X.ctrlKey)&&X.key==="r"&&(X.preventDefault(),X.stopPropagation(),v(k.id)),!X.altKey&&!X.ctrlKey&&!X.metaKey&&X.key!==" "&&(X.key==="ArrowRight"&&(X.preventDefault(),L&&!M&&l(k.id,!0)),X.key==="ArrowLeft"&&(X.preventDefault(),M?l(k.id,!1):k.parent_id&&i(k.parent_id)))},D=f.draggedId===k.id||f.isDragging&&P,G=`group relative mb-0.5 rounded-lg outline-none select-none cursor-default py-1.5 ${P?"bg-[#cfe1fc]":""} ${!P&&!D&&(e&&!P&&!D?"bg-slate-50":"")} ${$?"bg-emerald-50/30":""} ${D?"opacity-40 scale-[0.98] blur-[0.5px] transition-all duration-200":"opacity-100 scale-100 transition-all duration-200"} transition-all duration-200 ease-in-out`,H=()=>{if(!k.start_date)return null;const X=Li(k.start_date),re=Kl(k.start_date)&&!$;let ge="bg-slate-50 text-slate-400";return X?ge="bg-yellow-50 text-yellow-600 font-medium":re&&(ge="bg-red-50 text-red-600 font-medium"),x.jsxs("span",{className:`text-[10px] px-1.5 py-0.5 rounded border border-transparent ${ge} flex items-center gap-1`,children:[" ",x.jsx($0,{size:10})," ",jE(k.start_date)," "]})},se=T.fontWeight==="thin"?"font-extralight":"font-medium",be={small:"text-sm",normal:"text-base",large:"text-lg"}[T.fontSize]||"text-base";return x.jsx(cV.div,{layout:!0,transition:{layout:{duration:.2,ease:"easeInOut"}},ref:N,"data-task-id":k.id,"data-task-index":t.index,draggable:y!=="schedule",onDragStart:X=>c(X,t),className:G,style:{marginLeft:`${t.depth*Nm}px`},tabIndex:0,onKeyDown:C,onClick:X=>{X.stopPropagation(),S(X,k.id)},onDoubleClick:X=>{X.stopPropagation(),n()},children:x.jsxs("div",{className:"flex flex-col px-3",children:[y==="next"&&t.breadcrumbs&&t.breadcrumbs.length>0&&x.jsxs("div",{className:"flex items-center gap-1 mb-1 flex-wrap",children:[t.breadcrumbs.map((X,re)=>{const ge=vn[U(X)]||vn.blue;return x.jsxs(on.Fragment,{children:[" ",x.jsxs("button",{onClick:we=>{we.stopPropagation(),p(X.id)},className:`text-[9px] px-1.5 py-0.5 rounded border ${ge.badge} hover:opacity-80 transition-opacity flex items-center gap-1`,children:[" ",X.is_project?x.jsx(zE,{size:8}):x.jsx(BE,{size:8})," ",x.jsx("span",{className:"max-w-[80px] truncate",children:X.title})," "]})," ",re<t.breadcrumbs.length-1&&x.jsx(ql,{size:8,className:"text-gray-300"})," "]},X.id)}),x.jsx(DM,{size:10,className:"text-gray-300 ml-1"})]}),x.jsxs("div",{className:"flex items-start gap-3",children:[x.jsx("div",{className:`mt-1 cursor-grab active:cursor-grabbing text-slate-300 hover:text-slate-500 transition-colors hidden md:block ${y==="schedule"?"invisible":""}`,children:x.jsx($M,{size:14})}),x.jsxs("div",{className:"mt-0.5 flex items-center gap-1",children:[L&&y!=="next"?x.jsx("button",{onClick:X=>{X.stopPropagation(),l(k.id)},className:"text-slate-400 hover:text-slate-800 transition-transform",children:M?x.jsx(F0,{size:16}):x.jsx(ql,{size:16})}):x.jsx("div",{className:"w-[16px]"}),x.jsx(qE,{checked:$,onChange:X=>{X.stopPropagation(),R()},color:U(k),isRoot:!k.parent_id})]}),x.jsxs("div",{className:"flex-1 min-w-0 pt-0.5 cursor-text flex items-center",children:[x.jsx("span",{className:`${be} ${se} transition-all duration-300 ${$?"text-slate-400 line-through decoration-slate-300":"text-slate-700"} mr-2 truncate block max-w-[200px] md:max-w-none`,children:k.title}),(k.tags||[]).length>0&&x.jsxs(x.Fragment,{children:[x.jsx("div",{className:"hidden md:flex items-center gap-1 mr-2",children:(k.tags||[]).map(X=>{var ge;const re=(ge=h.find(we=>we.id===X))==null?void 0:ge.name;return re?x.jsxs("span",{className:`text-[10px] font-light border border-slate-200 rounded-md px-1.5 py-px ${$?"text-slate-300 bg-slate-50":"text-slate-500 bg-slate-50"}`,children:[" #",re," "]},X):null})}),x.jsxs("div",{className:"md:hidden flex items-center mr-2 text-slate-400",children:[x.jsx(B0,{size:12}),(k.tags||[]).length>1&&x.jsx("span",{className:"text-[9px] ml-0.5",children:(k.tags||[]).length})]})]}),k.description&&x.jsx("span",{className:"text-[10px] text-slate-300 mr-2",children:"..."}),x.jsxs("div",{className:`ml-auto ${$?"opacity-50":"opacity-100"}`,children:[" ",H()," "]})]}),x.jsx("div",{className:"opacity-100 md:opacity-0 md:group-hover:opacity-100 flex items-center gap-1 pl-2",children:x.jsx("button",{onClick:X=>{X.stopPropagation(),s(k.id)},className:"p-1 hover:text-red-500 text-slate-300 transition-colors",children:x.jsx(hd,{size:14})})})]})]})})},dV=({task:t,position:e,count:n})=>{if(!t)return null;const r=vn[t.color]||vn.blue;return x.jsx("div",{className:"fixed pointer-events-none z-[9999]",style:{left:e.x,top:e.y,transform:"translate(-20px, -50%) rotate(-2deg) scale(1.02)"},children:x.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border border-slate-200 px-4 py-2 min-w-[200px] max-w-[300px] ring-2 ring-blue-400/30 backdrop-blur-sm",children:[x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("div",{className:`w-3 h-3 rounded ${r.dot}`}),x.jsx("span",{className:"text-sm font-medium text-slate-700 truncate",children:t.title||""})]}),n>1&&x.jsx("div",{className:"absolute -top-2 -right-2 bg-blue-500 text-white text-xs font-bold w-5 h-5 rounded-full flex items-center justify-center shadow-lg border border-white",children:n})]})})},hV=({show:t,top:e,left:n,width:r,color:s})=>{if(!t)return null;const i=vn[s]||vn.blue;return x.jsx("div",{className:"absolute pointer-events-none z-40 transition-all duration-100 ease-out",style:{top:`${e}px`,left:`${n}px`,width:`${r}px`},children:x.jsx("div",{className:`h-0.5 ${i.indicator} rounded-full shadow-sm relative`,children:x.jsx("div",{className:`absolute -left-1.5 -top-[3px] w-2 h-2 ${i.indicator} rounded-full shadow-md`})})})},fV=()=>{const{visibleTasks:t,focusedTaskId:e,setFocusedTaskId:n,editingTaskId:r,setEditingTaskId:s,expandedTaskIds:i,endDrag:o,dragState:a,updateDropState:l,updateGhostPosition:c,selectedTaskIds:u,handleSelection:d,selectionAnchor:h,tasks:f,pendingFocusTaskId:p,setPendingFocusTaskId:g}=A.useContext(Vn),y=A.useRef(null),m=A.useRef(null);A.useEffect(()=>{const b=k=>{var M,L;if(r||((M=document.activeElement)==null?void 0:M.tagName)==="INPUT"||((L=document.activeElement)==null?void 0:L.tagName)==="TEXTAREA")return;const N=t.findIndex($=>$.data.id===e);if(k.metaKey||k.ctrlKey){if(k.key==="ArrowUp"){if(k.preventDefault(),t.length>0){const $=t[0];n($.data.id),d({shiftKey:!1,ctrlKey:!1},$.data.id)}return}if(k.key==="ArrowDown"){if(k.preventDefault(),t.length>0){const $=t[t.length-1];n($.data.id),d({shiftKey:!1,ctrlKey:!1},$.data.id)}return}}if(k.shiftKey&&(k.key==="ArrowDown"||k.key==="ArrowUp")){k.preventDefault();let $=N;k.key==="ArrowDown"&&($=Math.min(N+1,t.length-1)),k.key==="ArrowUp"&&($=Math.max(N-1,0));const P=t[$];P&&(n(P.data.id),d({shiftKey:!0,preventDefault:()=>{}},P.data.id));return}if(k.key==="ArrowDown"&&!k.altKey){k.preventDefault();const $=N+1;if($<t.length){const P=t[$];n(P.data.id),d({shiftKey:!1,ctrlKey:!1},P.data.id)}}else if(k.key==="ArrowUp"&&!k.altKey){k.preventDefault();const $=N-1;if($>=0){const P=t[$];n(P.data.id),d({shiftKey:!1,ctrlKey:!1},P.data.id)}}else k.key==="Enter"&&N!==-1&&!r&&!k.altKey&&(k.preventDefault(),s(t[N].data.id))};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[t,e,i,r,h]);const v=b=>{var X;if(b.preventDefault(),!a.isDragging||!y.current)return;c(b.clientX,b.clientY);const k=y.current.getBoundingClientRect(),N=b.clientX,M=b.clientY,L=N-k.left,$=100,P=10,U=window.innerHeight,R=document.querySelector("main");R&&(M<$?m.current||(m.current=setInterval(()=>{R.scrollTop-=P},16)):M>U-$?m.current||(m.current=setInterval(()=>{R.scrollTop+=P},16)):m.current&&(clearInterval(m.current),m.current=null));let C=-1,D=null,j=document.elementFromPoint(N,M);for(;j&&j!==y.current&&j!==document.body;){if(j.hasAttribute("data-task-index")){C=parseInt(j.getAttribute("data-task-index")||"-1"),D=j.getBoundingClientRect();break}j=j.parentElement}if(C===-1&&t.length>0&&y.current){const re=y.current.querySelector("[data-task-index]:last-child");if(re){const ge=re.getBoundingClientRect();M>ge.bottom&&(C=parseInt(re.getAttribute("data-task-index")||"-1")+1,D=ge)}}if(C===-1){const re=(X=y.current)==null?void 0:X.querySelector("[data-task-index]:first-child");if(re){const ge=re.getBoundingClientRect();M<ge.top&&(C=0,D=ge)}if(C===-1)return}let F=C;if(D){const re=D.top+D.height/2;M>re&&C<t.length&&(F=C+1)}const Y=L-a.dragOffsetX;let Q=Math.floor(Y/Nm);Q<0&&(Q=0);const W=t[F-1],G=W?W.depth+1:0;Q>G&&(Q=G);let H=0;D?F===C?H=D.top-k.top:H=D.bottom-k.top:F===0&&(H=0);const se=Q*Nm+40,be=k.width-se-20;l({dropIndex:F,dropDepth:Q,indicatorTop:H,indicatorLeft:se,indicatorWidth:be})},w=()=>{m.current&&(clearInterval(m.current),m.current=null),o()},S=b=>{s(null),p?(n(p),g(null)):n(b)},T=a.draggedId?f.find(b=>b.id===a.draggedId):null,E=u.includes(a.draggedId||"")?u.length:1,O=()=>{if(a.dropIndex===null||a.dropIndex===0)return"blue";const b=t[a.dropIndex-1];return(b==null?void 0:b.data.color)||"blue"};return t.length===0?x.jsxs("div",{className:"text-center py-20 opacity-20",children:[x.jsx(BM,{size:48,className:"mx-auto"}),x.jsx("p",{className:"text-xs mt-2",children:"No tasks"})]}):x.jsxs(x.Fragment,{children:[a.isDragging&&T&&x.jsx(dV,{task:T,position:a.ghostPosition,count:E}),x.jsxs("div",{ref:y,className:"pb-20 relative min-h-[500px]",onDragOver:v,onDrop:b=>{b.preventDefault(),w()},onDragEnd:w,children:[x.jsx(hV,{show:a.isDragging&&a.dropIndex!==null,top:a.indicatorTop,left:a.indicatorLeft,width:a.indicatorWidth,depth:a.dropDepth,color:O()}),t.map((b,k)=>x.jsx(on.Fragment,{children:r===b.data.id?x.jsx(sh,{initialData:b.data,onClose:()=>S(b.data.id)},b.data.id):x.jsx(uV,{flatTask:b,isFocused:e===b.data.id,onEdit:()=>s(b.data.id)},b.data.id)},b.data.id))]})]})},pV=()=>{const{tasks:t,updateTask:e,setEditingTaskId:n}=A.useContext(Vn),[r,s]=A.useState(new Date),[i,o]=A.useState("month"),[a,l]=A.useState(5),c=m=>t.filter(v=>{if(v.status==="deleted"||v.status==="logged")return!1;const w=v.start_date?new Date(v.start_date):v.due_date?new Date(v.due_date):null;return w&&ts(w,m)}),u=()=>{if(i==="month")s(new Date(r.getFullYear(),r.getMonth()-1,1));else if(i==="week"){const m=new Date(r);m.setDate(m.getDate()-7),s(m)}else{const m=new Date(r);m.setDate(m.getDate()-a),s(m)}},d=()=>{if(i==="month")s(new Date(r.getFullYear(),r.getMonth()+1,1));else if(i==="week"){const m=new Date(r);m.setDate(m.getDate()+7),s(m)}else{const m=new Date(r);m.setDate(m.getDate()+a),s(m)}},h=(m,v)=>{m.preventDefault();const w=m.dataTransfer.getData("text/plain");if(w){const S=new Date(v);S.setHours(9,0,0,0),e(w,{start_date:S.toISOString()})}},f=m=>{m.preventDefault()},p=m=>{const v=m.color||"blue",w=vn[v];return x.jsx("div",{draggable:!0,onDragStart:S=>{S.dataTransfer.setData("text/plain",m.id)},onClick:S=>{S.stopPropagation(),n(m.id)},className:`text-[10px] px-1.5 py-1 rounded border ${w.badge} cursor-grab active:cursor-grabbing truncate shadow-sm hover:shadow-md transition-all mb-1`,title:m.title,children:m.title},m.id)},g=()=>{const m=new Date(r.getFullYear(),r.getMonth()+1,0).getDate(),v=new Date(r.getFullYear(),r.getMonth(),1).getDay(),w=[],S=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(T=>x.jsx("div",{className:"bg-gray-50 text-center py-2 text-xs font-bold text-gray-400 uppercase tracking-wider border-b border-r border-gray-200 last:border-r-0",children:T},T));for(let T=0;T<v;T++)w.push(x.jsx("div",{className:"h-32 bg-gray-50/30 border-b border-r border-gray-100"},`empty-${T}`));for(let T=1;T<=m;T++){const E=new Date(r.getFullYear(),r.getMonth(),T),O=c(E),b=ts(E,new Date);w.push(x.jsxs("div",{onDragOver:f,onDrop:k=>h(k,E),className:`h-32 border-b border-r border-gray-100 p-2 overflow-y-auto hover:bg-gray-50 transition-colors ${b?"bg-indigo-50/30":""}`,children:[x.jsxs("div",{className:`text-xs font-bold mb-1 ${b?"text-indigo-600":"text-gray-400"}`,children:[T," ",b&&"(Today)"]}),x.jsx("div",{className:"space-y-0.5",children:O.map(p)})]},T))}return x.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[x.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200",children:S}),x.jsx("div",{className:"grid grid-cols-7 flex-1 overflow-y-auto",children:w})]})},y=m=>{const v=[];let w=new Date(r);if(i==="week"){const S=w.getDay(),T=w.getDate()-S;w=new Date(w.setDate(T))}for(let S=0;S<m;S++){const T=new Date(w);T.setDate(w.getDate()+S);const E=c(T),O=ts(T,new Date);v.push(x.jsxs("div",{className:"flex-1 min-w-[150px] border-r border-gray-200 flex flex-col h-full bg-white first:border-l-0 last:border-r-0",onDragOver:f,onDrop:b=>h(b,T),children:[x.jsxs("div",{className:`p-3 border-b border-gray-100 sticky top-0 bg-white z-10 ${O?"bg-indigo-50/50":""}`,children:[x.jsx("div",{className:`text-xs uppercase font-bold mb-1 ${O?"text-indigo-600":"text-gray-400"}`,children:T.toLocaleDateString("en-US",{weekday:"short"})}),x.jsx("div",{className:`text-lg font-light ${O?"text-indigo-600":"text-gray-800"}`,children:T.getDate()})]}),x.jsxs("div",{className:"flex-1 overflow-y-auto p-2 space-y-2 bg-gray-50/10",children:[E.map(p),E.length===0&&x.jsx("div",{className:"h-full flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity",children:x.jsx("div",{className:"text-[10px] text-gray-300 border border-dashed border-gray-200 rounded px-2 py-1",children:"Drop here"})})]})]},S))}return x.jsx("div",{className:"flex-1 overflow-x-auto overflow-y-hidden flex",children:v})};return x.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden h-full flex flex-col",children:[x.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 bg-gray-50/50",children:[x.jsxs("h2",{className:"font-bold text-gray-800 flex items-center gap-2",children:[x.jsx($0,{size:18,className:"text-gray-500"}),r.toLocaleString("default",{month:"long",year:"numeric"})]}),x.jsxs("div",{className:"flex items-center gap-4",children:[x.jsxs("div",{className:"bg-gray-200 p-0.5 rounded-lg flex text-xs font-medium",children:[x.jsx("button",{onClick:()=>o("month"),className:`px-3 py-1 rounded-md transition-all ${i==="month"?"bg-white text-indigo-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Month"}),x.jsx("button",{onClick:()=>o("week"),className:`px-3 py-1 rounded-md transition-all ${i==="week"?"bg-white text-indigo-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Week"}),x.jsx("button",{onClick:()=>o("custom"),className:`px-3 py-1 rounded-md transition-all ${i==="custom"?"bg-white text-indigo-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Custom"})]}),i==="custom"&&x.jsxs("div",{className:"flex items-center gap-2 bg-white px-2 py-1 rounded border border-gray-200",children:[x.jsx("span",{className:"text-[10px] text-gray-400 uppercase font-bold",children:"Days:"}),x.jsx("input",{type:"range",min:"1",max:"15",value:a,onChange:m=>l(parseInt(m.target.value)),className:"w-20 accent-indigo-600 h-1"}),x.jsx("span",{className:"text-xs font-mono w-4 text-center",children:a})]}),x.jsxs("div",{className:"flex gap-1",children:[x.jsx("button",{onClick:u,className:"p-1 hover:bg-gray-200 rounded text-gray-600",children:x.jsx(FE,{size:20})}),x.jsx("button",{onClick:()=>s(new Date),className:"px-3 py-1 text-xs font-bold text-gray-600 hover:bg-gray-200 rounded",children:"Today"}),x.jsx("button",{onClick:d,className:"p-1 hover:bg-gray-200 rounded text-gray-600",children:x.jsx(ql,{size:20})})]})]})]}),i==="month"?g():y(i==="week"?7:a)]})},mV=()=>{const{tasks:t,tags:e,addTask:n,addTag:r}=A.useContext(Vn),[s,i]=A.useState(null),o=A.useMemo(()=>{const d=e.find(h=>h.name.toLowerCase()==="album"||h.name==="");return d?d.id:null},[e]),a=A.useMemo(()=>o?t.filter(d=>d.tags.includes(o)&&d.status!=="deleted").sort((d,h)=>new Date(h.created_at).getTime()-new Date(d.created_at).getTime()):[],[t,o]),l=async()=>{let d=o;if(d||(d=await r("Album")),d){const h=await n({title:"",tags:[d],is_project:!1,status:"active"});setTimeout(()=>{i({id:h})},100)}},c=d=>{i(d)},u=()=>{i(null)};return x.jsxs("div",{className:"h-full flex flex-col bg-white overflow-hidden relative",children:[x.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-white z-10",children:[x.jsxs("h2",{className:"font-bold text-gray-700 flex items-center gap-2",children:[x.jsx(RM,{size:18})," Journal / Album"]}),x.jsxs("button",{onClick:l,className:"flex items-center gap-1 px-3 py-1.5 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 text-sm font-medium transition-colors shadow-sm",children:[x.jsx(HE,{size:16})," New Entry"]})]}),x.jsx("div",{className:"flex-1 overflow-y-auto p-6 bg-gray-50/50",children:a.length===0?x.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[x.jsx(Im,{size:48,className:"mb-4 opacity-20"}),x.jsx("p",{className:"text-sm",children:"No album entries yet."}),x.jsx("p",{className:"text-xs mt-1",children:'Create a task with the "Album" tag to see it here.'})]}):x.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:a.map(d=>x.jsxs("div",{onClick:()=>c(d),className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden cursor-pointer group hover:shadow-md transition-all hover:-translate-y-1",children:[x.jsxs("div",{className:"aspect-[4/3] bg-gray-100 relative overflow-hidden",children:[d.images&&d.images.length>0?x.jsx("img",{src:d.images[0],alt:d.title,className:"w-full h-full object-cover transition-transform group-hover:scale-105"}):x.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-300 bg-gray-50",children:x.jsx(Im,{size:24})}),x.jsx("div",{className:"absolute top-2 right-2 bg-black/50 backdrop-blur-sm text-white text-[10px] px-2 py-1 rounded-full",children:new Date(d.created_at).toLocaleDateString()})]}),x.jsxs("div",{className:"p-4",children:[x.jsx("h3",{className:`font-bold text-gray-800 mb-2 line-clamp-2 ${d.title?"":"italic text-gray-400"}`,children:d.title||"Untitled"}),x.jsx("div",{className:"flex flex-wrap gap-1 mt-auto",children:d.tags.filter(h=>h!==o).map(h=>{const f=e.find(p=>p.id===h);return f?x.jsx(Pm,{tag:f,size:"small"},h):null})})]})]},d.id))})}),s&&x.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/20 backdrop-blur-sm",onClick:u,children:x.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-2xl shadow-2xl max-h-[90vh] overflow-y-auto",onClick:d=>d.stopPropagation(),children:[x.jsx("div",{className:"p-2 border-b border-gray-100 flex justify-end",children:x.jsx("button",{onClick:u,className:"p-2 hover:bg-gray-100 rounded-full text-gray-500",children:x.jsx(is,{size:20})})}),x.jsx("div",{className:"p-4",children:x.jsx(sh,{initialData:t.find(d=>d.id===s.id),onClose:u})})]})})]})},gV=()=>{var d;const{advancedFilters:t,setAdvancedFilters:e,tags:n,tagFilter:r,tasks:s}=A.useContext(Vn);if(!r)return null;const i=h=>{h&&e(f=>({...f,additionalTags:f.additionalTags.includes(h)?f.additionalTags.filter(p=>p!==h):[...f.additionalTags,h]}))},o=h=>{e(f=>({...f,startDate:h}))},a=h=>{e(f=>({...f,dueDate:h}))},l=h=>{e(f=>({...f,color:h}))},c=()=>{e({additionalTags:[],startDate:null,dueDate:null,color:null})},u=t.additionalTags.length>0||t.startDate||t.dueDate||t.color;return x.jsxs("div",{className:"px-8 py-3 border-b border-gray-50 bg-gray-50/30 flex items-center gap-4 overflow-x-auto no-scrollbar",children:[x.jsx("div",{className:"flex items-center gap-2",children:x.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:"Filters:"})}),x.jsx(Tu,{icon:B0,label:"Tags",items:n.filter(h=>h.id!==r),selectedIds:t.additionalTags,onSelect:i,multiSelect:!0,placeholder:"Filter by tags..."}),x.jsx(fd,{label:"Start Date",value:t.startDate,onChange:o,tasks:s}),x.jsx(fd,{label:"Due Date",value:t.dueDate,onChange:a,tasks:s}),x.jsxs("div",{className:"relative group",children:[x.jsxs("button",{className:`flex items-center gap-1.5 px-2.5 py-1.5 rounded-md border text-xs transition-colors ${t.color?"bg-white border-transparent shadow-sm ring-1 ring-gray-100 text-gray-800":"text-gray-400 border-transparent hover:bg-gray-100"}`,children:[x.jsx(qM,{size:13}),x.jsx("span",{children:(t.color,"Color")}),t.color&&x.jsx("div",{className:"w-2 h-2 rounded-full ml-1",style:{backgroundColor:((d=vn[t.color])==null?void 0:d.color)||t.color}})]}),x.jsx("div",{className:"absolute top-full left-0 mt-2 bg-white rounded-lg shadow-xl border border-gray-100 p-2 hidden group-hover:block z-50 min-w-[150px]",children:x.jsx("div",{className:"grid grid-cols-4 gap-2",children:Object.keys(vn).map(h=>x.jsx("button",{onClick:()=>l(t.color===h?null:h),className:`w-6 h-6 rounded-full border-2 ${t.color===h?"border-gray-400 scale-110":"border-transparent hover:scale-110"} transition-transform`,style:{backgroundColor:vn[h].color},title:h},h))})})]}),u&&x.jsxs("button",{onClick:c,className:"ml-auto flex items-center gap-1 text-[10px] text-gray-400 hover:text-red-500 transition-colors",children:[x.jsx(is,{size:12})," Clear"]})]})},yV=()=>{const{user:t,logout:e,syncStatus:n,view:r,setView:s,tagFilter:i,setTagFilter:o,tasks:a,tags:l,toast:c,setToast:u,undo:d,redo:h,canUndo:f,canRedo:p,canNavigateBack:g,navigateBack:y,archiveCompletedTasks:m,editingTaskId:v,setEditingTaskId:w,themeSettings:S,sidebarWidth:T,setSidebarWidth:E}=A.useContext(Vn),[O,b]=A.useState(!1),[k,N]=A.useState(!1),[M,L]=A.useState(!1),$={small:"text-sm",normal:"text-base",large:"text-lg"}[S.fontSize]||"text-base",P=S.fontWeight==="thin"?"font-light":"font-bold",U=v?a.find(C=>C.id===v):null;A.useEffect(()=>{const C=D=>{D.key==="k"&&(D.metaKey||D.ctrlKey)&&(D.preventDefault(),b(j=>!j)),D.key==="Escape"&&b(!1)};return window.addEventListener("keydown",C),()=>window.removeEventListener("keydown",C)},[]),A.useEffect(()=>{const C=j=>{if(!k)return;let F=j.clientX;F<150&&(F=150),F>400&&(F=400),E(F)},D=()=>{N(!1),document.body.style.cursor="default"};return k&&(window.addEventListener("mousemove",C),window.addEventListener("mouseup",D),document.body.style.cursor="col-resize"),()=>{window.removeEventListener("mousemove",C),window.removeEventListener("mouseup",D)}},[k]);const R=()=>{var C;return i?((C=l.find(D=>D.id===i))==null?void 0:C.name)||"Tags":r.charAt(0).toUpperCase()+r.slice(1)};return x.jsxs("div",{className:"flex h-screen bg-white text-gray-900 font-sans selection:bg-indigo-50 selection:text-indigo-900",children:[x.jsxs("div",{style:{width:T},className:"relative flex-shrink-0 hidden md:block",children:[x.jsx(U1,{view:r,setView:s,tagFilter:i,setTagFilter:o}),x.jsx("div",{className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-indigo-400/50 transition-colors z-50",onMouseDown:()=>N(!0)})]}),M&&x.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 md:hidden",onClick:()=>L(!1),children:x.jsx("div",{className:"absolute left-0 top-0 h-full w-[280px] bg-white shadow-2xl animate-in slide-in-from-left duration-200",onClick:C=>C.stopPropagation(),children:x.jsx(U1,{view:r,setView:C=>{s(C),L(!1)},tagFilter:i,setTagFilter:C=>{o(C),L(!1)}})})}),x.jsxs("main",{className:"flex-1 flex flex-col relative overflow-hidden",children:[x.jsxs("header",{className:"h-14 flex items-center justify-between px-4 md:px-8 border-b border-gray-50 z-10 sticky top-0 bg-white/90 backdrop-blur-sm",children:[x.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[x.jsx("button",{className:"md:hidden p-1 -ml-2 text-gray-500 hover:bg-gray-100 rounded",onClick:()=>L(!0),children:x.jsx(WM,{size:20})}),g?x.jsxs("button",{onClick:y,className:"p-1 hover:bg-gray-100 rounded text-slate-500 flex items-center gap-1 text-sm font-medium transition-colors",title:" Next Actions (Alt + Left)",children:[" ",x.jsx(jM,{size:16})," ",x.jsx("span",{className:"hidden md:inline",children:""})," "]}):x.jsx("h2",{className:`${$} ${P} tracking-tight text-gray-800`,children:R()})]}),x.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[x.jsxs("div",{className:"flex items-center gap-1",children:[x.jsxs("button",{onClick:m,className:"p-1.5 rounded hover:bg-gray-100 text-slate-500 hover:text-emerald-600 transition-colors",title:" (Archive Completed)",children:[" ",x.jsx(OM,{size:16})," "]}),x.jsx("div",{className:"w-px h-4 bg-gray-200 mx-1"}),x.jsx("button",{disabled:!f,onClick:d,className:`p-1 rounded hover:bg-gray-100 ${f?"opacity-100":"opacity-30"}`,title:" (Ctrl+Z)",children:x.jsx(KE,{size:14})}),x.jsx("button",{disabled:!p,onClick:h,className:`p-1 rounded hover:bg-gray-100 ${p?"opacity-100":"opacity-30"}`,title:" (Ctrl+Shift+Z)",children:x.jsx(WE,{size:14})})]}),x.jsxs("div",{className:"flex items-center gap-1.5 pl-2 border-l border-gray-200 ml-1 group relative cursor-pointer",onClick:e,title:" / ",children:[x.jsxs("div",{className:"hidden md:flex flex-col items-end",children:[x.jsx("span",{className:"text-[9px] text-gray-400 uppercase tracking-wider font-bold leading-none mb-0.5",children:"User"}),x.jsx("span",{className:"text-[10px] font-mono text-gray-600 leading-none",title:t==null?void 0:t.id,children:t!=null&&t.email?t.email:t!=null&&t.id?`ID: ${t.id.slice(0,6)}...`:"Guest"})]}),x.jsxs("div",{className:"w-6 h-6 rounded-full bg-indigo-50 text-indigo-600 flex items-center justify-center border border-indigo-100 group-hover:bg-red-50 group-hover:text-red-600 group-hover:border-red-100 transition-colors",children:[x.jsx(XM,{size:12,className:"group-hover:hidden"}),x.jsx(VM,{size:12,className:"hidden group-hover:block"})]})]}),x.jsxs("div",{className:`flex items-center gap-1 text-[10px] ml-1 ${n==="synced"?"text-green-500":n==="error"?"text-red-500":"text-orange-400"}`,children:[n==="synced"?x.jsx(MM,{size:12}):x.jsx(PM,{size:12,className:"animate-pulse"}),x.jsx("span",{className:"uppercase tracking-wider hidden lg:inline",children:n==="synced"?"Synced":n==="error"?"Error":"Syncing..."})]}),n==="error"&&x.jsx("div",{className:"text-[10px] text-red-500 flex items-center gap-1",children:x.jsx(_M,{size:12})})]})]}),x.jsx(gV,{}),x.jsx("div",{className:"flex-1 overflow-y-auto p-8 scroll-smooth no-scrollbar",children:r==="calendar"?x.jsx(pV,{}):r==="journal"?x.jsx(mV,{}):x.jsx("div",{className:"max-w-3xl mx-auto",children:x.jsx(fV,{})})}),v&&(r==="calendar"||r==="journal")&&U&&x.jsx("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm z-50 flex items-center justify-center p-6",onClick:()=>w(null),children:x.jsxs("div",{className:"w-full max-w-2xl bg-white rounded-xl shadow-2xl ring-1 ring-black/5 p-6",onClick:C=>C.stopPropagation(),children:[x.jsxs("div",{className:"flex justify-between items-center mb-4",children:[x.jsx("h3",{className:"text-sm font-bold text-gray-500 uppercase tracking-wider",children:"Edit Task"}),x.jsx("button",{onClick:()=>w(null),className:"p-1 hover:bg-gray-100 rounded-full text-gray-400 hover:text-gray-600",children:x.jsx(is,{size:18})})]}),x.jsx(sh,{initialData:U,onClose:()=>w(null)})]})}),O&&x.jsx("div",{className:"fixed inset-0 bg-white/80 backdrop-blur-sm z-50 flex items-start justify-center pt-16 p-4 md:pt-32 md:p-6",children:x.jsx("div",{className:"w-full max-w-3xl bg-white rounded-xl shadow-2xl ring-1 ring-black/5 p-4 md:p-6",children:x.jsx(sh,{isQuickAdd:!0,onClose:()=>b(!1)})})}),c&&x.jsxs("div",{className:`fixed bottom-8 left-1/2 -translate-x-1/2 px-6 py-3 rounded-full shadow-xl flex items-center gap-6 z-50 text-sm ${c.type==="error"?"bg-red-500 text-white":"bg-gray-900 text-white"}`,children:[x.jsx("span",{children:c.msg}),c.undo&&x.jsx("button",{onClick:()=>{var C;(C=c.undo)==null||C.call(c),u(null)},className:"opacity-70 hover:opacity-100 transition-opacity",children:"Undo"})]})]})]})},vV=()=>{const[t,e]=A.useState(!1),[n,r]=A.useState(""),[s,i]=A.useState(""),[o,a]=A.useState("signin"),[l,c]=A.useState(null),[u,d]=A.useState(null),[h,f]=A.useState(""),[p,g]=A.useState(!1),y=w=>{if(w.preventDefault(),!!h.trim()){if(h.length<10){c("ID  UUID");return}localStorage.setItem("gtd_user_id",h.trim()),window.location.href="/"}},m=async w=>{w.preventDefault(),e(!0),c(null),d(null);try{if(!le)throw new Error("Supabase client not initialized");if(o==="signup"){const{error:S}=await le.auth.signUp({email:n,password:s});if(S)throw S;d("")}else{const{error:S}=await le.auth.signInWithPassword({email:n,password:s});if(S)throw S}}catch(S){c(S.message)}finally{e(!1)}},v=async w=>{if(!le)return;const{error:S}=await le.auth.signInWithOAuth({provider:w,options:{redirectTo:window.location.origin}});S&&(S.message.includes("Unsupported provider")?c("Google  Email "):c(S.message))};return x.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:x.jsxs("div",{className:"w-full max-w-md bg-white rounded-2xl shadow-xl p-8 border border-gray-100",children:[x.jsxs("div",{className:"flex flex-col items-center mb-8",children:[x.jsx("div",{className:"w-12 h-12 bg-indigo-600 rounded-xl flex items-center justify-center text-white mb-4 shadow-lg shadow-indigo-200",children:x.jsx(VE,{size:24})}),x.jsx("h1",{className:"text-2xl font-bold text-gray-900 tracking-tight",children:"Things Clone"}),x.jsx("p",{className:"text-sm text-gray-500 mt-2",children:""})]}),l&&x.jsx("div",{className:"mb-4 p-3 bg-red-50 text-red-600 text-sm rounded-lg border border-red-100",children:l}),u&&x.jsx("div",{className:"mb-4 p-3 bg-green-50 text-green-600 text-sm rounded-lg border border-green-100",children:u}),x.jsxs("form",{onSubmit:m,className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1 ml-1",children:"Email"}),x.jsxs("div",{className:"relative",children:[x.jsx(HM,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),x.jsx("input",{type:"email",required:!0,value:n,onChange:w=>r(w.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-100 focus:border-indigo-400 outline-none transition-all text-sm",placeholder:"name@example.com"})]})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1 ml-1",children:"Password"}),x.jsxs("div",{className:"relative",children:[x.jsx(zM,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),x.jsx("input",{type:"password",required:!0,value:s,onChange:w=>i(w.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-100 focus:border-indigo-400 outline-none transition-all text-sm",placeholder:"",minLength:6})]})]}),x.jsx("button",{type:"submit",disabled:t,className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-2.5 rounded-lg transition-all flex items-center justify-center gap-2 shadow-lg shadow-indigo-100 disabled:opacity-70 disabled:cursor-not-allowed",children:t?x.jsx(Ha,{className:"animate-spin",size:18}):x.jsxs(x.Fragment,{children:[o==="signin"?"":"",x.jsx($E,{size:16})]})})]}),x.jsxs("div",{className:"mt-6",children:[x.jsxs("div",{className:"relative",children:[x.jsx("div",{className:"absolute inset-0 flex items-center",children:x.jsx("div",{className:"w-full border-t border-gray-200"})}),x.jsx("div",{className:"relative flex justify-center text-sm",children:x.jsx("span",{className:"px-2 bg-white text-gray-500 text-xs",children:""})})]}),x.jsx("div",{className:"mt-6 grid grid-cols-1 gap-3",children:x.jsxs("button",{type:"button",onClick:()=>v("google"),className:"w-full inline-flex justify-center py-2.5 px-4 border border-gray-200 rounded-lg shadow-sm bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 transition-colors",children:[x.jsxs("svg",{className:"h-5 w-5 mr-2",viewBox:"0 0 24 24",children:[x.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),x.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),x.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),x.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Google"]})})]}),x.jsxs("div",{className:"mt-6",children:[x.jsxs("div",{className:"relative",children:[x.jsx("div",{className:"absolute inset-0 flex items-center",children:x.jsx("div",{className:"w-full border-t border-gray-200"})}),x.jsx("div",{className:"relative flex justify-center text-sm",children:x.jsx("span",{className:"px-2 bg-white text-gray-500 text-xs",children:" / "})})]}),x.jsx("div",{className:"mt-4",children:p?x.jsxs("form",{onSubmit:y,className:"flex gap-2",children:[x.jsx("input",{type:"text",placeholder:" Guest ID (UUID)...",value:h,onChange:w=>f(w.target.value),className:"flex-1 text-xs border border-gray-200 rounded px-2 py-1.5 focus:ring-1 focus:ring-indigo-300 outline-none"}),x.jsx("button",{type:"submit",className:"text-xs bg-gray-800 text-white px-3 py-1.5 rounded hover:bg-black transition-colors",children:""})]}):x.jsx("button",{onClick:()=>g(!0),className:"w-full text-xs text-gray-400 hover:text-gray-600 underline text-center",children:" Guest ID "})})]}),x.jsx("div",{className:"mt-6 text-center",children:x.jsx("button",{type:"button",onClick:()=>a(o==="signin"?"signup":"signin"),className:"text-sm text-indigo-600 hover:text-indigo-500 font-medium",children:o==="signin"?"":""})})]})})},wV=({message:t=""})=>x.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 p-4",children:x.jsxs("div",{className:"bg-[#1c1c1e] rounded-2xl shadow-2xl p-12 flex flex-col items-center justify-center min-w-[320px] max-w-md",children:[x.jsxs("div",{className:"bg-red-500/20 p-4 rounded-full mb-6",children:[x.jsx("div",{className:"bg-red-500 w-2 h-8 rounded-full mb-1 mx-auto"}),x.jsx("div",{className:"bg-red-500 w-2 h-2 rounded-full mx-auto"})]}),x.jsx("h1",{className:"text-white text-xl font-bold tracking-wide",children:t}),x.jsx("p",{className:"text-gray-500 text-xs mt-4 max-w-xs text-center break-all",children:t===""?"Check .env file and console logs.":""})]})}),xV=()=>{const{user:t,loading:e,initError:n}=A.useContext(Vn);if(e)return x.jsx("div",{className:"h-screen flex items-center justify-center bg-gray-50",children:x.jsxs("div",{className:"flex flex-col items-center gap-3",children:[x.jsx("div",{className:"w-8 h-8 border-2 border-indigo-600 border-t-transparent rounded-full animate-spin"}),x.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Loading workspace..."})]})});if(n)return x.jsx(wV,{message:n==="Supabase client not initialized"?"":n});const r=!!t;return x.jsxs(aN,{children:[x.jsx(vm,{path:"/login",element:r?x.jsx(m1,{to:"/",replace:!0}):x.jsx(vV,{})}),x.jsx(vm,{path:"/*",element:r?x.jsx(yV,{}):x.jsx(m1,{to:"/login",replace:!0})})]})};function bV(){return x.jsx(IN,{children:x.jsx(SM,{children:x.jsx(xV,{})})})}Ep.createRoot(document.getElementById("root")).render(x.jsx(bV,{}));
